# æ„å»º Python é¡¹ç›®çš„å¥½æ–¹æ³•

> åŸæ–‡ï¼š<https://towardsdatascience.com/the-good-way-to-structure-a-python-project-d914f27dfcc9>

## *ä½œä¸ºä¸€åæ•°æ®åˆå­¦è€…ï¼Œæˆ‘å¸Œæœ›æˆ‘çŸ¥é“çš„ä¸€äº›ç®€å•çš„ Python å»ºè®®*

![](img/bd891bdcd39efccf3c15ebb8d68148f6.png)

[ç…§ç‰‡](https://unsplash.com/photos/6CszxGveP8U)ä½œè€…[è²å¥¥å¨œÂ·æ–¯è«ä¼å¾·](https://unsplash.com/@thepeoplesdigital)

æ— è®ºä½ æ˜¯ç‹¬è‡ªå®Œæˆä¸€ä¸ªé¡¹ç›®ï¼Œè¿˜æ˜¯ä¸ä»–äººåˆä½œï¼Œéƒ½æœ‰ä¸‰ä¸ªç®€å•çš„å°è´´å£«å¸®åŠ©ä½ ä¿æŒç©ºé—´æ•´æ´ã€‚

*   [æç¤º 1:åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ](#da77)
*   [æç¤º#2:ä¸ºæµ‹è¯•åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ç›®å½•](#6492)
*   æŠ€å·§ 3:åˆ›å»ºä¸åŒçš„å†…å®¹ç›®å½•

å¦‚æœä½ æƒ³æ›´è¿›ä¸€æ­¥ï¼Œä½ è¿˜åº”è¯¥:

*   æŠ€å·§ 4:è®°å½•ä½ çš„ä»£ç 
*   [æç¤º 5:ä½¿ç”¨ GitHub è¿›è¡Œç‰ˆæœ¬æ§åˆ¶](#15e6)

æœ‰äº›éƒ¨åˆ†ä¸ PyCharm æœ‰å…³ã€‚å¦‚æœæ‚¨ä½¿ç”¨å…¶ä»– IDEï¼Œå¯ä»¥è·³è¿‡å®ƒã€‚

# æŠ€å·§ 1:åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒ

ä¸ºäº†ä¿æŒä½ çš„é¡¹ç›®ç©ºé—´è¿è¡Œï¼Œåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒå¹¶ä¿æŒä½ çš„ä¾èµ–å…³ç³»æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚

å¯ä»¥ä½¿ç”¨ Python çš„`venv`æ¨¡å—ï¼ŒæŒ‡å®š Python ç‰ˆæœ¬å’Œç¯å¢ƒåã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä½¿ç”¨ Python3 å¹¶è°ƒç”¨ç¯å¢ƒ venvã€‚ä¸€æ—¦åˆ›å»ºäº†ç›®å½•ï¼Œæ‚¨éœ€è¦åœ¨å…¶ä¸­è¿è¡Œè„šæœ¬`activate`ã€‚

![](img/07c96453d1ab7fa605192e53b93e1ca7.png)

*ä½œè€…å›¾ç‰‡*

**å‘½ä»¤æ¦‚è¦:**

1.  `python3 -m venv venv` â†’ *åˆ›å»º*ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒ
2.  `source venv/bin/activate` â†’ *æ¿€æ´»*ç¯å¢ƒ
3.  `deactivate` â†’ *è§£é™¤*ç¯å¢ƒ

**ğŸ‘â€ğŸ—¨Â·çš®æŸ¥å§†è§è§£**

å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ PyCharmï¼Œæ‚¨å°†ä¼šçœ‹åˆ°ä¸€ä¸ª`venv` ç›®å½•å‡ºç°åœ¨å·¦ä¾§çš„é¡¹ç›®ç›®å½•ä¸­ã€‚ä¸€äº›ä¸œè¥¿ä¼šè‡ªåŠ¨å®‰è£…åœ¨é‡Œé¢ã€‚æœ€æœ‰å¯èƒ½çš„æ˜¯ï¼Œä½ åªå…³å¿ƒ`activate`è„šæœ¬â€”â€”æ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°çš„ã€‚

![](img/dc14afbed2a8e83510eba59beea546d6.png)

*ä½œè€…å›¾ç‰‡*

é‡è¦çš„æ˜¯ï¼Œåœ¨ PyCharm ä¸­ï¼Œæ‚¨åº”è¯¥é‡‡å–é¢å¤–çš„æ­¥éª¤ï¼Œä»¥ä¾¿æ‚¨çš„ç¨‹åºå¯ä»¥åœ¨æ‚¨çš„è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œã€‚

å»å³ä¸‹è§’ã€‚æ‚¨åº”è¯¥çœ‹åˆ° PyCharm ä½¿ç”¨çš„æ˜¯å“ªä¸ªè§£é‡Šå™¨ã€‚

![](img/7fe6c4f687ec5552f53dd337ff88fe1d.png)

*ä½œè€…å›¾ç‰‡*

ç‚¹å‡»â€œæ·»åŠ è§£é‡Šå™¨â€å¹¶é€‰æ‹©â€œç°æœ‰ç¯å¢ƒâ€é€‰é¡¹ã€‚
æ¥ä¸‹æ¥ï¼Œå¯¼èˆªåˆ°æ‚¨åˆ›å»ºç¯å¢ƒçš„æ–‡ä»¶å¤¹ï¼Œå¹¶ä»`bin`ç›®å½•ä¸­é€‰æ‹© Pythonã€‚

![](img/5d46803c7bbe60095dadb0bf9754bd90.png)

*ä½œè€…å›¾ç‰‡*

å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæ‚¨åº”è¯¥åœ¨å³ä¸‹è§’çœ‹åˆ°è™šæ‹Ÿç¯å¢ƒä¸­å­˜åœ¨çš„ Python ç‰ˆæœ¬ã€‚ä¸é”™ï¼ğŸŠ

![](img/830780ca2d4d1e4dbd1e36012beca11f.png)

*ä½œè€…å›¾ç‰‡*

ç®€è€Œè¨€ä¹‹ï¼Œè™šæ‹Ÿç¯å¢ƒå…è®¸æ‚¨:

1.  **ä¿æŒä¾èµ–æ€§éš”ç¦»ã€‚è¿™é¿å…äº†æ‚¨çš„é¡¹ç›®ä½¿ç”¨ä¸åŒçš„åŒ…ç‰ˆæœ¬ï¼Œå¹¶ä¸”æ¯æ¬¡æ‚¨éœ€è¦è¿è¡Œä¸€ä¸ªé¡¹ç›®æ—¶ï¼Œæ‚¨éƒ½è¦å…¨å±€å¸è½½/é‡æ–°å®‰è£…æ‚¨éœ€è¦çš„ä¸œè¥¿ã€‚**
2.  **ä¸ä»–äººåˆ†äº«ä½ çš„ä¾èµ–ã€‚**

ä¸€æ—¦å®‰è£…äº†é¡¹ç›®éœ€è¦çš„æ‰€æœ‰åŒ…ï¼Œå°±å¯ä»¥è¿è¡Œ:

`pip freeze > requirements.txt`

`pip freeze`æ˜¯â€œå†»ç»“â€å½“å‰æ­£åœ¨ä½¿ç”¨çš„æ‰€æœ‰åŒ…/ç‰ˆæœ¬ã€‚ç„¶åä½ é€šè¿‡ä¸€ä¸ª txt æ–‡ä»¶ä¼ è¾“(å³ä¿å­˜)äº†`pip freeze`çš„è¾“å‡ºã€‚

ä½¿ç”¨æ‚¨çš„ç¨‹åºçš„å…¶ä»–äººå°†ä¼šè¿è¡Œ:

`pip install -r requirements.txt`

å¹¶ä¸”èƒ½å¤Ÿä¸€æ¬¡æ€§å®‰è£…æ‰€æœ‰çš„è½¯ä»¶åŒ…å’Œæ­£ç¡®çš„ç‰ˆæœ¬ã€‚å¾ˆç¥å¥‡å§ï¼ŸğŸš€

![](img/567cb19cc9898d2bcf3de5c9a2f5dfb5.png)

*ä½œè€…å›¾ç‰‡*

# æŠ€å·§#2:ä¸ºæµ‹è¯•åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ç›®å½•

æ‚¨å¬è¯´è¿‡ä¸ºæ‚¨çš„ä»£ç åˆ›å»ºæµ‹è¯•æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚æ‰€ä»¥ä½ æ­£åœ¨ç¼–å†™ Python ä»£ç ï¼Œå¹¶è¯•å›¾ç”¨ Pytest æµ‹è¯•å®ƒã€‚

ä¾‹å¦‚:å‡è®¾ä½ åˆ›å»ºäº†ä¸€ä¸ªåä¸º`greetings.py`çš„æ–‡ä»¶å’Œå¦ä¸€ä¸ªåä¸º`test_greetings.py`çš„æ–‡ä»¶æ¥ç¼–å†™ä¸€äº›æµ‹è¯•ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ Pytest ä½œä¸ºæµ‹è¯•åŒ…ã€‚Pytest æœ‰å¾ˆå¤šå‘½åçº¦å®šã€‚æ–‡ä»¶åä»¥`test_`å¼€å¤´å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚å¦‚æœæ‚¨éµå¾ªå®ƒï¼ŒPytest å°†è‡ªåŠ¨åœ¨å½“å‰ç›®å½•åŠå…¶ä¸‹çš„ç›®å½•ä¸­æŸ¥æ‰¾ä»¥`test_`å¼€å¤´çš„æ–‡ä»¶å¹¶è¿è¡Œå®ƒä»¬ã€‚

è¦åˆ›å»ºæ–°æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨`touch`å‘½ä»¤:

![](img/9bb9f99ce1891eb3e41d4cef28721ebc.png)

*ä½œè€…å›¾ç‰‡*

åœ¨ PyCharm çš„å³ä¸Šæ–¹ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°è¿™æ ·çš„å†…å®¹:

![](img/48d69d7ca2f7ceca73fe5bf8a56ca1e8.png)

*ä½œè€…å›¾ç‰‡*

æ‰“å¼€`greetings.py`ï¼Œå†™ä¸€ä¸ªç®€å•çš„å‡½æ•°:

åœ¨æ‚¨çš„ç»ˆç«¯ä¸­ï¼Œæ‚¨å¯ä»¥è¿è¡Œ`pip install pytest`æ¥å®‰è£…`pytest`æ¨¡å—ï¼Œç„¶åç®€å•åœ°å®‰è£…`pytest`ã€‚ç”±äºæ‚¨å°šæœªå®šä¹‰ä»»ä½•æµ‹è¯•ï¼Œ`pytest`å°†è¿è¡Œï¼Œä½†ä¼šæ”¶é›† 0 ä¸ªé¡¹ç›®ã€‚

![](img/be48500c12e9cd37f8d737d3521bd7a9.png)

ä½œè€…å›¾ç‰‡

æ‰“å¼€`test_greetings.py`å¹¶ç¼–å†™ä¸€ä¸ªæµ‹è¯•å‡½æ•°:

å¦‚æœæ‚¨æ³¨æ„åˆ°ï¼Œå‡½æ•°åä¹Ÿéœ€è¦ä»¥`test_`å¼€å¤´ï¼Œä¾‹å¦‚`test_say_hello`ã€‚è¿™æ˜¯å¦ä¸€ä¸ª Pytest å‘½åçº¦å®šã€‚

## å¦‚ä½•è°ƒè¯•æ¨¡å—æœªæ‰¾åˆ°é”™è¯¯

å¦ä¸€ä¸ªå¥½ä¸»æ„æ˜¯å°†æ‰€æœ‰çš„æµ‹è¯•æ”¶é›†åœ¨ä¸€ä¸ªç›®å½•ä¸­ã€‚

ç„¶è€Œï¼Œå¦‚æœæ‚¨åªæ˜¯è¿™æ ·åšï¼Œå½“æ‚¨ç°åœ¨è¿è¡Œ`pytest`æ—¶ï¼Œæ‚¨å°†ä¼šçœ‹åˆ°æ‚¨çš„æµ‹è¯•éƒ½æ²¡æœ‰å·¥ä½œã€‚å¦‚æœä½ ä»”ç»†çœ‹ï¼Œä½ å¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ª`ModuleNotFoundError`ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆä»¥åŠå¦‚ä½•ä¿®å¤å®ƒã€‚

![](img/379a72e86dc69f0868977a7ac2166087.png)

ä½œè€…å›¾ç‰‡

Pytest è¯•å›¾å¯¼å…¥`greetings`æ¨¡å—ï¼Œä½†æ˜¯å¤±è´¥äº†ã€‚
è§£å†³è¿™ä¸ªé—®é¢˜æœ€ç®€å•çš„æ–¹æ³•æ˜¯å‡è®¾`test`ç›®å½•æ˜¯ä¸€ä¸ªåŒ…(å³æ¨¡å—çš„é›†åˆ)ã€‚åœ¨ç›®å½•ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º`__init__.py`çš„æ–‡ä»¶

![](img/22a3ed57feb2278e53dbb754fc79a939.png)

*ä½œè€…å›¾ç‰‡*

è¿™æ˜¯ä¸€ä¸ªå®Œå…¨ç©ºçš„æ–‡ä»¶:

![](img/1af8716999fe23d300294a9b2a77ff17.png)

*ä½œè€…å›¾ç‰‡*

ç„¶è€Œï¼Œåœ¨é‚£é‡Œçš„ç®€å•äº‹å®ä½¿æ‚¨çš„æµ‹è¯•å†æ¬¡å·¥ä½œã€‚

![](img/910eb33e99cae7100b13f687ad489192.png)

ä½œè€…å›¾ç‰‡

ç§å•Šã€‚ğŸ·

# æŠ€å·§ 3:åˆ›å»ºä¸åŒçš„å†…å®¹ç›®å½•

æ—¢ç„¶æ‚¨å·²ç»æœ‰äº†åˆ›å»ºä¸€ä¸ª`__init__.py`æ–‡ä»¶çš„æƒ³æ³•ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥åˆ›å»ºä»»æ„å¤šçš„ç›®å½•ã€‚

ä¾‹å¦‚:

åŸºæœ¬ä¸Š:

> `__init__.py`ç”¨äºå°†ç›®å½•æ ‡è®°ä¸º Python åŒ…ç›®å½•

å¦‚æœæ‚¨åˆ é™¤äº†`__init__.py`æ–‡ä»¶ï¼ŒPython å°†ä¸å†åœ¨è¯¥ç›®å½•ä¸­å¯»æ‰¾å­æ¨¡å—ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨è¯•å›¾å°†è¯¥æ¨¡å—å¯¼å…¥åˆ°å…¶ä»–åœ°æ–¹ï¼Œå®ƒå°†ä¼šå¤±è´¥ã€‚

# æŠ€å·§ 4:è®°å½•ä½ çš„ä»£ç 

è®°å½•ä½ çš„ä»£ç å¯¹äºâ€œæœªæ¥â€çš„ä½ å’Œå…¶ä»–é˜…è¯»ä½ çš„é¡¹ç›®çš„äººéƒ½æ˜¯éå¸¸é‡è¦çš„ã€‚ä¸€äº›ç¨‹åºå‘˜ç”šè‡³è¯´:

> å¦‚æœå¾ˆéš¾è®°å½•ä½ çš„ä»£ç ï¼Œè€ƒè™‘æ”¹å˜è®¾è®¡ã€‚

æœ‰ 3 ä»¶é‡è¦çš„äº‹æƒ…ä½ åº”è¯¥è®°ä½:

1.  åœ¨æ¯ä¸ªæ–‡ä»¶çš„å¼€å¤´æ·»åŠ ä¸€ä¸ªå¸¦æœ‰æè¿°çš„ docstring

![](img/2d90dd2aa6937d443441c881386a8f47.png)

*ä½œè€…å›¾ç‰‡*

2.å‘æ¯ä¸ªå‡½æ•°å’Œç±»æ·»åŠ ä¸€ä¸ª docstring

![](img/55ec28ae9ed5e26808a5895abcef84b0.png)

*ä½œè€…å›¾ç‰‡*

3.æ¯å½“ä½ å®šä¹‰ä¸€ä¸ªå‡½æ•°æˆ–è€…ä¸€ä¸ªç±»çš„æ—¶å€™ä½¿ç”¨ç±»å‹æç¤º

![](img/4b28e8110df18045476176d434eb86f1.png)

*ä½œè€…å›¾ç‰‡*

ç±»å‹æç¤º(1)ä½¿å‡½æ•°å’Œç±»æ›´å…·å¯è¯»æ€§ï¼Œ(2)å…è®¸ä½ ç»•è¿‡åœ¨æ–‡æ¡£ä¸­æŒ‡å®šå‚æ•°çš„ç±»å‹ï¼Œä»¥åŠ(3)ä½ å¯ä»¥ä½¿ç”¨å®ƒä»¬é€šè¿‡`mypy`è‡ªåŠ¨æ£€æŸ¥ä½ çš„ä»£ç ã€‚ğŸ–

**æœ‰å¾ˆå¤šå†™å¥½æ–‡æ¡£çš„é£æ ¼æŒ‡å—ã€‚æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢**[**Google Style Python Docstring**](https://sphinxcontrib-napoleon.readthedocs.io/en/latest/example_google.html)**ã€‚**

# æŠ€å·§ 5:ä½¿ç”¨ GitHub è¿›è¡Œç‰ˆæœ¬æ§åˆ¶

å¦‚æœä½ å’Œå…¶ä»–äººä¸€èµ·å·¥ä½œï¼Œ`Git + GitHub`å¯¹äºè¿›è¡Œä»£ç å®¡æŸ¥å’Œé¿å…åˆå¹¶å†²çªæ˜¯å¿…ä¸å¯å°‘çš„ã€‚

å¦‚æœæ‚¨æ˜¯ç‹¬è‡ªå·¥ä½œï¼Œå®ƒä»¬ä»ç„¶æœ‰åŠ©äºä¿å­˜æ‚¨çš„å·¥ä½œï¼Œå¹¶èƒ½å¤Ÿæ¢å¤æ›´æ”¹å’Œâ€œå›åˆ°è¿‡å»â€ã€‚

ğŸ¢å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰è¿™äº›æ¦‚å¿µï¼Œæ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ›´å¤šä¿¡æ¯:

*   [é¢å‘ Python å¼€å‘è€…çš„ Git å’Œ GitHub ä»‹ç»](https://realpython.com/python-git-github-intro/)(å…è´¹)
*   [æ–°æ‚å¿—:å“¦ï¼Œå¦ˆçš„ï¼Œé¥­æ¡¶ï¼](https://jvns.ca/blog/2018/10/27/new-zine--oh-shit--git-/)(å·²ä»˜è´¹)

ğŸ˜±å¦‚æœæ‚¨å‘ç°è‡ªå·±åœ¨å¼€å§‹ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶æ—¶æ„Ÿåˆ°ææ…Œ:

*   å“¦ï¼Œå¦ˆçš„ï¼Œé¥­æ¡¶ï¼ï¼Ÿï¼

ğŸ’ªå¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šä¿¡æ¯:

*   [æ¬¢è¿å­¦ä¹  Git åˆ†æ”¯](https://learngitbranching.js.org/)

ä½¿ç”¨ Git çš„ç¬¬ä¸€ç§æ–¹æ³•å¾ˆç³Ÿç³•ï¼Œä½†æ˜¯æˆ‘ä¿è¯ä¼šæœ‰å›æŠ¥çš„ã€‚æˆ‘ä»¬éƒ½ç»å†è¿‡ğŸ™‡â€â™€ï¸

æˆ‘å¸Œæœ›è¿™æ˜¯æœ‰ç”¨çš„ï¼âš¡ï¸

**å‚è€ƒæ–‡çŒ®**

*   [æ–°è¯¾ç¨‹:ç”¨ pytest æµ‹è¯•æ‚¨çš„ Python ç¨‹åº](https://lerner.co.il/2020/08/31/new-course-testing-your-python-programs-with-pytest/)
*   [https://flax.readthedocs.io/en/latest/philosophy.html](https://flax.readthedocs.io/en/latest/philosophy.html)
*   [http://web.archive.org/web/20111010053227/](http://web.archive.org/web/20111010053227/http://jaynes.colorado.edu/PythonGuidelines.html#module_formatting)
*   [http://jaynes . Colorado . edu/python guidelines . html # module _ formatting](http://web.archive.org/web/20111010053227/http://jaynes.colorado.edu/PythonGuidelines.html#module_formatting)
*   [https://realpython.com/lessons/type-checking-mypy/](https://realpython.com/lessons/type-checking-mypy/)
*   [ä»€ä¹ˆæ˜¯ __init__ã€‚py ç”¨äºï¼Ÿ](https://web.archive.org/web/20200721150953/http://effbot.org/pyfaq/what-is-init-py-used-for.htm)
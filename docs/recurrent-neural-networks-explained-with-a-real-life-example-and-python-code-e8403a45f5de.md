# ç”¨ä¸€ä¸ªçœŸå®çš„ä¾‹å­å’Œ Python ä»£ç è§£é‡Šé€’å½’ç¥ç»ç½‘ç»œ

> åŸæ–‡ï¼š<https://towardsdatascience.com/recurrent-neural-networks-explained-with-a-real-life-example-and-python-code-e8403a45f5de>

## åœ¨æƒ…æ„Ÿåˆ†æä»»åŠ¡ä¸­ä½¿ç”¨é€’å½’ç¥ç»ç½‘ç»œ

![](img/6298ff1da60b91e60300c7b8d521ab0d.png)

ä½œè€…å›¾ç‰‡

è¿™æ˜¯è‡´åŠ›äºæ·±åº¦å­¦ä¹ ç³»åˆ—çš„ç¬¬äºŒç¯‡æ–‡ç« ï¼Œæ·±åº¦å­¦ä¹ æ˜¯ä¸€ç»„å¯ä»¥è¿½æº¯åˆ° 20 ä¸–çºª 40 å¹´ä»£çš„æœºå™¨å­¦ä¹ æ–¹æ³•ã€‚æ·±åº¦å­¦ä¹ åœ¨è¿‡å»å‡ åå¹´ä¸­å› å…¶åœ¨å›¾åƒåˆ†ç±»ã€è¯­éŸ³è¯†åˆ«å’Œæœºå™¨ç¿»è¯‘ç­‰é¢†åŸŸçš„å¼€åˆ›æ€§åº”ç”¨è€Œå—åˆ°å…³æ³¨ã€‚

ç¬¬ä¸€ç¯‡æ–‡ç« å…³æ³¨å¤šå±‚æ„ŸçŸ¥å™¨ã€‚å¦‚æœä½ æƒ³çœ‹ç”¨ç°å®ç”Ÿæ´»ä¸­çš„ä¾‹å­å’Œä¸€äº› Python ä»£ç è§£é‡Šä¸åŒçš„æ·±åº¦å­¦ä¹ ç®—æ³•ï¼Œè¯·ç»§ç»­å…³æ³¨ã€‚

å¤šå±‚æ„ŸçŸ¥å™¨çš„å‘å±•æ˜¯äººå·¥ç¥ç»ç½‘ç»œçš„ä¸€ä¸ªé‡è¦é‡Œç¨‹ç¢‘ã€‚ç¬¬ä¸€æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥*å°†è®¸å¤šæ„ŸçŸ¥æœºå †å åœ¨ä¸€èµ·*ï¼Œå¹¶æŒ‰å±‚ç»„ç»‡å®ƒä»¬ï¼Œä»¥åˆ›å»ºæœ€èƒ½ä»£è¡¨å¤æ‚é—®é¢˜çš„æ¨¡å‹ã€‚

å¤šå±‚æ„ŸçŸ¥å™¨ä»¥æš‚æ—¶çš„ã€ç¦»æ•£çš„æ–¹å¼å·¥ä½œã€‚å®ƒé‡‡ç”¨ä¸€ä¸ªè¾“å…¥å‘é‡ï¼Œæ‰§è¡Œä¸€ä¸ªå‰é¦ˆè®¡ç®—æ­¥éª¤ï¼Œåå‘ä¼ æ’­è¯¯å·®ï¼Œä¸€æ—¦æŸå¤±å‡½æ•°ä¸èƒ½å†æœ€å°åŒ–ï¼Œå°±åœæ­¢ï¼Œç”Ÿæˆè¾“å‡ºã€‚

![](img/653f680dd63004d90c7869221dcec991.png)

*æœ‰ä¸€ä¸ªéšè—å±‚çš„å¤šå±‚æ„ŸçŸ¥å™¨çš„ä¾‹å­ã€‚(å›¾ç‰‡ç”±ä½œè€…æä¾›)*

ä½†æ˜¯è®¸å¤šç°å®ä¸–ç•Œçš„é—®é¢˜éƒ½æ¶‰åŠåˆ°æ—¶é—´ç»´åº¦ã€‚å½“æ‰‹å¤´çš„é—®é¢˜ä»¥åºåˆ—çš„å½¢å¼å‡ºç°æ—¶å‘¢ï¼Ÿ

# ç”¨äºæƒ…æ„Ÿåˆ†æçš„ç¥ç»ç½‘ç»œ

åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œä½ ä½¿ç”¨äº†[å¤šå±‚æ„ŸçŸ¥å™¨è¿›è¡Œæƒ…æ„Ÿåˆ†æ](/multilayer-perceptron-explained-with-a-real-life-example-and-python-code-sentiment-analysis-cb408ee93141)ã€‚ä½ æ‹¿äº†ä½ çˆ¶æ¯åœ¨ä¹¡ä¸‹èˆ’é€‚çš„åºŠå’Œæ—©é¤çš„è¯„è®ºï¼Œè®­ç»ƒäº†ä¸€ä¸ªå¤šå±‚æ„ŸçŸ¥å™¨ï¼Œå¹¶é¢„æµ‹äº†è¯„è®ºçš„æ•´ä½“æƒ…ç»ªã€‚

![](img/ef468aa3733f096213057bc4aa000448.png)

*å¤šå±‚æ„ŸçŸ¥å™¨ç”¨æ¥ä»ä½ çˆ¶æ¯çš„æ°‘å®¿å­¦ä¹ è¯„è®ºçš„æƒ…ç»ªã€‚(å›¾ç‰‡ç”±ä½œè€…æä¾›)*

å¤šå±‚æ„ŸçŸ¥å™¨ä½¿ç”¨æ¯ç¯‡è¯„è®ºçš„ç¬¦å·åŒ–å•è¯å‘é‡ä½œä¸ºè¾“å…¥ï¼Œä½†å®ƒ*çœ‹ç€*æ¯ç¯‡è¯„è®ºä¸€ä¸ªå•ç‹¬çš„åŸå­å•ä½ã€‚

åˆ†æè¿™äº›è¯„è®ºçš„æ›´ç²¾ç¡®çš„æ–¹æ³•æ˜¯è€ƒè™‘æ¯ä¸ªå•è¯åœ¨è¯„è®ºä¸­çš„ä½ç½®ï¼Œå› ä¸ºå¥å­çš„ç»“æ„åœ¨èµ‹äºˆå…¶æ„ä¹‰æ–¹é¢èµ·ç€ä½œç”¨ã€‚

ä¸€ä¸ªæ¯”å¤šå±‚æ„ŸçŸ¥å™¨æ›´å¼ºå¤§çš„æ¨¡å‹å°†æ ¹æ®æ¯ä¸ªå¥å­çš„ç»“æ„æ¥åˆ†æè¯„è®ºã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ç±»ä¼¼äº*è¿™ä¸€æ¬¡çš„æœåŠ¡å¾ˆæ£’*å’Œ*è¿™ä¸€æ¬¡çš„æœåŠ¡å¾ˆæ£’*è¿™æ ·çš„å¥å­ï¼Œç¡®å®šè¿™äº›å¥å­æœ‰ç›¸åŒçš„æƒ…æ„Ÿå°±è¶³å¤Ÿèªæ˜äº†[1]ã€‚å³ä½¿å•è¯è¢«æ‰“ä¹±äº†ã€‚

ä¸ºäº†åœ¨æƒ…æ„Ÿåˆ†æä»»åŠ¡ä¸­æ›´è¿›ä¸€æ­¥ï¼Œæ‚¨éœ€è¦ä¸€ä¸ªä¸åŒçš„æ¨¡å‹ã€‚

ä½ éœ€è¦ä¸€ä¸ªæ¨¡å‹ï¼Œè®©*åœ¨æ¯æ¬¡è¯„è®ºä¸­æŠŠ*çœ‹åšæœ‰åºçš„å•è¯åºåˆ—ï¼Œè€Œä¸æ˜¯åŸå­å•ä½ã€‚æ¯ä¸ªå•è¯åºåˆ—ä¹Ÿå¯ä»¥æœ‰ä»»æ„é•¿åº¦ï¼Œå› ä¸ºæ¯ä¸ªå¥å­å¯ä»¥ç”±ä¸åŒæ•°é‡çš„å•è¯ç»„æˆã€‚

ä½ éœ€è¦å»ºç«‹ä¸€ä¸ª[é€’å½’ç¥ç»ç½‘ç»œ](https://en.wikipedia.org/wiki/Recurrent_neural_network)ã€‚

# é€’å½’ç¥ç»ç½‘ç»œ

**å¾ªç¯ç¥ç»ç½‘ç»œ**ç”¨äºå¤šä¸ªé¢†åŸŸã€‚ä¾‹å¦‚ï¼Œåœ¨[è‡ªç„¶è¯­è¨€å¤„ç†](https://en.wikipedia.org/wiki/Natural_language_processing) (NLP)ä¸­ï¼Œå®ƒä»¬è¢«ç”¨äº[ç”Ÿæˆæ‰‹å†™æ–‡æœ¬](https://arxiv.org/abs/1308.0850)ï¼Œæ‰§è¡Œ[æœºå™¨ç¿»è¯‘](https://arxiv.org/pdf/1409.3215.pdf)å’Œ[è¯­éŸ³è¯†åˆ«](http://proceedings.mlr.press/v32/graves14.pdf)ã€‚ä½†æ˜¯å®ƒä»¬çš„åº”ç”¨å¹¶ä¸å±€é™äºå¤„ç†è¯­è¨€ã€‚åœ¨[è®¡ç®—æœºè§†è§‰](https://en.wikipedia.org/wiki/Computer_vision)ä¸­ï¼Œé€’å½’ç¥ç»ç½‘ç»œå·²ç»è¢«ç”¨äºåƒ[å›¾åƒå­—å¹•](https://arxiv.org/abs/1411.4389)å’Œ[å›¾åƒé—®ç­”](https://arxiv.org/abs/1505.02074)è¿™æ ·çš„ä»»åŠ¡ä¸­ã€‚

å°†**é€’å½’ç¥ç»ç½‘ç»œ**ä¸[å¤šå±‚æ„ŸçŸ¥å™¨](/multilayer-perceptron-explained-with-a-real-life-example-and-python-code-sentiment-analysis-cb408ee93141)åŒºåˆ«å¼€æ¥çš„æ˜¯ï¼Œé€’å½’ç¥ç»ç½‘ç»œæ˜¯ä¸ºäº†å¤„ç†ä»£è¡¨åºåˆ—çš„è¾“å…¥è€Œæ„å»ºçš„ï¼Œå°±åƒä½ çˆ¶æ¯çš„åºŠå’Œæ—©é¤çš„è¯„è®ºä¸­çš„å•è¯åºåˆ—ã€‚ä½†å®ƒä¹Ÿå¤„ç†è¾“å‡ºåºåˆ—ï¼Œæ¯”å¦‚å½“ä½ æŠŠä¸€ä¸ªå¥å­ä»ä¸€ç§è¯­è¨€ç¿»è¯‘æˆå¦ä¸€ç§è¯­è¨€æ—¶ã€‚

**é€’å½’ç¥ç»ç½‘ç»œ**çš„ä½œç”¨å°±åƒä¸€æ¡é“¾ã€‚åœ¨æ¯ä¸ª*æ—¶é—´æ­¥é•¿*æ‰§è¡Œçš„è®¡ç®—å–å†³äºä¹‹å‰çš„è®¡ç®—ã€‚

æ·±åº¦å­¦ä¹ è®­ç»ƒçš„ç¥å¥‡ä¹‹å¤„åœ¨äºéšè—çš„å±‚ã€‚

åœ¨è®­ç»ƒçš„å¼€å§‹ï¼Œç½‘ç»œçš„ç»“æ„è¢«å®šä¹‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯ä¸€ä¸ªé€’å½’ç¥ç»ç½‘ç»œã€‚ä½†æ˜¯æˆ‘ä»¬åªçŸ¥é“å“ªäº›è¾“å…¥ä¸å“ªäº›è¾“å‡ºåŒ¹é…ã€‚è¯¥ç®—æ³•å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨éšè—å±‚æ¥å¯¹æ¯ä¸ªè¾“å…¥æ•°æ®ç‚¹è¿›è¡Œæœ€ä½³é€¼è¿‘ä»¥è¾“å‡ºæ•°æ®ç‚¹[1]ã€‚

# å¯è§†åŒ–é€’å½’ç¥ç»ç½‘ç»œ

å°†é€’å½’ç¥ç»ç½‘ç»œå¯è§†åŒ–çš„æœ€ä½³æ–¹å¼ä¹‹ä¸€æ˜¯ä½œä¸ºå¾ªç¯è®¡ç®—å›¾[1]ã€‚åœ¨è¿™ç§è¡¨ç¤ºä¸­ï¼Œé€’å½’ç¥ç»ç½‘ç»œå…·æœ‰ä¸‰ç§ä¸»è¦çŠ¶æ€:

*   **è¾“å…¥çŠ¶æ€**ï¼Œæ•æ‰æ¨¡å‹çš„è¾“å…¥æ•°æ®ã€‚
*   **è¾“å‡ºçŠ¶æ€**ï¼Œæ•æ‰æ¨¡å‹çš„ç»“æœã€‚
*   **é€’å½’çŠ¶æ€**ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªéšè—çŠ¶æ€é“¾ï¼Œæ•è·è¾“å…¥å’Œè¾“å‡ºçŠ¶æ€ä¹‹é—´çš„æ‰€æœ‰è®¡ç®—ã€‚

ä¸å…¶ä»–[ç›‘ç£æœºå™¨å­¦ä¹ æ¨¡å‹](https://en.wikipedia.org/wiki/Supervised_learning)ç±»ä¼¼ï¼Œé€’å½’ç¥ç»ç½‘ç»œä½¿ç”¨[æŸå¤±å‡½æ•°](https://en.wikipedia.org/wiki/Loss_function)å°†æ¨¡å‹çš„è¾“å‡ºä¸åŸºç¡€äº‹å®è¿›è¡Œæ¯”è¾ƒã€‚è¯¥æŸå¤±ç¨åè¢«åå‘ä¼ æ’­ï¼Œå¹¶ä¸”æ¨¡å‹æƒé‡è¢«æ›´æ–°ï¼Œå°±åƒåœ¨[å¤šå±‚æ„ŸçŸ¥å™¨](/multilayer-perceptron-explained-with-a-real-life-example-and-python-code-sentiment-analysis-cb408ee93141)ä¸­ä¸€æ ·ã€‚

![](img/7a05636ff4ea165659ce19f25f0ca793.png)

è¡¨ç¤ºä¸ºè®¡ç®—å›¾çš„é€’å½’ç¥ç»ç½‘ç»œã€‚*(å›¾ç‰‡ä½œè€…)*

è¿™æ˜¯ä¸€ä¸ª*å‹ç¼©è§†å›¾*ï¼Œæ›´åƒæ˜¯å¯¹é€’å½’ç¥ç»ç½‘ç»œæœºåˆ¶çš„æ€»ç»“ã€‚åœ¨å®è·µä¸­ï¼Œå½“ä½ *å±•å¼€*è¿™ä¸ªå›¾è¡¨æ—¶ï¼Œæ›´å®¹æ˜“å½¢è±¡åŒ–é‡ç°ã€‚å°¤å…¶æ˜¯åœ¨å¤„ç†æ–‡æœ¬åºåˆ—æ—¶ã€‚

åœ¨é€’å½’ç¥ç»ç½‘ç»œçš„*å±•å¼€è§†å›¾*ä¸­ï¼Œæ¯ä¸ªè®¡ç®—å¯¹åº”äºä¸€ä¸ª*æ­¥éª¤*ï¼Œä¹Ÿç§°ä¸ºå†…éƒ¨çŠ¶æ€ã€‚å¹¶ä¸”æ¯ä¸€æ­¥éƒ½ä¾èµ–äºå‰ä¸€æ­¥çš„è®¡ç®—ã€‚

![](img/a5aadba9e195f8d92a242bdca2780873.png)

*è¡¨ç¤ºä¸ºå±•å¼€çš„è®¡ç®—å›¾çš„é€’å½’ç¥ç»ç½‘ç»œã€‚(å›¾ç‰‡ç”±ä½œè€…æä¾›)*

ç”±äºæ¯ä¸ªå†…éƒ¨çŠ¶æ€éƒ½ä¾èµ–äºå‰ä¸€ä¸ªçŠ¶æ€ï¼Œæ‰€ä»¥ä»åºåˆ—å¼€å§‹èµ·ï¼Œä¿¡æ¯å°±ä¼ æ’­åˆ°äº†ç½‘ç»œä¸­çš„æ¯ä¸€å±‚ç¥ç»å…ƒä¸Šã€‚åƒæ˜¯ä¼ é€’ç»™åä»£çš„å¤è€è®°å¿†ã€‚

å¦‚æœå¤šå±‚æ„ŸçŸ¥å™¨æ„å‘³ç€åœ¨å±‚ä¸­å †å å¤šä¸ªç¥ç»å…ƒï¼Œé‚£ä¹ˆé€’å½’ç¥ç»ç½‘ç»œæ„å‘³ç€é“¾æ¥å¤šå±‚æ„ŸçŸ¥å™¨ï¼Œä»¥åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³çš„è®¡ç®—ã€‚

åœ¨é€’å½’ç¥ç»ç½‘ç»œçš„æƒ…å†µä¸‹ï¼Œ*å­˜å‚¨å™¨*æ˜¯å…³äºåˆ°ç›®å‰ä¸ºæ­¢åº”ç”¨äºåºåˆ—çš„è®¡ç®—çš„ä¿¡æ¯ã€‚

# é€’å½’ç¥ç»ç½‘ç»œè¶…çº§èƒ½åŠ›:å‚æ•°å…±äº«

*ç½‘ç»œä¸­æ‰€æœ‰æ—¶é—´æ­¥é•¿å…±äº«ä¸€ä¸ªæƒé‡å‘é‡ã€‚*

é€’å½’ç¥ç»ç½‘ç»œçš„ä¸€ä¸ªå…³é”®ç‰¹å¾æ˜¯**å‚æ•°å…±äº«**ã€‚åœ¨ç½‘ç»œçš„æ‰€æœ‰éƒ¨åˆ†ä¸­ï¼Œåªæœ‰ä¸€ç»„å‚æ•°è¢«ä½¿ç”¨å’Œä¼˜åŒ–ã€‚å¦‚æœè¿™äº›å‚æ•°æ²¡æœ‰è¢«å…±äº«ï¼Œæ¨¡å‹å°†ä¸å¾—ä¸*å­¦ä¹ *è¾“å…¥åºåˆ—çš„æ¯ä¸ªéƒ¨åˆ†çš„å‚æ•°ï¼Œå¹¶ä¸”å°†æœ‰æ›´å›°éš¾çš„æ—¶é—´æ¥æ¦‚æ‹¬å®ƒè¿˜æ²¡æœ‰è§è¿‡çš„ä¾‹å­[1]ã€‚

å…±äº«å‚æ•°ä½¿é€’å½’ç¥ç»ç½‘ç»œèƒ½å¤Ÿå¤„ç†ä¸åŒé•¿åº¦çš„è¾“å…¥ï¼Œå¹¶ä¸”ä»ç„¶åœ¨å¯æ¥å—çš„æ—¶é—´æ¡†æ¶å†…æ‰§è¡Œé¢„æµ‹ã€‚

å…±äº«å‚æ•°å¯¹äºæ¦‚åŒ–å…±äº«è¾“å…¥çš„åºåˆ—å°¤å…¶é‡è¦ï¼Œå°½ç®¡å®ƒä»¬ä½äºä¸åŒçš„ä½ç½®ã€‚åœ¨ä½ çˆ¶æ¯çš„ä½å®¿å’Œæ—©é¤è¯„è®ºçš„æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰å…±äº«çš„å‚æ•°ï¼Œç½‘ç»œå°†ä¼šæœ‰ä¸€æ®µéå¸¸è‰°éš¾çš„æ—¶é—´ï¼Œå¹¶å°†å¤šæ¬¡é‡å¤å­¦ä¹ ç›¸åŒçš„è¯­è¨€è§„åˆ™ï¼Œä»¥æ‰¾å‡ºç±»ä¼¼äº*è¿™ä¸€æ¬¡æœåŠ¡å¾ˆæ£’*å’Œ*è¿™ä¸€æ¬¡æœåŠ¡å¾ˆæ£’*çš„å¥å­ï¼Œå…·æœ‰ç›¸åŒçš„è¾“å‡ºæƒ…ç»ªã€‚

è¿™æ˜¯ RNNs çš„ä¸€ä¸ªä¸»è¦ä¼˜åŠ¿ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰å‚æ•°å…±äº«ï¼Œæ‚¨å¿…é¡»ä¸ºåºåˆ—ä¸­çš„æ¯ä¸ªæ—¶é—´æ­¥é•¿å­¦ä¹ ä¸åŒçš„æ¨¡å‹ï¼Œå¹¶ä¸”æ‚¨éœ€è¦ä¸€ä¸ªå¤§çš„è®­ç»ƒé›†æ¥é€‚åº”ä¸åŒçš„æ¨¡å‹è®­ç»ƒæ­¥éª¤ã€‚

å®é™…ä¸Šï¼Œå‚æ•°å…±äº«æ„å‘³ç€è¾“å‡ºå‡½æ•°æ˜¯å‰ä¸€æ—¶é—´æ­¥è¾“å‡ºçš„ç»“æœï¼Œæ¯ä¸€æ­¥ç”¨ç›¸åŒçš„è§„åˆ™æ›´æ–°ã€‚åè€…æ˜¯é€’å½’ç¥ç»ç½‘ç»œçš„å¦ä¸€ä¸ªé‡è¦æ–¹é¢ï¼Œæ›´æ–°è§„åˆ™æ˜¯ç›¸åŒçš„ï¼Œè¿™æ„å‘³ç€åœ¨æ¯ä¸ªæ—¶é—´æ­¥ï¼Œç½‘ç»œåº”ç”¨ç›¸åŒçš„æ¿€æ´»å‡½æ•°ã€‚

# è®¸å¤šéšè—çŠ¶æ€ï¼Œç›¸åŒçš„æ¿€æ´»åŠŸèƒ½

ç½‘ç»œå¯ä»¥æœ‰å°½å¯èƒ½å¤šçš„éšè—çŠ¶æ€ï¼Œä½†æœ‰ä¸€ä¸ªé‡è¦çš„å¸¸æ•°ã€‚åœ¨æ¯ä¸ªéšè—çŠ¶æ€ä¸‹ï¼Œä½ æ€»æ˜¯åœ¨è®¡ç®—ç›¸åŒçš„**æ¿€æ´»å‡½æ•°**ã€‚ä½¿ç”¨ç›¸åŒçš„å‡½æ•°è®¡ç®—æ¯å±‚çš„è¾“å‡º[3]ã€‚

![](img/3b1e3697e160a5ba61ba478a3ac8d3a5.png)

åº”ç”¨äºé€’å½’ç¥ç»ç½‘ç»œçš„æ¿€æ´»å‡½æ•°è®¡ç®—éšè—çŠ¶æ€ *h* ã€‚(å›¾ç‰‡ç”±ä½œè€…æä¾›)

æ¿€æ´»å‡½æ•°å¯ä»¥åƒçº¿æ€§å‡½æ•°æˆ– [sigmoid å‡½æ•°](https://en.wikipedia.org/wiki/Sigmoid_function)ä¸€æ ·ç®€å•ã€‚ä½†æ˜¯[åŒæ›²æ­£åˆ‡](https://en.wikipedia.org/wiki/Hyperbolic_functions#Hyperbolic_tangent)ä¹Ÿå¸¸ç”¨äºæ·±åº¦å­¦ä¹ ï¼Œå› ä¸ºä¸ sigmoid ç›¸æ¯”ï¼Œå®ƒå¾€å¾€æ›´å°‘å‡ºç°[æ¶ˆå¤±æ¢¯åº¦](https://en.wikipedia.org/wiki/Vanishing_gradient_problem)ã€‚

ç”¨åŒæ›²æ­£åˆ‡è®­ç»ƒæ·±åº¦ç¥ç»ç½‘ç»œå°±åƒè®­ç»ƒçº¿æ€§æ¨¡å‹ä¸€æ ·ç®€å•ï¼Œåªè¦è®¡ç®—é‡å¾ˆå°[1]ã€‚

è¡¨ç¤ºä¸º *tanh(x)* çš„åŒæ›²æ­£åˆ‡æ˜¯æ¿€æ´»å‡½æ•°çš„å¯é é€‰æ‹©ã€‚å®ƒçš„è¡Œä¸ºç±»ä¼¼äºé›¶é™„è¿‘çš„æ’ç­‰å‡½æ•°ï¼Œå³ tanh(0) = 0ã€‚

å› æ­¤ï¼Œåªè¦è¿™ä¸ªæ¿€æ´»å‡½æ•°çš„è®¡ç®—é‡å¾ˆå°ï¼Œç”¨åŒæ›²æ­£åˆ‡è®­ç»ƒæ·±åº¦ç¥ç»ç½‘ç»œå°±åƒè®­ç»ƒçº¿æ€§æ¨¡å‹ä¸€æ ·ç®€å•[1]ã€‚

# è¾“å‡ºå±‚å¾ˆç‰¹æ®Š:å®ƒå¯èƒ½éœ€è¦ Softmax

ç°åœ¨ä½ å¯èƒ½ä¼šæƒ³*ä½ ä¸æ˜¯è¯´è¿‡æ¯ä¸€å±‚éƒ½ä½¿ç”¨ç›¸åŒçš„æ¿€æ´»å‡½æ•°å—ï¼Ÿ*

æ˜¯çš„ï¼Œä½†æ˜¯åœ¨åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œè¾“å‡ºå›¾å±‚æ˜¯ç‰¹æ®Šçš„ã€‚

ç‰¹åˆ«æ˜¯å¯¹äºå¤„ç†åˆ†ç±»é—®é¢˜çš„ç¥ç»ç½‘ç»œï¼Œè¿˜æœ‰å¦ä¸€ä¸ªæ¿€æ´»å‡½æ•°ï¼Œåªåº”ç”¨äºè¾“å‡ºå±‚ï¼Œå‡ ä¹åƒä¸€ä¸ªåå¤„ç†æ­¥éª¤ã€‚æ»¡è¶³ [Softmax](https://en.wikipedia.org/wiki/Softmax_function) åŠŸèƒ½ã€‚

äºŒå…ƒåˆ†ç±»é—®é¢˜çš„è¾“å‡ºä¸æ˜¯ 0 å°±æ˜¯ 1ã€‚ä½†æœ‰æ—¶ä½ åœ¨å¤„ç†ä¸€ä¸ªå¤šç±»é—®é¢˜ï¼Œä¾‹å¦‚ï¼Œå¦‚æœä½ çˆ¶æ¯çš„åºŠå’Œæ—©é¤çš„è¯„è®ºè¢«å½’ç±»ä¸º*ç§¯æï¼Œä¸­ç«‹æˆ–æ¶ˆæã€‚*

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ‰ 3 ä¸ªå¯èƒ½çš„è¾“å‡ºç±»ï¼Œäº†è§£è§‚å¯Ÿå€¼å±äºæ­£ç±»çš„å¯èƒ½æ€§æ›´æœ‰ç”¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆé™¤äº†æ‚¨ä¸ºç½‘ç»œé€‰æ‹©çš„æ¿€æ´»å‡½æ•°ä¹‹å¤–ï¼Œ **Softmax** **å‡½æ•°**ä¹Ÿåº”ç”¨äºè¾“å‡ºå±‚ã€‚

![](img/d2bc6c7dbd273fdec6f5d7e1cfcf7dd6.png)

Softmax æ–¹ç¨‹ã€‚(å›¾ç‰‡ç”±ä½œè€…æä¾›)

å‘é‡ z æ˜¯ä»ç¬¬ä¸€å±‚å¼€å§‹çš„æ‰€æœ‰è®¡ç®—çš„ç»“æœï¼Œå®ƒæ˜¯åˆ°è¾¾è¾“å‡ºå±‚çš„å‘é‡ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„ç¥ç»ç½‘ç»œåªæœ‰ä¸€ä¸ªçº¿æ€§å±‚ï¼Œå‘é‡ *z* å¯ä»¥çœ‹èµ·æ¥åƒ:

![](img/29dfb31924c4f575cb7733c7a86fd2ef.png)

çº¿æ€§å›¾å±‚çš„çŸ¢é‡ *z* ã€‚(å›¾ç‰‡ç”±ä½œè€…æä¾›)

ä½¿ç”¨ Softmaxï¼Œè¯¥å‘é‡è¢«æŒ‡æ•°åŒ–ï¼Œå¹¶ä¸”å› ä¸ºè¿™æ˜¯ä¸€ä¸ªåˆ†ç±»ä»»åŠ¡ï¼Œæ‰€ä»¥åœ¨æ‰€æœ‰å¯èƒ½çš„ *K* ç±»ä¸­è¢«æ ‡å‡†åŒ–ï¼Œå°†å‘é‡å˜æˆæ¦‚ç‡åˆ†å¸ƒã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Softmax ä¹Ÿè¢«ç§°ä¸ºå½’ä¸€åŒ–æŒ‡æ•°å‡½æ•°ã€‚

åœ¨åº”ç”¨ Softmax ä¹‹åï¼ŒçŸ¢é‡ *z* çš„æ‰€æœ‰å€¼çš„æ€»å’Œæ€»æ˜¯ç­‰äº 1ã€‚å®ƒçš„å€¼è¡¨ç¤ºåœ¨è¾“å…¥å±‚ç»™äºˆç½‘ç»œçš„è§‚å¯Ÿå€¼å±äºæ¯ä¸ªç±»çš„æ¦‚ç‡ã€‚

å¦‚æœä¸å¯¹è¾“å‡ºå±‚åº”ç”¨ Softmaxï¼Œåˆ™é€’å½’ç¥ç»ç½‘ç»œçš„è¾“å‡ºæ˜¯ä¸€ä¸ªæ•°å­—

æ¯ä¸ªå¯èƒ½çš„ç±»åˆ«ã€‚å…·æœ‰æœ€é«˜å€¼çš„è¾“å‡ºæ˜¯è¯¥è§‚å¯Ÿçš„è·èƒœç±»[3]ã€‚

# ç©¿è¶Šæ—¶é—´çš„åå‘ä¼ æ’­

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å·²ç»ç ”ç©¶äº†é€’å½’ç¥ç»çš„æ›´å¹¿æ³›çš„æ¶æ„å’Œç»„ä»¶ï¼Œå³æ¿€æ´»å’ŒæŸå¤±åŠŸèƒ½ã€‚è®©æˆ‘ä»¬æŠŠæ³¨æ„åŠ›æ”¾åœ¨å­¦ä¹ ä¸Šã€‚

å½“è®¡ç®—ä»ä¸€å±‚ä¸­çš„æ¯ä¸ªéšè—å±‚æµå‘ä¸‹ä¸€å±‚æ—¶ï¼Œå®ƒå‘å‰ç§»åŠ¨ï¼Œå‘è¾“å‡ºå±‚ç§»åŠ¨ã€‚åˆ°è¾¾è¾“å‡ºå±‚æ—¶ï¼Œæ‚¨è®¡ç®—æŸå¤±å‡½æ•°ï¼Œè¿™æ„å‘³ç€æ‚¨å°†ç”Ÿæˆçš„è¾“å‡ºä¸è¯¥è®­ç»ƒè§‚å¯Ÿçš„é¢„æœŸ*çœŸ*å€¼è¿›è¡Œæ¯”è¾ƒã€‚

å¦‚æœè¿‡ç¨‹åœ¨æ­¤åœæ­¢ï¼Œç½‘ç»œå°†æ— æ³•å­¦ä¹ ã€‚è¿™å°†æ˜¯ä¸€ä¸ªå‰é¦ˆç½‘ç»œï¼Œå› ä¸ºä¿¡æ¯åœ¨ç½‘ç»œç»“æ„ä¸­å‘å‰ç§»åŠ¨ã€‚ä½†æ˜¯å­¦ä¹ éœ€è¦æŸç§å¾ªç¯ã€‚å°±åƒä½ åœ¨å­¦æ ¡æˆ–è‡ªå·±å­¦ä¹ ä¸€æ ·:ä¿¡æ¯åˆ°è¾¾ä½ çš„å¤§è„‘ï¼Œè¿™æ˜¯å‰é¦ˆéƒ¨åˆ†ï¼Œç„¶åä½ å¤„ç†å®ƒï¼Œå½“ä½ è¿™æ ·åšçš„æ—¶å€™ï¼Œä½ æ£€æŸ¥è‡ªå·±çš„å¿ƒæ™ºï¼Œæœ‰æ—¶é‡æ–°å­¦ä¹ æŸäº›ä¸œè¥¿ï¼Œè¿™æ˜¯æˆ‘ç§°ä¹‹ä¸ºå¾ªç¯çš„éƒ¨åˆ†ã€‚

ç¥ç»ç½‘ç»œå—åˆ°å¤§è„‘çš„å¯å‘ï¼Œä¸»è¦æ˜¯å—åˆ°ç¥ç»å…ƒå·¥ä½œæ–¹å¼çš„å¯å‘ã€‚ä½†æ˜¯è¿™äº›ç¥ç»ç½‘ç»œæ¶æ„ï¼Œä¹Ÿæœ‰è¿™ä¸ª*ä¸€ä¸ª*ä¸€ä¸ª*çš„å¾ªç¯éƒ¨åˆ†ã€‚*ä»–ä»¬*å­¦ä¹ *å¦‚ä½•å°†è¾“å…¥æ•°æ®æ˜ å°„åˆ°ä¸€ä¸ªå¯èƒ½çš„ç»“æœçš„éƒ¨åˆ†ã€‚

å›åˆ°é€’å½’ç¥ç»ç½‘ç»œï¼

è¾“å…¥é€šè¿‡æ‰€æœ‰å±‚ï¼Œå½“å®ƒåˆ°è¾¾è¾“å‡ºå±‚æ—¶ï¼Œå®ƒè®¡ç®—æŸå¤±å‡½æ•°ã€‚ç°åœ¨ï¼ŒçŸ¥é“è®¡ç®—é“¾ä¸é¢„æœŸçš„ç»“æœæœ‰å¤šä¸åŒæˆ–æœ‰å¤šè¿œï¼Œå®ƒå–æŸå¤±å‡½æ•°çš„å€¼ï¼Œå¹¶è®¡ç®—å®ƒç›¸å¯¹äºå‚æ•°çš„æ¢¯åº¦ã€‚

ç„¶åï¼Œåœ¨å¦ä¸€ç§ç®—æ³•çš„å¸®åŠ©ä¸‹ï¼Œå¦‚[éšæœºæ¢¯åº¦ä¸‹é™](https://medium.com/p/b7639d5e6a32)ï¼Œæ¢¯åº¦è¢«å‘é€å›ç›¸åçš„æ–¹å‘ã€‚ä¸€ç›´å›åˆ°è¾“å…¥å±‚ã€‚

è¿™æ ·ä½ å°±*åå‘ä¼ æ’­*äº†æŸå¤±å‡½æ•°ã€‚

æ¢¯åº¦çš„å®é™…è®¡ç®—è¢«ç§°ä¸º*åå‘ä¼ æ’­*ã€1ã€‘ã€‚ä½†æ˜¯é€šå¸¸ä¸å®é™…çš„å­¦ä¹ éƒ¨åˆ†ç›¸æ··æ·†ï¼Œå®é™…çš„å­¦ä¹ éƒ¨åˆ†æ˜¯é€šè¿‡åƒéšæœºæ¢¯åº¦ä¸‹é™è¿™æ ·çš„ç®—æ³•å®Œæˆçš„ã€‚

åˆ°è¾¾è¾“å…¥å±‚æ—¶ï¼Œéšæœºæ¢¯åº¦ä¸‹é™æˆ–å…¶ä»–åŸºäºæ¢¯åº¦çš„ä¼˜åŒ–ç®—æ³•è°ƒæ•´ç½‘ç»œæƒé‡ï¼Œå¹¶é€šè¿‡æ¯ä¸ªéšè—å±‚å†æ¬¡è®¡ç®—æ¿€æ´»å‡½æ•°ã€‚

é€šè¿‡ä»å½“å‰æƒé‡å‘é‡(Î¸)ä¸­å‡å»å…³äºæŸå¤±å‡½æ•°(J)çš„æ¢¯åº¦å€¼æ¥æ›´æ–°ç½‘ç»œä¸­çš„æ¯ä¸ªæƒé‡ã€‚è¿™ä¹Ÿç§°ä¸º*é‡é‡å˜åŒ–é‡* (vt) *ã€‚*

![](img/19db0ca18f51515bd03fe06db3133afb.png)

*åå‘ä¼ æ’­æƒé‡æ›´æ–°è§„åˆ™(å›¾ç‰‡ç”±ä½œè€…æä¾›)ã€‚*

è¯¥è¿‡ç¨‹ç»§ç»­è¿›è¡Œï¼Œç›´åˆ°æŸå¤±å‡½æ•°ä¸èƒ½å†è¢«æœ€å°åŒ–ï¼Œå› æ­¤å†æ¬¡è°ƒæ•´æƒé‡æ²¡æœ‰æ„ä¹‰ï¼Œå¹¶ä¸”åœ¨ç»™å®šå½“å‰è®­ç»ƒé›†å’Œæ¶æ„çš„æƒ…å†µä¸‹ï¼Œç¥ç»ç½‘ç»œçš„æ€§èƒ½è¢«æœ€å¤§é™åº¦åœ°æé«˜ã€‚

æ›´å¤æ‚çš„ç®—æ³•å’Œç¥ç»ç½‘ç»œæ¶æ„å¯èƒ½ä¼šæé«˜æ€§èƒ½ï¼Œä½†ä¹Ÿä¼šå¢åŠ æ‰€æœ‰è®¡ç®—çš„å¤æ‚æ€§ï¼Œä»è€Œå¯¼è‡´æ›´é•¿çš„è®­ç»ƒæ—¶é—´ã€‚

åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œä½ æ€»æ˜¯è¦å¤„ç†å–èˆã€‚å¯¹äºæ›´å¤æ‚çš„æ¨¡å‹ï¼Œä¸€äº›æŠ˜è¡·æ˜¯(a)æé«˜æ€§èƒ½ï¼Œä½†æ˜¯é™ä½æ¨¡å‹çš„å¯è§£é‡Šæ€§ï¼Œæˆ–è€…(b)æé«˜æ€§èƒ½ï¼Œä½†æ˜¯å¢åŠ è®­ç»ƒæ—¶é—´ã€‚

# ç°å®ä¸­çš„ RNNs:æƒ…æ„Ÿåˆ†æğŸ‘ ğŸ‘

ä½ å†³å®šä½¿ç”¨ [TensorFlow](https://www.tensorflow.org/) å¼ºå¤§çš„åº“æ¥å¸®åŠ©å¯¹ä½ çˆ¶æ¯çš„åºŠå’Œæ—©é¤çš„è¯„è®ºè¿›è¡Œåˆ†ç±»ï¼Œè€Œä¸æ˜¯ä»å¤´å¼€å§‹å»ºç«‹ä¸€ä¸ªé€’å½’ç¥ç»ç½‘ç»œã€‚

ä½ éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯[é€šè¿‡ *pip* åœ¨ä½ çš„æœºå™¨ä¸Šå®‰è£… TensorFlow](https://www.tensorflow.org/install) ï¼Œå› ä¸ºä½ å°†ä½¿ç”¨æœ¬åœ° Python ç¯å¢ƒã€‚

éµå¾ª TensorFlow æ–‡æ¡£:

```
# Requires the latest pip
> pip install --upgrade pip# Current stable release for CPU and GPU
> pip install tensorflow
```

ç„¶åä½ ä¼šæ³¨æ„åˆ° TensorFlow èµ„æº [6]ä¸Šæœ‰ä¸€ä¸ªä½¿ç”¨ RNNs çš„[æ–‡æœ¬åˆ†ç±»çš„å¥å£®ä¾‹å­ã€‚è¿™æ˜¯ä½ æƒ³åšçš„äº‹æƒ…çš„ä¸€ä¸ªå¾ˆå¥½çš„åŸºç¡€ï¼Œä½ åªéœ€è¦æ ¹æ®ä½ è‡ªå·±çš„ä»»åŠ¡æ¥è°ƒæ•´å®ƒã€‚](https://www.tensorflow.org/text/tutorials/text_classification_rnn)

ä¸€çœ¼çœ‹å»ï¼Œå»ºç«‹ä¸€ä¸ªé€’å½’ç¥ç»ç½‘ç»œæ¥å¯¹æ¥è‡ªä½ çˆ¶æ¯çš„åºŠå’Œæ—©é¤çš„æ‰€æœ‰è¯„è®ºçš„æƒ…ç»ªè¿›è¡Œåˆ†ç±»åŒ…æ‹¬:

1.  ç»„ç»‡åŸ¹è®­å’Œæµ‹è¯•æ–‡ä»¶
2.  åŠ è½½è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†
3.  ç»´åº¦é—®é¢˜:å‹ç¼©æ•°æ®é›†(çŸ¢é‡åŒ–)
4.  æ„å»ºé€’å½’ç¥ç»ç½‘ç»œ
5.  æ¨¡å‹æ‹Ÿåˆå’Œè¯„ä¼°
6.  ç²¾ç¡®åº¦å’ŒæŸå¤±å¯è§†åŒ–

# ç»„ç»‡åŸ¹è®­å’Œæµ‹è¯•æ–‡ä»¶

ç¬¬ä¸€æ­¥æ˜¯æŠŠä½ çš„è¡¨å…„å¼Ÿå¸®åŠ©åˆ†ç±»çš„è¯„è®ºæ•´ç†åˆ°ç›¸åº”çš„ç›®å½•ä¸­ã€‚å°†ä¼šæœ‰*è®­ç»ƒ*å’Œ*æµ‹è¯•*ç›®å½•ï¼Œæ¯ä¸€ä¸ªéƒ½æœ‰åŒ…å«*æ­£é¢*å’Œ*è´Ÿé¢*è¯„è®ºçš„å­ç›®å½•ã€‚

åœ¨è¿™ä¸ªç»„ç»‡ä¹‹åï¼Œå¦‚æœæ‚¨åœ¨æ‚¨çš„é¡¹ç›®ç›®å½•ä¸Šè¿è¡Œå‘½ä»¤æ ‘*,æ‚¨å°†ä¼šçœ‹åˆ°å¦‚ä¸‹å†…å®¹:*

*![](img/abc8c9628d5cb981cd557077e0225213.png)*

**è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†ç›®å½•*(å›¾ç‰‡ç”±ä½œè€…æä¾›)*

*åœ¨è¿™ä¸€æ­¥ä¸­é‡è¦çš„æ˜¯ï¼Œæ¯ä¸ªæ–‡ä»¶åªæœ‰ä¸€ä¸ªæ£€æŸ¥ï¼Œå› æ­¤å¯ä»¥åœ¨ä¸‹é¢çš„æ­¥éª¤ä¸­æ­£ç¡®åœ°åŠ è½½å’Œå¤„ç†å®ƒã€‚*

# *åŠ è½½è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†*

*è¦åŠ è½½è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†ï¼Œæ‚¨å¯ä»¥åˆ©ç”¨ Keras å®ç”¨ç¨‹åºæ–¹æ³•[text _ dataset _ from _ directory](https://www.tensorflow.org/api_docs/python/tf/keras/utils/text_dataset_from_directory)ï¼Œè¿™ç‰¹åˆ«éœ€è¦æ‚¨åœ¨ä¸Šä¸€æ­¥ä¸­æ•´ç†çš„ç›®å½•æ•°æ®é›†ç»“æ„ã€‚*

*![](img/7e776fbcffba508accd6c43a2d128752.png)*

**åŠ è½½è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†*(å›¾ç‰‡ç”±ä½œè€…æä¾›)*

# *ç»´åº¦é—®é¢˜:å‹ç¼©æ•°æ®é›†(çŸ¢é‡åŒ–)*

*ä½ çˆ¶æ¯çš„ä½å®¿å’Œæ—©é¤ç‚¹è¯„æ²¡é‚£ä¹ˆå†—é•¿ã€‚å°†ä¼šæœ‰æ›´å¤šçƒ­æƒ…çš„é¡¾å®¢ï¼Œä»–ä»¬å†™ä¸€ç¯‡å…³äºä»–ä»¬ä½“éªŒçš„çŸ­æ–‡ï¼Œä½†æ˜¯ä»æ•°æ®çš„è§’åº¦æ¥çœ‹ï¼Œç»“æœæ˜¯ä¸€ä¸ªç›¸å¯¹ä½ç»´åº¦çš„å‘é‡ã€‚*

*ä½†æ˜¯å¦‚æœä½ çˆ¶æ¯çš„ç”Ÿæ„å¦‚æ­¤å—æ¬¢è¿ï¼Œä»¥è‡³äºæ—…æ¸¸å’Œä¼‘é—²æ‚å¿—å¼€å§‹å†™å…³äºä»–ä»¬çš„æ–‡ç« ï¼ŒåŸºæœ¬ä¸Šæ˜¯è¯„è®ºï¼Œé‚£è¯¥æ€ä¹ˆåŠï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è°ˆè®ºçš„æ˜¯æ›´å¤§çš„æ•°æ®é›†ï¼Œæ¯ä¸ªè¯„è®ºéƒ½æ˜¯è‡³å°‘ 800 å­—çš„æ‚å¿—æ–‡ç« ã€‚*

*åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œä½ æ­£åœ¨å¤„ç†ä¸€ä¸ªç»´åº¦é—®é¢˜ã€‚ä½ æœ‰éå¸¸å¤§å’Œç¨€ç–çš„å‘é‡ï¼Œè¿™ä½¿å¾—æ‰€æœ‰çŸ©é˜µè®¡ç®—åœ¨è®¡ç®—ä¸Šå…·æœ‰æŒ‘æˆ˜æ€§ã€‚*

*ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼Œä½ éœ€è¦åšä¸€äº›ä¸ä¸»æˆåˆ†åˆ†æç±»ä¼¼çš„äº‹æƒ…ã€‚ä½ æƒ³è¦å‹ç¼©ä½ çš„æ•°æ®é›†ï¼ŒåŒæ—¶ä¿æŒå®ƒæ‰€æœ‰çš„è¡¨è¾¾èƒ½åŠ›å’Œæ ¸å¿ƒç‰¹å¾ã€‚*

> *è¿™äº›æ˜¯é€šè¿‡ä¸»æˆåˆ†åˆ†æçš„å˜ä½“ä»éå¸¸å¤§çš„æ–‡æ¡£è¯­æ–™åº“ä¸­å»ºç«‹çš„ã€‚å…¶æ€æƒ³æ˜¯å•è¯åœ¨åµŒå…¥ç©ºé—´ä¸­çš„ä½ç½®ä¿æŒè¯­ä¹‰ï¼›ä¾‹å¦‚ï¼ŒåŒä¹‰è¯åº”è¯¥å‡ºç°åœ¨å½¼æ­¤é™„è¿‘ã€‚â€[5]*

*ä¸€ä¸ªå…¸å‹çš„é¢„å¤„ç†æ­¥éª¤æ˜¯ç”¨ [wor2vec](https://en.wikipedia.org/wiki/Word2vec) [4]æ¥é™ä½ç»´åº¦ã€‚åœ¨ TensorFlow ä¸­ï¼Œ [Keras TextVectorization](https://www.tensorflow.org/api_docs/python/tf/keras/layers/TextVectorization) å±‚åšäº†ç±»ä¼¼çš„äº‹æƒ…ã€‚å®ƒè·å–ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ–è€…å°†å®ƒæ˜ å°„åˆ°ä¸€ä¸ªä¸€ç»´çš„ç´¢å¼•å¼ é‡æˆ–è€…ä¸€ä¸ªè¡¨ç¤ºå­—ç¬¦ä¸²ä¸­æ•°æ®çš„ä¸€ç»´æµ®ç‚¹å¼ é‡ã€‚*

*![](img/b19b5cd523a57756f44a8abfd86ad8ee.png)*

**åŠ è½½æ•°æ®å¹¶å¯¹è®­ç»ƒæ•°æ®é›†è¿›è¡ŒçŸ¢é‡åŒ–ã€‚*(å›¾ç‰‡ä½œè€…)*

*åœ¨è¿™ä¸€æ­¥ç»“æŸæ—¶ï¼Œè®­ç»ƒæ•°æ®é›†è¢«çŸ¢é‡åŒ–ï¼Œæ•°æ®å‡†å¤‡é˜¶æ®µå®Œæˆã€‚*

*ç°åœ¨ï¼Œæ‚¨å·²ç»å‡†å¤‡å¥½æ„å»ºé€’å½’ç¥ç»ç½‘ç»œäº†ã€‚*

# *æ„å»ºé€’å½’ç¥ç»ç½‘ç»œ*

*å®é™…ä¸Šï¼Œä½ çš„é€’å½’ç¥ç»ç½‘ç»œæ¨¡å‹æ˜¯ä¸€ç»„[è¿ç»­å±‚](https://www.tensorflow.org/api_docs/python/tf/keras/Sequential)ã€‚*

*ç¬¬ä¸€ä¸ªæ˜¯è¯æ±‡ç¼–ç å™¨ï¼Œåœ¨å‰é¢çš„æ­¥éª¤ä¸­åˆ›å»ºã€‚å®ƒåœ¨[åµŒå…¥å±‚](https://www.tensorflow.org/api_docs/python/tf/keras/layers/Embedding)ä¸­ä½¿ç”¨ï¼Œå®ƒå°†ç¼–ç å‘é‡ä¸­çš„å€¼è½¬æ¢æˆç‰¹å®šçš„èŒƒå›´ã€‚*

*ä¾‹å¦‚ï¼Œæ‚¨çš„è¯„è®ºä¸­çš„è¯æ±‡ç”± 151 ä¸ªå•è¯ç»„æˆï¼Œé€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤è·å¾—:*

```
*len(encoder.get_vocabulary())*
```

*å› æ­¤ï¼Œæ¨¡å‹é€šè¿‡ *input_dim* å°†è¯æ±‡å¤§å°ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›å¤§å°ä¸º 64 çš„è¾“å‡ºï¼Œä½¿ç”¨ *output_dim* å®šä¹‰ã€‚å› ä¸ºæ‚¨æŒ‡å®šäº†è¯æ±‡å¤§å° 151ï¼Œæ‰€ä»¥æ˜ å°„ä¸­æœ€å¤§çš„æ•´æ•°å°†æ˜¯ 150ã€‚*

*![](img/88f4ce40f1cb829ab562446765e7d493.png)*

**åŠ è½½æ•°æ®å’ŒçŸ¢é‡åŒ–è®­ç»ƒæ•°æ®é›†å¹¶æ„å»º RNNã€‚*(å›¾ç‰‡ä½œè€…æä¾›)*

*ä¸‹ä¸€å±‚ï¼Œ[åŒå‘](https://www.tensorflow.org/api_docs/python/tf/keras/layers/Bidirectional)ï¼Œè¡¨ç¤ºæ‚¨æƒ³è¦åˆ›å»ºä¸€ä¸ªåŒå‘é€’å½’ç¥ç»ç½‘ç»œã€‚è¿™æ„å‘³ç€ç½‘ç»œçš„è¾“å…¥é€šè¿‡ NRR å±‚å‘å‰å’Œå‘åä¼ æ’­ã€‚ç½‘ç»œåœ¨å¤„ç†è¾“å…¥çš„è¿‡ç¨‹ä¸­ï¼Œéšç€æ—¶é—´çš„æ¨ç§»è€Œäº§ç”Ÿçš„*è®°å¿†*ï¼Œä¸ä»…è¢«ä¼ é€’ç»™åé¢çš„ç»†èƒï¼Œè¿˜è¢«ä¼ é€’ç»™å‰é¢çš„ç»†èƒã€‚ç°åœ¨ï¼Œåœ¨è¾“å…¥åºåˆ—ä¸­ï¼Œç½‘ç»œä¸­çš„æ¯ä¸ªç»†èƒéƒ½æœ‰å…³äºè¿‡å»å’Œæœªæ¥çš„ä¿¡æ¯ã€‚*

*ä½¿ç”¨åŒå‘é€’å½’ç¥ç»ç½‘ç»œçš„ä¼˜ç‚¹åœ¨äºï¼Œä¸ä»…ä»…æ˜¯ç½‘ç»œä¸­çš„å…ˆå‰ä¿¡æ¯å¯¹è¾“å‡ºé¢„æµ‹æœ‰è´¡çŒ®ã€‚çŸ¥é“åœ¨åºåˆ—ä¸­ä»€ä¹ˆä¼šåœ¨å‰é¢å‡ºç°å¯¹æ¨¡å‹å¦‚ä½•å­¦ä¹ æœ‰é‡å¤§å½±å“ã€‚*

*è¿™ç§ä¼˜åŠ¿æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ã€‚ç”±äºä¿¡æ¯ç°åœ¨æ¥å›ä¼ æ’­ï¼Œè¿™äº›ç½‘ç»œå¾€å¾€ä¼šæ…¢å¾—å¤šï¼Œå› ä¸ºæ¢¯åº¦ç°åœ¨æœ‰ä¸€ä¸ªæ›´é•¿çš„ä¾èµ–é“¾ã€‚*

*ç„¶è€Œï¼Œä½ çˆ¶æ¯çš„ä½å®¿å’Œæ—©é¤è¯„è®ºæ˜¯ä¸€ä¸ªå°æ•°æ®é›†ã€‚æ‰€ä»¥ä½ å†³å®šå€¼å¾—ä¸€è¯•ï¼*

*æ¨¡å‹ä¸­çš„æœ€åä¸¤å±‚æ˜¯[è‡´å¯†å±‚](https://www.tensorflow.org/api_docs/python/tf/keras/layers/Dense)ã€‚å€’æ•°ç¬¬äºŒä¸ªç”¨äºå¤„ç†æ¨¡å‹æŸå¤±ï¼ŒåŒæ›²æ­£åˆ‡ä½œä¸ºæ¿€æ´»ã€‚æœ€åä¸€ä¸ªå°†è¾“å‡ºæ•´å½¢ä¸ºå¤§å° 1ï¼Œå‡è®¾æ‚¨å¸Œæœ›è¯¥æ¨¡å¼çš„è¾“å‡ºä¸º*æ­£*æˆ–*è´Ÿç±»*æŒ‡æ•°ã€‚*

*åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒRNN æ˜¯ä½¿ç”¨ 30 ä¸ª[å•å…ƒ](https://www.tensorflow.org/api_docs/python/tf/keras/layers/GRUCell)åˆ›å»ºçš„ã€‚è¿™äº›[é—¨æ§é€’å½’å•å…ƒ](https://en.wikipedia.org/wiki/Gated_recurrent_unit) (GRU)ä½¿ç”¨åŒæ›²æ­£åˆ‡ä½œä¸ºé€’å½’æ­¥éª¤çš„æ¿€æ´»å‡½æ•°ã€‚*

# *æ¨¡å‹æ‹Ÿåˆå’Œè¯„ä¼°*

*ç°åœ¨ä½ å·²ç»å»ºç«‹å¹¶ç¼–è¯‘äº†é€’å½’ç¥ç»ç½‘ç»œï¼Œæ˜¯æ—¶å€™[å°†å®ƒä¸è®­ç»ƒæ•°æ®é›†](https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit)ç›¸åŒ¹é…ï¼Œå¹¶è¿›è¡Œä¸€äº›é¢„æµ‹äº†ã€‚*

*æ‚¨å¯ä»¥è°ƒæ•´çš„å‡ ä¸ªå‚æ•°æ˜¯:*

*   **epochs* æ‚¨å¸Œæœ›ç®—æ³•åœ¨æ•´ä¸ªè®­ç»ƒé›†ä¸­è¿è¡Œå¤šå°‘æ¬¡*
*   **æ··æ´—*å¦‚æœæ‚¨æƒ³åœ¨æ¯æ¬¡å†å…ƒè¿­ä»£ä¹‹å‰æ··æ´—è®­ç»ƒæ•°æ®ã€‚é»˜è®¤ä¸º True*
*   **éªŒè¯ _ æ­¥éª¤*éªŒè¯æ­¥éª¤ç»“æŸå‰æŠ½å–çš„æ ·æœ¬æ‰¹æ¬¡æ•°ï¼Œç®—æ³•å¼€å§‹æ–°çš„æ—¶æœŸ*

*![](img/0b9471b2e989128437edafc72914fdfb.png)*

*ä»*åŠ è½½æ•°æ®å’Œå‘é‡åŒ–è®­ç»ƒæ•°æ®é›†*åˆ°*æ„å»º*å’Œè¯„ä¼° RNN *ã€‚*(å›¾ç‰‡ä½œè€…æä¾›)*

# *ç²¾ç¡®åº¦å’ŒæŸå¤±å¯è§†åŒ–*

*ä½œä¸ºæœ€åä¸€æ­¥ï¼Œå¯è§†åŒ–æ¨¡å‹çš„æŸå¤±å’Œå‡†ç¡®æ€§æ€»æ˜¯å¾ˆæœ‰è¶£çš„ã€‚å°¤å…¶æ˜¯å½“å®ƒé€šè¿‡å¤šæ¬¡è¿­ä»£è¿è¡Œæ—¶ã€‚*

```
*import os
import tensorflow as tf
import matplotlib.pyplot as plt# Loading Training and Test Datasets
train_dir = os.path.join('', '../datasets/train')train_dataset = tf.keras.utils.text_dataset_from_directory(
    train_dir, label_mode='int', labels='inferred', follow_links = True
)test_dir = os.path.join('', '../datasets/test')test_dataset = tf.keras.utils.text_dataset_from_directory(
    test_dir, label_mode='int', labels='inferred', follow_links = True
)# Vectorize training dataset
VOCAB_SIZE = 5000
encoder = tf.keras.layers.TextVectorization(max_tokens=VOCAB_SIZE)
encoder.adapt(train_dataset.map(lambda text, label: text))# Building the Recurrent Neural Network
# using GRU cells and Hyperbolic tangent as activation function
cell = tf.keras.layers.GRUCell(30, recurrent_activation='tanh')
model = tf.keras.Sequential([
    encoder,
    tf.keras.layers.Embedding(
        input_dim=len(encoder.get_vocabulary()),
        output_dim=64,
        # Use masking to handle the variable sequence lengths
        mask_zero=True),
    tf.keras.layers.Bidirectional(tf.keras.layers.RNN(cell)),
    tf.keras.layers.Dense(60, activation='tanh'),
    tf.keras.layers.Dense(1)
])# Compile model and use the algorithm Adam as optimization function
model.compile(loss=tf.keras.losses.BinaryCrossentropy(from_logits=True), optimizer=tf.keras.optimizers.Adam(1e-2), metrics=['accuracy'])# Fitting the model
history = model.fit(train_dataset, epochs=10, validation_data=test_dataset, validation_steps=10)# Model Evaluation
test_loss, test_acc = model.evaluate(test_dataset)print('Test Loss:', test_loss)
print('Test Accuracy:', test_acc)# Visualize Model Loss and Accuracy
def plot_graphs(history, metric):
  plt.plot(history.history[metric])
  plt.plot(history.history['val_'+metric], '')
  plt.xlabel("Epochs")
  plt.ylabel(metric)
  plt.legend([metric, 'val_'+metric])plt.figure(figsize=(16, 8))
plt.subplot(1, 2, 1)
plot_graphs(history, 'accuracy')
plt.ylim(None, 1)
plt.subplot(1, 2, 2)
plot_graphs(history, 'loss')
plt.ylim(0, None)*
```

*è¿™é‡Œï¼Œæ‚¨è¿˜å¯ä»¥åˆ©ç”¨æ¥è‡ª TensorFlow æ–‡æ¡£é¡µé¢çš„[ä¾¿æ·ç¤ºä¾‹ä¸­çš„ä»£ç æ¥ç»˜åˆ¶è®­ç»ƒå’ŒéªŒè¯æ•°æ®é›†çš„æŸå¤±å’Œå‡†ç¡®æ€§ã€‚](https://www.tensorflow.org/text/tutorials/text_classification_rnn#setup)*

*![](img/4d50febb1d3d3d3c0c54a2dbc87f8d5b.png)*

*ç»˜åˆ¶æ¯ä¸ªæ—¶æœŸçš„æ¨¡å‹æŸå¤±å’Œç²¾åº¦ã€‚(å›¾ç‰‡ç”±ä½œè€…æä¾›)*

*åœ¨å¯¹æµ‹è¯•æ•°æ®é›†è¿›è¡Œé¢„æµ‹åï¼Œå‡†ç¡®æ€§è¿œéå®Œç¾ã€‚å®ƒå¾˜å¾Šåœ¨ 0.5 å·¦å³ï¼Œè¿™æ„å‘³ç€ä½ çš„æ¨¡å‹åœ¨æŠ€æœ¯ä¸Šæ¯”éšæœºçŒœæµ‹å¥½ä¸äº†å¤šå°‘ã€‚*

*åœ¨æ‰€æœ‰è¯„ä¼°æ—¶æœŸï¼Œç²¾åº¦éå¸¸ç¨³å®šåœ°ä¿æŒåœ¨ 50%,åœ¨ç¬¬ä¸‰ä¸ªæ—¶æœŸä¹‹åï¼ŒæŸè€—å¼€å§‹ç¨³å®šå¢åŠ ã€‚*

*ä½†æ˜¯è¿™äº›ç»“æœä¸åº”è¯¥è®©ä½ æ°”é¦ã€‚æ‚¨çš„æ•°æ®é›†éå¸¸å°ï¼Œæ‰€ç”¨çš„ RNN æ¶æ„éå¸¸ç®€å•ï¼Œå½“ç„¶è¿˜å¯ä»¥æ”¹è¿›ã€‚è¿™åªæ˜¯ç†è§£ RNNs çš„ç¬¬ä¸€æ­¥ã€‚*

# *ç»“è®º*

*æ ¹æ®æ‰‹å¤´çš„ä»»åŠ¡ï¼Œæœ‰å‡ ç§ä¸åŒçš„æ–¹æ³•æ¥å»ºç«‹é€’å½’ç¥ç»ç½‘ç»œã€‚*

*å®ƒå¯ä»¥å…·æœ‰ä¸€å¯¹å¤šçš„ç»“æ„ï¼Œå°±åƒæ¨¡å‹å¿…é¡»ä¸ºç»™å®šçš„å›¾åƒåˆ›å»ºæ ‡é¢˜ä¸€æ ·ã€‚ä½†æ˜¯å¦‚æœä½ æŠŠè‹±è¯­ç¿»è¯‘æˆæ³•è¯­æˆ–è€…ç›¸åï¼Œä½ å°†ä¼šå»ºç«‹ä¸€ä¸ªå¤šå¯¹å¤šç»“æ„çš„é€’å½’ç¥ç»ç½‘ç»œã€‚*

*å¯¹äºæƒ…æ„Ÿåˆ†æä»»åŠ¡æˆ–å¯¹ä½ çˆ¶æ¯èˆ’é€‚çš„åºŠå’Œæ—©é¤çš„æ‰€æœ‰è¯„è®ºè¿›è¡Œåˆ†ç±»ï¼Œè¯¥ç½‘ç»œå…·æœ‰å¤šå¯¹ä¸€çš„ç»“æ„ï¼Œè¯„è®ºä¸­çš„å‡ ä¸ªè¯æ„æˆäº†ä¸€ä¸ªå•ä¸€çš„è¾“å‡ºï¼Œå³æƒ…æ„Ÿç±»åˆ«ã€‚æ— è®ºæ˜¯ç§¯æçš„è¿˜æ˜¯æ¶ˆæçš„ã€‚*

*ä½ åˆ›å»ºçš„ç½‘ç»œç›¸å¯¹ç®€å•ï¼Œåªæœ‰ 50%çš„å‡†ç¡®ç‡ã€‚*

*ä½†æˆ‘å¸Œæœ›ä½ èƒ½æ›´å¥½åœ°ç†è§£ä»€ä¹ˆæ˜¯é€’å½’ç¥ç»ç½‘ç»œï¼Œä¸ºä»€ä¹ˆå®ƒæ˜¯è¿™æ ·ä¸€ä¸ªæ”¹å˜æ¸¸æˆè§„åˆ™çš„æ·±åº¦å­¦ä¹ ç½‘ç»œæ¶æ„ï¼Œä»¥åŠå®ƒå¯ä»¥åº”ç”¨äºç°å®ç”Ÿæ´»ä¸­çš„å„ç§é—®é¢˜ã€‚*

**æ„Ÿè°¢é˜…è¯»ï¼**

# *å‚è€ƒ*

1.  *å¤å¾·è´¹å‹’ï¼Œä¼Šæ© jï¼Œæœ¬å‰å¥¥ï¼Œçº¦èˆ’äºšå’Œåº“ç»´å°”ï¼Œäºšä¼¦ã€‚æ·±åº¦å­¦ä¹ ï¼Œéº»çœç†å·¥å‡ºç‰ˆç¤¾ï¼Œ2016*
2.  *[é€’å½’ç¥ç»ç½‘ç»œçš„ä¸åˆç†æœ‰æ•ˆæ€§](https://karpathy.github.io/2015/05/21/rnn-effectiveness/)*
3.  *å¸Œé¡¿æ°å¤«ã€‚[æ·±åº¦ç¥ç»ç½‘ç»œçš„åº”ç”¨](https://arxiv.org/abs/2009.05673)*
4.  *æ‰˜é©¬æ–¯ç±³ç§‘æ´›å¤«ç¨‹å‡¯æ ¼é›·æ ¼ s ç§‘æ‹‰å¤šæ°å¼—é‡Œé™¢é•¿ã€‚[å‘é‡ç©ºé—´ä¸­å•è¯è¡¨ç¤ºçš„æœ‰æ•ˆä¼°è®¡](https://arxiv.org/abs/1301.3781)ã€‚(2013)*
5.  *åŠ é›·æ€Â·è©¹å§†æ–¯ã€ä¸¹å¦®æ‹‰Â·å¨æ»•ã€ç‰¹é›·å¼—Â·å“ˆæ–¯è’‚ã€ç½—ä¼¯ç‰¹Â·è’‚å¸ƒæ‹‰å°¼ã€‚(2021).ç»Ÿè®¡å­¦ä¹ å¯¼è®º:åº”ç”¨äº r .(ç¬¬äºŒç‰ˆ)*
6.  *[ä½¿ç”¨ RNN çš„æ–‡æœ¬åˆ†ç±»](https://www.tensorflow.org/text/tutorials/text_classification_rnn)ï¼ŒTensorFlow æ–‡æ¡£*
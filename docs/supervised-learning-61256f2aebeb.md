# ç›‘ç£å­¦ä¹ å¯¼è®º

> åŸæ–‡ï¼š<https://towardsdatascience.com/supervised-learning-61256f2aebeb>

## å…¶ä¸­æœ‰ä¸€ä¸ªæœ´ç´ è´å¶æ–¯åˆ†ç±»ç®—æ³•çš„ä¾‹å­

![](img/e79e65a5308036aea73a4df63e5e8eb6.png)

å›¾ç‰‡è¯´æ˜|ç…§ç‰‡ç”±[å®‰å¦®Â·ä¼¦å‡¯](https://www.pexels.com/@anniroenkae)æ‹æ‘„

è¿™æ˜¯ä»¥å½¼æ­¤ä¸ºåŸºç¡€çš„ç³»åˆ—æ–‡ç« çš„ç»§ç»­ã€‚è¯·çœ‹æˆ‘ä¸Šä¸€ç¯‡å…³äº[æ—¶é—´åºåˆ—åˆ†æ](/time-series-analysis-7138ec68754a)å’Œ[é€»è¾‘å›å½’](/logistic-regression-cebee0728cbf)çš„æ–‡ç« ã€‚

å¥½å§ï¼Œè®©æˆ‘ä»¬ä»ç›‘ç£å­¦ä¹ å¼€å§‹ã€‚æˆ‘åœ¨ä»¥å‰çš„æ–‡ç« ä¸­æåˆ°äº†ä¸€äº›ï¼Œä½†æ˜¯è®©æˆ‘å›é¡¾ä¸€ä¸‹è¿™ç¯‡æ–‡ç« çš„ä¸€äº›ç»†èŠ‚ã€‚

*   ç›‘ç£å­¦ä¹ :ä»å·²æœ‰æ•°æ®ä¸­å­¦ä¹ ï¼Œè¿™äº›æ•°æ®è¢«åˆ†ç±»å¹¶æ ‡æœ‰é¢„å®šä¹‰çš„ç±»åˆ«ã€‚æµ‹è¯•æ•°æ®ä¹Ÿè¢«æ ‡è®°åˆ°è¿™äº›ç±»ä¸­

è¿™é€‚ç”¨äºæ‰€æœ‰ç±»å‹çš„å­¦ä¹ ã€‚ä½†æ˜¯ï¼Œå…·ä½“æ¥è¯´ï¼Œå®ƒæœ‰**æ ‡è®°çš„é¢„å®šä¹‰ç±»**ã€‚è¿™æ˜¯æœ€é‡è¦çš„äº‹æƒ…â€” **ç›‘ç£å­¦ä¹ æœ‰ä¸€ä¸ªè¢«ç§°ä¸ºä¸“å®¶æ ‡ç­¾çš„ä¸œè¥¿**ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„è¯ï¼Œæ„æ€æ˜¯å®ƒè¢«æ ‡è®°ä¸ºä¸€ä¸ªç»“æœï¼›æˆ–è€…å¯¹äºä»»ä½•ç»™å®šçš„æƒ…å†µï¼Œéƒ½æœ‰ä¸€ä¸ªå·²çŸ¥çš„ã€æœŸæœ›çš„ç»“æœã€‚

æ— ç›‘ç£å­¦ä¹ (èšç±»)å¹¶ä¸å‡è®¾å®ƒçŸ¥é“ç­”æ¡ˆã€‚ä¾‹å¦‚ï¼Œç¾¤é›†å°†æŸ¥çœ‹æ•°æ®ï¼Œå¹¶æ ¹æ®æ•°æ®çš„çŠ¶æ€å¯¹æ•°æ®è¿›è¡Œåˆ†åŒºã€‚

ç›‘ç£å­¦ä¹ å°†æ ¹æ®æ ‡ç­¾å¯¹æ•°æ®è¿›è¡Œåˆ†åŒºã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„åŒºåˆ«ã€‚æ— ç›‘ç£å­¦ä¹ çš„ä¸€ä¸ªä¾‹å­æ˜¯èšç±»ã€‚ç›‘ç£å­¦ä¹ çš„ä¸€ä¸ªä¾‹å­æ˜¯å›å½’ï¼Œå°±åƒæˆ‘ä¹‹å‰å†™çš„ä¸€æ ·ã€‚

ä¾‹å¦‚ï¼Œåœ¨å›å½’æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬æœ‰ X å’Œ Yï¼Œæˆ‘ä»¬é€šè¿‡å®ƒä»¬ç”»ä¸€æ¡æœ€ä½³æ‹Ÿåˆçº¿ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒX æ˜¯æˆ‘ä»¬çš„è¾“å…¥ï¼ŒY æ˜¯è¾“å‡ºã€‚æˆ‘ä»¬å¯ä»¥è¯´è¿™æ˜¯ç›‘ç£å­¦ä¹ ï¼Œå› ä¸º Y æ˜¯ä¸“å®¶æ ‡ç­¾ï¼›ç»™å®šè¿™äº›ä¸“å®¶æ ‡ç­¾ï¼Œæ¨¡å‹æ­£åœ¨å­¦ä¹ å¦‚ä½•è·å– X å¹¶å¾—å‡º Yã€‚

# ç¤ºä¾‹:

*   æ¬ºè¯ˆäº¤æ˜“:æˆ‘ä»¬çŸ¥é“è®­ç»ƒæ•°æ®ä¸­å“ªäº›äº¤æ˜“æ˜¯æ¬ºè¯ˆ(1)ï¼Œå“ªäº›ä¸æ˜¯(0)
*   å†å…¥é™¢:æˆ‘ä»¬çŸ¥é“å“ªäº›æ‚£è€…åœ¨å‡ºé™¢åçš„æŸä¸ªæ—¶é—´çª—å†…å†æ¬¡å…¥é™¢
*   æ¨è:æˆ‘ä»¬çŸ¥é“å“ªäº›å•†å“å‘ˆç°ç»™äº†å®¢æˆ·ï¼Œå“ªäº›å•†å“è¢«ç‚¹å‡»ã€æ·»åŠ åˆ°è´­ç‰©è½¦æˆ–è´­ä¹°äº†
*   ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯åƒåœ¾é‚®ä»¶è¿‡æ»¤å™¨

æœºå™¨å­¦ä¹ ä»»åŠ¡æœ‰å¤šç§ç”¨é€”ã€‚è¿™é‡Œæœ‰ä¸€äº›ç»å…¸çš„æœºå™¨å­¦ä¹ ä»»åŠ¡çš„ä¾‹å­:è¯†åˆ«æ¬ºè¯ˆï¼Œè¯†åˆ«ç—…äººçš„å†æ¬¡å…¥é™¢ï¼Œè¯†åˆ«æ¨èï¼Œå°±åƒä½ å…¸å‹çš„ç½‘é£æœºå™¨å­¦ä¹ æ¡ˆä¾‹ï¼Œå½“ä½ å»ç½‘é£æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä½ ä¼šå–œæ¬¢çš„ç”µå½±çš„æ¨èï¼›è¿™äº›ç”µå½±æ˜¯åŸºäºä½ ä»¥å‰çœ‹è¿‡çš„ç”µå½±ï¼Œå¹¶è€ƒè™‘åˆ°å…¶ä»–äººåœ¨çœ‹è¿‡ä¸ä½ çœ‹è¿‡çš„ç”µå½±ç›¸ä¼¼çš„ç”µå½±æ—¶å–œæ¬¢ä»€ä¹ˆï¼Œä»¥åŠä»–ä»¬çœ‹è¿‡ä»€ä¹ˆç”µå½±ï¼Œé™¤æ­¤ä¹‹å¤–ã€‚è¿™å°±æ˜¯æ‰€è°“çš„æ¨èå¼•æ“ã€‚

> ä½œä¸ºä¸€ä¸ªé¢˜å¤–è¯ï¼Œè¿™ä¸ªæ¨èå¼•æ“æ˜¯ä¸€ç§ç°è‰²åŒºåŸŸï¼Œå¯èƒ½ä¸æ€»æ˜¯è¢«æè¿°ä¸ºç›‘ç£å­¦ä¹ ï¼Œä½†æˆ‘è·‘é¢˜äº†ã€‚

ç›‘ç£å­¦ä¹ çš„ä¸€ä¸ªç»å…¸ä¾‹å­æ˜¯åƒåœ¾é‚®ä»¶è¿‡æ»¤å™¨ã€‚åƒåœ¾é‚®ä»¶è¿‡æ»¤å™¨æ˜¯åšä»€ä¹ˆçš„ï¼Ÿå®ƒå°†ä½ çš„ç”µå­é‚®ä»¶åˆ†ä¸ºåƒåœ¾é‚®ä»¶å’Œéåƒåœ¾é‚®ä»¶ã€‚è¯¥æ¨¡å‹å­¦ä¹ çš„æ–¹å¼æ˜¯é€šè¿‡æŸäººï¼Œä¸€ä¸ªâ€œä¸“å®¶â€â€”â€”ä¸€ä¸ªäººï¼Œæ¥å°†å„ç§ç”µå­é‚®ä»¶æ ‡è®°ä¸ºåƒåœ¾é‚®ä»¶æˆ–éåƒåœ¾é‚®ä»¶ã€‚ç„¶åï¼Œç”µå­é‚®ä»¶å’Œè¿™äº›æ ‡ç­¾è¢«äº¤ç»™ä¸€ç§ç®—æ³•ï¼Œè¯¥ç®—æ³•é¢„è®¡ä¼šè®¡ç®—å‡ºå¦‚ä½•è‡ªè¡Œä»ç”µå­é‚®ä»¶åˆ°è¾¾è¯¥æ ‡ç­¾ã€‚è¿™æ•´ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºç›‘ç£å­¦ä¹ ã€‚

# å…¸å‹çš„æœºå™¨å­¦ä¹ ä»»åŠ¡:

*   **åˆ†ç±»:**æˆ‘ä»¬èƒ½ç»™è¾“å…¥æ‰“ä¸Šæ ‡ç­¾å—ï¼Ÿ
*   **å›å½’**:æˆ‘ä»¬èƒ½åšä¸ªé¢„æµ‹å—ï¼Ÿ
*   **å»ºè®®**:æˆ‘ä»¬èƒ½æ ¹æ®ç”¨æˆ·åå¥½é¢„æµ‹ä¸€äº›ä¸œè¥¿å—ï¼Ÿ

ç›‘ç£å­¦ä¹ æœ‰ä¸¤ä¸ªé‡è¦æ­¥éª¤:é¦–å…ˆï¼Œä½ è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œç„¶åä½ æµ‹è¯•è¿™ä¸ªæ¨¡å‹ã€‚ä½¿ç”¨çœ‹ä¸è§çš„æµ‹è¯•æ•°æ®æ¥æµ‹è¯•ä½ çš„æ¨¡å‹æ˜¯éå¸¸é‡è¦çš„ã€‚åœ¨ä»¥å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘å†™è¿‡ç›‘ç£å­¦ä¹ ï¼Œå°±åƒå›å½’ä¸€æ ·ï¼Œæˆ‘æ²¡æœ‰ä½¿ç”¨æµ‹è¯•æ•°æ®ï¼Œè€Œæ˜¯ä½¿ç”¨è®­ç»ƒæ•°æ®æ¥æµ‹è¯•æ¨¡å‹ã€‚è¿™æ˜¯ä¸å¥½çš„ï¼Œä¸æ˜¯ä¸€ä»¶å¥½äº‹ã€‚äººä»¬å¶å°”åšè¿™ä»¶äº‹ï¼Œåšè¿™ä»¶äº‹æœ‰ä¸åŒçš„åŸå› ã€‚åˆæ³•çš„ç†ç”±å¾ˆå°‘ï¼Œä½†æ˜¯æœ‰ä¸€äº›ã€‚å¦‚æœä½ ç”¨è®­ç»ƒæ•°æ®æ¥ç¡®å®šä½ çš„æ¨¡å‹çš„å‡†ç¡®æ€§ï¼Œé‚£ä¹ˆä½ å……å…¶é‡æ˜¯åœ¨æ„šå¼„è‡ªå·±ï¼›æœ€åçš„æƒ…å†µæ˜¯ï¼Œä½ åœ¨æ’’è°ã€‚

æ‰€ä»¥ä¸ºäº†æµ‹è¯•è¿™ä¸ªæ¨¡å‹ï¼Œä½ éœ€è¦ä½¿ç”¨æ‰€è°“çš„â€œçœ‹ä¸è§çš„æµ‹è¯•æ•°æ®â€ç°åœ¨ï¼Œæˆ‘ä»¬å¦‚ä½•åˆ›å»ºçœ‹ä¸è§çš„æµ‹è¯•æ•°æ®ï¼Ÿå—¯ï¼Œè¿™å¾ˆç®€å•ã€‚æ‚¨åªéœ€å°†æ‚¨çš„å»ºæ¨¡æ•°æ®åˆ†æˆè®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®:åœ¨æ¨¡å‹å·²ç»åœ¨è®­ç»ƒæ®µä¸Šè®­ç»ƒä¹‹åï¼Œæµ‹è¯•æ•°æ®ç”¨äºæ¨¡å‹çš„æµ‹è¯•ã€‚

æˆ‘ä»¬æ‰€è¯´çš„å­¦ä¹ æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿä½ ä½¿ç”¨æ•°æ®å’Œç®—æ³•å¾—å‡ºä¸€ä¸ªæ€§èƒ½æŒ‡æ ‡æˆ–æœ€å°åŒ–ä¸€ä¸ªæˆæœ¬å‡½æ•°â€”â€”è¿™æ˜¯å¦ä¸€ç§è¯´æ³•ã€‚å½“ä½ è¿™æ ·åšçš„æ—¶å€™ï¼Œä½ å°†ä¼šç”¨æ–°çš„æ“ä½œæ•°æ®æå‡ºä¸€ä¸ªæ¨¡å‹ï¼Œä½ å°†ä¼šå¾—åˆ°ä¸€ä¸ªç­”æ¡ˆã€‚

# å­¦ä¹ çš„åŸºæœ¬å‡è®¾

å­¦ä¹ çš„ä¸€ä¸ªåŸºæœ¬å‡è®¾æ˜¯è®­ç»ƒæ ·æœ¬çš„åˆ†å¸ƒä¸æµ‹è¯•æ ·æœ¬çš„åˆ†å¸ƒç›¸åŒï¼ŒåŒ…æ‹¬æœªæ¥æœªçŸ¥çš„æ ·æœ¬ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œè®­ç»ƒæ ·æœ¬çš„åˆ†å¸ƒä¸æœªæ¥çš„æ ·æœ¬è¶³å¤Ÿç›¸ä¼¼ã€‚é‰´äºå®ƒä»¬æ˜¯æœªæ¥çš„ä¾‹å­ï¼Œå®ƒä»¬æ˜¯çœ‹ä¸è§çš„ã€‚

å¦‚æœä½ æƒ³è¦ä¸€ä¸ªç²¾ç¡®çš„åº¦é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªåˆ†å¸ƒä¹Ÿåº”è¯¥ç±»ä¼¼äºæµ‹è¯•ä¾‹å­ã€‚è¿™ç§å‡è®¾ä¸æ˜¯å¿…éœ€çš„ã€‚ä¸€ä¸ªè¦æ±‚æ˜¯ï¼Œä¸ºäº†è®©ä½ ç›¸ä¿¡ä½ çš„å‡†ç¡®æ€§ï¼Œä½ çš„æµ‹è¯•ä¾‹å­å¿…é¡»å’Œä½ æœªæ¥çš„ä¾‹å­æ¥è‡ªåŒä¸€ä¸ªåˆ†å¸ƒã€‚

å¦‚æœæ‚¨åˆ›å»ºäº†ä¸€ä¸ªå¯ç”¨çš„æ¨¡å‹ï¼Œé‚£ä¹ˆæ‚¨çš„è®­ç»ƒç¤ºä¾‹æ¥è‡ªå“ªé‡Œå¹¶ä¸é‡è¦ã€‚å¦‚æœä½ çš„è®­ç»ƒæ ·æœ¬æ¥è‡ªä¸åŒçš„å‘è¡Œç‰ˆï¼Œé‚£å°±æ›´æœ‰åŠ›é‡äº†ã€‚è¦æˆä¸ºæœ‰æ•ˆçš„è¡¡é‡æ ‡å‡†ï¼Œæµ‹è¯•ç¤ºä¾‹å¿…é¡»è¶³å¤Ÿç±»ä¼¼äºåœ¨å®é™…æ“ä½œæ•°æ®æ—¶ä½¿ç”¨çš„ç¤ºä¾‹â€”â€”å½“æ¶‰åŠåˆ°å¯æ“ä½œæ€§æ—¶ã€‚ç°åœ¨ï¼Œå¯¹ä¸Šè¿°å‡è®¾çš„å¼ºçƒˆè¿åå°†å¯¼è‡´è¾ƒå·®çš„åˆ†ç±»å‡†ç¡®åº¦ã€‚

## æœºå™¨å­¦ä¹ æ¡†æ¶

![](img/fb66ce7ea3628dc2597eb1f42cabf845.png)

ä½œè€…å›¾ç‰‡

**è®­ç»ƒ:**ç»™å®šä¸€ä¸ª*è®­ç»ƒ*çš„æ ‡è®°æ ·æœ¬é›†{(x_1ï¼Œy_1ï¼Œâ€¦ (x_nï¼Œy_n)}ï¼Œä¼°è®¡ä½¿è®­ç»ƒé›†ä¸Šçš„é¢„æµ‹è¯¯å·®æœ€å°çš„é¢„æµ‹å‡½æ•°(f)å’Œå‚æ•°(Î¸)

![](img/a29e5565d438101d0e967b323f4ca08a.png)

åŸ¹è®­åŠŸèƒ½|ä½œè€…å›¾ç‰‡

**æµ‹è¯•:**å°†(f)åº”ç”¨äºä¸€ä¸ªä»æœªè§è¿‡çš„*æµ‹è¯•*ä¾‹å­(x)å¹¶è¾“å‡ºé¢„æµ‹å€¼(y = f(x))

åœ¨æ•´ä¸ªæœºå™¨å­¦ä¹ æ¡†æ¶ä¸­ï¼Œä½ ç»™ä¸€ä¸ª Xï¼Œç„¶åä½ å¾—åˆ°ä¸€ä¸ª yã€‚è¿™å°†ä¼šæœ‰ä¸€äº›è¯¯å·®ï¼Œå› ä¸ºæœ‰ä¸€äº›éšæœºå™ªå£°ä¸ä¸€åˆ‡ç›¸å…³ã€‚è¿™æ„å‘³ç€ä½ å¾—åˆ°çš„å®é™… Yï¼Œå¹¶ä¸å®Œå…¨æ˜¯ä¸Šé¢çš„å‡½æ•°ã€‚

# **åˆ†ç±»å·¥ä½œæµç¨‹**

![](img/5ee8b7775e5a5a99dec111323187bf7b.png)

åˆ†ç±»å·¥ä½œæµç¨‹å›¾|æŒ‰ä½œè€…åˆ†ç±»çš„å›¾ç‰‡

æœ€é‡è¦çš„æ˜¯æ•°æ®å¿…é¡»åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚æ¨¡å‹æ˜¯åœ¨è®­ç»ƒé›†ä¸­å¼€å‘çš„ï¼Œæ¨¡å‹æ˜¯åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°çš„ã€‚æœ€åï¼Œæ‚¨å¯ä»¥è·å¾—æ€§èƒ½åº¦é‡ï¼Œä¹Ÿç§°ä¸ºå‡†ç¡®æ€§åº¦é‡ã€‚è¿™é‡Œæœ‰ä¸‰ä¸ªæ€§èƒ½åº¦é‡:å…¶ä¸­ç§°ä¸ºå‡†ç¡®æ€§çš„æ€§èƒ½åº¦é‡å¯èƒ½æ˜¯æœ€å·®çš„æ€§èƒ½åº¦é‡ã€‚å‡†ç¡®ç‡å’Œå¬å›ç‡éƒ½ç›¸å½“ä¸é”™ã€‚æœ‰ä¸€ä¸ªæ›´å¥½çš„æ–¹æ³•æ˜¯ç²¾ç¡®åº¦å’Œå¬å›ç‡çš„æ··åˆï¼Œå³ F1 åˆ†æ•°ã€‚

æˆ‘æ›´å–œæ¬¢å®ƒçš„åŸå› æ˜¯å®ƒæ˜¯å¬å›ç‡å’Œç²¾ç¡®åº¦çš„æ··åˆä½“ã€‚ä½ ä¼šå¸Œæœ›æœ‰è‰¯å¥½çš„å›å¿†å’Œå‡†ç¡®æ€§ã€‚å¦‚æœä½ æœ‰éå¸¸å¥½çš„å›å¿†å’Œéå¸¸ç³Ÿç³•çš„ç²¾ç¡®åº¦ï¼Œåä¹‹äº¦ç„¶ï¼Œä½ çš„æ¨¡å‹æ˜¯æ²¡æœ‰ä»·å€¼çš„ã€‚å¯¹äºäºŒå…ƒåˆ†ç±»ï¼Œæœ‰ä¸€ä¸ªæ›´å¥½çš„å‡†ç¡®æ€§è¡¡é‡æ ‡å‡† ROC AUCã€‚

æ‰€ä»¥ ROC æ›²çº¿çš„æ›²çº¿ä¸‹é¢ç§¯æ˜¯ç”¨æ¥åˆ†ç±»çš„ã€‚å®ƒä¹‹æ‰€ä»¥ä¼˜äºä»¥å‰çš„æ€§èƒ½åº¦é‡ï¼Œæ˜¯å› ä¸ºå®ƒå¯¹æ‰€æœ‰é˜ˆå€¼éƒ½æœ‰æ•ˆï¼›è€Œå‡†ç¡®åº¦æˆ–ç²¾ç¡®åº¦å‡å®šä¸€ä¸ªé˜ˆå€¼ï¼Œé€šå¸¸å‡å®šé˜ˆå€¼ä¸º 0.5ã€‚åŒæ ·ï¼ŒF1 åˆ†æ•°ä¹Ÿå‡å®šé˜ˆå€¼ä¸º 0.5ã€‚ä½ å¯ä»¥é€‰æ‹©ä¸åŒçš„é˜ˆå€¼ï¼Œä½†å¤§å¤šæ•°äººä¸ä¼šè®¤ä¸ºä½ ä¼šé€‰æ‹©ä¸åŒçš„é˜ˆå€¼ã€‚

ä¹‹æ‰€ä»¥é€‰æ‹©ä¸åŒçš„é˜ˆå€¼ï¼Œæ˜¯å› ä¸ºæ‚¨å¯èƒ½æœ‰ä¸åŒçš„ç›®çš„ï¼Œå…¶ä¸­æ‚¨çš„å‡é˜³æ€§å¯èƒ½æ¯”å‡é˜´æ€§æ›´ç³Ÿç³•ï¼Œåä¹‹äº¦ç„¶ã€‚é€šè¿‡è°ƒæ•´ä½ çš„é˜ˆå€¼ï¼Œä½ å¯ä»¥æƒè¡¡è¿™äº›ã€‚

## è®¸å¤šåˆ†ç±»å™¨å¯ä¾›é€‰æ‹©

*   çº¿æ€§å›å½’
*   é€»è¾‘å›å½’
*   æ”¯æŒå‘é‡æœº(SVM)
*   ç¥ç»ç½‘ç»œ(å®‰ï¼Œæœ‰çº¿ç”µè§†æ–°é—»ç½‘ï¼ŒRNNï¼ŒDNN)
*   æœ´ç´ è´å¶æ–¯
*   è´å¶æ–¯ç½‘ç»œ
*   éšæœºæ£®æ—(éšæœºæ£®æ—)
*   æå‡å†³ç­–æ ‘(æ¢¯åº¦æå‡æ ‘)
*   k-æœ€è¿‘é‚»(KNN)

è¿™é‡Œæ˜¯æ‰€è°“çš„åˆ†ç±»å™¨ï¼Œç›‘ç£å­¦ä¹ ä¸­ä½¿ç”¨çš„ç®—æ³•ã€‚KNN é€šå¸¸è¢«è®¤ä¸ºæ˜¯ä½ æœ€ç®€å•çš„æ¦‚å¿µï¼Œå¹¶ä¸”ç»å¸¸åœ¨è¿™æ ·çš„è¯¾ä¸Šæ•™æˆï¼Œå› ä¸ºç®—æ³•ç›¸å¯¹ç®€å•:ä½ å¯ä»¥ä»å¤´å¼€å§‹å†™ç®—æ³•ã€‚

å¢å¼ºå†³ç­–æ ‘å’ŒéšæœºåŒ–æ£®æ—æ›¾ç»æ˜¯ä½ é€šå¸¸å–œæ¬¢çš„æœºå™¨å­¦ä¹ åˆ†ç±»ç®—æ³•ã€‚ä»Šå¤©ï¼Œâ€œæœ€æ–°â€ç±»å‹çš„ç®—æ³•æ˜¯ç¥ç»ç½‘ç»œã€‚å½“æˆ‘è¯´æœ€æ–°çš„æ—¶å€™ï¼Œæˆ‘çš„é™ˆè¿°æ˜¯å¤§çº¦ 5 åˆ° 10 å¹´å‰çš„ï¼Œè¿™å–å†³äºä½ å¦‚ä½•çœ‹å¾…å®ƒã€‚ä½†æ˜¯ç›´åˆ°å¤§çº¦äº”å¹´å‰ï¼ŒKaggle ç«èµ›[æ˜¯ç”±å¢å¼ºçš„å†³ç­–æ ‘å’Œéšæœºæ£®æ—èµ¢å¾—](https://www.kaggle.com/msjgriffiths/r-what-algorithms-are-most-successful-on-kaggle/data?scriptVersionId=0)ã€‚ç°åœ¨ï¼Œæ·±åº¦ç¥ç»ç½‘ç»œæ­£åœ¨èµ¢å¾— Kaggle æ¯”èµ›ã€‚æ‰€ä»¥ä¸æ˜¯ç¥ç»ç½‘ç»œï¼Œè€Œæ˜¯ä¸€ç§æ›´å¤æ‚çš„ç¥ç»ç½‘ç»œï¼Œå«åšæ·±åº¦ç¥ç»ç½‘ç»œ(DNN)ã€‚

é€»è¾‘å›å½’æ˜¯æ¯ä¸ªäººçš„æœ€çˆ±â€”â€”æ¯å½“ä½ åšä¸€ä¸ªåˆ†ç±»ï¼Œä½ é¦–å…ˆåšä¸€ä¸ªé€»è¾‘å›å½’ï¼Œæ€»æ˜¯è¿™æ ·ï¼ä»è¿™ä¸ªæ„ä¹‰ä¸Šæ¥è¯´ï¼Œæœ´ç´ è´å¶æ–¯ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚ä½†æ˜¯é€»è¾‘å›å½’å¯èƒ½æ›´è¿›ä¸€æ­¥ã€‚æ‰€ä»¥ä½ æ€»æ˜¯åšé€»è¾‘å›å½’ã€‚ä¸æ˜¯å› ä¸ºä½ æƒ³ç‚«è€€é€»è¾‘å›å½’çš„ç»“æœã€‚åªæ˜¯å®ƒæ˜¯å¦‚æ­¤çš„å¼ºå¤§ï¼Œä½ çŸ¥é“å¦‚æœä½ ä¸èƒ½è®©é€»è¾‘å›å½’èµ·ä½œç”¨ï¼Œä½ ä¹Ÿä¸èƒ½è®©å…¶ä»–ä»»ä½•ä¸œè¥¿èµ·ä½œç”¨ã€‚æ‰€ä»¥é€»è¾‘å›å½’æ˜¯ä½ è¦åšçš„ç¬¬ä¸€ä»¶äº‹ã€‚å½“è¿™ç§æ–¹æ³•å¥æ•ˆæ—¶ï¼Œä½ å°±å¼€å§‹å˜å¾—æ›´åŠ å¤§èƒ†ï¼Œå°è¯•ä¸Šé¢åˆ—å‡ºçš„å…¶ä»–ç®—æ³•ã€‚

# ä¸€èˆ¬åŒ–

**æ¬ æ‹Ÿåˆ**:æ¨¡å‹è¿‡äºâ€œç®€å•â€ï¼Œæ— æ³•è¡¨ç¤ºæ‰€æœ‰ç›¸å…³çš„ç±»ç‰¹å¾â€”â€”é«˜è®­ç»ƒè¯¯å·®å’Œé«˜éªŒè¯è¯¯å·®ã€‚

**è¿‡æ‹Ÿåˆ**:æ¨¡å‹è¿‡äºâ€œå¤æ‚â€ï¼Œæ‹Ÿåˆæ•°æ®ä¸­ä¸ç›¸å…³çš„ç‰¹å¾(å™ªå£°)â€”â€”è®­ç»ƒè¯¯å·®ä½ï¼ŒéªŒè¯è¯¯å·®é«˜(è®­ç»ƒå’ŒéªŒè¯æ€§èƒ½å·®è·å¤§)

ä¸€èˆ¬åŒ–æ„å‘³ç€å®ƒå·¥ä½œå¾—æœ‰å¤šå¥½ã€‚ä½œä¸ºä¸€ä¸ªå¾ˆå¥½çš„å¯å‘**æ¯å½“ä½ è¯´ä¸€èˆ¬åŒ–ï¼Œä½ ä¼šæƒ³åˆ°æ­£è§„åŒ–**ã€‚ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿå› ä¸ºä½ æ¦‚æ‹¬ä¸€ä¸ªæ¨¡å‹çš„æ–¹æ³•æ˜¯é€šè¿‡æ­£åˆ™åŒ–è¿™ä¸ªæ¨¡å‹ã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªå¾ˆå¥½çš„æ­£åˆ™åŒ–æ¨¡å‹ï¼Œå®ƒå¤§æ¦‚æ˜¯å¹¿ä¹‰çš„ã€‚æ³›åŒ–æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿè¿™æ„å‘³ç€å®ƒä¸ä»…ä»…åœ¨æœ€å°çš„ç¯å¢ƒä¸‹ä¹Ÿèƒ½å·¥ä½œã€‚å› æ­¤æ²¡æœ‰å‡ºç°è¿‡æ‹Ÿåˆã€‚æ¬ æ‹Ÿåˆæ¨¡å‹é€šå¸¸è¿‡äºç®€å•ï¼Œéœ€è¦åšæ›´å¤šçš„å·¥ä½œæ¥ä»ä¸­æå–ä¿¡æ¯ã€‚ä½†æ˜¯è¿‡æ‹Ÿåˆæ¨¡å‹ä¸å¤Ÿä¸€èˆ¬åŒ–ï¼Œéœ€è¦æ­£åˆ™åŒ–ã€‚

# æœºå™¨å­¦ä¹ ä¸­çš„å¸¸è§é™·é˜±

*   **è¿‡æ‹Ÿåˆ**
*   **æ¬ æ‹Ÿåˆ**
*   **æ•°æ®æ³„éœ²**:åœ¨è®­ç»ƒæ•°æ®ä¸­äº§ç”Ÿæ„æƒ³ä¸åˆ°çš„é¢å¤–ä¿¡æ¯ï¼Œäº§ç”Ÿä¸åˆ‡å®é™…çš„å¥½é¢„æµ‹ã€‚å°†æµ‹è¯•æ•°æ®æ³„éœ²åˆ°è®­ç»ƒæ•°æ®ä¸­ã€‚åŒ…å«æ¨¡å‹æ“ä½œç¯å¢ƒä¸­ä¸å­˜åœ¨çš„æ•°æ®

å¾ˆå°‘æœ‰æ¬ æ‹Ÿåˆçš„é™·é˜±ï¼Œå¯èƒ½æ˜¯ç®—æ³•çš„ä½¿ç”¨è¿‡äºåŸå§‹ï¼Œå¯¼è‡´äº†æŸç§ç¨‹åº¦çš„æ¬ æ‹Ÿåˆï¼Œå› ä¸ºäººä»¬å¯èƒ½å·²ç»åœæ­¢äº†é€»è¾‘å›å½’ï¼Œä»–ä»¬åº”è¯¥ä½¿ç”¨æ¢¯åº¦æå‡æ ‘ï¼Œå¦‚æœä½ æƒ³è®¤ä¸ºè¿™æ˜¯ä¸€ç§æ¬ æ‹Ÿåˆã€‚å¦‚å‰æ‰€è¿°ï¼Œè¿‡åº¦æ‹Ÿåˆæ˜¯ä½ çš„ä¸€ä¸ªå¤§é—®é¢˜ã€‚

ç°åœ¨ï¼Œä¸‹ä¸€ä¸ªå¤§é—®é¢˜æ˜¯æ•°æ®æ³„æ¼æˆ–ä»»ä½•ç±»å‹çš„ä»£ç†åˆ—æˆ–ä»£ç†ã€‚è¿™äº›é—®é¢˜ç»å¸¸å‘ç”Ÿã€‚è¿™ä¸ªæ¦‚å¿µå¾ˆéš¾ç†è§£ï¼Œå¾ˆéš¾è§£é‡Šï¼Œå¾ˆéš¾æ•™ä¸ºä»€ä¹ˆè¿™æ ·çš„äº‹æƒ…ä¼šç»å¸¸å‘ç”Ÿï¼Œé™¤éä½ è‡ªå·±åšè¿‡ã€‚

ä¾‹å¦‚ï¼Œä½ å·²ç»æŸ¥çœ‹äº†ä¸€ä¸ªæœˆçš„æ•°æ®ï¼Œå¹¶å¯¹å…¶è¿›è¡Œäº†å¤„ç†ï¼Œåªæœ‰å½“ä½ çš„æµ‹è¯•ç»“æœå‡ºæ¥åï¼Œä½ æ‰èƒ½çœ‹åˆ°ä½ çš„æœºå™¨å­¦ä¹ ç®—æ³•çš„æµ‹è¯•ç»“æœï¼Œæ¯”å¦‚ä½ çš„å‡†ç¡®ç‡ä¸º. 97ã€‚è¿™æ—¶ä½ æ‰æ„è¯†åˆ°ï¼Œâ€œå“¦ï¼Œæˆ‘ä¸€å®šæ˜¯æ•°æ®æ³„éœ²äº†ã€‚â€ç®€è€Œè¨€ä¹‹â€”â€”ä½ å¾ˆå°‘èƒ½å¾—åˆ°è¿™ä¹ˆå¥½çš„æ¨¡å‹ã€‚ç„¶åä½ å¿…é¡»å‰–æä½ çš„æ¨¡å‹ï¼Œä½ å¿…é¡»æ‰¾å‡ºä¸ºä»€ä¹ˆä½ çš„æ¨¡å‹å¥½å¾—ä¸çœŸå®ã€‚è€Œä½ çš„æ¨¡å‹å¥½åˆ°ä¸çœŸå®çš„åŸå› ï¼Œé€šå¸¸æ˜¯å› ä¸ºæ•°æ®æ³„éœ²ã€‚

> ä¸€ä¸ªç°å®ç”Ÿæ´»ä¸­çš„ä¾‹å­:å‰åˆ—è…ºç™Œæ¨¡å‹åŒ…æ‹¬ä¸€ä¸ªå˜é‡ï¼Œè¡¨æ˜æ‚£è€…æ˜¯å¦è¿›è¡Œäº†å‰åˆ—è…ºç™Œæ‰‹æœ¯ã€‚æ¨¡å‹çœ‹ä¸åˆ°æœªæ¥ï¼Œæ‚£è€…æ˜¯å¦åšè¿‡æ‰‹æœ¯çš„æ•°æ®åº”è¯¥å·²ç»ä»æ¨¡å‹ä¸­åˆ é™¤ä»¥è¿›è¡Œè®­ç»ƒã€‚

# æ··æ·†çŸ©é˜µ

![](img/713b0cbf3e44d4f5ee1f2e7d4524b88f.png)

æ··æ·†çŸ©é˜µçš„ç¼–ç 

è¿™æ˜¯ä¸€ä¸ªæ··æ·†çŸ©é˜µçš„ä¾‹å­ã€‚å…³äºè¿™äº›æ··æ·†çŸ©é˜µçš„ä¸€ä¸ªé‡è¦æ³¨æ„äº‹é¡¹æ˜¯ï¼Œå®ƒä»¬é€šå¸¸åœ¨å·¦ä¸Šè§’æœ‰çœŸè´Ÿå€¼ï¼Œåœ¨å³ä¸‹è§’æœ‰çœŸæ­£å€¼ã€‚ä¹‹æ‰€ä»¥ä¼šè¿™æ ·ï¼Œç°åœ¨çœ‹æ¥ï¼Œæ˜¯å› ä¸ºé›¶å°äºä¸€ã€‚å› ä¸ºçœŸæ­£çš„å¦å®šé€šå¸¸è¢«å»ºæ¨¡ä¸ºé›¶ï¼Œæ‰€ä»¥é¦–å…ˆåˆ—å‡ºå®ƒä»¬åœ¨æ•°å­—ä¸Šæ˜¯æœ‰æ„ä¹‰çš„ã€‚å½“ä½ æŠŠä½ çš„å®é™…ç±»å’Œä½ çš„é¢„æµ‹ç±»ç®€åŒ–æˆè®¡ç®—æœºæœ€å®¹æ˜“ç†è§£çš„å½¢å¼æ—¶ï¼Œä½ å°±æŠŠå®ƒä»¬ç®€åŒ–æˆäº† 0 å’Œ 1ã€‚å› ä¸ºé›¶æ¯”ä¸€å°ï¼Œæ‰€ä»¥é›¶å…ˆå»ï¼Œä¸€åå»ã€‚å› ä¸º 0 æ¯” 1 å°ï¼Œæ‰€ä»¥ 0 åœ¨å‚ç›´æ–¹å‘ä¸Šä¹Ÿæ˜¯å…ˆèµ°ï¼Œç„¶åæ˜¯ 1ã€‚é›¶é€šå¸¸ä¸ç¼ºå°‘æŸç‰©è”ç³»åœ¨ä¸€èµ·ï¼Œé€šå¸¸ä¸å¦å®šè”ç³»åœ¨ä¸€èµ·ã€‚

åœ¨è¿™é‡Œï¼Œé˜´æ€§å¹¶ä¸æ˜¯ä¸€ä»¶åäº‹â€”â€”å¦‚æœæˆ‘æ˜¯æ–°å† è‚ºç‚é˜´æ€§ï¼Œè¿™æ„å‘³ç€æˆ‘æ²¡æœ‰ COVIDï¼Œæˆ–è€…è‡³å°‘æˆ‘çš„æµ‹è¯•ç»“æœæ˜¯ COVID é˜´æ€§ã€‚å¦‚æœæˆ‘æ²¡æœ‰ COVIDï¼Œé‚£ä¹ˆè¿™å°±æ˜¯æˆ‘æ‰€è¯´çš„çœŸè´Ÿå€¼ã€‚åŒæ ·ï¼Œç¼–ç ä¸º 1 1 æ„å‘³ç€æˆ‘ç¡®å®æœ‰ COVIDï¼Œå¹¶ä¸”æˆ‘æ£€æµ‹ç»“æœä¸ºé˜³æ€§ã€‚

è¿™å°±æ˜¯ä¸ºä»€ä¹ˆçœŸé˜´æ€§å’ŒçœŸé˜³æ€§æ˜¯è¿™æ ·æ’åˆ—çš„:çœŸé˜´æ€§åœ¨å·¦ä¸Šæ–¹ï¼ŒçœŸé˜³æ€§åœ¨å³ä¸‹æ–¹ã€‚æƒ…å†µå¹¶ä¸æ€»æ˜¯è¿™æ ·â€”â€”è¿‡å»æ˜¯ç›¸åçš„ï¼ä½†è¿™æ˜¯ä½ æœ€è¿‘å¤§éƒ¨åˆ†æ—¶é—´çœ‹åˆ°çš„ã€‚è¿™å’Œ 0 å’Œ 1 çš„æ’åºæœ‰å…³ï¼

ç²¾ç¡®åº¦å’Œå¬å›ç‡æ˜¯éœ€è¦ç†è§£çš„é‡è¦æ¦‚å¿µï¼Œä½†è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ã€‚æ­£å¦‚æˆ‘ä¸Šé¢æåˆ°çš„ï¼Œæˆ‘æ›´å–œæ¬¢ F1 åˆ†æ•°ï¼Œç²¾åº¦å’Œå›å¿†çš„è°ƒå’Œå¹³å‡å€¼(ç›¸å¯¹äºç®—æœ¯å¹³å‡å€¼)ä½œä¸ºæˆ‘çš„â€œå‡†ç¡®æ€§â€æŒ‡æ ‡ï¼Œè€Œä¸æ˜¯é€‰æ‹©ä»»ä½•ä¸€ä¸ªã€‚ä½†æ˜¯åˆ†ç±»çš„æœ€ä½³æ€§èƒ½æµ‹é‡æ˜¯ ROC æ›²çº¿ã€‚

å—è¯•è€…å·¥ä½œç‰¹å¾(ROC)æ›²çº¿å¯¹äºåˆ†ç±»éå¸¸æœ‰ç”¨ã€‚æˆ‘ç›¸ä¿¡è¿™æ˜¯æœ€é‡è¦çš„å‡†ç¡®æ€§æµ‹é‡ï¼Œä½†æœ‰æ—¶å®ƒä¸èƒ½ä½¿ç”¨ã€‚è¿™æ˜¯æœ‰åŸå› çš„ï¼Œä½†ä¸€èˆ¬æ¥è¯´ï¼ŒROC æ›²çº¿æ˜¯ä½ æƒ³è¦ä½¿ç”¨çš„ã€‚ä¹‹æ‰€ä»¥è¦ç”¨ ROC æ›²çº¿ï¼Œæ˜¯å› ä¸ºå®ƒè€ƒè™‘äº†æ‰€æœ‰çš„é˜ˆå€¼ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ä¸ºä»€ä¹ˆé‡è¦ï¼Œè€ƒè™‘è¿™ä¸ªå‡è®¾çš„é¢è¯•é—®é¢˜:ç»™äººä»¬å‡é˜³æ€§ã€çœŸé˜³æ€§ã€å‡é˜´æ€§å’ŒçœŸé˜´æ€§çš„æ•°å­—â€”â€”æ¯ç§æ•°å­—æœ‰ 10 ä¸ªã€‚æ‰€ä»¥è¿™å¯èƒ½ä¼šç»™ä½ æœ€å·®çš„å‡†ç¡®åº¦åˆ†æ•°:0.5

> é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå¦‚æœä½ çš„æ¨¡å‹ç²¾ç¡®åˆ°äº† 0.01ï¼Œé‚£ä¹ˆåªè¦æŠŠä½ çš„ 0 ç±»å’Œ 1 ç±»çš„æ ‡ç­¾æ¢ä¸€ä¸‹ï¼Œä½ çš„æ¨¡å‹å°±ä¼šçªç„¶ç²¾ç¡®åˆ° 0.99

ä½†æ˜¯å¦‚æœä½ çœ‹çœ‹æ¦‚ç‡ï¼ŒçœŸé˜³æ€§å’ŒçœŸé˜´æ€§çš„æ¦‚ç‡:éƒ½æ˜¯ 0 å’Œ 1 å·¦å³â€”â€”æ„å‘³ç€å®ƒä»¬æ˜¯å¥½çš„ã€‚å‡é˜³æ€§å’Œå‡é˜´æ€§çš„æ¦‚ç‡éƒ½åœ¨ 0.5 å·¦å³ï¼Œè¿™æ„å‘³ç€å®ƒä»¬éå¸¸ç³Ÿç³•ã€‚è¿™æ„å‘³ç€é”™è¯¯æ˜¯ä¸å¯é çš„ï¼Œæ­£ç¡®çš„ç»“æœæ˜¯éå¸¸å¥½çš„æˆ–éå¸¸å®‰å…¨çš„ï¼›å› æ­¤ï¼Œæ‚¨å°†å› æ­¤è·å¾—æ›´é«˜çš„ ROC AUC åˆ†æ•°ï¼ä½ å°†æ°¸è¿œä¸ä¼šçœ‹åˆ°ä»»ä½•ç±»ä¼¼çš„å…¶ä»–å‡†ç¡®æ€§æªæ–½ï¼Œå› ä¸º**ä»–ä»¬ä¸è€ƒè™‘æ¦‚ç‡ã€‚ä»–ä»¬åªè€ƒè™‘å¸ƒå°”ç»“æœ**:å®ƒæ˜¯çœŸçš„æ­£è¿˜æ˜¯ä¸æ˜¯çœŸçš„æ­£ï¼Ÿ

# æœ´ç´ è´å¶æ–¯

æœ´ç´ è´å¶æ–¯æ¨¡å‹çš„ä¸€äº›å±æ€§æ˜¯

*   ä¸éœ€è¦å…ˆéªŒçŸ¥è¯†
*   è®¡ç®—å¤æ‚åº¦ä¸å‚æ•°/ç‰¹å¾çš„æ•°é‡æˆçº¿æ€§å…³ç³»
*   éœ€è¦æœ€å°‘çš„æ•°æ®æ¥ç”Ÿæˆæ¦‚æ‹¬è‰¯å¥½çš„æ¨¡å‹
*   å…·æœ‰ç®€å•å’Œå›ºæœ‰çš„æ­£åˆ™åŒ–

ä¸€äº›åº”ç”¨:

*   æ–‡ä»¶åˆ†ç±»
*   åƒåœ¾é‚®ä»¶æ£€æµ‹
*   å›¾åƒåˆ†ç±»

æ˜¯çš„ï¼Œæœ´ç´ è´å¶æ–¯ä¸­çš„è´å¶æ–¯ç¡®å®æŒ‡çš„æ˜¯è´å¶æ–¯å®šç†ï¼Œæˆ‘ä¹‹å‰[å†™è¿‡](/bayesian-statistics-11f225174d5a)å…³äºå®ƒã€‚è´å¶æ–¯å®šç†å’Œæœ´ç´ è´å¶æ–¯æ¨¡å‹ä¹‹é—´ä¹Ÿæœ‰éå¸¸æ˜ç¡®çš„è”ç³»ã€‚ç„¶è€Œï¼Œæœ´ç´ è´å¶æ–¯æ¨¡å‹çš„å‡è®¾æ˜¯ä¸ªä½“ç»´åº¦æ˜¯ç‹¬ç«‹çš„ï¼Œæˆ–è€…è¯´æ˜¯æœ´ç´ çš„ã€‚è¿™æ„å‘³ç€è´å¶æ–¯å®šç†çš„é‡è¦éƒ¨åˆ†ï¼Œä½ å¯ä»¥æŠŠ A çš„æ¦‚ç‡å’Œ B çš„æ¦‚ç‡è”ç³»èµ·æ¥ï¼Œæˆ–è€…ä¸éœ€è¦äº¤é›†ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œå¤©çœŸåœ°è®¤ä¸ºï¼Œæˆ‘ä»¬è¯´è¿™äº›æ¦‚ç‡æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚å› æ­¤æ¡ä»¶æ¦‚ç‡åŸºæœ¬ä¸Šæ¶ˆå¤±äº†ã€‚è¿™å°±æ˜¯æœ´ç´ è´å¶æ–¯ä¸­çš„â€œå¤©çœŸâ€â€”â€”è¡¨ç°å¾—å¥½åƒä½ çš„æ•°æ®ç»´åº¦æ˜¯ç‹¬ç«‹çš„ã€‚

å¦‚æœæ‚¨çš„æ•°æ®ç»´åº¦ä¸æ˜¯ç‹¬ç«‹çš„ï¼Œé‚£ä¹ˆæ‚¨çš„æœ´ç´ è´å¶æ–¯å°†ä¸ä¼šå¾ˆå¥½åœ°å·¥ä½œã€‚ä¸€ä¸ªä»¤äººæƒŠè®¶çš„ç»“æœï¼Œæˆ–è€…è‡³å°‘ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå¦‚æœä½ è¿‡äºå…³æ³¨ç‹¬ç«‹æ€§çš„è¦æ±‚ï¼Œæœ´ç´ è´å¶æ–¯æ¨¡å‹åœ¨ä½ çš„ç»´åº¦ä¸å®Œå…¨ç‹¬ç«‹çš„æƒ…å†µä¸‹ä»ç„¶å¯ä»¥å¾ˆå¥½åœ°å·¥ä½œã€‚ä¸ç®¡æ€æ ·ï¼Œæˆ‘çš„è§‚ç‚¹æ˜¯ï¼Œåœ¨è€ƒè™‘è´å¶æ–¯å®šç†æ—¶ï¼Œä¸€äº›æœ€å›°éš¾çš„éƒ¨åˆ†å› ä¸ºæœ´ç´ è´å¶æ–¯è€Œå˜å¾—éå¸¸ç®€å•ï¼›å› ä¸ºä½ å‡è®¾æ¦‚ç‡æ˜¯ç›¸äº’ç‹¬ç«‹çš„â€”â€”å› æ­¤ä¸éœ€è¦è®¡ç®—æˆ–å‡è®¾æ¡ä»¶æ¦‚ç‡ã€‚ç»´åº¦ç‹¬ç«‹æ€§å‡è®¾å…è®¸æ‚¨å°†æ¦‚ç‡å½¼æ­¤ç›¸ä¹˜ï¼Œè¿™å¤§å¤§ç®€åŒ–äº†è®­ç»ƒå’Œæµ‹è¯•æ¨¡å‹æ‰€éœ€çš„è®¡ç®—ã€‚

å°±åƒé€»è¾‘å›å½’æ˜¯å¦‚ä½•è¢«ç”¨ä½œåˆ†ç±»å™¨ä¸€æ ·ï¼Œä½ å¯ä»¥ç§°ä¹‹ä¸ºé€»è¾‘åˆ†ç±»å™¨ã€‚å› æ­¤ï¼Œæœ´ç´ è´å¶æ–¯çš„ä¸€ä¸ªæ›´å¥½çš„åå­—å¯èƒ½æ˜¯æœ´ç´ æ¦‚ç‡æ¨¡å‹ï¼Œä»¥è¿œç¦»è´å¶æ–¯å®šç†ä¸­å›ºæœ‰çš„æ¡ä»¶æ¦‚ç‡ã€‚

# æœ´ç´ è´å¶æ–¯çš„é™·é˜±

*   å°æ¦‚ç‡ç›¸ä¹˜å¯¼è‡´æµ®ç‚¹ä¸‹æº¢ã€‚è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡è®¡ç®—å¯¹æ•°æ¦‚ç‡ ln(p)æ¥è§£å†³
*   å¦‚æœæ²¡æœ‰æ ·æœ¬/æ•°æ®ï¼Œåˆ™ p(xj | Ck) = 0ï¼Œå¯¼è‡´æ¦‚ç‡çš„ä¹˜ç§¯ä¸º 0ã€‚æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘å™¨ç”¨äºç¡®ä¿æ‰€æœ‰ p(xj | Ck) > 0
*   å…±çº¿ç‰¹å¾ä¸æ˜¾ç¤ºç‹¬ç«‹æ€§ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œåº”å°†æ­¤ç±»è¦ç´ ä»æ•°æ®é›†ä¸­ç§»é™¤ï¼Œä»¥é˜²æ­¢æ¨¡å‹å‡ºç°é—®é¢˜
*   æ­£åˆ™åŒ–é€šå¸¸æ˜¯æœ´ç´ è´å¶æ–¯æ¨¡å‹çš„ä¸€ä¸ªå°é—®é¢˜ï¼Œå› ä¸ºæ— ä¿¡æ¯ç‰¹å¾è¶‹å‘äºå‡åŒ€åˆ†å¸ƒï¼Œè¿™ä¸ä¼šå½±å“ç»“æœ

# æœ´ç´ è´å¶æ–¯æ¨¡å‹çš„ç±»å‹

ç°åœ¨æˆ‘ä»¬å·²ç»ç ”ç©¶äº†æœ´ç´ è´å¶æ–¯æ¨¡å‹çš„åŸºç¡€ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä¸€äº›å…·ä½“çš„å…¬å¼ã€‚é‡è¦çš„æ˜¯è¦è®°ä½ï¼Œæ¯ä¸€ç±»é—®é¢˜éƒ½éœ€è¦ä¸€ä¸ªç‰¹å®šçš„æœ´ç´ è´å¶æ–¯æ¨¡å‹ã€‚

**å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨**æ˜¯æ¨¡å‹çš„ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å½¢å¼ã€‚å¤šé¡¹å¼åˆ†ç±»å™¨ä»å¤šç§å¯èƒ½æ€§ä¸­æ‰¾åˆ°æœ€å¯èƒ½çš„ç±»ã€‚ä¸ºäº†é˜²æ­¢æ•°å€¼ä¸‹æº¢ï¼Œæˆ‘ä»¬ç¼–å†™è¿™ä¸ªåˆ†ç±»å™¨ï¼Œå–ç­‰å¼ä¸¤è¾¹çš„å¯¹æ•°å¦‚ä¸‹:

![](img/9faad2608cdae4fa62dcbf656460af21.png)

ä½œè€…å›¾ç‰‡

é‚£ä¹ˆæœ€æœ‰å¯èƒ½çš„ğ‘¦Ì‚ç­æ˜¯:

![](img/541059895a7bc43821412c210beac9f2.png)

ä½œè€…å›¾ç‰‡

å¯¹äºä¼¯åŠªåˆ©æˆ–äºŒå…ƒæƒ…å†µï¼Œå¤šé¡¹å¼åˆ†ç±»å™¨å¯ä»¥ç®€åŒ–ä¸º:

![](img/0a9a6c58ff9c9ef660b3678e8f8297e8.png)

ä½œè€…å›¾ç‰‡

# æ–‡æ¡£åˆ†ç±»ç¤ºä¾‹

*   æœ´ç´ è´å¶æ–¯ä¸»é¢˜æ¨¡å‹ä½¿ç”¨ä»¥ä¸‹å…³ç³»ï¼ŒåŸºäºå•è¯{w1ï¼Œw2ï¼Œâ€¦ï¼Œwn}çš„å‡ºç°ï¼Œè®¡ç®—æ–‡æ¡£ D å…·æœ‰ä¸»é¢˜ C çš„æ¦‚ç‡:

![](img/493072e8f69e409439496078db2ac9b7.png)

ä¿¡ç”¨:[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Naive_Bayes_classifier)

åœ¨è¿™ä¸ªæ–‡æ¡£åˆ†ç±»çš„ä¾‹å­ä¸­ï¼Œä½ æœ‰å„ç§å„æ ·çš„æ–‡æ¡£ï¼Œä¸€ä¸ªæ‰€è°“çš„æ–‡æ¡£è¯­æ–™åº“ã€‚è¿™æ„å‘³ç€æ‚¨æœ‰ä¸€ä¸ªæ–‡æ¡£é›†åˆï¼Œå¹¶ä¸”è¿™äº›æ–‡æ¡£ä»¥æŸç§æ–¹å¼è¢«æ ‡è®°ã€‚é¦–å…ˆï¼Œç»™ä¸€ä¸ªæ–‡æ¡£ä¸€ä¸ªâ€œä¸“å®¶â€æ ‡ç­¾(åƒåœ¾é‚®ä»¶æˆ–éåƒåœ¾é‚®ä»¶)ã€‚åœ¨åº”ç”¨æ ‡ç­¾ä¹‹åï¼Œä½ è¦åšçš„æ˜¯ä¸ºæ¯ä¸ªå•è¯åˆ›å»ºä¸€ä¸ªåˆ—ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªå•è¯éƒ½å˜æˆäº†ä¸€ä¸ªå¸ƒå°”åˆ—ï¼Œå°±åƒä¸€é”®ç¼–ç ä¸€æ ·ã€‚

å¯¹æ–‡æ¡£ä¸­çš„æ¯ä¸ªå•è¯é‡å¤è¿™ä¸ªè¿‡ç¨‹ã€‚æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥å‡å°‘åˆ—æ•°ï¼Œä½†æˆ‘çš„è§‚ç‚¹æ˜¯æœ´ç´ è´å¶æ–¯å¯¹äºæ–‡æ¡£åˆ†ç±»éå¸¸æœ‰ç”¨ã€‚ç°åœ¨ï¼Œæœ‰ä»€ä¹ˆè¿™æ ·çš„ä¾‹å­å—ï¼Ÿä¾‹å¦‚ï¼Œè¿™ä»½æ–‡ä»¶æ˜¯å¦æŠ„è¢­ï¼Ÿè¿™ä»½æ–‡ä»¶åˆ°åº•æ˜¯ä¸æ˜¯å‡æ–°é—»ï¼Ÿè¿™åˆ°åº•æ˜¯ä¸æ˜¯åƒåœ¾é‚®ä»¶ï¼Ÿæœ´ç´ è´å¶æ–¯ä¹‹æ‰€ä»¥æ˜¯ä¸€ç§å—æ¬¢è¿çš„æ–¹æ³•ï¼Œæ˜¯å› ä¸ºè¯¥æ¨¡å‹ä¸ä»‹æ„å·¨å¤§çš„ç»´æ•°ã€‚å¯èƒ½ä¼šæœ‰ä¸€äº›æ€§èƒ½ä¸‹é™æˆ–ä¿çœŸåº¦ä¸‹é™ï¼Œå¯¼è‡´åˆ†ç±»å™¨åœ¨å¤§é‡æ•°æ®ç»´çš„æƒ…å†µä¸‹ä¸å…·æœ‰è‰¯å¥½çš„å‡†ç¡®æ€§ã€‚ä½†æ˜¯ï¼Œæœ‰åŠæ³•å»é™¤å¤šä½™çš„è¾“å…¥ã€‚ä»è®¡ç®—ä¸Šæ¥è¯´ï¼Œè¿™éå¸¸å¿«ï¼Œå› æ­¤å®ƒæ˜¯æ–‡æ¡£åˆ†ç±»çš„é¦–é€‰ã€‚

# Python ä»£ç ç¤ºä¾‹

æ—¢ç„¶ç†è®ºå·²ç»å¥ å®šï¼Œè®©æˆ‘å¸¦ä½ çœ‹ä¸€ä¸ªå®é™…çš„ä¾‹å­ã€‚ä¸‹é¢æ˜¯æœ´ç´ è´å¶æ–¯æ¨¡å‹çš„ä¸€ä¸ªç®€å•ä¾‹å­ã€‚æƒ³æƒ³ 1984 å¹´ç¾å›½ä¼—è®®é™¢ 435 åè®®å‘˜çš„æ”¿å…šå’Œ 16 é¡¹é‡è¦æ³•æ¡ˆçš„æŠ•ç¥¨ã€‚

æˆ‘å°†ä½¿ç”¨è¿™ä¸ªæ•°æ®é›†å»ºç«‹å¹¶æµ‹è¯•ä¸€ä¸ªåˆ†ç±»å™¨æ¥é¢„æµ‹å›½ä¼šè®®å‘˜çš„æ”¿å…šã€‚è®©æˆ‘ä»¬ä»è¿›å£å¼€å§‹:

```
import pandas
import numpy
import seaborn
from matplotlib import pyplot%matplotlib inlinevotes = pandas.read_csv('[https://library.startlearninglabs.uw.edu/DATASCI410/Datasets/house-votes-84.](https://archive.ics.uci.edu/ml/datasets/congressional+voting+records)csv', header=None, 
names=['class', 'V1', 'V2', 'V3', 'V4', 'V5', 'V6', 'V7', 'V8', 'V9','V10', 'V11', 'V12', 'V13', 'V14', 'V15', 'V16'])
print(votes.shape)
votes.head()
```

![](img/35ee59fdfc6344724d47d4c25821bdbc.png)

å½¢çŠ¶å’Œæ•°æ®é›†çš„å‰ 5 è¡Œ|ä½œè€…çš„å›¾åƒ

# åˆ†é…ä¸»é¢˜

ä¸Šè¿°æ•°æ®æ¡†ä¸­çš„æ¯ä¸ªæŠ•ç¥¨åˆ—éƒ½å¯¹åº”äºä»¥ä¸‹ä¸»é¢˜ï¼Œå› æ­¤è®©æˆ‘ä»¬ç”¨æ›´å®¹æ˜“è®°ä½çš„åç§°æ¥æ›¿æ¢åˆ—å:

```
vote_names = [
    'handicapped_infants',
    'water_project_cost_sharing',
    'adoption_of_the_budget_resolution',
    'physician_fee_freeze',
    'el_salvador_aid',
    'religious_groups_in_schools',
    'anti_satellite_test_ban',
    'aid_to_nicaraguan_contras',
    'mx_missile',
    'immigration',
    'synfuels_corporation_cutback',
    'education_spending',
    'superfund_right_to_sue',
    'crime',
    'duty_free_exports',
    'export_administration_act_south_africa']votes.columns = ['class'] + vote_names
votes.head()
```

![](img/8b91ecc163a949bf9b0d4ffd5b592dd3.png)

é‡æ–°æ ‡è®°çš„åˆ—|ä½œè€…å›¾ç‰‡

# è§†è§‰æ¢ç´¢â€”æ¡å½¢å›¾

ä¸ºäº†è¿›ä¸€æ­¥äº†è§£è¿™ä¸ªæ•°æ®ï¼Œæˆ‘ä»¬æ¥åšä¸€äº›å‰ 5 ç¥¨çš„å‰§æƒ…ã€‚ä¸‹é¢å•å…ƒæ ¼ä¸­çš„ä»£ç ä¸º`Class`æ”¿å…šçš„è¿™äº›æŠ•ç¥¨åˆ›å»ºäº†æ¡å½¢å›¾ã€‚æ‰§è¡Œè¿™æ®µä»£ç å¹¶æ£€æŸ¥ç»“æœ:

```
# Convert dataframe columns to "category" type to take advantage
# categorical utilities like facet-based plotting in seabornvotes['class'] = pandas.Categorical(votes['class'].astype('object')
    , categories=['republican', 'democrat'])values = ['y', 'n', '?']
vote_dtype = pandas.api.types.CategoricalDtype(categories=values)
for c in votes.columns[1:]:
    votes[c] = votes[c].astype('object').astype(
        vote_dtype)
democrats = votes[votes['class'] == 'democrat']
republicans = votes[votes['class'] == 'republican']
for vote_col in votes.columns[1:6]:
    pyplot.subplot(1, 2, 1)
    pyplot.hist([1 if x == 'y' else 0 for x in democrats[vote_col]])
    pyplot.title('Democrats: \n' + vote_col)
    pyplot.ylabel('count')
    pyplot.subplot(1, 2, 2)
    pyplot.hist([1 if x == 'y' else 0 for x in republicans[vote_col]])
    pyplot.title('Republicans: \n' + vote_col)
    pyplot.show()
```

![](img/5f943cc1873d0b9f06eba816ea199516.png)

ä½œè€…å›¾ç‰‡

![](img/c70c2479f107a786bc393daf82d49c04.png)

ä½œè€…å›¾ç‰‡

![](img/1b6de93ebc9671d7f5ba485622b676ec.png)

ä½œè€…å›¾ç‰‡

å½“æ£€æŸ¥è¿™äº›å›¾è¡¨æ—¶ï¼Œè¯·è®°ä½ï¼Œåœ¨è¿™ä¸ªæ•°æ®é›†ä¸­ï¼Œæ°‘ä¸»å…šäººæ¯”å…±å’Œå…šäººå¤šâ€”â€”å› æ­¤å®ƒä¸æ˜¯å®Œå…¨å¹³è¡¡çš„ã€‚é‡è¦çš„æ˜¯æ¯ä¸ªæ”¿å…šçš„æˆå‘˜æŠ•èµæˆç¥¨æˆ–åå¯¹ç¥¨çš„æ¦‚ç‡ã€‚æœ‰äº›æŠ•ç¥¨å› å…šæ´¾å…³ç³»è€Œé¢‡ä¸ºåé¢‡ï¼Œæ¯”å¦‚â€œé€šè¿‡é¢„ç®—å†³è®®â€ã€‚ç„¶è€Œï¼Œæœ‰äº›æŠ•ç¥¨åœ¨æ”¿å…šä¸­æœ‰ç›¸ä¼¼çš„æ¦‚ç‡ï¼Œä¾‹å¦‚â€œæ°´é¡¹ç›®æˆæœ¬åˆ†æ‘Šâ€ã€‚è¿™äº›æ”¿å…šçš„æŠ•ç¥¨æ¦‚ç‡ç”¨äºè®­ç»ƒæœ´ç´ è´å¶æ–¯æ¨¡å‹ã€‚

# è®­ç»ƒå’Œæµ‹è¯•æ¨¡å‹

ç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº†ä¸€äº›æ•°æ®çš„ç‰¹å¾ï¼Œæ˜¯æ—¶å€™è®­ç»ƒå’Œæµ‹è¯•ä¸€ä¸ªæœ´ç´ è´å¶æ–¯æ¨¡å‹äº†ã€‚python `sklearn.naive_bayes`åŒ…æä¾›äº†ä¸€ä¸ªåº“ï¼Œç”¨äºè®­ç»ƒæœ´ç´ è´å¶æ–¯æ¨¡å‹ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªå¯ä»¥å¯¹æ–°å®ä¾‹è¿›è¡Œé¢„æµ‹çš„æ¨¡å‹å¯¹è±¡:

```
import sklearn.model_selection as m_s
Votes_Train, Votes_Test = m_s.train_test_split(votes)
votes = Votes_Testlabel_col = 'class'# Convert our categorical values to numeric feature vectors
feature_vecs = numpy.array([
        votes[c].cat.codes 
        for c in votes.columns 
        if c != label_col]).T
print(feature_vecs.shape)feature_Train = numpy.array([
        Votes_Train[c].cat.codes 
        for c in Votes_Train.columns 
        if c != label_col]).T
print(feature_Train.shape)
```

![](img/0c87866d200118ae0d20b705e7abb125.png)

```
feature_vecs[:5]
```

![](img/cce189aadbf282812f54620de6ed04e5.png)

ä½œè€…å›¾ç‰‡

```
# Convert our label (democrat vs republican) to numeric values
labels = votes[label_col].cat.codes
labels_Train = Votes_Train[label_col].cat.codes
# Look at the mapping for the first 5 values
list(zip(votes[label_col][:5], labels[:5]))
```

![](img/0874d233eb2ad613e619913f183f1588.png)

ä½œè€…å›¾ç‰‡

```
import sklearn.naive_bayes# Define model
model = sklearn.naive_bayes.MultinomialNB(alpha=1e-7)
# Train model with votes dataset
model.fit(feature_Train, labels_Train)
```

![](img/8b0b442caa9217455f5ddcea826e2405.png)

ä½œè€…å›¾ç‰‡

# è¯„ä¼°æ¨¡å‹æ€§èƒ½

è®¡ç®—å‡ºæ¨¡å‹åï¼Œç°åœ¨è®©æˆ‘ä»¬æ¥è¯„ä¼°æ€§èƒ½ã€‚é€šè¿‡æ‰“å°ç»“æœçš„å‰ 10 è¡Œï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿäº†è§£æ¨¡å‹çš„æœ‰æ•ˆæ€§:

```
predicted_party = model.predict(feature_vecs[:10])
party_probabilities = model.predict_proba(feature_vecs[:10])results = pandas.DataFrame({
        'party': votes['class'][:10],
        'predicted': pandas.Categorical.from_codes(
            predicted_party, votes['class'][:10].cat.categories),
        'proba(Republican)': party_probabilities[:, 0],
        'proba(Democrat)': party_probabilities[:, 1],
    })
results
```

![](img/59966fcb625eddee130f6ee6e5caa49a.png)

ä½œè€…å›¾ç‰‡

å½“æ‚¨æ£€æŸ¥è¿™äº›ç»“æœæ—¶ï¼Œè¯·æ³¨æ„:

1.  æœ‰ 1 ä¾‹æ˜ç¡®çš„åˆ†ç±»é”™è¯¯ï¼Œ1 ä¾‹åˆ†ç±»æœªå®šï¼Œ8 ä¾‹åˆ†ç±»æ­£ç¡®ã€‚
2.  åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œé¢„æµ‹ç±»çš„æ¦‚ç‡(å¾—åˆ†)æ¯”å…¶ä»–ç±»çš„æ¦‚ç‡å¤§å¾—å¤šï¼ŒåŒ…æ‹¬åˆ†ç±»é”™è¯¯çš„æƒ…å†µã€‚
3.  ä¸€ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸¤ç±»æ¦‚ç‡å‡ ä¹ç›¸åŒã€‚

ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬è®¡ç®—è¯¥æ¨¡å‹çš„æ··æ·†çŸ©é˜µå’Œæ€§èƒ½æŒ‡æ ‡:

```
import sklearn.metricsdef confusion_matrix(labels, predicted_labels, label_classes):
    return pandas.DataFrame(
        sklearn.metrics.confusion_matrix(labels, predicted_labels),
        index=[label_classes], 
        columns=label_classes)def performance(results):
    accuracy = sklearn.metrics.accuracy_score(
        results['party'].cat.codes, results['predicted'].cat.codes)
    precision = sklearn.metrics.precision_score(
            results['party'].cat.codes, results['predicted'].cat.codes)
    recall = sklearn.metrics.recall_score(
            results['party'].cat.codes, results['predicted'].cat.codes)print('Accuracy = %.3f, Precision = %.3f, Recall = %.3f' % (accuracy, precision, recall))

    return confusion_matrix(
        results['party'], 
        results['predicted'], 
        results.party.cat.categories)performance(results)
```

![](img/6acb987fd8f8bf9ba44644dd50ce61e7.png)

ä½œè€…å›¾ç‰‡

ä» 435 åå›½ä¼šè®®å‘˜ä¸­çš„å‰ 10 åæ¥çœ‹ï¼Œç»“æœç›¸å½“ä¸é”™ã€‚

æ‰§è¡Œä¸‹é¢å•å…ƒæ ¼ä¸­çš„ä»£ç ï¼Œä½¿ç”¨æ‰€æœ‰æ•°æ®è®¡ç®—å¹¶æ‰“å°æ¨¡å‹è¯„ä¼°ï¼Œå¹¶å°†ç»“æœä¸ç¬¬ä¸€ä¸ªæ¨¡å‹è¿›è¡Œæ¯”è¾ƒ:

```
predicted_party = model.predict(feature_vecs)
party_probabilities = model.predict_proba(feature_vecs)results_all = pandas.DataFrame({
        'party': votes['class'],
        'predicted': pandas.Categorical.from_codes(
            predicted_party, votes['class'].cat.categories),
        'proba(democrat)': party_probabilities[:, 0],
        'proba(republican)': party_probabilities[:, 1],
    })
performance(results_all)
```

![](img/60baee0d37c7fc3bf5e80523eba4f451.png)

ä½œè€…å›¾ç‰‡

# æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘

æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘æ³•æ˜¯å¤„ç†æ²¡æœ‰è¶³å¤Ÿæ ·æœ¬æ¥è®¡ç®—æ¦‚ç‡çš„æ•°æ®é›†çš„æœ‰æ•ˆæ–¹æ³•ã€‚è¿™ç§æ–¹æ³•é¿å…äº†ğ‘(ğ‘¥ğ‘—|ğ¶ğ‘˜)=0p(xj|Ck)=0.

ä¸‹é¢å•å…ƒæ ¼ä¸­çš„ä»£ç ä½¿ç”¨ç›¸åŒçš„å›½ä¼šæŠ•ç¥¨æ•°æ®è®¡ç®—ä¸€ä¸ªæœ´ç´ è´å¶æ–¯æ¨¡å‹ï¼Œä½†æ˜¯ä½¿ç”¨äº†ä¸€ä¸ªè·¨åº¦ä¸º 3 ä¸ªæ•°æ®ç‚¹çš„æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘å™¨ã€‚æ‰§è¡Œè¿™æ®µä»£ç å¹¶æ£€æŸ¥ç»“æœ:

```
predicted_party = model.predict(feature_vecs)
party_probabilities = model.predict_proba(feature_vecs)results_all = pandas.DataFrame({
        'party': votes['class'],
        'predicted': pandas.Categorical.from_codes(
            predicted_party, votes['class'].cat.categories),
        'proba(democrat)': party_probabilities[:, 0],
        'proba(republican)': party_probabilities[:, 1],
    })
performance(results_all)
```

![](img/80581088fd1228328afb04db48b29b93.png)

ä½œè€…å›¾ç‰‡

ç»“æœç±»ä¼¼äºæ²¡æœ‰æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘è®¡ç®—çš„æ¨¡å‹ã€‚è¿™ä¸€ç»“æœæ˜¯æ„æ–™ä¹‹ä¸­çš„ï¼Œå› ä¸ºæ•°æ®é›†ä¸­çš„æ‰€æœ‰æ¡ˆä¾‹éƒ½æœ‰è¶³å¤Ÿçš„æ•°æ®ã€‚

# å¦ä¸€ä¸ªä¾‹å­â€”â€”äººå£æ™®æŸ¥æ”¶å…¥

ç°åœ¨æˆ‘ä»¬å¯ä»¥å°è¯•å¦ä¸€ä¸ªäºŒå…ƒåˆ†ç±»çš„ä¾‹å­ã€‚ä¸‹é¢å•å…ƒæ ¼ä¸­çš„ä»£ç åŠ è½½äº†ä¸€äº›ç¾å›½äººå£æ™®æŸ¥æ•°æ®æ ·æœ¬ã€‚æˆ‘ä»¬å¸Œæœ›æ„å»ºå¹¶è¯„ä¼°ä¸€ä¸ªæœ´ç´ è´å¶æ–¯æ¨¡å‹ï¼Œä»¥ 50ï¼Œ000 ç¾å…ƒä¸ºåˆ†ç•Œç‚¹ï¼Œæ ¹æ®é«˜æ”¶å…¥å’Œä½æ”¶å…¥å¯¹äººä»¬è¿›è¡Œåˆ†ç±»ã€‚æ‰§è¡Œæ­¤ä»£ç å¹¶æ£€æŸ¥æ•°æ®é›†ä¸­çš„ç‰¹å¾ã€‚

```
# income is a pd read_csv function from a source URL that no longer works
income.head()
```

![](img/a8981fe84f8107482bda577a058d4547.png)

ä½œè€…å›¾ç‰‡

```
income.shape
```

![](img/acf7c722066d8a8ba718049e2cf8a74a.png)

ä½œè€…å›¾ç‰‡

```
income.info()
```

![](img/29081dddfd1138b4e23c91b16e8246f5.png)

ä½œè€…å›¾ç‰‡

```
income.describe()
```

![](img/524a00ade4b06587dfa694a42add98c8.png)

ä½œè€…å›¾ç‰‡

# å‡å°‘ç‰¹å¾

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€äº›å¯èƒ½æ˜¯å…±çº¿çš„ç‰¹å¾ã€‚è¿˜æœ‰ä¸€ä¸ªç‰¹å¾ï¼Œ`fnlwgt`å¯¹è¿™äº›äººåˆ†ç±»æ²¡ä»€ä¹ˆç”¨ã€‚ä¸‹é¢å•å…ƒæ ¼ä¸­çš„ä»£ç åˆ é™¤äº†è¿™äº›åˆ—ã€‚æ‰§è¡Œæ­¤ä»£ç ä»¥åˆ›å»ºä¸€ä¸ªå…·æœ‰ç®€åŒ–åŠŸèƒ½çš„æ•°æ®é›†:

```
income = income.drop(['workclass', 'fnlwgt', 'education-num', 'relationship'], axis=1)
income.head(10)
```

![](img/b76b9b8e188307b2ad6bbcc32ad7a43b.png)

ä½œè€…å›¾ç‰‡

ç°åœ¨ï¼Œæˆ‘è®¡ç®—ä¸€ä¸ªæœ´ç´ è´å¶æ–¯æ¨¡å‹ï¼Œä½¿ç”¨æ”¶å…¥æ•°æ®é›†ä¸­çš„ç‰¹å¾å¯¹`income`è¿›è¡Œåˆ†ç±»:

```
for c in income.columns:
    if income[c].dtype == 'object':
        income[c] = income[c].astype('category')income_label_col = 'income'income_labels = income[income_label_col].cat.codesfeatures = []
for c in income.columns:
    if c != income_label_col:
        if str(income[c].dtype) == 'category':
            features.append(income[c].cat.codes)
        else:
            features.append(income[c])
income_feature_vecs = numpy.array(features).T# Create model
model = sklearn.naive_bayes.MultinomialNB(alpha=3)
model.fit(income_feature_vecs, income_labels)
```

![](img/b011236fa670dfbec5d4212727755df9.png)

ä½œè€…å›¾ç‰‡

```
features[8]
```

![](img/ab31e4d40b42b1a912d97e7ed5038a30.png)

ä½œè€…å›¾ç‰‡

```
conditional_probas = pandas.DataFrame(model.feature_log_prob_, columns=income.columns[:-1])
conditional_probas
```

![](img/5de5e16fc48ffea9f025f68c4d82040b.png)

ä½œè€…å›¾ç‰‡

```
(-conditional_probas).plot(kind='bar')
pyplot.show()
```

![](img/a9ea8e86d3f00fff9609dd8d1f9a99aa.png)

ä½œè€…å›¾ç‰‡

# æ”¹å˜ç‰¹å¾çš„æ•°é‡

ç°åœ¨è®©æˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹å‘æœ´ç´ è´å¶æ–¯æ¨¡å‹æ·»åŠ æ›´å¤šæ•°æ®æ ·æœ¬çš„æ•ˆæœã€‚ä¸‹é¢å•å…ƒæ ¼ä¸­çš„ä»£ç ä½¿ç”¨ 2ã€3ã€4ã€5 å’Œ 6 ç¥¨æ¥è®¡ç®—å’Œè¯„ä¼°æœ´ç´ è´å¶æ–¯æ¨¡å‹ã€‚æ‰§è¡Œæ­¤ä»£ç ï¼Œå¹¶å°†ç»“æœä¸ä½¿ç”¨å®Œæ•´æ•°æ®é›†è·å¾—çš„ç»“æœè¿›è¡Œæ¯”è¾ƒ:

```
label_col = 'class'# We need to convert our categorical values to numeric feature vectors
feature_vecs = numpy.array([
        votes[c].cat.codes 
        for c in votes.columns 
        if c != label_col]).T
print(feature_vecs.shape)# we also need to convert our label (democrat vs republican) to numeric values
labels = votes[label_col].cat.codes
# take a look at the mapping for the first 5 values like so
list(zip(votes[label_col][:5], labels[:5]))
```

![](img/30a4a552d07d94c17d64c92559c83a25.png)

ä½œè€…å›¾ç‰‡

```
for num_features in [2, 3, 4, 5, 6]:
    model = sklearn.naive_bayes.MultinomialNB()
    model.fit(feature_vecs[:, :num_features], labels)predicted_votes = model.predict(feature_vecs[:, :num_features])print('Number of features = %d' % num_features)
    accuracy = sklearn.metrics.accuracy_score(labels, predicted_votes)
    precision = sklearn.metrics.precision_score(labels, predicted_votes)
    recall = sklearn.metrics.recall_score(labels, predicted_votes)
    print('Accuracy = %.3f, Precision = %.3f, Recall = %.3f' % (accuracy, precision, recall))
    print('Confusion matrix:')
    print(confusion_matrix(labels, predicted_votes, votes['class'].cat.categories))
    print('')
```

![](img/99dd6419a39504ef64b8356000fc5fdd.png)

ä½œè€…å›¾ç‰‡

ä»è¿™äº›ç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œè¯¥æ¨¡å‹ä»…ç”¨å‡ ä¸ªç‰¹å¾å°±èƒ½å¿«é€Ÿè·å¾—å‡†ç¡®æ€§ã€‚äº‹å®ä¸Šï¼Œ16 ä¸ªç‰¹å¾ä¸­çš„ 5 æˆ– 6 ä¸ªæä¾›äº†ç›¸åŒçš„ç»“æœã€‚

è®¡ç®—ä¸€ä¸ªæœ´ç´ è´å¶æ–¯æ¨¡å‹ï¼Œè®¡ç®—å¹¶æ‰“å° 100ã€500ã€1000ã€2000ã€8000 å’Œ 32561 è¡Œ`income`æ•°æ®é›†çš„æ€§èƒ½ç»Ÿè®¡æ•°æ®:

```
NumberOfRowsTests = [100, 500, 1000, 2000, 8000, 32561]
for num_rows in (NumberOfRowsTests):
    model = sklearn.naive_bayes.MultinomialNB()
    model.fit(income_feature_vecs[:num_rows, :], income_labels[:num_rows])predicted_income = model.predict(income_feature_vecs[:num_rows, :])
    income_probabilities = model.predict_proba(income_feature_vecs[:num_rows, :])

    accuracy = sklearn.metrics.accuracy_score(income_labels[:num_rows], predicted_income)
    precision = sklearn.metrics.precision_score(income_labels[:num_rows], predicted_income)
    recall = sklearn.metrics.recall_score(income_labels[:num_rows], predicted_income)
    print('%6.0f rows:  Accuracy = %.3f, Precision = %.3f, Recall = %.3f' % (num_rows, accuracy, precision, recall))
    print('Confusion matrix:')
    print(confusion_matrix(
            income_labels[:num_rows], predicted_income, income.income.cat.categories), '\n')
```

![](img/c9586dbfba6a1ee14d7515163dd5c6fb.png)

ä½œè€…å›¾ç‰‡

# æ‘˜è¦

åœ¨æœ¬ç¬”è®°æœ¬ä¸­ï¼Œæˆ‘å®Œæˆäº†ä»¥ä¸‹å·¥ä½œ:

1.  æœ´ç´ è´å¶æ–¯æ¨¡å‹ç†è®º
2.  æœ´ç´ è´å¶æ–¯çš„é™·é˜±
3.  è‰¯å¥½çš„æ­£åˆ™åŒ–æ€§è´¨
4.  è®¡ç®—æ•ˆç‡
5.  è®¡ç®—å’Œè¯„ä¼°æœ´ç´ è´å¶æ–¯æ¨¡å‹çš„ç¤ºä¾‹
6.  æ£€æŸ¥æ•°æ®é›†å¤§å°å¯¹æœ´ç´ è´å¶æ–¯æ¨¡å‹ç»“æœçš„å½±å“
7.  ç›‘ç£å­¦ä¹ çš„è§£é‡Š

è¯·è®°ä½ï¼Œè™½ç„¶æœ´ç´ è´å¶æ–¯æ˜¯ä¸€ä¸ªæœ‰ç”¨ä¸”å¼ºå¤§çš„åˆ†ç±»å™¨â€”â€”ä½†è¿™ä¸ªæ¨¡å‹åº”è¯¥æ€»æ˜¯ä¸ä¸€ä¸ª[é€»è¾‘å›å½’](/logistic-regression-cebee0728cbf)æ¨¡å‹ç›¸æ¯”è¾ƒã€‚è¿™ç§å¯å‘å…è®¸è¿›è¡Œæœ‰ç”¨çš„å¥å…¨æ€§æ£€æŸ¥ï¼Œå¹¶ä¸”ä¸ºè¯„ä¼°æ‚¨çš„æ¨¡å‹æä¾›äº†é‡è¦çš„åŸºç¡€äº‹å®ã€‚

æˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼æ— è®ºä½ æ˜¯è¿™ä¸ªæ¦‚å¿µçš„æ–°æ‰‹ï¼Œè¿˜æ˜¯ä»…ä»…éœ€è¦å¤ä¹ ï¼Œæˆ‘å¸Œæœ›æˆ‘çš„è¯»è€…å¯¹æ•°æ®ç§‘å­¦å’Œæœºå™¨å­¦ä¹ ä¸­è¿™äº›å¤æ‚ä½†éå¸¸é‡è¦çš„ä¸»é¢˜æœ‰æ·±åˆ»è€Œå®Œæ•´çš„ç›´è§‰å’Œç†è§£ã€‚

å¦‚æœä½ æƒ³è®©æˆ‘ç»§ç»­å†™ç±»ä¼¼çš„ä¸»é¢˜ï¼Œè¯·è®¢é˜…ï¼

åœ¨ [Linkedin](https://www.linkedin.com/in/james-a-w-godwin/) ä¸Šæ‰¾åˆ°æˆ‘

*ç‰©ç†å­¦å®¶å…¼æ•°æ®ç§‘å­¦å®¶â€”â€”å¯ç”¨äºæ–°æœºé‡| SaaS |ä½“è‚²|åˆåˆ›ä¼ä¸š|æ‰©å¤§è§„æ¨¡*
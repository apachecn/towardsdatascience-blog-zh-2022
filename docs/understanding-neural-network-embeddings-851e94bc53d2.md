# ç†è§£ç¥ç»ç½‘ç»œåµŒå…¥

> åŸæ–‡ï¼š<https://towardsdatascience.com/understanding-neural-network-embeddings-851e94bc53d2>

## æ·±å…¥æ¢ç©¶ç¥ç»ç½‘ç»œåµŒå…¥

![](img/7ced7f1cb9f7b2b727038e8f40cd623f.png)

å°¼å…‹Â·å¸Œåˆ©å°”åœ¨ [Unsplash](https://unsplash.com) ä¸Šçš„ç…§ç‰‡

æˆ‘åœ¨ä¹‹å‰å…³äº[å‘é‡æ•°æ®åº“](https://frankzliu.com/blog/a-gentle-introduction-to-vector-databases)å’Œ [ML åº”ç”¨å¼€å‘](https://frankzliu.com/blog/making-machine-learning-more-accessible-for-application-developers)çš„åšå®¢æ–‡ç« ä¸­å·²ç»æåˆ°äº†åµŒå…¥/åµŒå…¥å‘é‡çš„ä¸»é¢˜ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ·±å…¥ç ”ç©¶åµŒå…¥å’ŒåµŒå…¥æ¨¡å‹å¦‚ä½•å·¥ä½œèƒŒåçš„ä¸€äº›ç†è®ºã€‚å› æ­¤ï¼Œæœ¬æ–‡å°†è‡´åŠ›äºæ›´æ·±å…¥åœ°ç ”ç©¶åµŒå…¥/åµŒå…¥å‘é‡ï¼Œä»¥åŠå®ƒä»¬åœ¨ç°ä»£ ML ç®—æ³•å’Œæµæ°´çº¿ä¸­çš„åº”ç”¨ã€‚

å¿«é€Ÿæ³¨æ„â€”â€”è¿™ç¯‡æ–‡ç« éœ€è¦æ·±åº¦å­¦ä¹ å’Œç¥ç»ç½‘ç»œçš„ä¸­çº§çŸ¥è¯†ã€‚å¦‚æœä½ è¿˜ä¸å¤ªäº†è§£ï¼Œæˆ‘å»ºè®®ä½ å…ˆçœ‹çœ‹è°·æ­Œçš„ ML é€Ÿæˆç­ã€‚è¯¾ç¨‹å†…å®¹å¯¹äºç†è§£ CV å’Œ NLP çš„ç¥ç»ç½‘ç»œåŸºç¡€å¾ˆæœ‰å¸®åŠ©ã€‚

# å¿«é€Ÿå›é¡¾ä¸€ä¸‹

é€šè¿‡åµŒå…¥å¯¹æ•°æ®è¿›è¡ŒçŸ¢é‡åŒ–ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§*é™ç»´çš„æ–¹æ³•*ã€‚ä¼ ç»Ÿçš„é™ç»´æ–¹æ³•â€” [PCA](/the-most-gentle-introduction-to-principal-component-analysis-9ffae371e93b) ã€ [LDA](https://www.mygreatlearning.com/blog/understanding-latent-dirichlet-allocation/) ç­‰ã€‚â€”ç»“åˆä½¿ç”¨çº¿æ€§ä»£æ•°ã€å†…æ ¸æŠ€å·§å’Œå…¶ä»–ç»Ÿè®¡æ–¹æ³•æ¥â€œå‹ç¼©â€æ•°æ®ã€‚å¦ä¸€æ–¹é¢ï¼Œç°ä»£æ·±åº¦å­¦ä¹ æ¨¡å‹é€šè¿‡å°†è¾“å…¥æ•°æ®æ˜ å°„åˆ°*æ½œåœ¨ç©ºé—´*ä¸­æ¥æ‰§è¡Œç»´åº¦ç¼©å‡ï¼Œæ½œåœ¨ç©ºé—´å³è¾“å…¥æ•°æ®çš„è¡¨ç¤ºï¼Œå…¶ä¸­é™„è¿‘çš„ç‚¹å¯¹åº”äºè¯­ä¹‰ä¸Šç›¸ä¼¼çš„æ•°æ®ç‚¹ã€‚ä¾‹å¦‚ï¼Œè¿‡å»ä»£è¡¨å•ä¸ªå•è¯æˆ–çŸ­è¯­çš„çƒ­ç‚¹å‘é‡ç°åœ¨å¯ä»¥è¡¨ç¤ºä¸ºç»´åº¦æ˜¾è‘—é™ä½çš„å¯†é›†å‘é‡ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ [Towhee åº“](https://github.com/towhee-io/towhee)çœ‹åˆ°è¿™ä¸€ç‚¹:

```
% pip install towhee  # pip3
% python              # python3>>> import towhee 
>>> text_embedding = towhee.dc(['Hello, world!']) \ 
...     .text_embedding.transformers(model_name='distilbert-base-cased') \ 
...     .to_list()[0]
...
>>> embedding # includes punctuation and start & end tokensarray([[ 0.30296388,  0.19200979,  0.10141158, ..., -0.07752968, 0.28487974, -0.06456392],
       [ 0.03644813,  0.03014304,  0.33564508, ...,  0.11048479, 0.51030815, -0.05664057],
       [ 0.29160976,  0.43050566,  0.46974635, ...,  0.22705288, -0.0923526, -0.04366254],
       [ 0.14108554, -0.00599108,  0.34098792, ...,  0.16725197, 0.10088076, -0.06183652],
       [ 0.35695776,  0.30499873,  0.400652  , ...,  0.20334958, 0.37474275, -0.19292705],
       [ 0.6206475 ,  0.50192136,  0.602711  , ..., -0.03119299, 1.1860386 , -0.6167787 ]], dtype=float32)
```

åŸºäºæ·±åº¦ç¥ç»ç½‘ç»œçš„åµŒå…¥ç®—æ³•å‡ ä¹è¢«æ™®éè®¤ä¸ºæ¯”ä¼ ç»Ÿçš„é™ç»´æ–¹æ³•æ›´å¼ºã€‚è¿™äº›åµŒå…¥åœ¨è¡Œä¸šä¸­çš„å„ç§åº”ç”¨ä¸­ä½¿ç”¨å¾—è¶Šæ¥è¶Šé¢‘ç¹ï¼Œä¾‹å¦‚å†…å®¹æ¨èã€é—®ç­”ã€èŠå¤©æœºå™¨äººç­‰ã€‚æ­£å¦‚æˆ‘ä»¬å°†åœ¨åé¢çœ‹åˆ°çš„ï¼Œåœ¨ç¥ç»ç½‘ç»œä¸­ä½¿ç”¨åµŒå…¥æ¥è¡¨ç¤ºå›¾åƒå’Œæ–‡æœ¬*è¿‘å¹´æ¥ä¹Ÿå˜å¾—è¶Šæ¥è¶Šæµè¡Œã€‚*

![](img/08e1eed26127233ceaa680b008c82d9f.png)

ç”± [DistilBERT](https://towhee.io/text-embedding/transformers) åˆ¶ä½œçš„å¯è§†åŒ–æ–‡æœ¬åµŒå…¥ã€‚è¯·æ³¨æ„ï¼Œå°½ç®¡â€œfootballâ€å’Œâ€œfootballâ€è¿™ä¸¤ä¸ªè¯éƒ½å¾ˆå¸¸è§ï¼Œä½†â€œfootballâ€å’Œâ€œsoccerâ€çš„å…³ç³»å´æ¯”â€œfootballâ€æ›´è¿‘ã€‚

# ç›‘ç£åµŒå…¥

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¥å‰çš„æ–‡ç« ä½¿ç”¨äº†æ¥è‡ªä½¿ç”¨*ç›‘ç£å­¦ä¹ *è®­ç»ƒçš„æ¨¡å‹çš„åµŒå…¥ï¼Œå³æ¥è‡ªæ ‡è®°/æ³¨é‡Šæ•°æ®é›†è®­ç»ƒçš„ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œ [ImageNet](https://image-net.org/) æ•°æ®é›†åŒ…å«ä¸€ç»„ç²¾é€‰çš„å›¾åƒåˆ°ç±»åˆ«çš„æ˜ å°„ï¼Œè€Œé—®ç­”æ•°æ®é›†å¦‚ [SQuAD](https://rajpurkar.github.io/SQuAD-explorer/) æä¾›ä¸åŒè¯­è¨€çš„ 1:1 å¥å­æ˜ å°„ã€‚

è®¸å¤šé€šè¿‡æ ‡è®°æ•°æ®è®­ç»ƒçš„è‘—åæ¨¡å‹ä½¿ç”¨äº¤å‰ç†µæŸå¤±æˆ–å‡æ–¹è¯¯å·®ã€‚ç”±äºç›‘ç£è®­ç»ƒçš„æœ€ç»ˆç›®æ ‡æ˜¯æˆ–å¤šæˆ–å°‘åœ°å¤åˆ¶è¾“å…¥æ•°æ®å’Œæ³¨é‡Šä¹‹é—´çš„ 1:1 æ˜ å°„(ä¾‹å¦‚ï¼Œåœ¨ç»™å®šè¾“å…¥å›¾åƒçš„æƒ…å†µä¸‹è¾“å‡ºç±»åˆ«ä»¤ç‰Œæ¦‚ç‡)ï¼Œå› æ­¤ä»ç›‘ç£æ¨¡å‹ç”Ÿæˆçš„åµŒå…¥å¾ˆå°‘ä½¿ç”¨è¾“å‡ºå±‚ã€‚ä¾‹å¦‚ï¼Œåœ¨ ImageNet-1k ä¸Šè®­ç»ƒçš„æ ‡å‡† ResNet50 æ¨¡å‹è¾“å‡º 1000 ç»´å‘é‡ï¼Œè¯¥å‘é‡å¯¹åº”äºè¾“å…¥å›¾åƒæ˜¯ç¬¬ *N* ä¸ªç±»æ ‡ç­¾çš„å®ä¾‹çš„æ¦‚ç‡ã€‚

![](img/6d821e1dad35e561984702e667f52955.png)

LeNet-5ï¼Œå·²çŸ¥æœ€æ—©çš„è®¡ç®—æœºè§†è§‰ç¥ç»ç½‘ç»œæ¶æ„ä¹‹ä¸€ã€‚å›¾ç‰‡ by [D2L.ai](https://d2l.ai/) ï¼Œ [CC BY-SA 4.0](https://creativecommons.org/licenses/by-sa/4.0/) ã€‚

ç›¸åï¼Œå¤§å¤šæ•°ç°ä»£åº”ç”¨ç¨‹åºä½¿ç”¨å€’æ•°ç¬¬äºŒå±‚æ¿€æ´»ä½œä¸ºåµŒå…¥ã€‚åœ¨ä¸Šå›¾(LeNet-5)ä¸­ï¼Œè¿™å¯¹åº”äºæ ‡è®°ä¸º`FC (10)` (10 ç»´è¾“å‡ºå±‚)å’Œ`FC (84)`çš„å±‚ä¹‹é—´çš„æ¿€æ´»ã€‚è¿™ä¸€å±‚ç¦»è¾“å‡ºè¶³å¤Ÿè¿‘ï¼Œå¯ä»¥å‡†ç¡®åœ°è¡¨ç¤ºè¾“å…¥æ•°æ®çš„è¯­ä¹‰ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªç›¸å½“ä½çš„ç»´åº¦ã€‚æˆ‘ä¹Ÿè§è¿‡è®¡ç®—æœºè§†è§‰åº”ç”¨ç¨‹åºä½¿ç”¨æ¨¡å‹ä¸­æ›´æ—©å±‚çš„æ± æ¿€æ´»ã€‚è¿™äº›æ¿€æ´»æ•è·è¾“å…¥å›¾åƒçš„ä½çº§ç‰¹å¾(è§’ã€è¾¹ã€åšå®¢ç­‰...)ï¼Œè¿™å¯ä»¥æé«˜å¾½æ ‡è¯†åˆ«ç­‰ä»»åŠ¡çš„æ€§èƒ½ã€‚

# ç¼–ç å™¨å’Œè‡ªæˆ‘ç›‘ç£

ä½¿ç”¨å¸¦æ³¨é‡Šçš„æ•°æ®é›†çš„ä¸€ä¸ªä¸»è¦ç¼ºç‚¹æ˜¯å®ƒä»¬éœ€è¦æ³¨é‡Š(è¿™å¬èµ·æ¥æœ‰ç‚¹æ„šè ¢ï¼Œä½†æ˜¯è¯·åŸè°…æˆ‘)ã€‚ä¸ºä¸€ç»„ç‰¹å®šçš„è¾“å…¥æ•°æ®åˆ›å»ºé«˜è´¨é‡çš„æ³¨é‡Šéœ€è¦ä¸€ä¸ªæˆ–è®¸å¤šäººèŠ±è´¹æ•°ç™¾ç”šè‡³æ•°åƒä¸ªå°æ—¶çš„æ—¶é—´ã€‚ä¾‹å¦‚ï¼Œå®Œæ•´çš„ ImageNet æ•°æ®é›†åŒ…å«å¤§çº¦ 22k ä¸ªç±»åˆ«ï¼Œéœ€è¦ 25000 äººæ¥ç®¡ç†ã€‚è®©äº‹æƒ…æ›´åŠ å¤æ‚çš„æ˜¯ï¼Œè®¸å¤šå¸¦æ ‡ç­¾çš„æ•°æ®é›†ç»å¸¸åŒ…å«æ„æƒ³ä¸åˆ°çš„ä¸å‡†ç¡®ã€æ˜æ˜¾çš„é”™è¯¯ï¼Œæˆ–è€…ç²¾é€‰ç»“æœä¸­çš„ [NSFW å†…å®¹](https://github.com/vinayprabhu/Dataset_audits/blob/master/Notebooks/ImageNet_2_NSFW_analysis.ipynb)ã€‚éšç€è¿™ç§å®ä¾‹æ•°é‡çš„å¢åŠ ï¼Œç”±ç›‘ç£å­¦ä¹ è®­ç»ƒçš„åµŒå…¥æ¨¡å‹ç”Ÿæˆçš„åµŒå…¥è´¨é‡æ˜¾è‘—ä¸‹é™ã€‚

![](img/ccb57576be58b1f1d94408fdb3e82128.png)

æ¥è‡ª [Unsplash æ•°æ®é›†](https://unsplash.com/data)çš„æ ‡è®°ä¸ºâ€œå¸Œæœ›â€çš„å›¾åƒã€‚å¯¹äºäººç±»æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸æ˜æ™ºçš„æè¿°ï¼Œä½†å®ƒå¯èƒ½ä¼šå¯¼è‡´æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å­¦ä¹ é”™è¯¯çš„ç‰¹å¾ç±»å‹ã€‚ç”± [Lukas L](https://unsplash.com/photos/jSjgQmaQtVQ) æ‹æ‘„ã€‚

å¦ä¸€æ–¹é¢ï¼Œä»¥æ— äººç›‘ç£çš„æ–¹å¼è®­ç»ƒçš„æ¨¡ç‰¹ä¸éœ€è¦æ ‡ç­¾ã€‚é‰´äºæ¯å¤©ç”Ÿæˆçš„æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘å’Œè§†é¢‘æ•°é‡æƒŠäººï¼Œä½¿ç”¨è¿™ç§æ–¹æ³•è®­ç»ƒçš„æ¨¡å‹åŸºæœ¬ä¸Šå¯ä»¥è®¿é—®æ— é™é‡çš„è®­ç»ƒæ•°æ®ã€‚è¿™é‡Œçš„è¯€çªæ˜¯å¼€å‘æ­£ç¡®ç±»å‹çš„æ¨¡å‹å’ŒåŸ¹è®­æ–¹æ³•æ¥åˆ©ç”¨è¿™äº›æ•°æ®ã€‚ä¸€ç§ä»¤äººéš¾ä»¥ç½®ä¿¡çš„å¼ºå¤§ä¸”æ—¥ç›Šæµè¡Œçš„æ–¹å¼æ˜¯é€šè¿‡*è‡ªåŠ¨ç¼–ç å™¨*(æˆ–ä¸€èˆ¬çš„*ç¼–ç å™¨/è§£ç å™¨*æ¶æ„)ã€‚

*è‡ªåŠ¨ç¼–ç å™¨*é€šå¸¸æœ‰ä¸¤ä¸ªä¸»è¦ç»„ä»¶ã€‚ç¬¬ä¸€ä¸ªç»„ä»¶æ˜¯ç¼–ç å™¨:å®ƒå°†ä¸€äº›æ•°æ®ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºå›ºå®šé•¿åº¦çš„å‘é‡ã€‚ç¬¬äºŒä¸ªç»„ä»¶æ˜¯è§£ç å™¨:å®ƒå°†å‘é‡æ˜ å°„å›åŸå§‹æ•°æ®ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ç¼–ç å™¨-è§£ç å™¨æ¶æ„:

![](img/66e44393bba8644ac7de23b3d8a02de9.png)

ç¼–ç å™¨-è§£ç å™¨æ¶æ„ç¤ºæ„å›¾ã€‚å›¾ç‰‡ç”± [D2L.ai](https://d2l.ai/) ï¼Œ [CC BY-SA 4.0](https://creativecommons.org/licenses/by-sa/4.0/) ã€‚

å¯¹åº”äº`Encoder`å’Œ`Decoder`çš„è“æ¡†éƒ½æ˜¯å‰é¦ˆç¥ç»ç½‘ç»œï¼Œè€Œ`State`æ˜¯æœŸæœ›çš„åµŒå…¥ã€‚è¿™ä¸¤ç§ç½‘ç»œéƒ½æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„â€”â€”è®¸å¤šå›¾åƒè‡ªåŠ¨ç¼–ç å™¨å°†æ ‡å‡†çš„ ResNet50 æˆ– ViT ç”¨äºç¼–ç å™¨ç½‘ç»œï¼Œå°†ç±»ä¼¼çš„å¤§å‹ç½‘ç»œç”¨äºè§£ç å™¨ç½‘ç»œã€‚

ç”±äºè‡ªåŠ¨ç¼–ç å™¨è¢«è®­ç»ƒä¸ºå°†è¾“å…¥æ˜ å°„åˆ°æ½œåœ¨çŠ¶æ€ï¼Œç„¶åå†æ˜ å°„å›åŸå§‹æ•°æ®ï¼Œå› æ­¤æ— ç›‘ç£æˆ–è‡ªç›‘ç£åµŒå…¥ç›´æ¥æ¥è‡ªç¼–ç å™¨çš„è¾“å‡ºå±‚ï¼Œè¿™ä¸åœ¨å®Œå…¨ç›‘ç£ä¸‹è®­ç»ƒçš„æ¨¡å‹çš„ä¸­é—´å±‚ç›¸åã€‚å› æ­¤ï¼Œè‡ªåŠ¨ç¼–ç å™¨åµŒå…¥ä»…ç”¨äº*é‡å»º*ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä»¬å¯ä»¥ç”¨æ¥è¡¨ç¤ºè¾“å…¥æ•°æ®ï¼Œä½†é€šå¸¸ä¸è¶³ä»¥è¡¨ç¤ºè¯­ä¹‰ï¼Œä¾‹å¦‚åŒºåˆ†çŒ«çš„ç…§ç‰‡å’Œç‹—çš„ç…§ç‰‡ã€‚

è¿‘å¹´æ¥ï¼Œé™¤äº†ä¼ ç»Ÿçš„è‡ªåŠ¨ç¼–ç å™¨ä¹‹å¤–ï¼Œè‡ªæˆ‘ç›‘ç£ä¹Ÿæœ‰äº†è®¸å¤šæ”¹è¿›ã€‚å¯¹äº NLPï¼Œå…·æœ‰*ä¸Šä¸‹æ–‡*çš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œå³å•è¯æˆ–å­—ç¬¦åœ¨åŒä¸€ä¸ªå¥å­æˆ–çŸ­è¯­ä¸­ç›¸å¯¹äºå…¶ä»–å•è¯æˆ–å­—ç¬¦å‡ºç°çš„ä½ç½®ï¼Œæ˜¯å¸¸è§çš„ï¼Œç°åœ¨è¢«è®¤ä¸ºæ˜¯è®­ç»ƒæœ€å…ˆè¿›çš„æ–‡æœ¬åµŒå…¥æ¨¡å‹çš„äº‹å®ä¸Šçš„æŠ€æœ¯ã€‚è‡ªæˆ‘ç›‘ç£çš„è®¡ç®—æœºè§†è§‰åµŒå…¥æ¨¡å‹ä¹Ÿæ­£åœ¨è“¬å‹ƒå‘å±•ï¼›ä¾èµ–äºæ•°æ®æ‰©å……çš„å¯¹æ¯”è®­ç»ƒæŠ€æœ¯åœ¨åº”ç”¨äºä¸€èˆ¬çš„è®¡ç®—æœºè§†è§‰ä»»åŠ¡æ—¶å·²ç»æ˜¾ç¤ºå‡ºå¾ˆå¥½çš„æ•ˆæœã€‚ [SimCLR](https://arxiv.org/abs/2002.05709) å’Œ [data2vec](https://arxiv.org/abs/2202.03555) æ˜¯ç¥ç»ç½‘ç»œçš„ä¸¤ä¸ªä¾‹å­ï¼Œå®ƒä»¬åˆ©ç”¨æ©è”½å’Œ/æˆ–å…¶ä»–å¢å¼ºè¿›è¡Œè‡ªæˆ‘ç›‘ç£è®­ç»ƒã€‚

# åµŒå…¥ä½œä¸ºå…¶ä»–æ¨¡å‹çš„è¾“å…¥

åµŒå…¥æ¨¡å‹æ˜¯éå¸¸ç‹¬ç‰¹çš„ï¼›å®ƒä»¬ä¸ä»…å¯¹ä¸€èˆ¬çš„åº”ç”¨ç¨‹åºå¼€å‘æœ‰ä»·å€¼ï¼Œè€Œä¸”å®ƒä»¬çš„è¾“å‡ºç»å¸¸ç”¨äºå…¶ä»–æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚è§†è§‰å˜å½¢é‡‘åˆšæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚å¾—ç›Šäºä¼ ç»Ÿå·ç§¯ç¥ç»ç½‘ç»œæ‰€ä¸å…·å¤‡çš„å¼ºå¤§æ€§èƒ½å’Œå·¨å¤§æ„Ÿå—åŸŸï¼Œå®ƒä»¬çš„å—æ¬¢è¿ç¨‹åº¦åœ¨è¿‡å»ä¸¤å¹´é‡Œå‡ºç°äº†çˆ†ç‚¸å¼å¢é•¿ã€‚è§†è§‰è½¬æ¢å™¨çš„æ ¸å¿ƒå‰ææ˜¯å°†å›¾åƒåˆ†æˆæ­£æ–¹å½¢å°å—ï¼Œä¸ºæ¯ä¸ªå°å—ç”ŸæˆåµŒå…¥ï¼Œå¹¶å°†åµŒå…¥ä½œä¸ºæ ‡å‡†è½¬æ¢å™¨çš„è¾“å…¥ã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œè¿™å¯¹äºå›¾åƒè¯†åˆ«éå¸¸æœ‰æ•ˆã€‚

å¦ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯ OpenAI çš„[å‰ªè¾‘](https://github.com/openai/CLIP)ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤§å‹ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œç»è¿‡è®­ç»ƒå¯ä»¥å°†å›¾åƒä¸è‡ªç„¶è¯­è¨€è¿›è¡ŒåŒ¹é…ã€‚CLIP çš„è®­ç»ƒå¯¹è±¡æ˜¯æ¥è‡ªäº’è”ç½‘çš„å¤§é‡æ•°æ®ï¼Œä¾‹å¦‚ Flickr ç…§ç‰‡å’Œç›¸åº”çš„ç…§ç‰‡æ ‡é¢˜ã€‚

![](img/997d4362be271998dbdb28ae6f08fe03.png)

ç¼–ç å™¨åŠå…¶ç›¸åº”çš„åµŒå…¥åœ¨ OpenAI çš„å‰ªè¾‘æ¨¡å‹ä¸­å‘æŒ¥äº†å·¨å¤§çš„ä½œç”¨ã€‚å›¾ç‰‡ç”± [OpenAI](https://github.com/openai) ï¼Œ [CC BY-SA 4.0](https://creativecommons.org/licenses/by-sa/4.0/) ã€‚

CLIP èƒŒåçš„æ–¹æ³•å®é™…ä¸Šç›¸å½“ç®€å•ã€‚é¦–å…ˆï¼ŒCLIP å°†å›¾åƒå’Œæ–‡æœ¬æ˜ å°„æˆä¸€ç§æ½œåœ¨çŠ¶æ€(å³ä¸€ç§åµŒå…¥)ï¼›è¿™äº›æ½œåœ¨çŠ¶æ€ç„¶åè¢«è®­ç»ƒä»¥æ˜ å°„åˆ°*ç›¸åŒçš„ç©ºé—´*ï¼Œå³å¦‚æœæ–‡æœ¬èƒ½å¤Ÿå‡†ç¡®åœ°æè¿°å›¾åƒï¼Œåˆ™æ–‡æœ¬åµŒå…¥å’Œå›¾åƒåµŒå…¥åº”è¯¥å½¼æ­¤éå¸¸æ¥è¿‘ã€‚å½“æ¶‰åŠåˆ° ML æ—¶ï¼Œå›°éš¾åœ¨äºç»†èŠ‚ï¼Œå¦‚æœæ²¡æœ‰ç›¸å½“å¤§çš„æ•°æ®é›†å’Œä¸€äº›è¶…å‚æ•°è°ƒæ•´ï¼ŒCLIP å®é™…ä¸Šå¾ˆéš¾å®ç°ã€‚

CLIP è¢«ç”¨ä½œ DALLE(å’Œ DALLE-2)ä¸­çš„æ ¸å¿ƒç»„ä»¶ï¼ŒDALLE-2 æ˜¯ OpenAI çš„æ–‡æœ¬åˆ°å›¾åƒç”Ÿæˆå¼•æ“ã€‚æœ€è¿‘æœ‰å¾ˆå¤šå…³äº DALLE-2 çš„ä¼ è¨€ï¼Œä½†å¦‚æœæ²¡æœ‰ CLIP çš„ä»£è¡¨æ€§ï¼Œè¿™äº›éƒ½æ˜¯ä¸å¯èƒ½çš„ã€‚è™½ç„¶ CLIP å’Œ DALLE çš„ç»“æœä»¤äººå°è±¡æ·±åˆ»ï¼Œä½†å›¾åƒåµŒå…¥ä»æœ‰å¾ˆå¤§çš„å‘å±•ç©ºé—´ã€‚æŸäº›é«˜çº§è¯­ä¹‰ï¼Œå¦‚å¯¹è±¡è®¡æ•°å’Œæ•°å­¦è¿ç®—ï¼Œä»ç„¶éš¾ä»¥åœ¨å›¾åƒåµŒå…¥ä¸­è¡¨ç¤ºã€‚

# ç”Ÿæˆæ‚¨è‡ªå·±çš„åµŒå…¥

æˆ‘å·²ç»æŒ‡å‡ºäº† [Towhee](https://github.com/towhee-io/towhee) å¼€æºé¡¹ç›®å‡ æ¬¡ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨å®ƒæ¥ç”ŸæˆåµŒå…¥ä»¥åŠå¼€å‘éœ€è¦åµŒå…¥çš„åº”ç”¨ç¨‹åºã€‚Towhee åŒ…è£…äº†æ¥è‡ªå„ç§æ¥æº(ï¼Œ`[torchvision](https://github.com/pytorch/vision)`ç­‰)çš„æ•°ç™¾ä¸ªå›¾åƒåµŒå…¥å’Œåˆ†ç±»æ¨¡å‹...)å¹¶æ¥å—å„ç§ä¸åŒæŠ€æœ¯çš„è®­ç»ƒã€‚Towhee ä¹Ÿæœ‰è®¸å¤š NLP æ¨¡å‹ï¼Œæ„Ÿè°¢ğŸ¤—s [å˜å‹å™¨](https://github.com/huggingface/transformers)åº“ã€‚

è®©æˆ‘ä»¬åé€€ä¸€æ­¥ï¼Œçœ‹çœ‹ Towhee æ˜¯å¦‚ä½•åœ¨å¹•åç”Ÿæˆè¿™äº›åµŒå…¥çš„ã€‚

```
>>> from towhee import pipeline
>>> p = pipeline('image-embedding')
>>> embedding = p('towhee.jpg')
```

ä½¿ç”¨[åˆ°](https://github.com/towhee-io/towhee)ï¼Œä»ç›‘ç£æ¨¡å‹ç”ŸæˆåµŒå…¥çš„é»˜è®¤æ–¹æ³•æ˜¯ç®€å•åœ°ç§»é™¤æœ€ç»ˆåˆ†ç±»æˆ–å›å½’å±‚ã€‚å¯¹äº PyTorch æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ç‰‡æ®µæ¥å®ç°:

```
>>> import torch.nn as nn
>>> import torchvision
>>> resnet50 = torchvision.models.resnet50(pretrained=True)
>>> resnet50_emb = nn.Sequential(*(list(resnet50.children())[:-1]))
```

ä¸Šé¢ä»£ç ç‰‡æ®µä¸­çš„æœ€åä¸€è¡Œé‡æ–°åˆ›å»ºäº†ä¸€ä¸ªå‰é¦ˆç½‘ç»œ(`nn.Sequential`)ï¼Œå®ƒç”±`resnet50` ( `resnet50.children()`)ä¸­é™¤æœ€åä¸€å±‚(`[:-1]`)ä¹‹å¤–çš„æ‰€æœ‰å±‚ç»„æˆã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸åŒçš„å±‚ç§»é™¤æ–¹æ³•æ¥ç”Ÿæˆä¸­é—´åµŒå…¥ã€‚å¯¹äºç”¨å¯¹æ¯”/ä¸‰é‡æŸå¤±è®­ç»ƒçš„æ¨¡å‹æˆ–ä½œä¸ºè‡ªåŠ¨ç¼–ç å™¨ï¼Œè¯¥æ­¥éª¤æ˜¯ä¸å¿…è¦çš„ã€‚

åŸºäº(å¯¹äº CV)å’Œ`[transformers](https://github.com/huggingface/transformers)`(å¯¹äº NLP)çš„æ¨¡å‹ä¹Ÿä¿æŒäº†å®ƒä»¬è‡ªå·±çš„æ–¹æ³•ï¼Œä½¿å¾—ç‰¹å¾æå–å˜å¾—å®¹æ˜“:

```
>>> import numpy as np
>>> from PIL import Image
>>> import timm
>>> image = numpy.array(Image.open('towhee.jpg'))
>>> model = timm.models.resnet50(pretrained=True)
>>> embedding = model.forward_features(img)>>> from transformers import AutoTokenizer, AutoModel
>>> tokenizer = AutoTokenizer.from_pretrained('bert-base-uncased')
>>> model = AutoModel.from_pretrained('bert-base-uncased')
>>> inputs = tokenizer('Hello, world!', return_tensors='pt')
>>> outputs = model(**inputs)
>>> embedding = outputs.last_hidden_state()
```

Towhee ä¸º`timm`å’Œ`transformers`ç»´æŠ¤åŒ…è£…å™¨:

```
>>> import towhee
>>> text_embedding = towhee.dc(['Hello, world!']) \
...     .text_embedding.transformers(model_name='distilbert-base-cased') \
...     .to_list()[0] # same as intro example
...
>>> img_embedding = towhee.glob('towhee.jpg') \
...     .image_decode() \
...     .image_embedding.timm(model_name='resnet50') \
...     .to_list()[0]
...
```

# å…¶ä»–èµ„æº

å¦‚æœæ‚¨æƒ³é˜…è¯»æ›´å¤šå†…å®¹æˆ–ä»å¦ä¸€ä¸ªè§’åº¦ç ”ç©¶è¿™ä¸ªä¸»é¢˜ï¼Œæˆ‘æ•´ç†äº†ä¸€ä¸ªç®€çŸ­çš„(éå¸¸ä¸å®Œæ•´çš„)å…³äºåµŒå…¥å¼çš„å…¶ä»–èµ„æºåˆ—è¡¨:

1.  [Milvus æ–‡æ¡£](https://milvus.io/docs/v1.1.0/vector.md)æä¾›äº†åµŒå…¥çŸ¢é‡çš„æ¦‚è¿°(å› ä¸ºå®ƒä¸å­˜å‚¨å’ŒçŸ¢é‡æ•°æ®åº“ç›¸å…³)ã€‚
2.  OpenAI åœ¨[æ–‡æœ¬åµŒå…¥](https://beta.openai.com/docs/guides/embeddings)ä¸Šç»´æŠ¤é¡µé¢ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹ã€‚
3.  [Will Koehrsen](https://willkoehrsen.github.io/) æä¾›äº†ä¸€ä¸ª[åµŒå…¥å¼çš„ä¼Ÿå¤§æ¦‚è¿°](/neural-network-embeddings-explained-4d028e6f0526)ã€‚å®ƒæœ‰ç‚¹è¿‡æ—¶(2018)ï¼Œä½†ä»ç„¶æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ„æºã€‚
4.  åœ¨[æ¨ç‰¹](https://blog.twitter.com/engineering/en_us/topics/insights/2018/embeddingsattwitter)ä¸ŠæŸ¥çœ‹åµŒå…¥æŠ€æœ¯æ˜¯å¦‚ä½•è¢«ä½¿ç”¨çš„ï¼Œä»¥è·å¾—æ¨èã€‚
5.  åå‘å›¾åƒæœç´¢æ˜¯åµŒå…¥å‘é‡çš„è®¸å¤šåº”ç”¨ä¹‹ä¸€ã€‚æœ¬æ•™ç¨‹å±•ç¤ºäº†å¦‚ä½•åœ¨å‡ åˆ†é’Ÿå†…å»ºç«‹ä¸€ä¸ªã€‚

å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·è€ƒè™‘åœ¨ Twitter ä¸Šå…³æ³¨æˆ‘ã€‚åœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­ï¼Œæˆ‘å°†ç®€è¦ä»‹ç»ç›¸ä¼¼æ€§æœç´¢å’Œå‘é‡ç´¢å¼•ç®—æ³•ã€‚æ•¬è¯·æœŸå¾…ï¼

*åŸè½½äº 2022 å¹´ 4 æœˆ 30 æ—¥ https://frankzliu.com*[](https://frankzliu.com/blog/understanding-neural-network-embeddings)**ã€‚**
# å†…æ ¸å¤§å°ä¸º 1024x1024 æˆ–æ›´å¤§çš„å‚…ç«‹å¶å·ç§¯

> åŸæ–‡ï¼š<https://towardsdatascience.com/fourier-cnns-with-kernel-sizes-of-1024x1024-and-larger-29f513fd6120>

## å·ç§¯ç¥ç»ç½‘ç»œä¸­çš„å¤šç»´å‚…ç«‹å¶å˜æ¢

![](img/1618ccc7104da72e43985326ba073ee8.png)

ç…§ç‰‡ç”± [Edz Norton](https://unsplash.com/@edznorton?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

C æœ€è¿‘ï¼Œé€‰æ‹©æ€§ç¥ç»ç½‘ç»œ(CNN)å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚ä¸ç®¡å®ƒä»¬æ˜¯å¦æˆåŠŸï¼Œå·ç§¯éƒ½æ˜¯ä½æ•ˆçš„ã€‚æ»‘åŠ¨çª—å£éœ€è¦è®¸å¤šè®¡ç®—ï¼Œå¹¶ä¸”é™åˆ¶äº†å†…æ ¸çš„å¤§å°ã€‚åŒæ—¶ï¼Œé€šå¸¸åœ¨[3ï¼Œ3]åˆ°[7ï¼Œ7]ä¹‹é—´çš„å°æ ¸é™åˆ¶äº†æ„ŸçŸ¥åœºï¼Œå¹¶ä¸”éœ€è¦è®¸å¤šå±‚æ¥æ•æ‰è¾“å…¥å¼ é‡çš„å…¨å±€èƒŒæ™¯(ä¾‹å¦‚ 2D å›¾åƒ)ã€‚å›¾åƒè¶Šå¤§ï¼Œå°æ»¤é•œçš„æ•ˆæœè¶Šå·®ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ å¾ˆéš¾æ‰¾åˆ°è¾“å…¥é«˜åˆ†è¾¨ç‡å›¾åƒçš„ CNNã€‚

å¦‚æœæˆ‘å‘Šè¯‰ä½ æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥å°†å†…æ ¸å¤§å°æ‰©å±•åˆ°[1024ï¼Œ1024]ç”šè‡³æ›´å¤§ï¼Œæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥åœ¨ç»™å®šçš„è¾“å…¥åˆ†è¾¨ç‡ä¸‹å¢åŠ å†…æ ¸å¤§å°ï¼Œè€Œå¯¹æ¨ç†æ—¶é—´å‡ ä¹æ²¡æœ‰å½±å“ï¼Œå¦‚æœæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥åœ¨ä¸ä¸¢å¤±å‡ ä¹ä»»ä½•ä¿¡æ¯çš„æƒ…å†µä¸‹å¤§å¹…é™ä½ç‰¹å¾å›¾çš„ç©ºé—´ç»´åº¦ï¼Œåˆä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ

æ‰€æœ‰è¿™äº›æ‰¿è¯ºéƒ½åŸºäºä¸€ä¸ªç®€å•çš„æ•°å­¦å±æ€§:å‚…ç«‹å¶å˜æ¢çš„å·ç§¯å®šç†(å‡†ç¡®åœ°è¯´æ˜¯äº’ç›¸å…³å®šç†),æˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•æ­£ç¡®åœ°åˆ©ç”¨å®ƒï¼

> æ³¨æ„:éšç€è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘åœ¨æˆ‘çš„ GitHub ä¸Šå‘å¸ƒäº†ä¸€ä¸ªåŒ…å«æ‰€æœ‰ä»£ç çš„[ç¬”è®°æœ¬](https://github.com/sascha-kirch/ML_Notebooks/blob/main/2D_FFTs.ipynb)

# æ¦‚è¿°

1.  [å·ç§¯çš„ç¼ºé™·](#e0f2)
2.  [2D ç¦»æ•£å‚…ç«‹å¶å˜æ¢ç»“æœ](#69b2)
3.  [å‘ç° 2D FFT é¢‘è°±](#5a4c)
4.  [åœ¨ TensorFlow ä¸­å®ç°](#dc1b)
5.  [ç»“è®º](#5720)
6.  [è¿›ä¸€æ­¥é˜…è¯»å’Œé“¾æ¥](#4720)

# å·ç§¯çš„ç¼ºé™·

è®©æˆ‘ä»¬å›é¡¾ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚å·ç§¯æ˜¯åº”ç”¨äºä¸¤ä¸ªå‡½æ•°çš„æ•°å­¦è¿ç®—ã€‚è®©æˆ‘ä»¬ä»ä¸€ç»´æƒ…å†µå¼€å§‹:

![](img/052ec41c949d12bbb52018c66f394849.png)![](img/0aac0cdc52240647d27dfdf78a41ae35.png)

1D å·ç§¯ï¼Œ(ä¸Š)è¿ç»­ 1D å·ç§¯ï¼Œ(ä¸‹)ç¦»æ•£ 1D å·ç§¯

æ¢å¥è¯è¯´:å–ä¸¤ä¸ªä¿¡å·ï¼Œä¸€ä¸ªä¿æŒåŸæ ·ï¼Œå¦ä¸€ä¸ªç»•åæ ‡è½´ç¿»è½¬ã€‚å°†å›ºå®šä¿¡å·ä¸Šçš„ç¿»è½¬ä¿¡å·ä»è´Ÿæ— ç©·å¤§ç§»åŠ¨åˆ°æ­£æ— ç©·å¤§(æˆ–è€…ç›´åˆ°ä¿¡å·çš„æ‰€æœ‰éé›¶éƒ¨åˆ†éƒ½å·²é‡å )ã€‚å¯¹äºæ¯ä¸ªæ­¥éª¤ï¼Œè®¡ç®—å…ƒç´ ä¹˜ç§¯å¹¶å¯¹æ‰€æœ‰å€¼æ±‚å’Œã€‚ç»“æœå€¼æ˜¯è¯¥ç‰¹å®šæ­¥éª¤çš„å·ç§¯ç»“æœã€‚å·ç§¯ä¹Ÿå¯ä»¥åº”ç”¨äºäºŒç»´ä¿¡å·(ä¾‹å¦‚å›¾åƒ):

![](img/fb6b70b19db43b35b5dc9d56271c1750.png)![](img/74f7ba3b9d91015b698abafa707b7503.png)

2D å·ç§¯ï¼Œ(ä¸Š)è¿ç»­ 2D å·ç§¯ï¼Œ(ä¸‹)ç¦»æ•£ 2D å·ç§¯

ä½†æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä¹‹å‰æåˆ°äº†äº’ç›¸å…³å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºå·ç§¯å’Œäº’ç›¸å…³å®é™…ä¸Šæ˜¯ä»¥ç›¸åŒçš„æ–¹å¼è®¡ç®—çš„ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯æ»¤æ³¢å™¨è¢«ç¿»è½¬äº†ã€‚è¿™ç”±ä¸åŒçš„ç¬¦å·è¡¨ç¤º:

![](img/0aac0cdc52240647d27dfdf78a41ae35.png)![](img/a9cd04eb00905a6e32ad78c8127384f0.png)

(ä¸Š)ç¦»æ•£å·ç§¯å’Œ(ä¸‹)ç¦»æ•£äº’ç›¸å…³ä¹‹é—´çš„æ¯”è¾ƒ

TensorFlow å’Œ PyTorch å®é™…ä¸Šæ˜¯åœ¨è®¡ç®—è¾“å…¥ä¿¡å·å’Œå¯å­¦ä¹ æ»¤æ³¢å™¨çš„äº’ç›¸å…³ï¼Œè€Œä¸æ˜¯å·ç§¯ã€‚æœ‰å…³ç³»å—ï¼Ÿä¸å°½ç„¶ï¼ç”±äºæ»¤æ³¢å™¨æ˜¯ç”±ç½‘ç»œå­¦ä¹ çš„ï¼Œæ‰€ä»¥æ»¤æ³¢å™¨æ˜¯å¦ç¿»è½¬å¹¶ä¸é‡è¦ã€‚ç½‘ç»œä¼šè‡ªå·±æ‰¾å‡ºä»€ä¹ˆæ˜¯æœ€å¥½çš„ã€‚ä¸ç¿»è½¬è¿‡æ»¤å™¨ç”šè‡³å¯ä»¥èŠ‚çœä¸€äº›è®¡ç®—ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¿‡æ»¤å™¨æ˜¯å›ºå®šçš„ï¼Œè¿™æ„å‘³ç€å¦‚æœæ‚¨åŠ è½½ä¸€ä¸ªè®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œæ‚¨åº”è¯¥çŸ¥é“å®ƒæ˜¯ä½¿ç”¨äº’ç›¸å…³è¿˜æ˜¯å·ç§¯æ¥è®­ç»ƒçš„ï¼Œå¹¶ä¸”æœ€ç»ˆå¿…é¡»ç¿»è½¬è¿‡æ»¤å™¨çš„æƒé‡ã€‚

ä½ åº”è¯¥è®°ä½ä¸¤ä»¶äº‹:

1.  éœ€è¦å¤§é‡çš„è®¡ç®—æ¥è®¡ç®—è¾“å‡ºåºåˆ—ä¸­çš„å•ä¸ªç‚¹ã€‚
2.  è¾“å…¥ä¿¡å·è¶Šå¤§(å³å›¾åƒçš„åˆ†è¾¨ç‡è¶Šé«˜)ï¼Œæ»¤æ³¢å™¨å¿…é¡»ç§»åŠ¨å¾—è¶Šé¢‘ç¹ï¼Œå› æ­¤éœ€è¦æ›´å¤šçš„è®¡ç®—ã€‚è¿™åŒæ ·é€‚ç”¨äºè¾ƒå¤§çš„è¿‡æ»¤å™¨ã€‚

æ›´å¤šçš„è®¡ç®—æ„å‘³ç€æ›´å¤šçš„å†…å­˜å’Œæ›´é•¿çš„ç­‰å¾…æ—¶é—´ï¼Œç›´åˆ°ç»“æœå¯ç”¨ã€‚CNN çš„åæœæ˜¯æ˜¾è€Œæ˜“è§çš„:æ›´ä½çš„è¾“å…¥åˆ†è¾¨ç‡å’Œæ›´å°çš„æ»¤æ³¢å™¨ã€‚é—®é¢˜:æ›´å°‘çš„åƒç´ æ„å‘³ç€æ›´å°‘çš„ç»†èŠ‚ï¼Œæ›´å°çš„è¿‡æ»¤å™¨å¯¼è‡´æ›´å°çš„æ„Ÿå—é‡ã€‚ç½‘ç»œéœ€è¦æœ‰å¤šä¸ªè¿ç»­çš„å·ç§¯å±‚ï¼Œä»¥å¢åŠ æ¥æ”¶åŸŸã€‚ç½‘ç»œå˜å¾—æ›´æ·±ï¼Œè¿™åˆç»™åŸ¹è®­å¸¦æ¥äº†æ–°çš„æŒ‘æˆ˜ã€‚

![](img/cfefa5828c2985d5cc08e972b9c3b97d.png)

å·ç§¯ç¥ç»ç½‘ç»œæ„Ÿå—é‡çš„å¢é•¿

# 2D ç¦»æ•£å‚…ç«‹å¶å˜æ¢æ¥æ‹¯æ•‘

ä»æ•°å­¦ä¸Šè®²ï¼Œæ—¶é—´å˜é‡ t çš„å®å‡½æ•°æˆ–å¤å‡½æ•° x(t)çš„å‚…ç«‹å¶å˜æ¢æ˜¯å®é¢‘ç‡å˜é‡ f çš„å¤å‡½æ•° X(f ):

![](img/86025c5435d53b94999b26abf10d27c2.png)

å‚…é‡Œå¶å˜æ¢

ä½ ä¹Ÿå¯ä»¥è¯´æˆ‘ä»¬å°†ä¿¡å·ä»æ—¶åŸŸæŠ•å°„åˆ°é¢‘åŸŸã€‚é€šè¿‡è¿™æ ·åšï¼Œæˆ‘ä»¬å¯ä»¥å—ç›Šäºå‚…ç«‹å¶å˜æ¢çš„ç‰¹æ®Šæ€§è´¨ï¼Œå³å·ç§¯å®šç†å’Œç›¸å…³å®šç†ã€‚

![](img/afadf930f78978d25c662ae18800ce28.png)![](img/61837727c9cc9c55c82459a83d8238ad.png)

å‚…ç«‹å¶å®šç†ï¼Œ(ä¸Š)å·ç§¯å®šç†ï¼Œ(ä¸‹)äº’ç›¸å…³å®šç†

è¿™äº›ç‰¹æ€§éå¸¸é‡è¦ï¼Œä¹Ÿæ˜¯æœ¬æ–‡çš„åŸºç¡€:æ—¶åŸŸä¸­çš„å·ç§¯/ç›¸å…³å¯¹åº”äºé¢‘åŸŸä¸­ç®€å•çš„é€å…ƒç´ ä¹˜æ³•ã€‚ä½†è¿™æœ‰ä»€ä¹ˆå¥½æ¿€åŠ¨çš„å‘¢ï¼Ÿå¦‚å‰æ‰€è¿°ï¼Œå·ç§¯éœ€è¦å¾ˆå¤šè®¡ç®—ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¤§å›¾åƒå’Œè¿‡æ»¤å™¨ã€‚å…¶å¤æ‚åº¦ä¸åºåˆ—é•¿åº¦æˆäºŒæ¬¡æ¯”ä¾‹ï¼Œå³ O(N)ã€‚æ ¹æ®å·ç§¯å®šç†ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹å˜æ¢åçš„è¾“å…¥å’Œå˜æ¢åçš„æ»¤æ³¢å™¨æ‰§è¡Œé€å…ƒç´ ä¹˜æ³•ã€‚å­˜åœ¨æœ‰æ•ˆçš„ç®—æ³•æ¥è®¡ç®—å‚…ç«‹å¶å˜æ¢ï¼Œå³å¿«é€Ÿå‚…ç«‹å¶å˜æ¢(FFT)ï¼Œå…¶å°†å¤æ‚åº¦é™ä½åˆ° O(N log(N))ã€‚è€Œæœ€å¥½çš„éƒ¨åˆ†ï¼Œåªè¦æ»¤æ³¢å™¨ä½œä¸ºè¾“å…¥ä¿¡å·æ›´å°ï¼Œè®¡ç®—è¦æ±‚æ˜¯ä¸å˜çš„ã€‚ä¸ç®¡æˆ‘ä»¬çš„è¿‡æ»¤å™¨çš„å†…æ ¸å¤§å°æ˜¯[3ï¼Œ3]è¿˜æ˜¯[1024ï¼Œ1024]ã€‚åœ¨ TensorFlow ä¸­å®ç°çš„éƒ¨åˆ†ä¸­çš„ç»†èŠ‚ã€‚

å‚…ç«‹å¶å˜æ¢ä¹Ÿå­˜åœ¨äºå®æ•°æˆ–å¤æ•°ç¦»æ•£ä¿¡å· x[k]ä¸­ï¼Œå…¶åˆ†é…å®æ•°å˜é‡ n çš„å¤æ•°ç¦»æ•£ä¿¡å· X[n]:

![](img/ab47bff63759056c7a415d7c6fcc74c7.png)![](img/684ac567654056722e8d7e2e59ecdc0f.png)

ç¦»æ•£å‚…ç«‹å¶å˜æ¢ï¼Œ(ä¸Š)1D ç¦»æ•£å‚…ç«‹å¶å˜æ¢ï¼Œ(ä¸‹)2D ç¦»æ•£å‚…ç«‹å¶å˜æ¢

ç¦»æ•£å‚…ç«‹å¶å˜æ¢(DFT)æ³¨å®šç”¨äºæ•°å­—ä¿¡å·å¤„ç†ï¼Œå› ä¸ºè®¡ç®—æœºä»¥ç¦»æ•£å€¼å­˜å‚¨ä¿¡å·ã€‚

> æ³¨æ„:ç¦»æ•£ä¿¡å·æ˜¯æ—¶é—´ç¦»æ•£å’Œæ•°å€¼ç¦»æ•£çš„ã€‚æ—¶é—´ç¦»æ•£å‹ï¼Œå› ä¸ºå®ƒä»¥ç‰¹å®šçš„æ—¶é—´é—´éš”è¿›è¡Œé‡‡æ ·ï¼›æ•°å€¼ç¦»æ•£å‹ï¼Œå› ä¸ºæ¯ä¸ªå€¼éƒ½ç”±ç‰¹å®šæ•°é‡çš„ä½è¡¨ç¤ºï¼Œä¾‹å¦‚ INT32 ä¸º 32 ä½ã€‚

åœ¨ä½¿ç”¨ DFT æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è®°ä½ä¸€äº›å«ä¹‰:

1.  å‡è®¾è¾“å…¥ä¿¡å·æ˜¯å‘¨æœŸæ€§çš„ï¼Œå¹¶ä¸”é‡‡æ ·ä¸€ä¸ªå®Œæ•´çš„å‘¨æœŸ
2.  äº§ç”Ÿçš„å…‰è°±æ˜¯å‘¨æœŸæ€§çš„

> æ³¨:å›¾åƒå¯ä»¥è¢«è§£é‡Šä¸ºç©ºé—´ä¿¡å·ï¼Œè€Œä¸æ˜¯æ—¶é—´ä¿¡å·ã€‚åœ¨è®¡ç®—æœºä¸Šï¼Œå›¾åƒæ˜¯ç©ºé—´ç¦»æ•£çš„ï¼Œå› ä¸ºå€¼å­˜å‚¨åœ¨åƒç´ ä¸­ï¼Œè¿™äº›åƒç´ æ˜¯ä»å…·æœ‰ç©ºé—´åˆ†å¸ƒçš„å•å…ƒçš„å›¾åƒä¼ æ„Ÿå™¨ä¸­é‡‡æ ·çš„æˆ–è€…è¢«æ•°å­—åŒ–çš„ã€‚

äºŒç»´ DFT(ä»¥åŠ 2D è¿ç»­å‚…ç«‹å¶å˜æ¢)å¯ä»¥åˆ†æˆè¿ç»­çš„ 1D DFTï¼Œå…¶ä¸­è¡Œå’Œåˆ—å¯ä»¥åˆ†åˆ«è®¡ç®—ã€‚

![](img/b44440bcbe5598f19feef60ee6c34580.png)

2D DFT åœ¨è¿ç»­çš„ 1D DFT ä¸­åˆ†ç¦»

è¿™è‡³å°‘æœ‰ä¸¤ä¸ªä¼˜ç‚¹:ç¬¬ä¸€ï¼Œå¯ä»¥é‡å¤ä½¿ç”¨ 1D DFT çš„ç®—æ³•ï¼Œç¬¬äºŒï¼Œæœ‰åŠ©äºå»ºç«‹ 2D DFT çš„ç›´è§‰ï¼Œå› ä¸ºè¡Œå’Œåˆ—å¯ä»¥å•ç‹¬è§£é‡Šã€‚

ä½†æ˜¯å½“ç„¶ï¼Œç¦»æ•£å‚…ç«‹å¶å˜æ¢æœ‰ä¸€ä¸ªå°ç»†èŠ‚:**å·ç§¯å®šç†ä¸é€‚ç”¨äº DFTã€‚**

ä¸¤ä¸ªä¿¡å·çš„ DFT çš„ä¹˜ç§¯å¯¹åº”äºç”±ç®—å­âŠ›è¡¨ç¤ºçš„å®ƒä»¬çš„å¾ªç¯å·ç§¯ï¼Œè€Œä¸æ˜¯å®ƒä»¬çš„çº¿æ€§å·ç§¯ã€‚

![](img/d75f7288f29cdcf5c6ff88b6398f1365.png)

DFT çš„å¾ªç¯å·ç§¯å®šç†

å¾ªç¯å·ç§¯æ˜¯ä»¥ä¿¡å·é•¿åº¦ N é‡å¤çš„å‘¨æœŸæ€§ä¿¡å·ï¼Œè€Œçº¿æ€§å·ç§¯çš„é•¿åº¦ä¸º(N+F-1)ï¼Œå…¶ä¸­ F æ˜¯æ»¤æ³¢ä¿¡å·çš„é•¿åº¦ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨ç›²ç›®åœ°åœ¨é¢‘åŸŸä¸­æ±‚ä¹˜ç§¯ï¼Œæ‚¨ä¼šå°†é•¿åº¦ä¸º(N+M-1)çš„ä¿¡å·å‹ç¼©åˆ°é•¿åº¦ä¸º N çš„ä¿¡å·ä¸­ï¼Œè¿™å¯ä»¥è¢«è§†ä¸ºæ—¶åŸŸä¸­çš„**æ··å ï¼Œä»è€Œåœ¨æœ€ç»ˆç»“æœä¸­äº§ç”Ÿä¸éœ€è¦çš„ä¼ªåƒã€‚å¹¸è¿çš„æ˜¯ï¼Œå¾ªç¯å·ç§¯å’Œçº¿æ€§å·ç§¯å…±äº«ä¸€äº›å€¼ï¼Œå³(N-F+1)ã€‚å‰©ä½™çš„(F-1)å€¼è¢«ç»•å›å¹¶å¹²æ‰°ä¿¡å·çš„å…¶ä»–å€¼ã€‚**

è¿™é‡Œæœ‰ä¸€ä¸ªæƒ³æ³•:å¦‚æœè¢«åŒ…è£…çš„å€¼å¹²æ‰°çš„å€¼ä¸ºé›¶ï¼Œæ„å‘³ç€æ²¡æœ‰å¹²æ‰°ï¼Œé‚£ä¼šæ€ä¹ˆæ ·ï¼Ÿè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä»å¾ªç¯å·ç§¯ä¸­é‡å»ºçº¿æ€§å·ç§¯ã€‚å½“ä¿¡å·è‡³å°‘ç”¨(F-1)é›¶å¡«å……æ—¶ï¼ŒåŒ…è£…å€¼ä¸ä¼šå¹²æ‰°çœŸå®å€¼ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å¾ªç¯åœ°å°†åŒ…è£…çš„å€¼ç§»å›å®ƒçš„ä½ç½®ï¼Œå¹¶è£å‰ªå¡«å……çš„å€¼ã€‚è¯¦ç»†ä¿¡æ¯å°†åœ¨å®æ–½éƒ¨åˆ†æ˜¾ç¤ºã€‚

æˆ‘ä¸å†èµ˜è¿°æ‰€æœ‰çš„æ•°å­¦ç»†èŠ‚ï¼Œå¹¶åœ¨æ–‡ç« æœ«å°¾é“¾æ¥äº†æ›´å¤šçš„èµ„æºã€‚

# å‘ç° 2D DFT é¢‘è°±

ç°åœ¨æˆ‘ä»¬å·²ç»è®¨è®ºäº†ç†è®ºï¼Œè®©æˆ‘ä»¬å‘ç°ä¸€äº› 2D å‚…ç«‹å¶å˜æ¢ï¼Œå¹¶åŠ å¼ºæˆ‘ä»¬å¯¹ 2D å‚…ç«‹å¶å˜æ¢çš„ç›´è§‰ã€‚

## åŸºæœ¬æµ‹è¯•ä¿¡å·åŠå…¶å¯¹ç»†èƒç¥ç»ç½‘ç»œçš„å½±å“

è€ƒè™‘åƒç´ å¼ºåº¦éµå¾ªå¯¹è§’æ­£å¼¦æ³¢çš„å›¾åƒã€‚ä½ æœŸæœ›ä»€ä¹ˆæ ·çš„æŒ¯å¹…è°±ï¼Ÿå¦‚å‰æ‰€è¿°ï¼Œ2D å‚…ç«‹å¶å˜æ¢å¯ä»¥é€šè¿‡å°† 2D å‚…ç«‹å¶å˜æ¢æ²¿ç€å›¾åƒçš„æ¯ä¸ªè½´åˆ†æˆå¤šä¸ª 1D å‚…ç«‹å¶å˜æ¢æ¥è®¡ç®—ã€‚å¦‚æœä½ æƒ³è±¡æ²¿ç€æ¨ªè½´è¡Œèµ°ï¼Œä½ ä¼šé‡åˆ°é‡å¤çš„æ¨¡å¼ã€‚å¦‚æœä½ æƒ³è±¡æ²¿ç€çºµè½´è¡Œèµ°ï¼Œæƒ…å†µä¹Ÿæ˜¯å¦‚æ­¤ã€‚å› æ­¤ï¼Œåœ¨ç¬¬å››è±¡é™(å³ä¸‹)ï¼Œå³é¢‘ç‡æˆåˆ†ä¸ºæ­£å€¼çš„è±¡é™å†…ï¼Œå¾ˆè‡ªç„¶åœ°ä¼šå‡ºç°é«˜é¢‘è°±å€¼ã€‚

![](img/35d35a70c3a06f49f5ef808b8daa6e4d.png)

å¯¹è§’æ­£å¼¦è¾“å…¥å›¾åƒçš„ 2D DFT(ä¸Šå›¾)å›¾åƒå›¾ï¼Œ(ä¸‹å›¾)ä½œè€…çš„ 3D å›¾

> æ³¨æ„:2D æŒ¯å¹…è°±åœ¨ç»˜åˆ¶æ—¶é€šå¸¸ä½¿ç”¨å¯¹æ•°å‡½æ•°è¿›è¡Œç¼©æ”¾ï¼Œå› ä¸ºå›¾åƒæ— è®ºå…¶å†…å®¹å¦‚ä½•éƒ½å…·æœ‰é«˜åç§»ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸ä»¥æ— ç¬¦å·æ•´æ•°è¡¨ç¤ºï¼Œè€Œæ— ç¬¦å·æ•´æ•°ä»…è¡¨ç¤ºæ­£å€¼ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬è€ƒè™‘å…·æœ‰ä¸åŒè¾¹é•¿çš„çŸ©å½¢çš„è¾“å…¥å›¾åƒã€‚å¦‚æœä½ å†æ¬¡æƒ³è±¡æ²¿ç€æ¯ä¸ªè½´èµ°ï¼Œä½ å°†åœ¨æ°´å¹³è½´ä¸Šé‡åˆ°ä¸€ä¸ªå…·æœ‰çŸ­è„‰å†²å®½åº¦çš„çŸ©å½¢ï¼Œåœ¨å‚ç›´è½´ä¸Šé‡åˆ°ä¸€ä¸ªå…·æœ‰è¾ƒå®½è„‰å†²å®½åº¦çš„çŸ©å½¢ã€‚å¦‚æœä½ ç†Ÿæ‚‰ä¿¡å·ç†è®ºï¼Œä½ ä¼šç«‹å³æƒ³åˆ°ä½ çš„é¢‘è°±æœ‰æŸç§ sinc å‡½æ•°ï¼Œå…¶ä¸­ sinc(x)=sin(x)/xã€‚

![](img/209dc6efa48ed90810895362f133da47.png)

ä¸åŒè¾¹é•¿çŸ©å½¢çš„ 2D DFT

å¦‚æœä½ æœŸå¾…ä¸€ä¸ªæ­£å¼¦å‡½æ•°ï¼Œä½ æ˜¯å®Œå…¨æ­£ç¡®çš„ã€‚é¢‘è°±ç”±æ²¿ä¸¤ä¸ªè½´çš„æ­£å¼¦å‡½æ•°ç»„æˆã€‚è¿™é‡Œå¯ä»¥åšä¸€ä¸ª ***åŸºæœ¬é¢è§‚å¯Ÿ*** : æ¨ªè½´ä½œä¸ºçºµè½´æœ‰è¾ƒé«˜çš„é¢‘ç‡æˆåˆ†ï¼Œè¿‡é›¶ç‚¹åœ¨æ¨ªè½´æ›´åˆ†æ•£ã€‚è¿™ä¸€è§‚å¯Ÿæœ‰ä¸¤å±‚å«ä¹‰:

1.  è¾“å…¥å›¾åƒä¸­çš„çª„ç©ºé—´ç‰¹å¾åœ¨æŒ¯å¹…è°±ä¸­å…·æœ‰é«˜é¢‘åˆ†é‡ï¼Œå› æ­¤å®ƒä»¬å…·æœ‰é«˜å¸¦å®½ã€‚é«˜å¸¦å®½æ»¤æ³¢å™¨å®¹æ˜“äº§ç”Ÿå™ªå£°ã€‚
2.  å…‰è°±ä¸è¾“å…¥å›¾åƒä¸­è¦ç´ çš„ç©ºé—´é•¿åº¦æˆåæ¯”ã€‚çª„ç‰¹å¾å¯¼è‡´å®½å…‰è°±ï¼Œå®½ç‰¹å¾å¯¼è‡´çª„å…‰è°±ã€‚

è¿™å¯¹äºæˆ‘ä»¬çš„ CNN æ¥è¯´æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿæ ¹æ®æˆ‘ä»¬ä¸Šé¢çš„è§‚å¯Ÿï¼Œè¿™åº”è¯¥æ„å‘³ç€å…·æœ‰å°æ»¤æ³¢å™¨çš„***CNN å……å½“é«˜å¸¦å®½æ»¤æ³¢å™¨ï¼Œå› æ­¤å®¹æ˜“äº§ç”Ÿè¾“å…¥å™ªå£°*** *ã€‚*æ»¤æ³¢å™¨å°ºå¯¸è¶Šå¤§ï¼Œæ»¤æ³¢å™¨å¸¦å®½è¶Šä½ï¼Œé€‰æ‹©æ€§è¶Šå¼ºã€‚

## å›¾åƒçš„ 2D DFT å’Œé¢‘åŸŸæ»¤æ³¢

æ—¢ç„¶æˆ‘ä»¬å·²ç»è®¨è®ºäº†ä¸€äº›åŸºæœ¬ä¿¡å·ï¼Œè®©æˆ‘ä»¬ç ”ç©¶çœŸå®å›¾åƒçš„ 2D DFTã€‚

![](img/743d0721c496a1a396cc419e07d845fc.png)

ä½œè€…çš„å›¾åƒçš„ 2D DFT

é¢‘è°±çš„ä¸­å¿ƒè¡¨ç¤ºé¢‘ç‡ä¸ºé›¶ï¼Œä¹Ÿç§°ä¸ºåç§»ã€‚ç¦»ä¸­å¿ƒè¶Šè¿œï¼Œè¾“å…¥ä¸­çš„é¢‘ç‡æˆåˆ†è¶Šé«˜ã€‚è®°ä½è¿™ä¸€ç‚¹ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°å¾—å‡ºä¸€ä¸ªé«˜é€šæ»¤æ³¢å™¨å’Œä¸€ä¸ªä½é€šæ»¤æ³¢å™¨ã€‚

é«˜é€šæ»¤æ³¢å™¨æŠ‘åˆ¶ä½é¢‘ï¼Œä¿ç•™é«˜é¢‘æˆåˆ†ã€‚è¿™ç§è¡Œä¸ºå¯ä»¥é€šè¿‡è¿™æ ·çš„æ»¤æ³¢å™¨æ¥å®ç°ï¼Œè¯¥æ»¤æ³¢å™¨åœ¨é è¿‘ä¸­å¿ƒçš„ä½ç½®å…·æœ‰ 0ï¼Œè€Œåœ¨è¿œç¦»ä¸­å¿ƒçš„ä½ç½®å…·æœ‰ 1ã€‚é€šè¿‡å°†æ»¤æ³¢å™¨ä¸é¢‘è°±ç›¸ä¹˜ï¼Œç„¶åè®¡ç®—å‚…ç«‹å¶é€†å˜æ¢æ¥åº”ç”¨æ»¤æ³¢å™¨ã€‚

![](img/718e61c09b4a5b3ed6bb6955025aa04c.png)

ä½œè€…çš„é«˜é€šæ»¤æ³¢å™¨

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œé«˜é€šæ»¤æ³¢å™¨å¯ä»¥ç”¨ä½œè¾¹ç¼˜æ£€æµ‹å™¨ã€‚å›¾åƒä¸­çš„è¾¹ç¼˜çš„ç‰¹å¾åœ¨äºåƒç´ å€¼çš„çªå˜ï¼Œå› æ­¤å®ƒå…·æœ‰é«˜æ¢¯åº¦ã€‚æ¢¯åº¦è¶Šé«˜ï¼Œæ¶‰åŠçš„é¢‘ç‡è¶Šé«˜ã€‚

å¦ä¸€æ–¹é¢ï¼Œä½é€šæ»¤æ³¢å™¨æŠ‘åˆ¶é«˜é¢‘åˆ†é‡ï¼Œä¿ç•™ä½é¢‘åˆ†é‡ã€‚ä½é€šæ»¤æ³¢å™¨å¯ä»¥é€šè¿‡åœ¨ä¸­å¿ƒåŒºåŸŸä¸º 1 è€Œåœ¨å¤–éƒ¨åŒºåŸŸä¸º 0 çš„æ©æ¨¡æ¥å®ç°ã€‚

![](img/38787268ac535e2f64e5fb546ba34c17.png)

ä½œè€…çš„ä½é€šæ»¤æ³¢å™¨

ç»è¿‡ä½é€šæ»¤æ³¢çš„å›¾åƒçœ‹èµ·æ¥æ¨¡ç³Šä¸æ¸…ï¼Œå¤±å»äº†æ¸…æ™°åº¦ã€‚è®¡ç®—æœºè§†è§‰ä¸­ä½¿ç”¨çš„å…¸å‹æ»¤æ³¢å™¨æ˜¯é«˜æ–¯æ»¤æ³¢å™¨ã€‚å®ƒä¹Ÿæ˜¯ä¸€ä¸ªä½é€šæ»¤æ³¢å™¨ï¼Œä½†å¯¹äºè¾ƒé«˜çš„é¢‘ç‡ï¼Œæ»¤æ³¢æ•ˆæœé€æ¸å¢å¼ºï¼Œè€Œä¸æ˜¯çªç„¶æˆªæ­¢é¢‘ç‡ã€‚å®ƒä½¿å›¾åƒå¹³æ»‘ã€‚ä¸‹å›¾ç”±é«˜æ–¯æ»¤æ³¢å™¨æ»¤æ³¢ï¼Œå…¶æ–¹å·®(sigma å¹³æ–¹)ç­‰äºä¹‹å‰åœ†å½¢ä½é€šæ»¤æ³¢å™¨çš„æˆªæ­¢é¢‘ç‡ã€‚

![](img/f18f3fdb2a5aec11869caa99eb2620c3.png)

ä½œè€…çš„é«˜æ–¯æ»¤æ³¢å™¨(å¹³æ»‘)

å›¾åƒæ¨¡ç³Šï¼Œä½†å¤±çœŸè¾ƒå°‘ã€‚å®ƒçœ‹èµ·æ¥æ›´å…‰æ»‘ã€‚

æœºå™¨å­¦ä¹ åº”ç”¨çš„ä¸€ä¸ªéå¸¸æœ‰è¶£çš„è¿‡æ»¤å™¨æ˜¯çŸ©å½¢è¿‡æ»¤å™¨ã€‚å·ç§¯ç¥ç»ç½‘ç»œé€šå¸¸é€æ¸å‡å°ç©ºé—´å®½åº¦å¹¶å¢åŠ é€šé“æ•°é‡ã€‚æ±‡é›†ï¼Œå¦‚æœ€å¤§æ±‡é›†æˆ–å¹³å‡æ±‡é›†ç»å¸¸è¢«ç”¨æ¥å‡å°‘ç©ºé—´å®½åº¦ã€‚å¦‚æœæˆ‘ä»¬åœ¨é¢‘åŸŸä¸­æ±‡é›†å‘¢ï¼Ÿ

![](img/e6a12650e75819f09fe1e0e35c8f1d2b.png)

ä½œè€…çš„çŸ©å½¢è¿‡æ»¤å™¨

é€šè¿‡åœ¨é¢‘åŸŸä¸­åº”ç”¨çŸ©å½¢æ»¤æ³¢å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å½»åº•å»é™¤é¢‘ç‡åˆ†é‡ï¼Œè€Œä¸ä¼šå¯¹ç©ºé—´åŸŸä¸­çš„å›¾åƒè´¨é‡äº§ç”Ÿå¤§çš„å½±å“ã€‚

DFT å¯¹äºå®è¾“å…¥æœ‰ä¸€ä¸ªæœ‰è¶£çš„æ€§è´¨:å®ƒå…³äºåŸç‚¹å…±è½­å¯¹ç§°ã€‚å¯¹ç§°æ€§æ„å‘³ç€é¢‘è°±åŒ…å«å†—ä½™ï¼Œåœ¨è®¡ç®—è¿‡ç¨‹ä¸­å¯ä»¥å¿½ç•¥è¿™äº›å†—ä½™ï¼Œä»¥è¿›ä¸€æ­¥åŠ å¿«å¤„ç†é€Ÿåº¦ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†è¿™ç§å˜æ¢åŠå…¶ä»å…‰è°±é‡å»ºçš„é€†å˜æ¢ã€‚

![](img/17b0d9c0dde3972c66bd9942777df392.png)

ä½œè€…çš„å›¾åƒçš„ 2D å¿«é€Ÿå‚…ç«‹å¶å˜æ¢

**ä»æœ¬èŠ‚ä¸­å–èµ°:**

1.  ä½é¢‘æˆåˆ†åœ¨ 2D é¢‘è°±çš„ä¸­å¿ƒï¼Œè€Œé«˜é¢‘æˆåˆ†è¿œç¦»ä¸­å¿ƒ
2.  æ‚¨å¯ä»¥åˆ©ç”¨ DFT çš„å¯¹ç§°æ€§æ¥å‡å°‘æ‰€éœ€çš„è®¡ç®—èµ„æºï¼Œåªè®¡ç®— rDFTã€‚
3.  å°å°ºå¯¸æ»¤æ³¢å™¨ç”±äºå…¶é«˜å¸¦å®½è€Œæ˜“äºäº§ç”Ÿå™ªå£°ã€‚

è¿™æ˜¯æˆ‘ä¸ºç”Ÿæˆè¿™äº›å›¾è€Œåˆ›å»ºçš„ç¬”è®°æœ¬:

[](https://github.com/sascha-kirch/ML_Notebooks/blob/main/2D_FFTs.ipynb) [## ML _ Notebooks/2D _ ffts . ipynb at main sascha-kir ch/ML _ Notebooks

### æœºå™¨å­¦ä¹ ç›¸å…³ç¬”è®°æœ¬åˆé›†åˆ†äº«ã€‚-ML _ Notebooks/2D _ ffts . ipynb at mainâ€¦

github.com](https://github.com/sascha-kirch/ML_Notebooks/blob/main/2D_FFTs.ipynb) 

# TensorFlow ä¸­çš„å®ç°

åˆ©ç”¨ç¦»æ•£å‚…é‡Œå¶å˜æ¢å®ç°çº¿æ€§å·ç§¯ï¼Œæˆ‘ä»¬å·²ç»å…·å¤‡äº†æ‰€æœ‰æ¡ä»¶ã€‚

æ¦‚æ‹¬åœ°è¯´ï¼Œæˆ‘ä»¬éœ€è¦å®æ–½ä»¥ä¸‹ 6 ä¸ªæ­¥éª¤:

1.  å¡«è¡¥è¾“å…¥å›¾åƒä»¥é¿å…æ—¶åŸŸä¸­çš„æ··å 
2.  å¯¹å›¾åƒå¤§å°è¿›è¡Œå¡«å……è¿‡æ»¤ï¼Œä»¥å‡†å¤‡å…ƒç´ ä¹˜æ³•
3.  è®¡ç®—è¾“å…¥å›¾åƒå’Œæ»¤æ³¢å™¨çš„ 2D rFFT
4.  å˜æ¢è¾“å…¥å’Œå˜æ¢æ»¤æ³¢å™¨çš„é€å…ƒç´ ä¹˜æ³•
5.  è®¡ç®—æ»¤æ³¢è¾“å…¥çš„ 2D é€† rFFT ä»¥è·å¾—å¾ªç¯å·ç§¯
6.  ä»å¾ªç¯å·ç§¯é‡å»ºçº¿æ€§å·ç§¯

## æ­¥éª¤ 1 â€”å¡«å……è¾“å…¥å›¾åƒ

ä¸ºäº†é¿å…æ—¶åŸŸä¸­çš„æ··å æ•ˆåº”ï¼Œæˆ‘ä»¬éœ€è¦ç”¨è‡³å°‘(F-1)é›¶ç‚¹æ¥å¡«å……å›¾åƒï¼Œå…¶ä¸­ F æ˜¯æ»¤æ³¢å™¨çš„è¾¹é•¿ã€‚æ­¤å¤–ï¼Œè®¡ç®— DFT çš„ FFT ç®—æ³•å¯¹äºä¿¡å·é•¿åº¦ä¸º 2 çš„å¹‚(ä¾‹å¦‚ 128ï¼Œ512ï¼Œ1024)ç‰¹åˆ«æœ‰æ•ˆã€‚

è‡³å°‘æœ‰ä¸¤ç§é€‰æ‹©æ¥å¡«å……è¾“å…¥å›¾åƒ:é¦–å…ˆï¼Œæˆ‘ä»¬æ‰‹åŠ¨å¡«å……å›¾åƒã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬å°† FFT çš„åºåˆ—é•¿åº¦è®¾ç½®ä¸ºå¡«å……ä¿¡å·çš„é•¿åº¦ã€‚æˆ‘æ›´å–œæ¬¢åè€…ã€‚

ä¸‹é¢çš„ä»£ç æ‰‹åŠ¨å¡«å……å›¾åƒã€‚

è¿™é‡Œæ˜¯æˆ‘åœ¨è®¡ç®— FFT æ—¶æŒ‡å®šæ›´é«˜åºåˆ—é•¿åº¦çš„é¦–é€‰æ–¹æ³•:

```
# image is of shape [b,c,h,w]
padding **=** GetImagePadding(filter_shape[0]) 
image_shape **=** (input_shape[0],
               input_shape[1],
               input_shape[2]**+**2*****padding,
               input_shape[3]**+**2*****padding)image_shape **=** FillImageShapeToPower2(image_shape)

F_image **=** tf**.**signal**.**rfft2d(image, fft_length**=**[image_shape[**-**2],image_shape[**-**1]])
```

## æ­¥éª¤ 2-æ ¹æ®å›¾åƒå¤§å°å¡«å……æ»¤é•œ

å› ä¸ºæˆ‘ä»¬éœ€è¦ç”¨å˜æ¢åçš„æ»¤æ³¢å™¨è®¡ç®—å˜æ¢åå›¾åƒçš„å…ƒç´ ä¹˜ç§¯ï¼Œæ‰€ä»¥åœ¨è®¡ç®—å‚…ç«‹å¶å˜æ¢ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å°†æ»¤æ³¢å™¨å¡«å……åˆ°å¡«å……åå›¾åƒçš„å¤§å°ã€‚è¿‡æ»¤å™¨ç”¨é›¶å¡«å……ã€‚åŒæ ·ï¼Œæˆ‘å»ºè®®é€šè¿‡æ­£ç¡®è®¾ç½® fft è®¡ç®—çš„ fft _ lenght å‚æ•°æ¥å¡«å……æ»¤æ³¢å™¨ï¼Œå³

```
F_filter **=** tf**.**signal**.**rfft2d(filter, fft_length**=**[image_shape[**-**2],image_shape[**-**1]])
```

## æ­¥éª¤ 3 â€”è®¡ç®— 2D rfft

æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½è¾“å…¥ä¿¡å·ï¼Œç°åœ¨å¯ä»¥è®¡ç®—å¡«å……å›¾åƒå’Œå¡«å……æ»¤æ³¢å™¨çš„ FFT:

```
# Image shape [b,c,h,w], Filter shape [out, in , k, k]
F_image **=** tf**.**signal**.**rfft2d(image, fft_length**=**[image_shape[**-**2],image_shape[**-**1]])F_filter **=** tf**.**signal**.**rfft2d(filter, fft_length**=**[image_shape[**-**2],image_shape[**-**1]])
```

æˆ‘ä»¬åˆ©ç”¨å®è¾“å…¥çš„å…±è½­å¯¹ç§°æ€§ï¼Œä»…ä½¿ç”¨ [rfft2d](https://www.tensorflow.org/api_docs/python/tf/signal/rfft2d) è®¡ç®— 2D ä¿¡å·çš„å® FFTã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬è¾“å…¥æ— å¡«å……ä¿¡å·ï¼Œå¹¶å°† fft_length è®¾ç½®ä¸ºå¤§äºè¾“å…¥é•¿åº¦çš„å€¼ã€‚è¿™å°†è‡ªåŠ¨ç”¨é›¶å¡«å……ä¿¡å·ã€‚

**é‡è¦** : TensorFlow å¯¹ [rfft2d](https://www.tensorflow.org/api_docs/python/tf/signal/rfft2d) çš„å®ç°è®¡ç®—è¾“å…¥çš„æœ€åä¸¤ä¸ªç»´åº¦ä¸Šçš„ fftã€‚ä¸åƒåœ¨ [numpy çš„å®ç°](https://numpy.org/doc/stable/reference/generated/numpy.fft.rfft2.html)ä¸­ï¼Œä½ ä¸èƒ½é€šè¿‡å‚æ•°æ”¹å˜ç»´åº¦ã€‚å› æ­¤ï¼Œå›¾åƒçš„å½¢çŠ¶æ˜¯[æ‰¹æ¬¡ã€é€šé“ã€é«˜åº¦ã€å®½åº¦]ï¼Œå†…æ ¸çš„å½¢çŠ¶æ˜¯[è¾“å‡ºè¿‡æ»¤å™¨ã€è¾“å…¥è¿‡æ»¤å™¨ã€å†…æ ¸é«˜åº¦ã€å†…æ ¸å®½åº¦]

å¦‚æœæˆ‘ä»¬åœ¨é¢‘åŸŸä¸­æ‰§è¡Œå·ç§¯ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ã€‚ç”±äº TensorFlow å®é™…ä¸Šå®ç°äº†äº’ç›¸å…³ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹å˜æ¢åçš„æ»¤æ³¢å™¨è¿›è¡Œå…±è½­ï¼Œä»¥è·å¾—ä¸€è‡´çš„ç»“æœ:

```
F_filter **=** tf**.**math**.**conj(F_filter)
```

## æ­¥éª¤ 4â€”å˜æ¢å›¾åƒå’Œå˜æ¢æ»¤æ³¢å™¨çš„ç›¸ä¹˜

å¦‚æœæˆ‘ä»¬åªæœ‰å•ä¸ªå›¾åƒå’Œå•ä¸ªè¿‡æ»¤å™¨ï¼Œåˆ™é€å…ƒç´ ä¹˜æ³•å°†ç®€å•åœ°ä¸º`F_image*F_folter`ã€‚åœ¨ä¸€ä¸ªçœŸå®çš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä»¥æ‰¹å¤„ç†çš„å½¢å¼æœ‰å¤šä¸ªå›¾åƒï¼Œå¹¶ä¸”æˆ‘ä»¬å¹¶è¡Œåœ°åº”ç”¨å¤šä¸ªè¿‡æ»¤å™¨ã€‚æˆ‘ä»¬éœ€è¦é‡æ–°æ’åˆ—è¾“å…¥ä¿¡å·çš„ç»´åº¦ï¼Œå¹¶åˆ©ç”¨é˜µåˆ—å¹¿æ’­æ¥æ‰§è¡Œæ­¤æ“ä½œï¼Œè€Œä¸æ¶‰åŠä»»ä½•å¾ªç¯ã€‚

TensorFlow çš„ [einsum()](https://www.tensorflow.org/api_docs/python/tf/einsum) å‡½æ•°å¯ç”¨äºè½»æ¾é‡å¡‘ç»´åº¦ã€‚ç®­å¤´å·¦è¾¹çš„å­—ç¬¦æè¿°è¾“å…¥å½¢çŠ¶ï¼Œå³è¾¹çš„å­—ç¬¦æè¿°è¾“å‡ºå½¢çŠ¶ã€‚å›¾åƒå’Œè¿‡æ»¤å™¨çš„å°ºå¯¸ä»¥è¿™æ ·ä¸€ç§æ–¹å¼é‡æ–°æ’åˆ—ï¼Œå³å½“è®¡ç®—å…ƒç´ ä¹˜ç§¯æ—¶ï¼Œæ‰€æœ‰æ‰¹æ¬¡å’Œæ‰€æœ‰è¾“å‡ºè¿‡æ»¤å™¨å°†è¢«[å¹¿æ’­](https://numpy.org/doc/stable/user/basics.broadcasting.html)ã€‚ä¹˜æ³•ä¹‹åï¼Œé€šè¿‡æ•´å½¢å’Œå‡å°è¾“å…¥æ»¤æ³¢å™¨ç»´åº¦æ¥æ¢å¤åˆå§‹å½¢çŠ¶ã€‚

## æ­¥éª¤ 5 â€”è®¡ç®—é€† 2D rFFT

[é€† FFT](https://www.tensorflow.org/api_docs/python/tf/signal/irfft2d) ç®€å•åœ°å–è‡ªå…·æœ‰ä¸ FFT ç›¸åŒçš„ fft_length å‚æ•°çš„æ»¤æ³¢ä¿¡å·:

```
out **=** tf**.**signal**.**irfft2d(filterd_image, fft_length**=**[image_shape[**-**2],image_shape[**-**1]])
```

## æ­¥éª¤ 6-ä»å¾ªç¯å·ç§¯é‡å»ºçº¿æ€§å·ç§¯

è®°ä½ï¼Œè¦ä»å¾ªç¯å·ç§¯é‡å»ºçº¿æ€§å·ç§¯ï¼Œæˆ‘ä»¬éœ€è¦æ‰§è¡Œä¸¤ä¸ªæ­¥éª¤:é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§å¡«å……é‡å¾ªç¯ç§»ä½ç»“æœã€‚ç¬¬äºŒï¼Œæˆ‘ä»¬éœ€è¦æˆªæ–­åˆ°æˆ‘ä»¬æ„Ÿå…´è¶£çš„åŒºåŸŸï¼Œæ‰€æœ‰æ‰¹æ¬¡çš„å›¾åƒçš„åˆå§‹å½¢çŠ¶å’Œæ–°çš„é€šé“æ•°ã€‚

```
#Circular shift
out **=** tf**.**roll(out,shift **=** [2*****padding,2*****padding],axis **=** [**-**2,**-**1]) #Truncation
out **=** tf**.**slice(out, 
               begin **=** [0, 0, padding, padding], 
               size**=**[input_shape[0], 
                     filter_shape[**-**1],  
                     input_shape[2], 
                     input_shape[3]]
               )
```

ä»…æ­¤è€Œå·²ï¼
ä¸‹é¢çš„ä»£ç æ˜¾ç¤ºäº†æ­¥éª¤ 1 åˆ° 6 çš„å®Œæ•´å®ç°:

> æ³¨æ„:å‚…ç«‹å¶åŸŸä¸­çš„å·ç§¯ä¹Ÿä»¥ TensorFlow å±‚çš„å½¢å¼å®ç°ï¼Œä½œä¸ºæˆ‘çš„ DeepSaki åŒ…çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥åœ¨ [GitHub](https://github.com/sascha-kirch/DeepSaki/blob/25613bd7d5a98e41aa2ce7a2da1b02abdcd2989f/DeepSaki/layers/fourier_layer.py#L5-L159) ä¸Šæ‰¾åˆ°æˆ–ä» [PyPi](https://pypi.org/project/DeepSaki/) ä¸‹è½½ã€‚

# ç¡®è®¤

ä½ å¯èƒ½ä¼šé—®è‡ªå·±:**ä½†æ˜¯è¿™çœŸçš„æœ‰ç”¨å—ï¼Ÿ**ä¸€èµ·æ¥çœ‹çœ‹å§ï¼æ‰€æœ‰éªŒè¯æ­¥éª¤éƒ½åŒ…å«åœ¨æœ¬æ–‡çš„[ç¬”è®°æœ¬ä¸­ã€‚](https://github.com/sascha-kirch/ML_Notebooks/blob/main/2D_FFTs.ipynb)

é¦–å…ˆï¼Œæˆ‘ä»¬å°†æŸ¥çœ‹ä¸¤ä¸ªå‡½æ•°çš„å†…æ ¸å¤§å°çš„æ‰§è¡Œæ—¶é—´(ç§’): [tf.nn.conv2d()](https://www.tensorflow.org/api_docs/python/tf/nn/conv2d) å’Œæˆ‘ä»¬çš„å®ç°ã€‚

![](img/dc27f6e9e91b8e0dbd75c2e51704c8b9.png)

2D å·ç§¯å’Œ 2D DFT å·ç§¯çš„æ‰§è¡Œæ—¶é—´ä¸å†…æ ¸å¤§å°ã€‚å›¾åƒå¤§å°:550x550x1ï¼Œæ‰¹æ¬¡:1ï¼Œè¿‡æ»¤å™¨:1(ä½œè€…)

æ­£å¦‚æ‚¨æ‰€æ–™ï¼Œ2D å·ç§¯çš„æ‰§è¡Œæ—¶é—´ä¼šéšç€å†…æ ¸å¤§å°çš„å¢åŠ è€Œå¢åŠ ã€‚å¦ä¸€æ–¹é¢ï¼Œæ— è®ºæ»¤æ³¢å™¨å¤§å°å¦‚ä½•ï¼Œ2D DFT å·ç§¯åœ¨æ‰§è¡Œæ—¶é—´ä¸Šæ˜¯æ’å®šçš„ã€‚è¿™æ˜¯å› ä¸ºæ»¤é•œè¢«å¡«å……åˆ°å›¾åƒçš„å¤§å°ã€‚å¦‚æœè¿‡æ»¤å™¨è¶Šå¤§ï¼Œå¡«å……çš„å€¼å°±è¶Šå°‘ã€‚

ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹è°ƒæŸ¥ç»“æœä¸­çš„å·®å¼‚ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬åœ¨ 720x720 åƒç´ çš„å›¾åƒä¸Šåº”ç”¨å¤§å°ä¸º 3x3 çš„å…·æœ‰ 8 ä¸ªè¿‡æ»¤å™¨çš„å†…æ ¸ã€‚æˆ‘ä»¬é€šè¿‡ä¸¤ç§ç®—æ³•è¿è¡Œå®ƒï¼Œå¹¶è®¡ç®—ç»å¯¹å·®çš„å¹³å‡å€¼å’Œæ ‡å‡†åå·®ã€‚

```
convResult **=** CalcConv(image, filter)
dftResult **=** CalcDFT2D(image, filter)

error **=** tf**.**math**.**abs(convResult**-**dftResult)
mean = tf**.**math**.**reduce_mean(error)
std = tf**.**math**.**reduce_std(error)# Mean Absolute Error: 0.001560982083901763
# Standard deviation: 0.0015975720016285777
```

å‡å€¼å’Œæ ‡å‡†å·®éƒ½å¾ˆä½ã€‚è¿™ç§å·®å¼‚æ¥è‡ªäºæ•°å­—çš„ä¸å‡†ç¡®æ€§ã€‚å½“è§‚å¯Ÿæ»¤æ³¢åçš„å›¾åƒå’Œç›¸åº”çš„æŒ¯å¹…è°±æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒä»¬æ˜¯ä¸å¯åŒºåˆ†çš„ã€‚

![](img/a8de33d0c0c4a944f1a13bf54dcdce4e.png)![](img/d7b4a0be2efa8ea1117e4a6f914ac4cd.png)

è¿‡æ»¤å›¾åƒå’Œ 2D å…‰è°±çš„ç›´æ¥æ¯”è¾ƒã€‚(ä¸Š)2D çº¿æ€§å·ç§¯(ä¸‹)2D DFT å·ç§¯ä½œè€…

# ç»“è®º

æˆ‘ä»¬å·²ç»äº†è§£äº†å·ç§¯å’Œ DFT èƒŒåçš„æ•°å­¦åŸºç¡€ï¼Œé€šè¿‡è§‚å¯Ÿä¸åŒçš„å…‰è°±è·å¾—äº†ä¸€äº›ç›´è§‰ï¼ŒæŸ¥çœ‹äº† TensorFlow ä¸­çš„ä»£ç ï¼Œå¹¶æœ€ç»ˆéªŒè¯äº†ç»“æœçš„æ­£ç¡®æ€§ã€‚

è®¾è®¡åœ¨é¢‘åŸŸè€Œä¸æ˜¯ç©ºé—´åŸŸå·¥ä½œçš„å±‚å¸¦æ¥äº†æ–°çš„æœºä¼šï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¤§è¾“å…¥å›¾åƒå’Œå¤§æ»¤æ³¢å™¨å°ºå¯¸ã€‚ç»•è¿‡é¢‘åŸŸä¼¼ä¹æœ‰æ‚–ç›´è§‰ï¼Œä½†å®é™…ä¸ŠåŠ å¿«äº†è®¡ç®—é€Ÿåº¦ã€‚

# è¿›ä¸€æ­¥é˜…è¯»å’Œé“¾æ¥

[](https://github.com/sascha-kirch/ML_Notebooks/blob/main/2D_FFTs.ipynb) [## ML _ Notebooks/2D _ ffts . ipynb at main sascha-kir ch/ML _ Notebooks

### æœºå™¨å­¦ä¹ ç›¸å…³ç¬”è®°æœ¬åˆé›†åˆ†äº«ã€‚â€”ML _ Notebooks/2D _ ffts . ipynb at mainâ€¦

github.com](https://github.com/sascha-kirch/ML_Notebooks/blob/main/2D_FFTs.ipynb) [](https://github.com/sascha-kirch/DeepSaki) [## GitHub - sascha-kirch/DeepSaki:å¯é‡ç”¨æœºå™¨å­¦ä¹ ä»£ç çš„é›†åˆï¼ŒåŒ…æ‹¬æ¨¡å‹â€¦

### æ¬¢è¿ AI enthuisiasts æ¥åˆ° DeepSakiï¼Œè¿™æ˜¯ä¸€ä¸ªå¯é‡ç”¨æœºå™¨å­¦ä¹ ä»£ç çš„é›†åˆã€‚ğŸ’ª ğŸ¤– ğŸ¤˜ä½¿ç”¨çš„ ML æ¡†æ¶æ˜¯â€¦

github.com](https://github.com/sascha-kirch/DeepSaki) [](https://pypi.org/project/DeepSaki/) [## è¿ªæ™®è¨åŸº

### æ¬¢è¿ AI enthuisiasts æ¥åˆ° DeepSakiï¼Œè¿™æ˜¯ä¸€ä¸ªå¯é‡ç”¨æœºå™¨å­¦ä¹ ä»£ç çš„é›†åˆã€‚:è‚Œè‚‰::æœºå™¨äºº::é‡‘å±:MLâ€¦

pypi.org](https://pypi.org/project/DeepSaki/)  [## å¾ªç¯å·ç§¯ä¸çº¿æ€§å·ç§¯:æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

### ä»€ä¹ˆæ˜¯å¾ªç¯å·ç§¯ï¼Œå®ƒä¸çº¿æ€§å·ç§¯æœ‰ä»€ä¹ˆä¸åŒï¼Ÿå·ç§¯çš„å®šä¹‰å’Œâ€¦

thewolfsound.com](https://thewolfsound.com/circular-vs-linear-convolution-whats-the-difference/)
# æ—¶é—´åºåˆ—åˆ†è§£

> åŸæ–‡ï¼š<https://towardsdatascience.com/time-series-decomposition-8f39432f78f9>

## å°†æ—¶é—´åºåˆ—åˆ†è§£æˆåŸºæœ¬çš„æ„å»ºå—

![](img/16c662816f557c4871fdf5ec2daa0b06.png)

å¥¥æ–¯æ›¼Â·æ‹‰çº³åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

# ä»‹ç»

å½“è¯•å›¾è·å¾—æ´å¯ŸåŠ›å¹¶æ‰¾åˆ°äº§ç”Ÿæœªæ¥é¢„æµ‹çš„æœ€ä½³æ¨¡å‹æ—¶ï¼Œç†è§£ä½ çš„ [**æ—¶é—´åºåˆ—**](https://en.wikipedia.org/wiki/Time_series) æ˜¯æœ€åŸºæœ¬çš„ã€‚å¤§å¤šæ•°æ—¶é—´åºåˆ—å¯ä»¥è¢«åˆ†è§£æˆä¸åŒçš„ [**æˆåˆ†**](https://en.wikipedia.org/wiki/Decomposition_of_time_series) æ¥å¸®åŠ©ä»¥ç»“æ„åŒ–çš„æ–¹å¼å¯¹å…¶è¿›è¡Œè¯Šæ–­ï¼Œæä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„åˆ†æå·¥å…·ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æƒ³è®¨è®ºè¿™äº›ä¸åŒçš„ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•è·å¾—å®ƒä»¬ï¼Œä»¥åŠæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨ Python è¿›è¡Œæ—¶é—´åºåˆ—åˆ†è§£ã€‚

# æ—¶é—´åºåˆ—ç»„ä»¶

æ—¶é—´åºåˆ—æ˜¯(ä¸»è¦)ä¸‰ä¸ªéƒ¨åˆ†çš„ç»„åˆ:*è¶‹åŠ¿*ã€*å­£èŠ‚æ€§*å’Œ*æ®‹å·®/ä½™æ•°*ã€‚è®©æˆ‘ä»¬é€ä¸€åˆ†æã€‚

[**è¶‹åŠ¿**](https://en.wikipedia.org/wiki/Linear_trend_estimation) **:** è¿™æ˜¯ç³»åˆ—çš„æ•´ä½“è¿åŠ¨ã€‚å®ƒå¯èƒ½æŒç»­å¢åŠ åŠ ç­æ—¶é—´ã€å‡å°‘åŠ ç­æ—¶é—´æˆ–ä¸¤è€…å…¼è€Œæœ‰ä¹‹ã€‚

[**å­£èŠ‚æ€§**](https://en.wikipedia.org/wiki/Seasonality) **:** åºåˆ—ä¸­ä»»ä½•æœ‰è§„å¾‹çš„å­£èŠ‚æ€§æ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œå†°æ·‡æ·‹çš„é”€é‡åœ¨å¤å­£é€šå¸¸é«˜äºå†¬å­£ã€‚è¦äº†è§£æ›´å¤šå…³äºå­£èŠ‚æ€§çš„çŸ¥è¯†ï¼Œè¯·æŸ¥çœ‹æˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç« :

[](/seasonality-of-time-series-5b45b4809acd)  

[**æ®‹å·®/ä½™æ•°**](https://otexts.com/fpp3/residuals.html) **:** è¿™æ˜¯æˆ‘ä»¬è€ƒè™‘äº†è¶‹åŠ¿å’Œå­£èŠ‚æ€§ä¹‹åå‰©ä¸‹çš„é‚£ä¸€ç‚¹ã€‚ä¹Ÿå¯ä»¥è®¤ä¸ºåªæ˜¯ [**ç»Ÿè®¡å™ªå£°**](https://www.statisticshowto.com/statistical-noise/) ã€‚

> æœ‰æ—¶ä¹Ÿæœ‰ä¸€ä¸ªå•ç‹¬çš„ [**å‘¨æœŸ**](https://otexts.com/fpp2/tspatterns.html) æˆåˆ†ï¼Œä½†å®ƒç»å¸¸è¢«å½’å…¥è¶‹åŠ¿æˆåˆ†ã€‚

# åŠ æ³•ä¸ä¹˜æ³•æ¨¡å‹

è¿™äº›ç»„ä»¶çš„ç»„åˆæ–¹å¼å–å†³äºæ‚¨çš„ç³»åˆ—çš„æ€§è´¨ã€‚å¯¹äºä¸€ä¸ª [***åŠ æ³•***](https://en.wikipedia.org/wiki/Additive_model) æ¨¡å‹æˆ‘ä»¬æœ‰:

![](img/fa40164a6413c280177fc7fb31788c6e.png)

ä½œè€…ç”¨ LaTeX å†™çš„æ–¹ç¨‹å¼ã€‚

è€Œå¯¹äºä¸€ä¸ª ***ä¹˜æ€§*** ç³»åˆ—:

![](img/2c4f8d7d70dfe02ad962482f1e6da6d9.png)

ä½œè€…ç”¨ LaTeX å†™çš„æ–¹ç¨‹å¼ã€‚

å…¶ä¸­ ***Y*** ä¸ºæ•°åˆ—ï¼Œ ***T*** ä¸ºè¶‹åŠ¿ï¼Œ ***S*** ä¸ºå­£èŠ‚æ€§ï¼Œ ***R*** ä¸ºæ®‹å·®åˆ†é‡ã€‚

å½“åºåˆ—å˜åŒ–çš„å¤§å°åœ¨ä¸€è‡´çš„ç»å¯¹æ•°å€¼èŒƒå›´å†…æ—¶ï¼ŒåŠ æ³•æ¨¡å‹æ˜¯æœ€åˆé€‚çš„ã€‚å¦ä¸€æ–¹é¢ï¼Œä¹˜æ³•æ¨¡å‹æ˜¯å½“ç³»åˆ—çš„æ³¢åŠ¨æ˜¯åœ¨ä¸€ä¸ªç›¸å¯¹çš„å’Œæˆæ¯”ä¾‹çš„è§„æ¨¡ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæ¯å¹´å¤å¤©çš„å†°æ·‡æ·‹é”€å”®é¢é«˜å‡º 1000ï¼Œé‚£ä¹ˆè¯¥æ¨¡å‹å°±æ˜¯å¯åŠ æ€§çš„ã€‚å¦‚æœæ¯å¹´å¤å¤©é”€å”®é¢æŒç»­å¢é•¿ 20%,ä½†æ˜¯ç»å¯¹é”€å”®é¢åœ¨å˜åŒ–ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¨¡å‹å°±æ˜¯ä¹˜æ³•æ¨¡å‹ã€‚æˆ‘ä»¬å°†åœ¨åé¢è®¨è®ºä¸€ä¸ªä¾‹å­ï¼Œè¿™ä¸ªä¾‹å­å°†ä½¿è¿™ä¸ªç†è®ºæ›´åŠ å…·ä½“ã€‚

å¯ä»¥é€šè¿‡ç®€å•çš„å¯¹æ•°å˜æ¢æˆ– [**Box-Cox å˜æ¢**](https://en.wikipedia.org/wiki/Power_transform) å°†ä¹˜æ³•æ¨¡å‹è½¬æ¢ä¸ºåŠ æ³•æ¨¡å‹:

![](img/926283e20488818b7d4f0710394474d6.png)

ä½œè€…ç”¨ LaTeX å†™çš„æ–¹ç¨‹å¼ã€‚

è¦äº†è§£å…³äº Box-Cox å˜æ¢çš„æ›´å¤šä¿¡æ¯ï¼Œæ‚¨å¯ä»¥é˜…è¯»æˆ‘ä»¥å‰çš„ä¸€ç¯‡æ–‡ç« :

[](/box-cox-transform-for-time-series-cc45f26082c6)  

# åˆ†è§£æ˜¯æ€ä¹ˆåšçš„ï¼Ÿ

æœ‰å¤šç§ç®—æ³•å’Œæ–¹æ³•å¯ä»¥å°†æ—¶é—´åºåˆ—åˆ†è§£ä¸ºä¸‰ä¸ªéƒ¨åˆ†ã€‚æˆ‘æƒ³å›é¡¾ä¸€ä¸‹ç»å…¸çš„[](https://www.openforecast.org/adam/classical-seasonal-decomposition.html)**æ–¹æ³•ï¼Œå› ä¸ºè¿™ç§æ–¹æ³•ç»å¸¸ä½¿ç”¨å¹¶ä¸”éå¸¸ç›´è§‚ã€‚**

*   **ä½¿ç”¨[ç§»åŠ¨/æ»šåŠ¨å¹³å‡å€¼](https://www.investopedia.com/terms/m/movingaverage.asp)è®¡ç®—è¶‹åŠ¿åˆ†é‡**ã€ *Tã€*ã€**ã€‚**
*   **å»è¶‹åŠ¿ç³»åˆ—ï¼Œ ***Y-T*** ä¸ºåŠ æ³•æ¨¡å‹ï¼Œ ***Y/T*** ä¸ºä¹˜æ³•æ¨¡å‹ã€‚**
*   **è®¡ç®—å­£èŠ‚æ€§æˆåˆ† ***S*** ï¼Œå–æ¯ä¸ªå­£èŠ‚å»è¶‹åŠ¿åºåˆ—çš„å¹³å‡å€¼ã€‚**
*   **å‰©ä½™åˆ†é‡ ***R*** è®¡ç®—å¦‚ä¸‹: ***R = Y-T-R*** å¯¹äºåŠ æ³•æ¨¡å‹ï¼Œ ***R = Y/(TR)*** å¯¹äºä¹˜æ³•æ¨¡å‹ã€‚**

**è¿˜æœ‰å…¶ä»–å‡ ç§åˆ†è§£æ–¹æ³•ï¼Œå¦‚ [**STL**](/stl-decomposition-how-to-do-it-from-scratch-b686711986ec) ï¼Œ[**X11**](https://otexts.com/fpp3/x11.html)**å’Œ [**å¸­ä½**](https://otexts.com/fpp3/seats.html) ã€‚è¿™äº›éƒ½æ˜¯å…ˆè¿›çš„æ–¹æ³•ï¼Œè¡¥å……äº†ä¼ ç»Ÿæ–¹æ³•çš„åŸºæœ¬æ–¹æ³•ï¼Œå¹¶æ”¹è¿›äº†å…¶ç¼ºç‚¹ã€‚****

# ****Python ä¸­çš„åˆ†è§£****

****è®©æˆ‘ä»¬å†æ¬¡å›é¡¾ä¸€ä¸‹ 1948 å¹´è‡³ 1961 å¹´é—´ç¾å›½èˆªç©ºå…¬å¸çš„ç»å…¸å®¢è¿é‡æ•°æ®:****

> ****æ•°æ®[æ¥è‡ªæ‹¥æœ‰ CC0 è®¸å¯è¯çš„ Kaggle](https://www.kaggle.com/datasets/ashfakyeafi/air-passenger-data-for-time-series-analysis) ã€‚****

****ä½œè€…ä»£ç è¦ç‚¹ã€‚****

****![](img/3af53709f3c5cce46b20cce879d99ab0.png)****

****ä½œè€…ç”¨ Python åˆ¶ä½œçš„æƒ…èŠ‚ã€‚****

****ä»è¯¥å›¾ä¸­ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°ä¸€ä¸ªå¢é•¿è¶‹åŠ¿å’Œä¸€ä¸ªå¹´åº¦å­£èŠ‚æ€§ã€‚è¯·æ³¨æ„ï¼Œæ³¢åŠ¨çš„å¤§å°éšç€æ—¶é—´çš„æ¨ç§»è€Œå¢åŠ ï¼Œå› æ­¤æˆ‘ä»¬æœ‰ä¸€ä¸ªä¹˜æ³•æ¨¡å‹ã€‚****

****æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ statsmodels å‡½æ•°[*seasonal _ decompose*](https://www.statsmodels.org/dev/generated/statsmodels.tsa.seasonal.seasonal_decompose.html)*åˆ†è§£æ—¶é—´åºåˆ—ï¼Œå¹¶åœ¨è°ƒç”¨è¯¥å‡½æ•°æ—¶æŒ‡å®šæˆ‘ä»¬æœ‰ä¸€ä¸ªâ€œä¹˜æ³•â€æ¨¡å‹:*****

*****ä½œè€…ä»£ç è¦ç‚¹ã€‚*****

*****![](img/5c300a1ee07a30e97eb3474f5695d57f.png)*****

*****ä½œè€…ç”¨ Python åˆ¶ä½œçš„æƒ…èŠ‚ã€‚*****

*****ä»ä¸Šé¢çš„å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¯¥å‡½æ•°ç¡®å®æˆåŠŸåœ°æ•è·äº†ä¸‰ä¸ªç»„ä»¶ã€‚*****

*****æˆ‘ä»¬å¯ä»¥é€šè¿‡åº”ç”¨ [*boxcox*](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.boxcox.html) Scipy å‡½æ•°ï¼Œä½¿ç”¨ Box-Cox å˜æ¢æ¥ç¨³å®šæ–¹å·®ï¼Œä»è€Œå°†æˆ‘ä»¬çš„åºåˆ—è½¬æ¢ä¸ºåŠ æ³•æ¨¡å‹:*****

*****ä½œè€…ä»£ç è¦ç‚¹ã€‚*****

*****![](img/c1834ec03c556e82d69acb35f5207137.png)*****

*****ä½œè€…ç”¨ Python åˆ¶ä½œçš„æƒ…èŠ‚ã€‚*****

*****åŒæ ·ï¼Œè¯¥å‡½æ•°ä¼¼ä¹å¾ˆå¥½åœ°æ•æ‰åˆ°äº†è¿™ä¸‰ä¸ªç»„ä»¶ã€‚æœ‰è¶£çš„æ˜¯ï¼Œæˆ‘ä»¬çœ‹åˆ°æ®‹å·®åœ¨æ—©äº›å¹´å’Œæ™šäº›å¹´æœ‰æ›´é«˜çš„æ³¢åŠ¨æ€§ã€‚åœ¨ä¸ºæ­¤ç³»åˆ—æ„å»ºé¢„æµ‹æ¨¡å‹æ—¶ï¼Œè¿™å¯èƒ½æ˜¯éœ€è¦è€ƒè™‘çš„å› ç´ ã€‚*****

# *****ç»“è®º*****

*****åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•å°†ä¸€ä¸ªæ—¶é—´åºåˆ—åˆ†è§£æˆä¸‰ä¸ªåŸºæœ¬éƒ¨åˆ†:è¶‹åŠ¿ã€å­£èŠ‚æ€§å’Œæ®‹å·®ã€‚è¿™ä¸‰ä¸ªéƒ¨åˆ†çš„ç»„åˆäº§ç”Ÿäº†ä½ è§‚å¯Ÿåˆ°çš„æ—¶é—´åºåˆ—ï¼Œæ ¹æ®å®ƒçš„æ€§è´¨ï¼Œå®ƒå¯ä»¥æ˜¯åŠ æ³•çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¹˜æ³•çš„ã€‚æœ‰å‡ ç§æŠ€æœ¯æ¥è¿›è¡Œåˆ†è§£ï¼Œå¦‚ STLï¼Œæµ·è±¹çªå‡»é˜Ÿå’Œ X11ï¼Œä½†æ˜¯æˆ‘æ›´å–œæ¬¢ç»å…¸çš„æ–¹æ³•ï¼Œå› ä¸ºå®ƒéå¸¸ç›´è§‚ã€‚èƒ½å¤Ÿåˆ†è§£æ—¶é—´åºåˆ—æœ‰åŠ©äºåŠ æ·±å¯¹æ•°æ®çš„ç†è§£ï¼Œä»è€Œæ›´å®¹æ˜“åšå‡ºæœªæ¥é¢„æµ‹ã€‚*****

*****è¿™ç¯‡æ–‡ç« ä¸­ä½¿ç”¨çš„å®Œæ•´ä»£ç å¯ä»¥åœ¨æˆ‘çš„ GitHub ä¸­æ‰¾åˆ°:*****

*****[](https://github.com/egorhowell/Medium-Articles/blob/main/Time%20Series/Time%20Series%20Tools/decomposition.py)  

# å‚è€ƒèµ„æ–™å’Œè¿›ä¸€æ­¥é˜…è¯»

*   *é¢„æµ‹:åŸç†ä¸å®è·µ:*ã€https://otexts.com/fpp2/ 

# å’Œæˆ‘è”ç³»ï¼

*   [*è¦æƒ³åœ¨åª’ä½“ä¸Šé˜…è¯»æ— é™çš„æ•…äº‹ï¼Œè¯·åŠ¡å¿…åœ¨è¿™é‡Œæ³¨å†Œï¼*](/@egorhowell/membership) ğŸ’œ
*   [*åœ¨æˆ‘å‘å¸ƒæ³¨å†Œé‚®ä»¶é€šçŸ¥æ—¶è·å¾—æ›´æ–°ï¼*T13*ğŸ˜€*](/subscribe/@egorhowell)
*   [*é¢†è‹±*](https://www.linkedin.com/in/egor-howell-092a721b3/) ğŸ‘”
*   [*ç¢ç¢å¿µ*](https://twitter.com/EgorHowell) ğŸ–Š
*   [*github*](https://github.com/egorhowell)*ğŸ–¥*
*   *[](https://www.kaggle.com/egorphysics)**ğŸ…***

> ***(æ‰€æœ‰è¡¨æƒ…ç¬¦å·ç”± [OpenMoji](https://openmoji.org/) è®¾è®¡â€”â€”å¼€æºè¡¨æƒ…ç¬¦å·å’Œå›¾æ ‡é¡¹ç›®ã€‚è®¸å¯è¯: [CC BY-SA 4.0](https://creativecommons.org/licenses/by-sa/4.0/#)********
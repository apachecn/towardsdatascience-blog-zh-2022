# ä»æ¯ä¸€ç¯‡æ–‡æœ¬ä¸­æå–æœ€å…ˆè¿›çš„è§è§£

> åŸæ–‡ï¼š<https://towardsdatascience.com/generating-state-of-the-art-text-embeddings-with-hardware-accessible-by-everyone-46bc7d084703>

## ä¸éœ€è¦ OpenAI GPT-3 å’Œç±»ä¼¼çš„å·¥å…·æ¥ä¸ºä½ çš„è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡è·å¾—æœ€å…ˆè¿›çš„è¯­ä¹‰æ–‡æœ¬æ´å¯Ÿã€‚

![](img/294d1aeb43cb7ec6a9d8df79fe730c38.png)

æ¥æº:ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›ä½œ

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¤§å‹è¯­è¨€æ¨¡å‹ï¼Œå¦‚ **GPT-3ï¼Œå¹¶ä¸èƒ½é€šè¿‡å…¶å¯†é›†çš„æ–‡æœ¬åµŒå…¥**ä¸ºè®¸å¤š NLP(è‡ªç„¶è¯­è¨€å¤„ç†)ä»»åŠ¡ç”Ÿæˆæœ€ä½³çš„è¯­ä¹‰æ–‡æœ¬æ´å¯Ÿï¼Œä»¥åŠ**å¦‚ä½•è®©æ¯ä¸ªäººéƒ½å¯ä»¥ç”¨å¹¿æ³›å¯ç”¨çš„ç¡¬ä»¶ç”Ÿæˆæœ€å…ˆè¿›çš„åµŒå…¥**ã€‚

![](img/24eff4faf4a265e42a65e20d98e64f57.png)

æ¥æº:å¼ºåŠ›èƒ¶æ¨¡å‹å¯¹æ¯”â€”å…¨é¢è¯„æµ‹[æ­¤å¤„](https://docs.google.com/spreadsheets/d/1Oe-v2zhYyFW3P1K-mLZME0pwxWMQ9qxP0fhZCRZ_XVA/edit?usp=sharing) â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›ä½œ

å¯†é›†æ–‡æœ¬åµŒå…¥æ˜¯ç¼–ç å•è¯å«ä¹‰çš„æ–‡æœ¬çš„çŸ¢é‡è¡¨ç¤ºã€‚è¿™æ ·ï¼Œæ„ä¹‰ç›¸è¿‘çš„è¯åœ¨çŸ¢é‡è¡¨ç¤ºä¸­æ˜¯ç›¸è¿‘çš„ã€‚è¿™äº›åµŒå…¥å¯¹äºå¤æ‚çš„ä»»åŠ¡éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚æ¯”è¾ƒæ–‡æœ¬å†…å®¹çš„ç›¸ä¼¼æ€§ã€è¯­ä¹‰æœç´¢ã€é‡Šä¹‰æŒ–æ˜ç­‰ã€‚åœ¨è¿‡å»çš„å‡ å¹´ä¸­ï¼Œè¯­è¨€æ¨¡å‹çš„è§„æ¨¡å‘ˆæŒ‡æ•°å¢é•¿ï¼Œç”±äºèµ„æºçš„é™åˆ¶ï¼Œè®¸å¤šä»ä¸šè€…å‡ ä¹ä¸å¯èƒ½ç”¨æœ€æ–°çš„æ¨¡å‹è¿›è¡Œå®éªŒã€‚æˆ‘å¯èƒ½æœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆç»™ä½ ğŸ˜‰ã€‚

![](img/d793d5a0cfb7f4852f040dae751dde8e.png)

æ¥æº:è’¸é¦ä¼¯ç‰¹ï¼Œä¼¯ç‰¹çš„è’¸é¦ç‰ˆæœ¬:æ›´å°ã€æ›´å¿«ã€æ›´ä¾¿å®œã€æ›´è½»â€”â€”[https://arxiv.org/pdf/1910.01108.pdf](https://arxiv.org/pdf/1910.01108.pdf)

# é—®é¢˜é™ˆè¿°å’Œå‰è¿›æ–¹å‘

æˆ‘ä»¬å¤§å¤šæ•°äººé¢ä¸´çš„é™åˆ¶æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰æƒé™æˆ–è´¢åŠ›éƒ¨ç½²å¤§å‹ GPU/TPU é›†ç¾¤æ¥è¿è¡Œå¤§å‹è¯­è¨€æ¨¡å‹ï¼Œå¦‚ T5ã€MPNet æˆ– GPT-3ã€‚ä¸ºäº†å…‹æœè¿™äº›é™åˆ¶å¹¶è·å¾—æœ€å…ˆè¿›çš„æ–‡æœ¬åµŒå…¥ï¼Œæˆ‘åœ¨ä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤ä¸ŠèŠ±äº†å¾ˆå¤šæ—¶é—´ï¼Œæˆ‘æƒ³ä¸ä½ ä»¬åˆ†äº«:

1.  åŸºäºæ‰€æœ‰ç›¸å…³è¯­è¨€æ¨¡å‹çš„æ€§èƒ½å’Œæ¨¡å‹å‚æ•°çš„æ•°é‡å¯¹å…¶è¿›è¡Œæ¯”è¾ƒå’Œæ’åºï¼Œä»¥æ‰¾åˆ°æœ€æœ‰æ•ˆçš„é¢„è®­ç»ƒæ¨¡å‹ã€‚
2.  åº”ç”¨å¹¶æ¯”è¾ƒä¸åŒçš„å¾®è°ƒæŠ€æœ¯å¦‚ä½•æé«˜é¢„è®­ç»ƒæ¨¡å‹çš„æ€§èƒ½ã€‚

# åŠ¨æœº

å½“ç„¶ï¼Œæˆ‘æœ‰è‡ªå·±çš„ç†ç”±ç”Ÿæˆé«˜è´¨é‡çš„æ–‡æœ¬åµŒå…¥ã€‚æˆ‘çš„ç›®æ ‡æ˜¯ä½¿ç”¨æ–‡æœ¬åµŒå…¥ä½œä¸ºæˆ‘è‡ªå·±çš„æ¨¡å‹çš„è¾“å…¥ï¼Œä»¥å¸®åŠ©å†³å®šæˆ‘è‡ªå·±çš„é‡‘èèµ„äº§é€‰æ‹©ã€‚ç”±äºæˆ‘æ”¶åˆ°äº†å¾ˆå¤šå…¬å¼€æˆ‘çš„æ¨¡å‹çš„è¯·æ±‚ï¼Œæˆ‘å‘èµ·äº†ä¸€ä¸ªåä¸º [**PinkLion**](https://www.pinklion.xyz/) çš„é¡¹ç›®ã€‚

æˆ‘è®¾è®¡äº† PinkLionï¼Œé€šè¿‡æä¾›å¯¹æ½œåœ¨é¢„æµ‹æ¨¡å‹çš„è®¿é—®ï¼Œå®ç°åŠ¨æ€æŠ•èµ„ç»„åˆä¼˜åŒ–å’Œèµ„äº§åˆ†æã€‚è¿™äº›æ¨¡å‹å¯ä»¥è®¿é—®æˆåƒä¸Šä¸‡åªè‚¡ç¥¨ã€åŸºé‡‘/ETF å’ŒåŠ å¯†è´§å¸çš„æ—¥å¸¸èµ„äº§æ•°æ®ã€‚

> è¯·éšæ„å°è¯•ï¼Œå¹¶åˆ†äº«åé¦ˆğŸ™ã€‚(è¿˜å¤„äºç²—ç•¥çŠ¶æ€) [www.pinklion.xyz](http://www.pinklion.xyz/)

[](https://www.pinklion.xyz/)  

# 1.æ ¹æ®æ€§èƒ½å’Œè§„æ¨¡å¯¹è¯­è¨€æ¨¡å‹è¿›è¡Œæ¯”è¾ƒå’Œæ’åº

ä½œä¸ºç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å¿…é¡»å¯¹ç°æœ‰çš„è¯­è¨€æ¨¡å‹ã€å®ƒä»¬çš„æ€§èƒ½ä»¥åŠå®ƒä»¬çš„è§„æ¨¡æœ‰ä¸€ä¸ªå¾ˆå¥½çš„äº†è§£ã€‚å› æ­¤ï¼Œç›®æ ‡æ˜¯åŸºäºå„ç§åŸºå‡†æµ‹è¯•ä»»åŠ¡æ¯”è¾ƒä¸åŒçš„è¯­è¨€æ¨¡å‹ï¼Œå¹¶ç¡®å®šå®ƒä»¬ç›¸å¯¹äºå…¶å‚æ•°æ•°é‡çš„è¡¨ç°å¦‚ä½•ã€‚

## æ¨¡å‹æ€§èƒ½çš„å®šä¹‰â€”èƒ¶æ°´å’Œå¼ºåŠ›èƒ¶

å°½ç®¡é˜…è¯»äº†å¤§é‡ç ”ç©¶è®ºæ–‡ï¼Œä½†ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå¾ˆå°‘å‘ç°è·¨å¤šä¸ªåŸºå‡†ä»»åŠ¡(å¦‚ SentEval [1]ã€GLUE [2]ã€SQuAD[3]ã€RACE [4]æˆ– SWAG [5])çš„å®Œå…¨é€æ˜çš„æ¨¡å‹è¯„ä¼°ã€‚åœ¨è¿›ä¸€æ­¥ç ”ç©¶è¿™ä¸ªè¯é¢˜åï¼Œæˆ‘å¾—å‡ºç»“è®ºï¼Œè®¤ä¸º[***ã€é€šç”¨è¯­è¨€ç†è§£è¯„æµ‹ã€‘ã€2ã€‘***](https://gluebenchmark.com/)*ä¼¼ä¹æ˜¯æœ€å¹¿æ³›ä½¿ç”¨çš„è¯„æµ‹è¯­è¨€æ¨¡å‹æ€§èƒ½çš„åŸºå‡†ã€‚*

> *GLUE æ˜¯ä¸€ä¸ªå·¥å…·å’Œæ•°æ®é›†çš„é›†åˆï¼Œç”¨äºè¯„ä¼°ä¸€ä¸ªæ¨¡å‹åœ¨ä¸€ç»„ä¹ä¸ªè‡ªç„¶è¯­è¨€ä»»åŠ¡ä¸­çš„æ€§èƒ½ã€‚è¿™ä¹é¡¹ä»»åŠ¡é›†ä¸­åœ¨æ–‡æœ¬ç›¸ä¼¼æ€§å’Œé‡Šä¹‰ã€åˆ†ç±»å’Œæ¨ç†é¢†åŸŸã€‚*

*æœ‰äº†è¿™ä¸ªç»“è®ºï¼Œæˆ‘å¼€å§‹æ”¶é›†æ‰€æœ‰ç›¸å…³è¯­è¨€æ¨¡å‹çš„ GLUE è¯„ä¼°ç»“æœã€‚å°½ç®¡ GLUE è¢«å¹¿æ³›ä½¿ç”¨ï¼Œä½†æ˜¯ä»ç„¶å¾ˆéš¾è·å¾—æ‰€æœ‰ç›¸å…³çš„åˆ†æ•°ï¼Œå°¤å…¶æ˜¯å¯¹äºè¾ƒå°çš„æ¨¡å‹ç‰ˆæœ¬ã€‚æœ¬æ–‡ä¸­çš„æ‰€æœ‰åç»­æ•°å­—éƒ½æ˜¯æŒ‰ç…§ä»¥ä¸‹é¡ºåºä» GLUE æ’è¡Œæ¦œã€æ¨¡å‹çš„ç ”ç©¶è®ºæ–‡æˆ–ç›¸åº”æ¨¡å‹çš„ Github é¡µé¢è·å¾—çš„ã€‚*

*å¯¹äºæ¯ä¸ªå¯¹å¦‚ä½•è¯¦ç»†ç»„æˆ [GLUE [2]](https://gluebenchmark.com/) åŸºå‡†æ„Ÿå…´è¶£çš„äººæ¥è¯´ï¼Œè¿™é‡Œæ˜¯ç»„æˆåŸºå‡†çš„ä»»åŠ¡åç§°ã€ç¼©å†™ã€æè¿°å’Œåº¦é‡ã€‚*

> *å¦‚æœæ‚¨å¯¹è¯¦ç»†çš„ç²˜åˆä»»åŠ¡ä¸æ„Ÿå…´è¶£ï¼Œè¯·è·³åˆ°ä¸‹ä¸€èŠ‚â€œ**æ¨¡å‹æ¯”è¾ƒå’Œæ’åâ€ã€‚***

*   ***è¯­è¨€å¯æ¥å—æ€§è¯­æ–™åº“(CoLA)** :åˆ¤æ–­ä¸€ä¸ªå¥å­çš„è¯­æ³•æ˜¯å¦æ­£ç¡®ã€‚â€” *æŒ‡æ ‡:é©¬ä¿®ç›¸å…³æ€§**
*   ***æ–¯å¦ç¦æƒ…æ„Ÿæ ‘åº“(SST-2)** : åˆ¤æ–­å¥å­æ˜¯æ­£é¢æƒ…æ„Ÿè¿˜æ˜¯è´Ÿé¢æƒ…æ„Ÿã€‚â€”â€”*å…¬åˆ¶:* *å‡†ç¡®åº¦**
*   ***å¾®è½¯ç ”ç©¶é™¢é‡Šä¹‰è¯­æ–™åº“(MRPC)** :åˆ¤æ–­ä¸¤ä¸ªå¥å­æ˜¯å¦æ˜¯å½¼æ­¤çš„é‡Šä¹‰ã€‚â€” *æŒ‡æ ‡:å‡†ç¡®æ€§/F1**
*   ***è¯­ä¹‰æ–‡æœ¬ç›¸ä¼¼åº¦åŸºå‡†(STS-B)** :ç¡®å®šä¸¤ä¸ªå¥å­çš„ç›¸ä¼¼åº¦ï¼Œåˆ†å€¼ä» 1 åˆ° 5ã€‚â€” *æŒ‡æ ‡:çš®å°”æ£®ç›¸å…³æ€§/æ–¯çš®å°”æ›¼ç›¸å…³æ€§**
*   ***é—®ç­”å¼è‡ªç„¶è¯­è¨€æ¨ç†(QNLI)** :åˆ¤æ–­é—®é¢˜çš„ç­”æ¡ˆæ˜¯å¦åœ¨ç¬¬äºŒå¥è¯ä¸­ã€‚(è¿™ä¸ªæ•°æ®é›†æ˜¯ä»ç­æ•°æ®é›†æ„å»ºçš„ã€‚)â€” *åº¦é‡:å‡†ç¡®åº¦**
*   *Quora é—®é¢˜å¯¹(QQP) :åˆ¤æ–­ä¸¤ä¸ªé—®é¢˜æ˜¯å¦è¯­ä¹‰ç­‰ä»·ã€‚â€” *æŒ‡æ ‡:å‡†ç¡®æ€§/F1**
*   ***å¤šä½“è£è‡ªç„¶è¯­è¨€æ¨ç†(MNLI)** :ç¡®å®šä¸€ä¸ªå¥å­æ˜¯å¦åŒ…å«ã€åé©³æˆ–ä¸ä¸€ä¸ªç»™å®šçš„å‡è®¾æ— å…³ã€‚(è¯¥æ•°æ®é›†æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸€ä¸ªç‰ˆæœ¬çš„éªŒè¯å’Œæµ‹è¯•é›†æ¥è‡ªåŒä¸€ä¸ªå‘è¡Œç‰ˆï¼Œå¦ä¸€ä¸ªç‰ˆæœ¬ç§°ä¸ºä¸åŒ¹é…ï¼Œå…¶ä¸­éªŒè¯å’Œæµ‹è¯•ä½¿ç”¨åŸŸå¤–ã€‚â€” *æŒ‡æ ‡:å‡†ç¡®åº¦**
*   ***è¯†åˆ«æ–‡æœ¬è•´æ¶µ(RTE)** :ç¡®å®šä¸€ä¸ªå¥å­æ˜¯å¦åŒ…å«ç»™å®šçš„å‡è®¾ã€‚â€” *æŒ‡æ ‡:å‡†ç¡®åº¦**
*   ***Winograd è‡ªç„¶è¯­è¨€æ¨ç†(WNLI)** :åˆ¤æ–­å«æœ‰åŒ¿åä»£è¯çš„å¥å­å’Œæ›¿æ¢äº†è¯¥ä»£è¯çš„å¥å­æ˜¯å¦åŒ…å«ã€‚(è¯¥æ•°æ®é›†æ˜¯ä» Winograd æ¨¡å¼æŒ‘æˆ˜æ•°æ®é›†æ„å»ºçš„ã€‚)â€” *åº¦é‡:å‡†ç¡®åº¦**

*é€šè¿‡å–æ‰€æœ‰ä»»åŠ¡çš„å¹³å‡å€¼æ¥è®¡ç®—æœ€ç»ˆçš„ç²˜åˆåˆ†æ•°ã€‚åƒ MRPC å’Œ STS-B è¿™æ ·æœ‰ä¸¤ä¸ªè·Ÿè¸ªæŒ‡æ ‡çš„ä»»åŠ¡é¦–å…ˆè¢«å¹³å‡ï¼Œç„¶åè¢«è®¤ä¸ºæ˜¯è¯¥ä»»åŠ¡çš„å•ä¸€å¾—åˆ†ã€‚*

*![](img/0345908321049bfb0265be32b499da06.png)*

*æ¥æº:èƒ¶æ°´ä»»åŠ¡æè¿°â€”è¡¨æ ¼å¯åœ¨æ­¤å¤„[æ‰¾åˆ°](https://docs.google.com/spreadsheets/d/1Oe-v2zhYyFW3P1K-mLZME0pwxWMQ9qxP0fhZCRZ_XVA/edit?usp=sharing) â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›å»º*

## *æ¨¡å‹æ¯”è¾ƒå’Œæ’åº*

*åœ¨å®šä¹‰äº†æˆ‘ä»¬å¦‚ä½•åº¦é‡æ¨¡å‹çš„æ€§èƒ½ä¹‹åï¼Œè¿™é‡Œæ˜¯æ”¶é›†åˆ°çš„ä¸åŒè¯­è¨€æ¨¡å‹å®¶æ—çš„è§è§£ã€‚ä¸‹è¡¨æ˜¾ç¤ºäº†æ¯ä¸ªæ¨¡å‹çš„å‚æ•°æ•°é‡ã€æ¨¡å‹çš„å†…å­˜å­˜å‚¨é‡(è¿™äº›æ•°å­—å·²ä» Tensorflow Hub æˆ–ç›¸åº”æ¨¡å‹çš„ Github é¡µé¢è·å¾—)ä»¥åŠä¸Šæ–‡æ‰€è¿°çš„ç²˜åˆåˆ†æ•°ã€‚æœ€åï¼Œ**æœ€åä¸€åˆ—*æ¨¡å‹æ€§èƒ½/å¤§å°æ¯”ç‡*æ˜¾ç¤ºäº†åŸºäºæ¨¡å‹çš„ç²˜åˆåˆ†æ•°åŠå…¶å‚æ•°æ•°é‡è®¡ç®—çš„æ¯”ç‡ã€‚***

> *æ¨¡å‹æ€§èƒ½/å°ºå¯¸æ¯”=ç²˜åˆåˆ†æ•°/æ¨¡å‹å‚æ•°æ•°é‡*

*æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å‹åœ¨ GLUE benchmark ä¸Šç”¨æ›´å°‘çš„å‚æ•°è¡¨ç°å¾—æ›´å¥½ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¯”ç‡å°±æ›´é«˜ã€‚å› æ­¤ï¼Œ*å‹å·æ€§èƒ½/å°ºå¯¸æ¯”*æ ä¸­çš„æ•°å­—è¶Šé«˜è¶Šå¥½ã€‚*

*![](img/0d6952d4476509de21c7adfcd07fc542.png)*

*æ¥æº:è¯­è¨€æ¨¡å‹å¯¹æ¯”â€”å…¨é¢è¯„æµ‹[æ­¤å¤„](https://docs.google.com/spreadsheets/d/1Oe-v2zhYyFW3P1K-mLZME0pwxWMQ9qxP0fhZCRZ_XVA/edit?usp=sharing) â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›ä½œ*

*ä»æ•´ä½“æ¥çœ‹ï¼Œå¾ˆæ˜æ˜¾ï¼Œéšç€æ¨¡å‹å°ºå¯¸çš„å¢åŠ ï¼Œæ€§èƒ½/å°ºå¯¸æ¯”è¿…é€Ÿé™ä½ã€‚å› æ­¤ï¼Œæ¨¡å‹ä¸­æ¯ä¸ªå¢åŠ çš„å‚æ•°éƒ½æœ‰å¾ˆå¼ºçš„æ”¶ç›Šé€’å‡ã€‚ç®€å•çœ‹ä¸€ä¸‹ Google[ã€11ã€‘](https://arxiv.org/pdf/1910.10683.pdf)å·²ç»å…¬å¸ƒçš„ T5 è½¦å‹å®¶æ—ï¼Œè¿™ä¸€ç‚¹å°±å˜å¾—éå¸¸æ˜æ˜¾ã€‚*

*![](img/78795ff74ee9e5303fdd84827f95d3eb.png)*

*æ¥æº:T5 å®¶æ—å¯¹æ¯”â€”å…¨é¢è¯„æµ‹[æ­¤å¤„](https://docs.google.com/spreadsheets/d/1Oe-v2zhYyFW3P1K-mLZME0pwxWMQ9qxP0fhZCRZ_XVA/edit?usp=sharing) â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›ä½œ*

*æœ€å°çš„ T5 å‹å· T5-small æ‹¥æœ‰ 6000 ä¸‡ä¸ªå‚æ•°ï¼Œç²˜åˆåˆ†æ•°ä¸º 77.4ï¼Œæ€§èƒ½/å°ºå¯¸æ¯”ä¸º 1.29ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæœ€å¤§çš„ T5 å‹å· T5â€“11B çš„èƒ¶åˆåˆ†æ•°ä¸º 90.3ï¼Œæ¯” T5-small é«˜ 12.9 åˆ†ã€‚*

*ä¸ºäº†å®ç° 12.9 ç‚¹æˆ– 16.6%çš„åˆ†æ•°å¢åŠ ï¼Œæ¨¡å‹å¤§å°å¿…é¡»ä» 6000 ä¸‡ä¸ªå‚æ•°å¢åŠ åˆ° 110 äº¿ä¸ªå‚æ•°ï¼Œå³å¢åŠ äº† 18300%ğŸ¤¯ã€‚*

*ç°åœ¨ä½ å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆ GPT-3 æ²¡æœ‰å‡ºç°åœ¨ä¸Šè¡¨ä¸­ã€‚åŸå› æ˜¯ GPT-3 ä¸æ˜¯åœ¨æ™®é€šèƒ¶æ°´åŸºå‡†ä¸Šæ­£å¼è¯„ä¼°çš„ï¼Œè€Œæ˜¯åœ¨[å¼ºåŠ›èƒ¶ã€6ã€‘](https://super.gluebenchmark.com/)åŸºå‡†ä¸Šè¯„ä¼°çš„ã€‚*

> *SuperGLUE æ˜¯åœ¨ image GLUE ä¹‹ååˆ›å»ºçš„ä¸€ä¸ªæ–°åŸºå‡†ï¼Œå®ƒå…·æœ‰ä¸€ç»„æ–°çš„æ›´éš¾çš„è¯­è¨€ç†è§£ä»»åŠ¡ã€‚*

*å¹¸è¿çš„æ˜¯ï¼Œå¼ºåŠ›èƒ¶æ’è¡Œæ¦œåˆ—å‡ºäº†æ™®é€šèƒ¶æ°´åŸºå‡†æµ‹è¯•ä¸­çš„ GPT-3 å’Œå¤šä¸ªå‹å·(ä¼¯ç‰¹-å¤§å·ã€ç½—ä¼¯å¡”-å¤§å·ã€T5â€“11B)ã€‚æ¯”è¾ƒä¼¯ç‰¹-åŸºåœ°å’Œ GPT-3ï¼ŒGPT-3 åªæœ‰æ›´é«˜çš„å¼ºåŠ›èƒ¶åˆ†æ•° 2.8 åˆ†(69.0 â†’ 71.8)ã€‚å°½ç®¡ GPT 3 å·çš„å‚æ•°æ˜¯å®ƒçš„ 1605 å€ã€‚åŒæ ·ï¼ŒRoBERTa-large å’Œ T5â€“11B çš„å‚æ•°æ¯” GPT-3 å°‘ï¼Œä½†å¾—åˆ†æ›´é«˜ï¼Œåˆ†åˆ«ä¸º 84.6 å’Œ 89.3ã€‚*

*![](img/24eff4faf4a265e42a65e20d98e64f57.png)*

*æ¥æº:å¼ºåŠ›èƒ¶å¯¹æ¯”â€”å…¨é¢è¯„æµ‹[æ­¤å¤„](https://docs.google.com/spreadsheets/d/1Oe-v2zhYyFW3P1K-mLZME0pwxWMQ9qxP0fhZCRZ_XVA/edit?usp=sharing) â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›ä½œ*

*äº†è§£åˆ°çœŸæ­£çš„å¤§å‹æ¨¡å‹ï¼Œå¦‚ GPT-3 åœ¨å¼ºåŠ›èƒ¶ä¸Šçš„è¡¨ç°ä¼˜äºå…¶ä»–æ¨¡å‹(ç½—ä¼¯å¡”-å¤§å‹å’Œ T5â€“11B)ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾ GPT-3 åœ¨æ™®é€šèƒ¶æ°´åŸºå‡†ä¸Šä¹Ÿä¼˜äºè¿™äº›æ¨¡å‹ã€‚*

*å›åˆ°æˆ‘ä»¬æ­£å¸¸çš„ GLUE æ¯”è¾ƒï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ç°æœ€ä½³*æ€§èƒ½/å¤§å°æ¯”*çš„è¯­è¨€æ¨¡å‹å®¶æ—æ˜¯ ALBERT (A Lite BERT) æ¨¡å‹ã€‚*

*![](img/07207f37525fdb10bc88ab3594600221.png)*

*æ¥æº:é˜¿å°”ä¼¯ç‰¹å®¶æ—å¯¹æ¯”â€”å…¨é¢è¯„ä¼°[æ­¤å¤„](https://docs.google.com/spreadsheets/d/1Oe-v2zhYyFW3P1K-mLZME0pwxWMQ9qxP0fhZCRZ_XVA/edit?usp=sharing) â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›ä½œ*

*ALBERT-base æ¨¡å‹å®ç°äº†*çš„ **6.986** ï¼Œæ˜¯æ‰€æœ‰æµ‹è¯•è¯­è¨€æ¨¡å‹ä¸­æœ€é«˜çš„æ¯”ç‡ã€‚é«˜æ¯”ç‡å¯ä»¥è§£é‡Šä¸ºéå¸¸å¥½çš„èƒ¶åˆåˆ†æ•° 83.9ï¼ŒåŒæ—¶æ˜¯æ‰€æœ‰æµ‹è¯•æ¨¡å‹ä¸­æœ€å°çš„ï¼Œåªæœ‰ 1200 ä¸‡ä¸ªå‚æ•°ã€‚å› æ­¤ï¼ŒALBERT-base æä¾›äº†æ¯ä¸ªéƒ¨ç½²å‚æ•°çš„æœ€ä½³æ€§èƒ½ã€‚ç”±äºå‚æ•°æ•°é‡å¾ˆå°‘ï¼Œè‰¾ä¼¯ç‰¹-åŸºå’Œè‰¾ä¼¯ç‰¹-å¤§å¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ K80 æˆ– P100 GPU ä¸Šè®­ç»ƒã€‚**

## **æ¨¡å‹æ¯”è¾ƒçš„ç»“è®º**

**å½“ç”¨æœ‰é™çš„èµ„æºç”Ÿæˆå¯†é›†æ–‡æœ¬åµŒå…¥æ—¶ï¼Œæœ€å¥½è€ƒè™‘çš„æ¨¡å‹æ—æ˜¯ ALBERT æ—ã€‚åœ¨æ‰€æœ‰è¯„ä¼°çš„è¯­è¨€æ¨¡å‹ä¸­ï¼ŒALBERT-base å’Œ ALBERT-large å…·æœ‰æœ€å¥½çš„*æ€§èƒ½/å¤§å°æ¯”*ã€‚ä¸¤è€…éƒ½æœ‰ 1200 ä¸‡å’Œ 1800 ä¸‡ä¸ªå‚æ•°ï¼Œèƒ¶åˆåˆ†æ•°åˆ†åˆ«ä¸º 83.8 å’Œ 85.7ã€‚è¿™ä½¿å¾—è¿™ä¸¤ç§å‹å·æˆä¸ºæœ€å°çš„å‹å·ä¹‹ä¸€ï¼ŒåŒæ—¶æä¾›äº†ä¸ T5 å‹å·ç›¸å½“çš„æ€§èƒ½ï¼Œè€Œ T5 å‹å·åˆ™å¤§å¾—å¤šã€‚æ­¤å¤–ï¼ŒGPT-3 åœ¨ SuperGLUE åŸºå‡†æµ‹è¯•ä¸­è¡¨ç°ä¸ä½³ï¼Œå¦‚æœä¸‹æ¸¸ä»»åŠ¡ä¸æ–‡æœ¬ç”Ÿæˆæ— å…³ï¼Œåˆ™ä¸åº”è¯¥é€‰æ‹©å®ƒä½œä¸ºæ¨¡å‹ã€‚å®Œæ•´è¯„ä»·å¯ä»¥åœ¨ [**è¿™é‡Œ**](https://docs.google.com/spreadsheets/d/1Oe-v2zhYyFW3P1K-mLZME0pwxWMQ9qxP0fhZCRZ_XVA/edit?usp=sharing) æ‰¾åˆ°ã€‚**

**åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•ä½¿ç”¨ä¸åŒçš„å¾®è°ƒæŠ€æœ¯æ¥è¿›ä¸€æ­¥æé«˜ **ALBERT-base** çš„æ€§èƒ½ã€‚**

# **2.é€šè¿‡åº”ç”¨å’Œæ¯”è¾ƒä¸åŒçš„å¾®è°ƒæŠ€æœ¯æ¥æé«˜é¢„è®­ç»ƒæ¨¡å‹çš„æ€§èƒ½**

**åœ¨é€‰æ‹©äº† ALBERT-base ä½œä¸ºæˆ‘ä»¬çš„è¯­è¨€æ¨¡å‹ä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨æƒ³è¦å¾®è°ƒä¸€èˆ¬è®­ç»ƒçš„æ¨¡å‹ï¼Œä½¿å®ƒæ›´é€‚åˆæˆ‘ä»¬è‡ªå·±çš„åº”ç”¨ç¨‹åºã€‚æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥å¾®è°ƒæ¨¡å‹ä»¥ç”Ÿæˆæ–‡æœ¬åµŒå…¥ã€‚ç„¶è€Œï¼Œä¸åŒçš„å¾®è°ƒæ–¹æ³•ä¼šå¯¼è‡´éå¸¸ä¸åŒçš„å®šæ€§ç»“æœã€‚å› ä¸ºæ¯”è¾ƒä¸åŒçš„å¾®è°ƒæŠ€æœ¯éœ€è¦ä»˜å‡ºå¤§é‡çš„åŠªåŠ›ï¼Œæ‰€ä»¥æˆ‘æƒ³åˆ†äº«æˆ‘è‡ªå·±çš„ç»“æœï¼Œä»¥ä¾¿å°†æ¥å…¶ä»–äººæ›´å®¹æ˜“ç†è§£ã€‚**

**åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ¯”è¾ƒä¸‰ç§ä¸åŒçš„å¾®è°ƒè¿‡çš„ ALBERTsï¼Œå®ƒä»¬éƒ½æ˜¯ç”¨ä¸åŒçš„å¾®è°ƒæŠ€æœ¯æ”¹å˜çš„ã€‚è¿™é‡Œæ˜¯ä¸åŒæ–¹æ³•å’Œç»“æœçš„åˆæ­¥æ¦‚è¿°ã€‚**

**![](img/320ff1274698686e7ebda89dba25e77d.png)**

**æ¥æº:æ¯”è¾ƒ ALBERT-base å¾®è°ƒæ¶æ„â€”å…¨é¢è¯„ä¼°[æ­¤å¤„](https://github.com/JanSchm/CapMarket/blob/master/bot_experiments/text%20embeddings/3-Evaluate_All_ALBERT_Classifiers.ipynb) â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›å»º**

1.  ****å†»ç»“è‰¾ä¼¯ç‰¹:**å†»ç»“è‰¾ä¼¯ç‰¹ç”±å¸¸è§„é¢„è®­ç»ƒè‰¾ä¼¯ç‰¹åŸºç¡€æ¨¡å‹ç»„æˆï¼Œè¯¥æ¨¡å‹è¢«å†»ç»“ï¼Œå› æ­¤åœ¨å¾®è°ƒæ—¶ä¸ä¼šæ›´æ–°å…¶å‚æ•°ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æœ‰ä¸€ä¸ªå¯è®­ç»ƒçš„åˆ†ç±»å¤´ï¼ŒåŒ…æ‹¬ä¸€ä¸ª dense å’Œä¸€ä¸ª softmax åˆ†ç±»å±‚ã€‚è¯¥æ¨¡å‹å°†ä½œä¸ºæˆ‘ä»¬çš„**åŸºçº¿åŸºå‡†**ï¼Œå› ä¸ºå®ƒå°†ä»£è¡¨ ALBERT-base åœ¨æ²¡æœ‰é‡å¤§å¾®è°ƒçš„æƒ…å†µä¸‹çš„è¡¨ç°ã€‚**
2.  **ç»è¿‡è®­ç»ƒçš„è‰¾ä¼¯ç‰¹:ç»è¿‡è®­ç»ƒçš„è‰¾ä¼¯ç‰¹å’Œå†°å†»çš„è‰¾ä¼¯ç‰¹æœ‰ç€å®Œå…¨ä¸€æ ·çš„æ¶æ„ï¼Œç„¶è€Œï¼Œæ‰€æœ‰çš„ç»„ä»¶éƒ½æ˜¯å®Œå…¨å¯ä»¥è®­ç»ƒå’Œå¾®è°ƒçš„ã€‚è¿™æ„å‘³ç€ ALBERT-base ç»„ä»¶å’Œåˆ†ç±»å¤´(å¯†é›†å±‚+ Softmax å±‚)å¯ä»¥é’ˆå¯¹åˆ†ç±»å¾®è°ƒä»»åŠ¡å®Œå…¨è°ƒæ•´å®ƒä»¬çš„æƒé‡ã€‚**
3.  ****æš¹ç½—é˜¿å°”ä¼¯ç‰¹:**æš¹ç½—é˜¿å°”ä¼¯ç‰¹çš„çµæ„Ÿæ¥è‡ªé€šç”¨[æš¹ç½—æ¡†æ¶ã€7ã€‘](https://proceedings.neurips.cc/paper/1993/file/288cc0ff022877bd3df94bc9360b9c5d-Paper.pdf)ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒåŒ…æ‹¬ä¸‰ä¸ªç›¸åŒçš„åŸºäºé˜¿å°”ä¼¯ç‰¹çš„ç½‘ç»œï¼Œè¿™äº›ç½‘ç»œä½¿ç”¨å…±äº«æƒé‡ã€‚é™¤äº†ä¸‰ä¸ªå­ç½‘ç»œä¹‹å¤–ï¼Œè¿˜ä¸ºåˆ†ç±»å¾®è°ƒä»»åŠ¡æ·»åŠ äº†ç”± softmax å±‚è¡¨ç¤ºçš„åˆ†ç±»å¤´ã€‚**

## **èµ„æ–™ç»„**

**ä¸ºäº†äº†è§£ä¸åŒçš„å¾®è°ƒæ–¹æ³•åœ¨ç°å®ä¸–ç•Œä¸­çš„æ¯”è¾ƒï¼Œæˆ‘é€‰æ‹©äº† [HuffPost æ–°é—»åˆ†ç±»æ•°æ®é›†ã€8ã€‘](https://www.kaggle.com/datasets/rmisra/news-category-dataset)ä½œä¸ºæ–‡æœ¬è¯­æ–™åº“ã€‚è¯¥æ•°æ®é›†åŒ…å« 2012 å¹´è‡³ 2018 å¹´é—´ä»ã€Šèµ«èŠ¬é¡¿é‚®æŠ¥ã€‹æ”¶é›†çš„ **200853** æ¡æ–°é—»è®°å½•ï¼Œæ ‡é¢˜å’Œæè¿°åˆ†å¸ƒåœ¨ 41 ä¸ªç‹¬ç‰¹çš„æ–°é—»ç±»åˆ«ä¸­ã€‚å› æ­¤ï¼Œè¿™ä¸ªæ•°æ®é›†éå¸¸é€‚åˆäºæŸ¥çœ‹æˆ‘ä»¬å¯ä»¥åœ¨å¤šå¤§ç¨‹åº¦ä¸Šé’ˆå¯¹åˆ†ç±»ä»»åŠ¡å¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒã€‚è¿™æ˜¯æ•°æ®é›†çš„ä¸€ä¸ªç¤ºä¾‹ã€‚**

**![](img/1816c7e350ce1c803829139dbd832af8.png)**

**æ¥æº:èµ«èŠ¬é¡¿é‚®æŠ¥æ–°é—»åˆ†ç±»æ•°æ®æ ·æœ¬â€”â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›å»º**

> **æˆ‘ä»¬å¾®è°ƒä»»åŠ¡çš„ç›®æ ‡æ˜¯æ ¹æ®ç»™å®šçš„æ–°é—»æ ‡é¢˜é¢„æµ‹æ–°é—»ç±»åˆ«ã€‚**

## **æ•°æ®å‡†å¤‡**

**ç”±äºæˆ‘ä»¬å¸Œæœ›ä»…ä½¿ç”¨æ–°é—»æ ‡é¢˜ä½œä¸ºè¾“å…¥æ¥é¢„æµ‹æ–°é—»ç±»åˆ«ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆå¸Œæœ›é€šè¿‡è®¡ç®—å’Œç»˜åˆ¶æ¯ä¸ªæ–°é—»æ ‡é¢˜çš„å­—ç¬¦å’Œå­—æ•°åˆ†å¸ƒæ¥è·å¾—æ•°æ®é›†çš„æ›´å¥½æ¦‚è¿°ã€‚**

**å¯¹äºæ–°é—»æ ‡é¢˜çš„å­—æ•°ï¼Œæœ€å°å­—æ•°ä¸º 0ï¼Œæœ€å¤§å­—æ•°ä¸º 44ï¼Œå¹³å‡ä¸€ä¸ªæ–°é—»æ ‡é¢˜æœ‰ 9 ä¸ªå­—ã€‚ç„¶è€Œï¼Œä»åˆ†å¸ƒæƒ…å†µæ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼Œç”±äºè®¸å¤šæ ‡é¢˜æœ‰å¤§é‡çš„å•è¯ï¼Œæ‰€ä»¥å¹³å‡å€¼è¢«å¤¸å¤§äº†ã€‚**

**æ–°é—»æ ‡é¢˜çš„å­—ç¬¦è®¡æ•°çš„åˆ†å¸ƒæ˜¾ç¤ºäº†ç±»ä¼¼çš„æƒ…å†µï¼Œå…¶ä¸­å¤§é‡æ ‡é¢˜å…·æœ‰å¤§é‡å­—ç¬¦ã€‚å¯¹äºå­—ç¬¦è®¡æ•°ï¼Œ0 æ˜¯æœ€å°è®¡æ•°ï¼Œ320 æ˜¯æœ€å¤§è®¡æ•°ï¼Œå¹³å‡ä¸€ä¸ªæ ‡é¢˜æœ‰ 57 ä¸ªå­—ç¬¦ã€‚**

**![](img/8b632d3d3b39cac0ad2ad61540440012.png)**

**æ¥æº:èµ«èŠ¬é¡¿é‚®æŠ¥æ–°é—»æ ‡é¢˜å•è¯å’Œå­—ç¬¦çš„æ¦‚ç‡åˆ†å¸ƒâ€”â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›å»º**

**ä¸ºäº†æé«˜è¾“å…¥æ•°æ®çš„è´¨é‡ï¼Œæˆ‘ä»¬åˆ é™¤äº†æ¯ä¸ªæ ‡é¢˜å°‘äº 10 ä¸ªå•è¯çš„æ‰€æœ‰æ–°é—»è®°å½•ã€‚åº”ç”¨æ­¤æ¡ä»¶**å°†è®°å½•æ•°é‡ä» 200853 å‡å°‘åˆ° 189339ã€‚****

**åˆ é™¤æ ‡é¢˜å°‘äº 10 ä¸ªå•è¯çš„æ‰€æœ‰è®°å½•ï¼Œå¹¶åº”ç”¨ 80/20 è®­ç»ƒå’ŒéªŒè¯æ•°æ®é›†æ‹†åˆ†åï¼Œç±»åˆ«åˆ†å¸ƒå¦‚ä¸‹æ‰€ç¤ºã€‚**

**![](img/190bda0ff9edea12e6c20a2e68f29cfc.png)**

**æ¥æº:èµ«èŠ¬é¡¿é‚®æŠ¥è®­ç»ƒå’ŒéªŒè¯æ‹†åˆ†æ–°é—»ç±»åˆ«â€”â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›å»º**

**ç°åœ¨å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªé«˜çº§åˆ«ä¸å¹³è¡¡ï¼Œä¸*æ”¿æ²»*æ˜¯å ä¸»å¯¼åœ°ä½çš„é˜¶çº§ã€‚è¿™ç§åå·®å°†åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­é€šè¿‡ç»™æ¯ä¸ªç±»åˆ†é…ä¸åŒçš„æƒé‡æ¥çº æ­£(ç¨åä¼šæœ‰æ›´å¤šçš„ä»‹ç»)ã€‚**

## **æ¯”è¾ƒå¾®è°ƒæŠ€æœ¯**

**åœ¨å¯¹æˆ‘ä»¬çš„ 3 ä¸ªæ¨¡å‹(*å†°å†»è‰¾ä¼¯ç‰¹*ã€*è®­ç»ƒè‰¾ä¼¯ç‰¹*ã€*æš¹ç½—è‰¾ä¼¯ç‰¹*)è¿›è¡Œäº†è®­ç»ƒä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨èƒ½å¤Ÿæ›´è¯¦ç»†åœ°æŸ¥çœ‹æ¨¡å‹çš„æ€§èƒ½ï¼Œè¯¥è®­ç»ƒæ•°æ®é›†å…·æœ‰ 160682 æ¡å¯¹æ–°é—»ç±»åˆ«è¿›è¡Œåˆ†ç±»çš„è®°å½•ã€‚**

**ä»¥ä¸‹æ‰€æœ‰æŒ‡æ ‡å‡æ¥è‡ªéªŒè¯æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†æ˜¾ç¤ºï¼Œä»æ•´ä½“æ¥çœ‹ï¼Œ ***æš¹ç½—é˜¿å°”ä¼¯ç‰¹*çš„æ€§èƒ½æœ€å¥½**ï¼Œï¼Œå…¶æ¬¡æ˜¯*å—è¿‡è®­ç»ƒçš„é˜¿å°”ä¼¯ç‰¹*ï¼Œç„¶åæ˜¯*å†·å†»é˜¿å°”ä¼¯ç‰¹*ã€‚**

> *****æš¹ç½—é˜¿å°”ä¼¯ç‰¹*å‡ ä¹åœ¨æ‰€æœ‰æŒ‡æ ‡ä¸Šè¡¨ç°æœ€ä½³****

**é¦–å…ˆæ¯”è¾ƒ*å†»ç»“çš„è‰¾ä¼¯ç‰¹*å’Œ*è®­ç»ƒçš„è‰¾ä¼¯ç‰¹*ï¼Œå‰è€…ä½¿ç”¨åŸºäºè‰¾ä¼¯ç‰¹çš„ç½‘ç»œçš„æœªæ”¹å˜çš„æƒé‡ï¼Œåè€…ç”±äºèµ«èŠ¬é¡¿é‚®æŠ¥çš„è®­ç»ƒè¿‡ç¨‹è€Œå…·æœ‰å¾®è°ƒçš„æƒé‡ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥çœ‹åˆ°æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚ç»è¿‡*è®­ç»ƒçš„è‰¾ä¼¯ç‰¹*çš„å‡†ç¡®ç‡ä¸º 58%ï¼ŒF1 å¾—åˆ†ä¸º 60%ï¼ŒAUC-micro å€¼ä¸º 0.996ï¼Œè€Œ*å†·å†»è‰¾ä¼¯ç‰¹*çš„å‡†ç¡®ç‡ä¸º 32%ï¼ŒF1 å¾—åˆ†ä¸º 35%ï¼ŒAUC-micro å€¼ä¸º 0.905ã€‚**

**![](img/f523e5186feb323bbe60f71e8ba84562.png)**

**æ¥æº:æ¯”è¾ƒ ALBERT-base å¾®è°ƒæŒ‡æ ‡â€”å…¨é¢è¯„ä¼°[æ­¤å¤„](https://github.com/JanSchm/CapMarket/blob/master/bot_experiments/text%20embeddings/3-Evaluate_All_ALBERT_Classifiers.ipynb) â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›å»º**

**ç¬¬äºŒæ­¥æ¯”è¾ƒ*siame ALBERT*æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œsiame ç‰ˆæœ¬åœ¨å‡ ä¹æ‰€æœ‰æŒ‡æ ‡ä¸Šéƒ½ä¼˜äºå…¶ä»–ä¸¤æ¬¾è½¦å‹ã€‚*æš¹ç½—é˜¿å°”ä¼¯ç‰¹*åœ¨éªŒè¯æ•°æ®é›†ä¸Šçš„å‡†ç¡®ç‡ä¸º 63%ï¼Œå‡ ä¹æ˜¯*å†·å†»é˜¿å°”ä¼¯ç‰¹*å‡†ç¡®ç‡çš„ä¸¤å€ï¼Œä¹Ÿé«˜äº*è®­ç»ƒè¿‡çš„é˜¿å°”ä¼¯ç‰¹*çš„å‡†ç¡®ç‡ã€‚ç»¼ä¸Šæ‰€è¿°ï¼ŒSiamese ALBERT çš„å‡†ç¡®ç‡ä¸º 63%ï¼ŒF1 åˆ†æ•°ä¸º 64%ï¼ŒAUC-micro å€¼ä¸º 0.946ï¼Œç•¥ä½äº*è®­ç»ƒè¿‡çš„ ALBERT* æ–¹æ³•çš„åŒç­‰åˆ†æ•°ã€‚**

**å› ä¸ºæˆ‘ä»¬æœ€åˆçš„ç›®æ ‡æ˜¯åˆ›å»ºæœ€å¥½çš„æ–‡æœ¬åµŒå…¥ï¼Œè¿™é‡Œæ˜¯ç”± Siamese ALBERT ç”Ÿæˆçš„åµŒå…¥ã€‚æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬ç¡®å®ä¸ºä¸åŒçš„æ–°é—»æ ‡é¢˜ç±»åˆ«å®ç°äº†ä¸åŒçš„èšç±»ã€‚æš¹ç½—åµŒå…¥çš„ä¸€ä¸ªæœ‰è¶£çš„ç‰¹å¾æ˜¯ï¼Œå®ƒä¸ä»…ä¸ºä¸åŒçš„ç±»åˆ«åˆ›å»ºèšç±»ï¼Œè€Œä¸”å…·æœ‰ç±»ä¼¼å†…å®¹çš„æ–°é—»æ ‡é¢˜ç±»åˆ«ï¼Œå¦‚ T *ä¸–ç•Œé‚®æŠ¥*ã€*ä¸–ç•Œé‚®æŠ¥*å’Œ*ä¸–ç•Œæ–°é—»*åœ¨åµŒå…¥ç©ºé—´ä¸­å½¼æ­¤é è¿‘ã€‚**

**![](img/a44c11606687b234c74244c16b2f420d.png)**

**æ¥æº:æš¹ç½—é˜¿å°”ä¼¯ç‰¹æ–°é—»æ ‡é¢˜åµŒå…¥â€”â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›å»º**

**ä¸åŒè¯„ä¼°æ­¥éª¤å’ŒåµŒå…¥ä»£çš„å®Œæ•´ä»£ç å¯åœ¨æˆ‘çš„**[**Github**](https://github.com/JanSchm/CapMarket/blob/master/bot_experiments/text%20embeddings/3-Evaluate_All_ALBERT_Classifiers.ipynb)ä¸Šè·å¾—ã€‚****

# ****æš¹ç½—é˜¿å°”ä¼¯ç‰¹çš„å®ç°****

****ä¸Šé¢ä»‹ç»çš„ *Siamese ALBERT* æ˜¯åœ¨ç¡¬ä»¶å—é™çš„æƒ…å†µä¸‹äº§ç”Ÿé«˜è´¨é‡æ–‡æœ¬åµŒå…¥çš„æœ€ä½³æ–¹æ³•ã€‚å› æ­¤ï¼Œæˆ‘ä¹Ÿæƒ³åˆ†äº«ä¸€ä¸‹*æš¹ç½—é˜¿å°”ä¼¯ç‰¹*æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠå¦‚ä½•å®ç°è¿™ä¸ªç½‘ç»œå¹¶é‡ç°ä¸Šé¢çš„ç»“æœã€‚****

****è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹éšè—åœ¨å•ä¸ª*è¿ä½“é˜¿å°”ä¼¯ç‰¹*ç›’å­åé¢çš„æ¶æ„çš„é«˜çº§è¡¨ç¤ºã€‚Siamese ALBERT ç”± 3 ä¸ªåŸºäº ALBERT çš„å­ç½‘ç»„æˆï¼Œè¿™äº›å­ç½‘ç›¸äº’åˆ†æ‹…é‡é‡ã€‚****

****![](img/e19ec9ee3fbcf8b75cf708a42730062d.png)****

****æ¥æº:æš¹ç½—ä¼Ÿä¸šç½‘ç»œå»ºè®¾â€” [ä»£å·](https://github.com/JanSchm/CapMarket/blob/master/bot_experiments/text%20embeddings/2-Train_Siamese_ALBERT_Classifier_TripletSemiHardLoss_.ipynb) â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›ä½œ****

****æš¹ç½—ç³»ç»Ÿçš„è¾“å…¥æ˜¯æ–‡æœ¬æ ‡é¢˜å’Œæ–°é—»ç±»åˆ«çš„ä¸‰å…ƒç»„ã€‚è¯¥ä¸‰å…ƒç»„ç”±æ¥è‡ªç›¸åŒç±»åˆ«çš„ä¸¤ä¸ªæ ‡é¢˜(ä¾‹å¦‚ï¼Œç±»åˆ«ä¸–ç•Œæ–°é—»)å’Œæ¥è‡ªä¸åŒç±»åˆ«çš„ä¸€ä¸ªæ ‡é¢˜(ä¾‹å¦‚ï¼Œç±»åˆ«æ”¿æ²»)ç»„æˆã€‚æ–‡æœ¬æ ‡é¢˜é€šè¿‡ä¸‰ä¸ªå­ç½‘ç»œï¼Œäº§ç”Ÿä¸‰ä¸ªè¾“å‡ºï¼Œè¿™äº›è¾“å‡ºè¢«ä¼ é€’åˆ°**ä¸‰å…ƒåŠç¡¬æŸå¤±å‡½æ•°**ï¼Œè¯¥å‡½æ•°è¯•å›¾ä½¿ä¸¤ä¸ªç›¸ä¼¼ç±»åˆ«çš„è¾“å…¥æ›´æ¥è¿‘ï¼ŒåŒæ—¶è¯•å›¾åœ¨åµŒå…¥ç©ºé—´å†…ä½¿å…·æœ‰ä¸åŒç±»åˆ«çš„ç¬¬ä¸‰ä¸ªè¾“å…¥çš„è¾“å…¥è¿œç¦»ã€‚å°½ç®¡çœ‹èµ·æ¥ä¸‰å…ƒè¿ä½“ç»“æ„æœ‰ 3 ä¸ªç½‘ç»œï¼Œä½†å®ƒåªæœ‰ä¸€ä¸ªç½‘ç»œä¸ºæ¯ä¸ªå­ç½‘æä¾›ç›¸åŒçš„æƒé‡ã€‚å› æ­¤ï¼Œå­ç½‘å½¼æ­¤å…±äº«å®ƒä»¬çš„æƒé‡ã€‚****

## ****ä¸‰é‡æŸå¤±****

****åœ¨ 2015 å¹´ã€9ã€‘çš„ [Face Net ç ”ç©¶è®ºæ–‡ä¸­å¼•å…¥äº†ä¸‰é‡æŸå¤±ï¼Œä»¥æ‰¾åˆ°ä¸€ç§å¯æ‰©å±•çš„æ–¹æ³•æ¥å¤„ç†äººè„¸è¯†åˆ«ç­‰ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡çš„ç‰¹ç‚¹æ˜¯ç±»åˆ«æ•°é‡å¤šè€Œæ¯ç±»æ ·æœ¬æ•°é‡å°‘ã€‚](https://arxiv.org/pdf/1503.03832.pdf)****

****![](img/35e22f878fc4f4d9c9048d64548890b8.png)****

****æ¥æº:ä¸‰é‡æŸå¤±åµŒå…¥å›¾â€”ç”±[ä½œè€…](https://medium.com/@janschmitz_80340/membership)åˆ›ä½œ****

****ä¸€èˆ¬æ¥è¯´ï¼Œä¸‰è”ä½“æŸå¤±-è¿ä½“ç»“æ„å¯ä»¥ç”¨äºéå¸¸ä¸åŒçš„ç›®çš„ï¼Œä¾‹å¦‚æ–‡æœ¬å’Œå›¾åƒç›¸ä¼¼æ€§ä»»åŠ¡ã€‚è¿™å¯ä»¥å½’å› äºè¿™æ ·çš„äº‹å®ï¼Œå³å®ƒå…è®¸ç›´æ¥å­¦ä¹ ä»å…¶è¾“å…¥åˆ°ç´§è‡´æ¬§å‡ é‡Œå¾—ç©ºé—´çš„æ˜ å°„ï¼Œå…¶ä¸­è·ç¦»ç›´æ¥å¯¹åº”äºç›¸ä¼¼æ€§çš„åº¦é‡ã€‚æ¢å¥è¯è¯´ï¼Œ**ä¸‰é‡æŸå¤±æœ€å°åŒ–é”šå’Œæ­£ä¹‹é—´çš„è·ç¦»ï¼Œæœ€å¤§åŒ–é”šå’Œè´Ÿä¹‹é—´çš„è·ç¦»**ã€‚é”šå’Œé˜³æ€§å…·æœ‰ç›¸åŒçš„ç±»åˆ«ï¼Œè€Œé˜´æ€§æ˜¯ä»ä¸åŒçš„ç±»åˆ«ä¸­å–æ ·çš„ã€‚*ä¸‰é‡æ€æŸå¤±*å‡½æ•°ç”±æ¬§æ‹‰è·ç¦»å‡½æ•°è¡¨ç¤ºã€‚****

****![](img/53111e6e26e6b3570535e218dec52c1a.png)****

****æ¥æº:ä¸‰é‡æŸå¤±å›¾è§£â€”[https://www.tensorflow.org/addons/tutorials/losses_triplet](https://www.tensorflow.org/addons/tutorials/losses_triplet)****

## ****æš¹ç½—é˜¿å°”ä¼¯ç‰¹å®æ–½****

****ä½†æ˜¯åœ¨æˆ‘ä»¬è¿·å¤±åœ¨ç†è®ºä¹‹å‰ï¼Œè®©æˆ‘ä»¬ä»å®ç°å¼€å§‹ã€‚ä¸€å¦‚æ—¢å¾€ï¼Œç¬¬ä¸€æ­¥æ˜¯åŠ è½½æ•°æ®é›†ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒæ˜¯ã€Šèµ«èŠ¬é¡¿é‚®æŠ¥ã€‹çš„æ•°æ®é›†ï¼Œéšåï¼Œæ¸…ç†å’Œå‡†å¤‡æ•°æ®ï¼Œä»¥ä¾¿å¯ä»¥æä¾›ç»™æˆ‘ä»¬çš„ç½‘ç»œã€‚è¿™äº›æ­¥éª¤å·²ç»åœ¨å‰é¢çš„ç« èŠ‚ä¸­ç®€è¦æè¿°è¿‡ï¼Œç”¨äºæ•°æ®å‡†å¤‡çš„ä»£ç ç»“åˆå®Œæ•´çš„å®ç°å¯ä»¥åœ¨ [**è¿™é‡Œ**](https://github.com/JanSchm/CapMarket/blob/master/bot_experiments/text%20embeddings/1-Train_Siamese_ALBERT_TripletSemiHardLoss.ipynb) æ‰¾åˆ°ã€‚****

****åœ¨æ¸…ç†å’Œå‡†å¤‡å¥½æˆ‘ä»¬çš„æ•°æ®ä¹‹åï¼Œæˆ‘ä»¬åŠ è½½ **ALBERT tokenizer** å¹¶è®¾ç½®ä¸€ä¸ªæ•°æ®ç”Ÿæˆå™¨å‡½æ•°ï¼Œä»¥å®ç°ä¸€ä¸ªçµæ´»çš„å®ç°ï¼Œå°†æˆ‘ä»¬çš„æ•°æ®æ‰¹é‡æä¾›ç»™ siamese æ¨¡å‹ã€‚****

****æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä» Tensorflow Hub åŠ è½½é¢„è®­ç»ƒçš„ ALBERT-base æ¨¡å‹ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæš¹ç½—è‰¾ä¼¯ç‰¹ç½‘ç»œé‡‡ç”¨ä¸‰ä¸ªè¾“å…¥(å•è¯ _ idã€æ©ç ã€ç±»å‹ _ id)ã€‚è¿™äº›ä¸æ˜¯ä¹‹å‰ä¸‰é‡æŸè€—è¾“å…¥çš„*é”šã€æ­£*å’Œ*è´Ÿ*,è€Œæ˜¯è‰¾ä¼¯ç‰¹æ¨¡å‹éœ€è¦çš„æ­£å¸¸è¾“å…¥ã€‚åœ¨ 3 ä¸ªå¹¶è¡Œè¾“å…¥ä¹‹åï¼ŒåŠ è½½çš„è‰¾ä¼¯ç‰¹åŸºç½‘ç»œè¢«åˆå¹¶åˆ°*æš¹ç½—è‰¾ä¼¯ç‰¹*ä¸­ä½œä¸ºå•ä¸€å±‚ï¼Œæˆ‘ä»¬å°†ä»å…¶ä¸­æå–*æ±‡é›†è¾“å‡º*æƒé‡å¹¶å°†å®ƒä»¬é¦ˆé€åˆ° 64 ç»´å¯†é›†å±‚ä¸­ã€‚å¯†é›†å±‚ä¹‹åæ˜¯ L2 å½’ä¸€åŒ–å±‚ï¼Œè€Œæœ€åçš„ **L2 å±‚å¯¹äºè®­ç»ƒæˆåŠŸè‡³å…³é‡è¦ï¼Œå¦åˆ™ç½‘ç»œä¼šæœ‰ä¸ç¨³å®šçš„è®­ç»ƒè¿­ä»£**å’Œé—®é¢˜æ”¶æ•›ã€‚****

****ä½ ç°åœ¨å¯èƒ½æƒ³çŸ¥é“:ä¸ºä»€ä¹ˆæ²¡æœ‰ 3 ä¸ªç‹¬ç«‹çš„å­ç½‘ç»œæˆ–ä¸åŒçš„è¾“å…¥æµæ¥ä¸ºç½‘ç»œæä¾›ä¸€ä¸ªé”šå®šçš„ã€ç§¯æçš„å’Œæ¶ˆæçš„ç±»ç¤ºä¾‹ï¼Ÿ****

****äº‹å®ä¸Šï¼Œæˆ‘åˆ†äº«çš„å®ç°ä¸éœ€è¦é…ç½®ç”± 3 ä¸ªå­ç½‘ç»œç»„æˆçš„ç½‘ç»œæ¶æ„ã€‚åœ¨å®šä¹‰æˆ‘ä»¬ç½‘ç»œçš„æŸè€—å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† [Tensorflow Addons ä¸‰é‡åŠç¡¬æŸè€—ã€10ã€‘](https://www.tensorflow.org/addons/tutorials/losses_triplet)å‡½æ•°å®ç°ï¼Œå®ƒåœ¨åå°å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚æŸå¤±å‡½æ•°ç¡®ä¿åœ¨æˆ‘ä»¬æ‘„å…¥çš„æ‰¹æ¬¡ä¸­æ‰¾åˆ°ä¸‰å…ƒç»„ã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºåœ¨çº¿å­¦ä¹ ï¼Œå¹¶ç¡®ä¿åªè®­ç»ƒ(åœ¨æˆ‘ä»¬çš„åŠç¡¬æŸå¤±å‡½æ•°çš„æƒ…å†µä¸‹)åŠç¡¬ä¸‰å…ƒç»„ã€‚****

****æ­¤å¤–ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥ä¿å­˜æˆ‘ä»¬çš„è®­ç»ƒè¿è¡Œã€‚æœ€åï¼Œæˆ‘ä»¬ç”¨ model.fit()å¯åŠ¨è®­ç»ƒè¿è¡Œã€‚è¿™äº›éƒ½æ˜¯è®­ç»ƒä¸€ä¸ªåˆç†çš„è¿ä½“ç½‘ç»œæ‰€éœ€çš„æ­¥éª¤ã€‚å®Œæ•´çš„ä»£ç å¯ä»¥åœ¨ è¿™é‡Œ [**è®¿é—®ã€‚**](https://github.com/JanSchm/CapMarket/blob/master/bot_experiments/text%20embeddings/1-Train_Siamese_ALBERT_TripletSemiHardLoss.ipynb)****

# ****ç»“è®º****

****å½“é¢ä¸´ç¡¬ä»¶é™åˆ¶æ—¶ï¼ŒALBERT-base å’Œ ALBERT-large æ˜¯ç”Ÿæˆé«˜è´¨é‡æ–‡æœ¬åµŒå…¥çš„ä¼˜ç§€è¯­è¨€æ¨¡å‹ã€‚è¿™ä¸¤ç§æ¨¡å¼éƒ½æ‹¥æœ‰ç›®å‰æ‰€æœ‰å¯ç”¨çš„é¢„è®­ç»ƒè¯­è¨€ç½‘ç»œä¸­æœ€å¥½çš„æ€§èƒ½/è§„æ¨¡æ¯”ä¹‹ä¸€ã€‚GPT-3 ä¸æ˜¯å…³äºè®¸å¤šè¯­è¨€ä»»åŠ¡çš„æœ€å…ˆè¿›çš„æ¨¡å‹ï¼Œå› æ­¤é™¤äº†è¯­è¨€ç”Ÿæˆåº”ç”¨ä¹‹å¤–ï¼Œä¸åº”è¯¥è€ƒè™‘ä½¿ç”¨å®ƒã€‚****

****ä½¿ç”¨å¾®è°ƒæŠ€æœ¯æ¥è¿›ä¸€æ­¥æé«˜æ¨¡å‹åœ¨å„ç§æŒ‡æ ‡ä¸Šçš„æ€§èƒ½ï¼Œä¸ä¼ ç»Ÿçš„å¾®è°ƒæ–¹æ³•ç›¸æ¯”ï¼Œsiamese æ¶æ„åœ¨æ€§èƒ½ä¸Šæœ‰æ‰€æé«˜ï¼Œä¼ ç»Ÿçš„å¾®è°ƒæ–¹æ³•åªæ˜¯åœ¨é¢„è®­ç»ƒç½‘ç»œä¹‹åæ·»åŠ å¾®è°ƒå¤´ã€‚****

****æˆ‘å¸Œæœ›æˆ‘çš„å‘ç°å¯ä»¥å¸®åŠ©äººä»¬åœ¨æœªæ¥å»ºç«‹è‡ªå·±çš„é¡¹ç›®å’Œäº§å“ã€‚****

> ****æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼****

## ****-ç®€Â·æ–½å¯†èŒ¨****

*   *******å¦‚æœä½ å–œæ¬¢è¿™ä¸ªï¼Œ*** [***è®¢é˜…***](https://medium.com/@janschmitz_80340/membership) ***åˆ°æˆ‘çš„åª’ä»‹è·å–æ›´å¤šå†…å®¹ï¼*******
*   *******ä½ ä¹Ÿå¯ä»¥*** [***å…³æ³¨æˆ‘ä¸Šåª’***](https://medium.com/subscribe/@janschmitz_80340)****
*   *******æˆ–***[***PinkLion***](https://www.pinklion.xyz/)***å¹¶ç»™æˆ‘ä¸€äº›åé¦ˆ*******

# ****å‚è€ƒèµ„æ–™:****

****[1] SentEval:å¥å­åµŒå…¥è¯„ä¼°å·¥å…·åŒ…[https://github.com/facebookresearch/SentEval](https://github.com/facebookresearch/SentEval)****

****[2]èƒ¶æ°´:é€šç”¨è¯­è¨€ç†è§£è¯„æµ‹[https://gluebenchmark.com/](https://gluebenchmark.com/)****

****[3]å°é˜Ÿ:å²ä¸¹ç¦é—®ç­”æ•°æ®é›†ã€https://rajpurkar.github.io/SQuAD-explorer/ ****

****[4] RACE:æ¥è‡ªè€ƒè¯•çš„å¤§è§„æ¨¡é˜…è¯»ç†è§£æ•°æ®é›†[https://arxiv.org/pdf/1704.04683.pdf](https://arxiv.org/pdf/1704.04683.pdf)****

****[5] SWAG:åŸºäºå¸¸è¯†æ¨ç†çš„å¤§è§„æ¨¡å¯¹æŠ—æ€§æ•°æ®é›†[https://arxiv.org/pdf/1808.05326.pdf](https://arxiv.org/pdf/1808.05326.pdf)****

****[6]å¼ºåŠ›èƒ¶:é€šç”¨è¯­è¨€ç†è§£ç³»ç»Ÿçš„ä¸€ä¸ªæ›´æ£˜æ‰‹çš„åŸºå‡†[https://arxiv.org/pdf/1905.00537.pdf](https://arxiv.org/pdf/1905.00537.pdf)https://super.gluebenchmark.com/****

****[7]ä½¿ç”¨â€œæš¹ç½—â€æ—¶é—´å»¶è¿Ÿç¥ç»ç½‘ç»œçš„ç­¾åéªŒè¯[https://proceedings . neur IPS . cc/paper/1993/file/288 cc 0 ff 022877 BD 3d f 94 BC 9360 B9 c5d-paper . pdf](https://proceedings.neurips.cc/paper/1993/file/288cc0ff022877bd3df94bc9360b9c5d-Paper.pdf)****

****[8]ç±³æ–¯æ‹‰ï¼Œé‡Œæ²™åœã€‚(2018).æ–°é—»ç±»åˆ«æ•°æ®é›†ã€‚10.13140/rg . 2 . 2 . 20331.18729 .[https://www . ka ggle . com/datasets/RMI SRA/news-category-dataset](https://www.kaggle.com/datasets/rmisra/news-category-dataset)â€”Misraï¼ŒRishabh & Groverï¼ŒJigyasaã€‚(2021).ä¸º ML é›•åˆ»æ•°æ®:æœºå™¨å­¦ä¹ çš„ç¬¬ä¸€æ­¥ã€‚****

****[9] FaceNet:äººè„¸è¯†åˆ«å’Œèšç±»çš„ç»Ÿä¸€åµŒå…¥ã€https://arxiv.org/pdf/1503.03832.pdf ****

****[10]tensor flow Addons loss:TripletSemiHardLossã€https://www.tensorflow.org/addons/tutorials/losses_triplet ****

****[11]ç”¨ç»Ÿä¸€çš„æ–‡æœ¬åˆ°æ–‡æœ¬è½¬æ¢å™¨æ¢ç´¢è¿ç§»å­¦ä¹ çš„æé™[https://arxiv.org/pdf/1910.10683.pdf](https://arxiv.org/pdf/1910.10683.pdf)****
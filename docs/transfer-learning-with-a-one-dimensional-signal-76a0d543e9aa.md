# ä¸€ç»´ä¿¡å·çš„è¿ç§»å­¦ä¹ 

> åŸæ–‡ï¼š<https://towardsdatascience.com/transfer-learning-with-a-one-dimensional-signal-76a0d543e9aa>

## åŠ ä¸Šæ•°æ®æ´å¯ŸåŠ›

![](img/f00b5d303ed8e2e474f8ce235c9b5119.png)

å›¾ç‰‡ä½œè€…ã€‚

## ç›®å½•

> â€”â€”[ç®€ä»‹](#dfab)
> â€”â€”[ä¿¡å·ç»Ÿè®¡](#16cd)
> â€”â€”[è·å–åŒè°±å›¾åƒ](#59b9)
> â€”â€”[è½½è·å›¾åƒ](#cdef)
> â€”â€”[åˆ›å»ºæ¨¡å‹](#9f93)
> â€”â€”[è®­ç»ƒå¹¶è¯„ä¼°](#74bc)
> â€”â€”[æŸè€—å’Œç²¾åº¦åº¦é‡](#7e17)
> â€”â€”[æ•°æ®æ´å¯Ÿ](#dc27)
> â€”â€”[ç»“è®º](#7814)

# ä»‹ç»

è¿ç§»å­¦ä¹ é‡ç”¨ä¸ºæ—§ä»»åŠ¡å»ºç«‹çš„æ¨¡å‹ä½œä¸ºæ–°ä»»åŠ¡çš„èµ·ç‚¹ã€‚æ¨¡å‹å‚æ•°è¢«å†»ç»“â€”å¯¹æ—§ä»»åŠ¡çš„è®­ç»ƒå·²ç»å®Œæˆã€‚VGG16 å°±æ˜¯è¿™æ ·ä¸€ä¸ªè®­ç»ƒæœ‰ç´ çš„æ¨¡å‹ã€‚è¿™æ˜¯ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œ(CNN)å¯¹å›¾åƒè¿›è¡Œåˆ†ç±»ã€‚å®ƒèµ¢å¾—äº† 2014 å¹´ ImageNet æŒ‘æˆ˜èµ›ã€‚

æˆ‘ä»¬ç¨å¾®ä¿®æ”¹ VGG16ï¼Œä½¿å…¶æˆä¸ºæ–°å›¾åƒçš„æœ‰æ•ˆåˆ†ç±»å™¨ã€‚æ¨¡å‹é‡ç”¨å¤§å¤§é™ä½äº†åŸ¹è®­æ—¶é—´å’Œæˆæœ¬ã€‚è¿™å°±æ˜¯è¿ç§»å­¦ä¹ çš„ç¥å¥‡ä¹‹å¤„ã€‚

æˆ‘ä»¬çš„æ•°æ®é›†æ˜¯ä»ä¸€ç»´ä¿¡å·äº§ç”Ÿçš„å›¾åƒã€‚ä¸€ç»´ä¿¡å·æ˜¯ä¸€æ¡ä¾§å‘å¼¯æ›²çš„çº¿ã€‚ä¿¡å·å¹…åº¦éšæ—¶é—´ä¸Šä¸‹ç§»åŠ¨ã€‚

![](img/cb75876166d00ce089c44990e276fd54.png)

ä¿¡å·å¹…åº¦éšæ—¶é—´çš„å˜åŒ–ã€‚ä¿¡å·æ˜¯ä¸€ç»´ï¼Œæ—¶é—´æ˜¯äºŒç»´ã€‚

å›¾åƒæ˜¯ä»æŒ¯åŠ¨ä¿¡å·ä¸­æå–çš„[åŒè°±](https://medium.com/@mackiej/fourier-and-bispectral-analysis-of-signals-c7a71021b1c8)å›¾åƒã€‚æ¯ä¸ªéƒ½æ˜¯ä» 4ï¼Œ095 (2 -1)ä¸ªæ•°æ®ç‚¹æ®µæ„å»ºçš„ã€‚

![](img/c63fc5d4439d8eb45f818d8fe8b577f5.png)

æ˜¾ç¤ºæ³µæ°”èš€çš„åŒè°±å›¾åƒã€‚

æŒ¯åŠ¨ä¿¡å·æ˜¯ä»¥ 16ï¼Œ000 Hz é‡‡æ ·çš„æ³µåŠ é€Ÿè®¡æ•°æ®ã€‚å·¥ç¨‹å¸ˆè®°å½•äº†ä¸‰ç§å–æ ·æ¡ä»¶ã€‚é€šè¿‡é€æ˜çš„æ³µå£³[ [1](#b35f) ]è§‚å¯Ÿæ¯ç§æƒ…å†µã€‚

**ä¸‰ä¸ªä¿¡å·:**

1.  **æ— æ°”èš€** (nc) â€”æ³µæ­£å¸¸è¿è¡Œ
2.  **ä½æ±½èš€**ã€LCã€‘**â€”å°æ°”æ³¡äº‘**
3.  ****äº§ç”Ÿæ°”èš€**(ç›´æµ)â€”â€”å¤§å›¢æ°”æ³¡**

**![](img/d0b9bf22fe8bb618911222b4ff4ff08a.png)**

**ä»¥ 16000Hz é‡‡æ ·çš„æ³µåŠ é€Ÿè®¡ä¿¡å·ã€‚ä»ä¸Šåˆ°ä¸‹ï¼Œæ¡ä»¶ä¸ºæ— æ°”èš€ã€ä½æ°”èš€å’Œå‘å±•æ°”èš€ã€‚**

## **ä¿¡å·ç»Ÿè®¡**

**æ¯ä¸ªåŠ é€Ÿåº¦è®¡ä¿¡å·æœ‰ 800ï¼Œ001 ä¸ªæ•°æ®ç‚¹(16ï¼Œ000 Hz æ—¶ä¸º 50 ç§’)ã€‚æ¯ä¸ªçš„å¹³å‡æŒ¯å¹…ä¸ºé›¶ã€‚**

**![](img/4465ca5e0070d4f221419ac54c81184c.png)**

**ç†ŠçŒ«ç»Ÿè®¡æ— /ä½/å‘å±•ç©ºåŒ–ä¿¡å·ã€‚**

**è¿™ä¸‰ä¸ªæ¡ä»¶çš„é…å¯¹å›¾æ˜¾ç¤ºå®ƒä»¬ä¹‹é—´å‡ ä¹æ²¡æœ‰ç›¸å…³æ€§ã€‚åœ¨è¿™ä¸ªæ ·æœ¬ä¸­ï¼Œå‘å±•çš„ç©ºåŒ–(dc1)çŠ¶æ€çœ‹èµ·æ¥æ˜¯é«˜æ–¯å‹çš„ã€‚æˆ‘ä»¬ç¨åå†è®¨è®ºè¿™ä¸ªé—®é¢˜çš„é‡è¦æ€§ã€‚**

**![](img/0328cd33b9dbaa906cd6b3f915bfea1b.png)**

**å›¾ç‰‡ä½œè€…ã€‚( [GitHub è¦è¯€](https://gist.github.com/jkmackie/2a5e455fd8072ccc81daeeee1eb6f18a))**

## **è·å–åŒè°±å›¾åƒ**

**å›¾åƒå’Œä¿¡å·ä¿å­˜åœ¨è¿™ä¸ª [GitHub repo](https://github.com/jkmackie/transfer_learning_VGG16) ä¸­ã€‚è¦è‡ªå·±åˆ›å»ºå›¾åƒï¼Œè¯·éµå¾ªä»¥ä¸‹æ–¹æ³•:**

1.  **ä½¿ç”¨`joblib.load(â€˜signals.joblibâ€™)`åŠ è½½æ¯ä¸ªä¿¡å·çš„ç†ŠçŒ«æ•°æ®å¸§:nc1 å’Œ dc1ã€‚å°†ä¿¡å·åˆ†å‰²æˆä¸é‡å çš„ 4ï¼Œ095 ä¸ªç‚¹æ®µã€‚ä½¿ç”¨è¿™ç§æŠ€æœ¯ï¼Œä¸€ä¸ª 800ï¼Œ000 ç‚¹çš„ä¿¡å·æœ‰ 195 ä¸ªå›¾åƒã€‚**
2.  **ä½œè€…çš„åŒè°±ä»£ç (ä¸‹é¢çš„åŒè°± 2D)ä»ä¿¡å·æ®µ`y` [ [2](#01cb) ]åˆ›å»ºåŒè°±å›¾åƒã€‚åœ¨ç¬¬ 104 è¡Œå®ä¾‹åŒ– Bispectrum2Dã€‚ä½¿ç”¨`freqsample=16,000`å’Œ`window_name=â€™hanningâ€™`ã€‚Hanning æ˜¯ç”¨äºæœªçŸ¥ä¿¡å·çš„å¸¸ç”¨çª—å£ã€‚è¦ç»˜åˆ¶å›¾åƒï¼Œè¯·ä½¿ç”¨`bs2D.plot_bispec_magnitude()`ã€‚**
3.  **ä¿å­˜æ¯ä¸ªå›¾åƒã€‚æˆ‘å¼ºçƒˆå»ºè®®åœ¨æ¯ä¸ªæ–‡ä»¶åä¸­ä¿å­˜ç´¢å¼•ã€‚è¿™ä½¿å¾—å°†æ¥åˆ†ç¦»æµ‹è¯•å›¾åƒå˜å¾—å®¹æ˜“ã€‚`plt.savefig(fâ€™./images/{feature_name}_hanning_{start_idx}-{end_idx}.pngâ€™)`**
4.  **[å°†](https://gist.github.com/jkmackie/70ada8c662e3dd7a2b0da05ca3d05c1f)å›¾åƒæ ¼å¼åŒ–ä¸º 224x224 åƒç´ ã€‚è¿™æ˜¯ VGG16 æ‰€éœ€çš„å°ºå¯¸ã€‚**
5.  **ä½¿ç”¨ VGG16 **é¢„å¤„ç† _ è¾“å…¥**åº“:**

**`from tensorflow.keras.applications.vgg16 import preprocess_input`**

**å®ƒå°†å›¾åƒä» RGB è½¬æ¢åˆ° BGRã€‚æ­¤å¤–ï¼Œâ€œæ¯ä¸ªé¢œè‰²é€šé“ç›¸å¯¹äº ImageNet æ•°æ®é›†ä»¥é›¶ä¸ºä¸­å¿ƒï¼Œæ²¡æœ‰ç¼©æ”¾ã€‚â€**

> ****åŒè°± 2D Python æ•°æ®ç±»:****

**ä» 1D ä¿¡å·äº§ç”Ÿ 2D åŒè°±å›¾åƒã€‚ä½œè€…çš„ Python æ•°æ®ç±»ã€‚( [GitHub](https://gist.github.com/jkmackie/388344f86e29c4841077f74a95bad6df) )**

*****å…³äºåŒè°±çš„æ—æ³¨ 2D:*** *è®¡ç®—æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å®ç°â€”â€”ä¸éœ€è¦ Python ç±»ç»§æ‰¿æ¥è§¦ç‚¹ï¼Œä¹Ÿä¸éœ€è¦æœ¯è¯­ç¿»è¯‘ã€‚ä½œè€…å°†ä¸¤ä¸ª Python ç±»é‡æ„ä¸ºä¸€ä¸ª dataclassã€‚åŒè°± 2D è‡ªåŠ¨ä»é‡‡æ ·é¢‘ç‡äº§ç”Ÿé¢‘ç‡èŒƒå›´ã€‚***

## **åŠ è½½å›¾åƒ**

**æ¯ä¸ªå›¾åƒç±»éƒ½æœ‰ä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚â€œè®­ç»ƒâ€æ–‡ä»¶å¤¹å·²æ ‡è®°äº†ç”¨äºè®­ç»ƒæ¨¡å‹çš„å›¾åƒã€‚æœ‰æ•ˆç”¨äºåŸ¹è®­æœŸé—´çš„æ¨¡å‹è°ƒæ•´å’Œåº¦é‡ã€‚æµ‹è¯•(åˆåç»´æŒ)æ˜¯çœ‹ä¸è§çš„å›¾åƒï¼Œä»¥éªŒè¯æ¨¡å‹çš„æ™®éæ€§ã€‚æˆ‘ä»¬å°†è¿›è¡Œä»¥ä¸‹äºŒè¿›åˆ¶åˆ†ç±»åœºæ™¯:æ— ç©ºåŒ–ä¸ç›´æ¥ç©ºåŒ–[ [3](#e63b) ]ã€‚**

**![](img/08ffcf0d8d49611aea1372d5714e4e76.png)**

**æ–‡ä»¶å¤¹ç»“æ„:nc =æ— æ°”èš€ï¼›dc =ç›´æ¥ç©ºåŒ–ã€‚ç”±äºæ‹…å¿ƒæ•°æ®æ³„æ¼ï¼Œä½œè€…é€‰æ‹©å°†æœ‰æ•ˆæ–‡ä»¶å¤¹ä¸åˆ—è½¦æ–‡ä»¶å¤¹åˆ†å¼€ã€‚Tensorflow API å¯ä»¥åŠ¨æ€åœ°å°†è®­ç»ƒåˆ†æˆè®­ç»ƒå’ŒéªŒè¯æ•°æ®ã€‚**

**ä» [GitHub repo](https://github.com/jkmackie/transfer_learning_VGG16) ä¸‹è½½å›¾åƒæ•°æ®é›†ã€‚å‚è§ç”¨ Python ç¼–å†™çš„è¿ç§»å­¦ä¹  Jupyter ç¬”è®°æœ¬ã€‚**

**æˆ‘ä»¬å¦‚ä½•ä¸ºå›¾åƒå»ºæ¨¡ï¼ŸTensorFlow 2 æ˜¯å›¾åƒæ¨¡å‹çš„è½¯ä»¶å·¥å…·ã€‚**

**åœ¨å¼ é‡æµä¸­åˆ›å»ºå›¾åƒæ•°æ®é›†ã€‚è¯¦æƒ…å¦‚ä¸‹ã€‚æœ‰ 210 å¹…è®­ç»ƒå›¾åƒå’Œ 60 å¹…éªŒè¯å›¾åƒã€‚æ¯ä¸ªä¸­çš„å›¾åƒéƒ½æ˜¯äº’æ–¥çš„ã€‚æ­¤å¤–ï¼ŒéªŒè¯å›¾åƒåœ¨æ—¶é—´ä¸Šåœ¨è®­ç»ƒå›¾åƒä¹‹å(ä¿¡å·æ˜¯æ—¶é—´åºåˆ—)ã€‚**

> **ç”¨äºæ¨¡å‹æ‹Ÿåˆçš„å›¾åƒæ•°æ®é›†:**

**åŠ è½½ VGG16ã€‚è·å–å¹¶å¯è§†åŒ–æ•°æ®ã€‚**

**![](img/e9adb67671719ac685e7d4ea016613a9.png)**

**ä» RGB åˆ° BGR çš„ VGG16 ç‰¹å®šé¢„å¤„ç†åçš„åŒè°±å›¾åƒã€‚**

## **åˆ›å»ºæ¨¡å‹**

**è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æ•°æ®é›†ç»“æ„ã€‚å®ƒå°†å¦‚ä½•ä¸ VGG16 é…åˆä½¿ç”¨ï¼Ÿ**

**æˆ‘ä»¬ä¸€æ‰¹é€‰æ‹© 32 å¼ å›¾ç‰‡ã€‚è¿™äº›å›¾åƒæ˜¯ 224 X 224 çš„ã€‚3 è¡¨ç¤ºçº¢è‰²ã€ç»¿è‰²å’Œè“è‰²(RGB)é€šé“ã€‚**

```
1 train class names: ['dc', 'nc']
2 val class names: ['dc', 'nc']
3 images, xpixels, ypixels, color_channels: (32, 224, 224, 3)
4 labels: (32,)
```

**åœ¨ä¸‹é¢çš„ç¬¬ 3 è¡Œï¼Œæˆ‘ä»¬åˆå§‹åŒ– VGG16ã€‚å®ƒæœ‰å°†è¿‘ 1500 ä¸‡ä¸ªå‚æ•°ã€‚å®ƒä»¬è¢«è®¾ç½®ä¸ºä¸å¯è®­ç»ƒï¼Œå› æ­¤è¢«å†»ç»“ã€‚æ­¤å¤–ï¼Œæœ€åå‡ ä¸ªåˆ†ç±»å±‚è¢«æ’é™¤:include_top = Falseã€‚**

```
Model: "vgg16"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 input_5 (InputLayer)        [(None, 224, 224, 3)]     0         

 block1_conv1 (Conv2D)       (None, 224, 224, 64)      1792      

 block1_conv2 (Conv2D)       (None, 224, 224, 64)      36928     

 block1_pool (MaxPooling2D)  (None, 112, 112, 64)      0         

 block2_conv1 (Conv2D)       (None, 112, 112, 128)     73856     

 block2_conv2 (Conv2D)       (None, 112, 112, 128)     147584    

 block2_pool (MaxPooling2D)  (None, 56, 56, 128)       0         

 block3_conv1 (Conv2D)       (None, 56, 56, 256)       295168    

 block3_conv2 (Conv2D)       (None, 56, 56, 256)       590080    

 block3_conv3 (Conv2D)       (None, 56, 56, 256)       590080    

 block3_pool (MaxPooling2D)  (None, 28, 28, 256)       0         

 block4_conv1 (Conv2D)       (None, 28, 28, 512)       1180160   

 block4_conv2 (Conv2D)       (None, 28, 28, 512)       2359808   

 block4_conv3 (Conv2D)       (None, 28, 28, 512)       2359808   

 block4_pool (MaxPooling2D)  (None, 14, 14, 512)       0         

 block5_conv1 (Conv2D)       (None, 14, 14, 512)       2359808   

 block5_conv2 (Conv2D)       (None, 14, 14, 512)       2359808   

 block5_conv3 (Conv2D)       (None, 14, 14, 512)       2359808   

 block5_pool (MaxPooling2D)  (None, 7, 7, 512)         0         

=================================================================
Total params: 14,714,688
Trainable params: 0
Non-trainable params: 14,714,688
_________________________________________________________________
```

**VGG16 å°±æ˜¯æˆ‘ä»¬çš„`base_model`ã€‚ç°åœ¨æ’å…¥æœ€åå‡ ä¸ªåˆ†ç±»å±‚(ä¸‹é¢çš„ç¬¬ 4â€“7 è¡Œå’Œç¬¬ 12â€“15 è¡Œ)ã€‚ä¸€å¦‚æ—¢å¾€ï¼Œé€‰æ‹©ç¥ç»ç½‘ç»œå±‚çš„å¤§å°æ›´å¤šçš„æ˜¯è‰ºæœ¯è€Œä¸æ˜¯ç§‘å­¦ã€‚è¿™å¯èƒ½éœ€è¦åå¤è¯•éªŒã€‚å¥½æ¶ˆæ¯æ˜¯èµ·ç‚¹æ˜¯ä¸€ä¸ªä»¤äººæ•¬ç•çš„`base_model`ã€‚**

> **å¸¦æœ‰åˆ†ç±»å±‚çš„æ¨¡å‹å±‚:**

```
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 vgg16 (Functional)          (None, 7, 7, 512)         14714688  

 flatten (Flatten)           (None, 25088)             0         

 dense (Dense)               (None, 10)                250890    

 dropout (Dropout)           (None, 10)                0         

 dense_1 (Dense)             (None, 1)                 11        

=================================================================
Total params: 14,965,589
Trainable params: 250,901
Non-trainable params: 14,714,688
_________________________________________________________________
```

**æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨æ¨¡å‹ä¸­æ·»åŠ äº† 25 ä¸‡ä¸ª**å¯è®­ç»ƒå‚æ•°**ã€‚å› ä¸ºæ‰€æœ‰çš„ VGG16 å‚æ•°éƒ½è¢«å†»ç»“ï¼Œæ‰€ä»¥ä¹‹å‰ä¸ºé›¶ã€‚**

## **åŸ¹è®­å’Œè¯„ä¼°**

**æˆ‘ä»¬å»ºç«‹äº†æ¨¡å‹ã€‚ç°åœ¨è®¾ç½®åŸ¹è®­æµç¨‹ã€‚ç¼–è¯‘æ¨¡å‹(ä¸‹é¢çš„ç¬¬ 2 è¡Œ)ã€‚ä½¿ç”¨è‡ªå®šä¹‰å›è°ƒè®°å½•æŒ‡æ ‡(ç¬¬ 8â€“30 è¡Œ)ã€‚æ¨¡å‹è¢«æ‹Ÿåˆ(ç¬¬ 33 è¡Œ)ã€‚**

**ä¸‹é¢çš„ä»£ç åŠ è½½ test_ds â€”æµ‹è¯•æ•°æ®é›†ã€‚**

**è¯„ä¼°æµ‹è¯•(ä¹Ÿç§°ä¸ºä¿æŒ)æ•°æ®ã€‚**

**æµ‹è¯•å›¾åƒè¯„ä¼° 100%å‡†ç¡®(*é€šå¸¸â€”â€”ç»“æœæ˜¯éšæœºçš„*)ã€‚åªä½¿ç”¨äº†ä¸‰ä¸ªæ—¶æœŸçš„è®­ç»ƒã€‚è¿™å°±æ˜¯è¿ç§»å­¦ä¹ çš„ç¥å¥‡ä¹‹å¤„ã€‚**

## **æŸå¤±å’Œå‡†ç¡®æ€§æŒ‡æ ‡**

**åœ¨å·¦ä¸‹å›¾çš„ç¬¬ä¸€ä¸ªæ—¶æœŸä¹‹åï¼Œè®­ç»ƒæŸå¤±ä¸‹é™åˆ°æ¥è¿‘é›¶ã€‚æ³¨æ„åœ¨ä¸€ä¸ªæ—¶æœŸåï¼Œè®­ç»ƒæŸå¤±æ¯”ç¡®è®¤æŸå¤±é«˜å¾—å¤šã€‚æ˜¯å¦å­˜åœ¨ä¸åŸå§‹æ—¶åºä¿¡å·ç›¸å…³çš„æ•°æ®æ³„æ¼ï¼Ÿ**

**æ¯ä¸ªæ–‡ä»¶å¤¹éƒ½æ˜¯ç‹¬ç«‹çš„(æ˜¯ä¸æ˜¯**è€Œä¸æ˜¯**ä½¿ç”¨ TensorFlow API æ¥æ‹†åˆ†éªŒè¯å›¾åƒ)ã€‚æ­¤å¤–ï¼Œè®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•æ•°æ®æ˜¯æ—¶é—´åˆ†ç¦»çš„ã€‚æ‰€ä»¥è®­ç»ƒæ•°æ®åœ¨æ—¶é—´çº¿ä¸Šå…ˆäºéªŒè¯æ•°æ®ã€‚å¹¶ä¸”éªŒè¯æ•°æ®åœ¨æµ‹è¯•æ•°æ®ä¹‹å‰ã€‚**

**![](img/d7c9b9137b50f55b71e29e2f9bc14e3f.png)**

**ä½œè€…çš„æ¨¡å‹æŸå¤±å’Œå‡†ç¡®æ€§ã€‚å‹å·®è®¾ç½®ä¸º 0.3ã€‚**

**æ ¹æ® Keras å¼€å‘äººå‘˜çš„è¯´æ³•ï¼Œè¾å­¦å¯èƒ½å¯¼è‡´åŸ¹è®­æŸå¤±é«˜äºâ€œæµ‹è¯•â€(éªŒè¯)æŸå¤±ã€‚å®Œæ•´çš„è§£é‡Šæ˜¯[è¿™é‡Œ](https://keras.io/getting_started/faq/#why-is-my-training-loss-much-higher-than-my-testing-loss)ã€‚ä¸‹é¢ï¼ŒåŸ¹è®­å’ŒéªŒè¯ä¹‹é—´çš„å·®è·é€šè¿‡æ¶ˆé™¤è¾å­¦è€Œç¼©å°ã€‚**

**![](img/72df5bd619ad52fd5369a5962cadce52.png)**

**é‹åº•è„±è½å·²ç§»é™¤ã€‚**

**å°½ç®¡æœ‰éå…¸å‹çš„åº¦é‡æ›²çº¿ï¼Œä½†æ¨¡å‹æ˜¯ä¸€èˆ¬åŒ–çš„ã€‚äº‹å®ä¸Šï¼Œä¸ç®¡æœ‰æ²¡æœ‰è¾å­¦ï¼Œæµ‹è¯•é¢„æµ‹éƒ½æ˜¯ 100%å‡†ç¡®çš„ã€‚**

**![](img/80d7cb9e76ac0d8a1c57b37d2a255a5d.png)**

**æµ‹è¯•æ•°æ®åº¦é‡(`[sklearn.metrics](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html)` [)ã€‚åˆ†ç±» _ æŠ¥å‘Š](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html)**

**è¿™ä¸ªä»»åŠ¡éœ€è¦è¿™ä¹ˆå¤§çš„ CNN æ¨¡å‹å—ï¼Ÿå¤§æ¦‚ä¸ä¼šå§ï¼CNN ä¼¼ä¹è¿‡åº¦å‚æ•°åŒ–äº†ã€‚çš„ç¡®ï¼Œè°·æ­Œå¤§è„‘ç ”ç©¶ç§°ï¼Œä¸€ä¸ªç®€å•çš„å¸¦`**num_weights = 2 * *n*_samples + *d*_dimensions**`çš„ä¸¤å±‚ç¥ç»ç½‘ç»œå¯ä»¥è¡¨ç¤ºä»»ä½•å‡½æ•°[ [4](#3645) ]ã€‚**

## **æ•°æ®æ´å¯Ÿ**

**æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªæœ‰æ•ˆçš„äºŒå…ƒåˆ†ç±»æ¨¡å‹ï¼Œæœ‰è¿‘ 1500 ä¸‡ä¸ªå‚æ•°ã€‚å·¥ä½œåšå¾—å¥½å—ï¼Ÿæˆ‘ä»¬æ˜¯å¦æ­£ç¡®åœ°æ¢ç´¢å’Œç†è§£äº†ä¿¡å·æ•°æ®ï¼Ÿ**

**æ˜¯æ—¶å€™é‡æ–°æŸ¥çœ‹**ä¿¡å·ç»Ÿè®¡**éƒ¨åˆ†çš„ 800 ç‚¹éšæœºæ ·æœ¬ç›´æ–¹å›¾äº†ã€‚å›æƒ³ä¸€ä¸‹äº§ç”Ÿçš„ç©ºåŒ–ä¿¡å·çœ‹ä¸Šå»æ˜¯é«˜æ–¯å‹çš„ã€‚**

**æˆ‘ä»¬ç”¨æ›´å¤šçš„æ•°æ®ç‚¹åšç›´æ–¹å›¾å§ã€‚ä¸‹é¢çš„ **nc** ä¿¡å·çœ‹èµ·æ¥æ˜¯ 8000 ç‚¹å’Œ 80000 ç‚¹æ ·æœ¬çš„åŒå³°ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ **dc** ä¿¡å·æ˜¯å•å³°é«˜æ–¯æ›²çº¿ã€‚**

**![](img/2e582cdd4ec0a43669d70c31c19c08ab.png)**

**ä¿¡å·ç›´æ–¹å›¾ã€‚é¡¶è¡Œâ€”æ— æ°”ç©´ç°è±¡ã€‚åº•æ’â€”å½¢æˆæ°”ç©´ã€‚**

**å¯èƒ½äºŒè¿›åˆ¶åˆ†ç±»å°±æ˜¯é©¼å³°è®¡æ•°ï¼Œä¸éœ€è¦æ·±åº¦å­¦ä¹ ï¼ä¸¤ä¸ªå³°å€¼è¡¨ç¤ºæ²¡æœ‰æ°”èš€ï¼Œä¸€ä¸ªå³°å€¼è¡¨ç¤ºæ°”èš€ã€‚**

**ä¸ºäº†è®¡ç®—å³°å€¼ï¼Œæˆ‘ä»¬éœ€è¦(1)å¹³æ»‘ä¿¡å·å’Œ(2)è®¡ç®—å±€éƒ¨æœ€å¤§å€¼ã€‚é€šè¿‡[æ ¸å¯†åº¦ä¼°è®¡](https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KernelDensity.html)ï¼Œæ³¢åŠ¨ä¿¡å·è½¬æ¢ä¸ºå¹³æ»‘æ›²çº¿ã€‚SciPy æœ‰ä¸€ä¸ª`find_peaks`å‡½æ•°æ¥è®¡ç®—ä¿¡å·çš„å±€éƒ¨æœ€å¤§å€¼ã€‚**

```
from scipy.signal import find_peaks
peaks_num = len(find_peaks(y_kde, height=0.2)[0])
```

**é€šè¿‡å°†ä¿¡å·åˆ†æ®µæ¥è®¡ç®—å³°å€¼ã€‚åŒæ ·ï¼Œæˆ‘ä»¬é¢„è®¡æ— æ°”ç©´ç°è±¡æœ‰ä¸¤ä¸ªå³°å€¼ï¼Œè€Œå‘å±•æ°”ç©´ç°è±¡æœ‰ä¸€ä¸ªå³°å€¼ã€‚**

**é¦–å…ˆæµ‹è¯• 800 ä¸ªç‚¹æ®µå³°å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªä¿¡å·æœ‰ 1000 ä¸ªç‹¬ç«‹æ®µ`(800*1,000=800,000)`ã€‚ç»“æœæ˜¯å‡ ç™¾ä¸ªé”™è¯¯ã€‚ç³Ÿç³•çš„ç»“æœã€‚**

**![](img/2b893a46ec541f7db471c3a167c9ff5e.png)**

**å³°å€¼è®¡æ•°æ— æ°”èš€çš„ KDEã€‚æŒ‡æ•°æ˜¾ç¤ºäº† 8000 ç‚¹çš„åŒºé—´ã€‚100 ä¸ªç‰‡æ®µä¸­çš„å•ä¸ªé”™è¯¯åœ¨ä¸Šé¢ä»¥çº¢è‰²æ˜¾ç¤ºã€‚**

**ç›´æ–¹å›¾æ˜¾ç¤ºäº†**8000 ç‚¹**æ®µçš„æ›´æ¸…æ™°çš„å³°å€¼ã€‚äº‹å®è¯æ˜ï¼Œå¢åŠ æ•°æ®ç‚¹å¯ä»¥æé«˜å‡†ç¡®æ€§ã€‚é™¤ä¸€ä¸ªåŒºæ®µå¤–ï¼Œæ‰€æœ‰åŒºæ®µéƒ½æœ‰æ­£ç¡®çš„å³°æ•°ï¼Œå‡†ç¡®ç‡ä¸º 99.5%ã€‚è¿™æ˜¯ä¸€å¤§è¿›æ­¥ã€‚æ‰€æœ‰éœ€è¦çš„æ˜¯ä¸€ä¸ªæ›´å¤§çš„æ ·æœ¬å’Œæ›²çº¿å¹³æ»‘[ [5](#9d57) ]ã€‚**

```
**8,000 point segments:**
* no cavitation - 100 segments
* developed cavitation - 100 segments
* total segments - 200 segmentsaccuracy = 99.5% **=** (200 segments - 1 error) / 200 segments * 100
```

# **ç»“è®º**

**æœ¬é¡¹ç›®ä½¿ç”¨äº†ä¸¤ç§æƒ…å†µä¸‹åŠ é€Ÿåº¦è®¡ä¿¡å·çš„å›¾åƒ:*æ— ç©ºåŒ–*å’Œ*äº§ç”Ÿç©ºåŒ–*ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ‹¥æœ‰è¿‘ 1500 ä¸‡ä¸ªå‚æ•°çš„å·ç§¯ç¥ç»ç½‘ç»œå¯¹å›¾åƒè¿›è¡Œåˆ†ç±»ã€‚å…¶ä¸­ï¼Œ25 ä¸‡åªå—è¿‡æŠ“ç—’è®­ç»ƒï¼Œå¤§çº¦ 1400 ä¸‡åªè¢«å†·å†»ã€‚**

**CNN å¯¹äºäºŒå…ƒåˆ†ç±»æ˜¯æœ‰æ•ˆçš„ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€ä¸ªæ›´ç®€å•çš„é€‰æ‹©ã€‚æ²¡æœ‰å›¾åƒå’Œæ²¡æœ‰å¤§æ¨¡å‹æ˜¯å¿…éœ€çš„ã€‚æ•°å³°å°±è¡Œäº†ã€‚**

****åè®°****

**å¯¹äºå¯»æ‰¾æ›´å¤šåŒè°±åˆ†æçš„è¯»è€…ï¼Œæˆ‘å†™äº†[ä¿¡å·çš„å‚…ç«‹å¶å’ŒåŒè°±åˆ†æ](https://medium.com/@mackiej/fourier-and-bispectral-analysis-of-signals-c7a71021b1c8)ã€‚**

**é™¤éå¦æœ‰è¯´æ˜ï¼Œæ‰€æœ‰å›¾ç‰‡å‡ç”±ä½œè€…æä¾›ã€‚ç¥ä½ æ„‰å¿«ï¼ğŸ˜**

```
**REFERENCES**[1] Ali Hajnayeb, "[Cavitation Analysis in Centrifugal Pumps Based on Vibration Bispectrum and Transfer Learning](https://www.researchgate.net/journal/Shock-and-Vibration-1875-9203/publication/356754152_Cavitation_Analysis_in_Centrifugal_Pumps_Based_on_Vibration_Bispectrum_and_Transfer_Learning/links/61aa54b8aade5b1bf5ffe596/Cavitation-Analysis-in-Centrifugal-Pumps-Based-on-Vibration-Bispectrum-and-Transfer-Learning.pdf)", 2021\. Hajnayeb Accelerometer Dataset:  [nc](https://www.researchgate.net/publication/308415702_No_Cavitation1), [lc](https://www.researchgate.net/publication/308415892_Limited_Cavitation1), [dc](https://www.researchgate.net/publication/308415784_Developed_Cavitation1)[2] Matteo Bachetti, et al., stingray v1.0 code, [https://docs.stingray.science](https://docs.stingray.science/), 2022.[3] Multi-class classification is successful with bispectrum images as per [1].  The neuron count in the final layer increases--one per class.  The author chose binary classification to highlight a classification alternative.[4] Chiyuan Zhang, et al., [Understanding Deep Learning Requires Rethinking Generalization](https://arxiv.org/pdf/1611.03530.pdf), 2017.[5] Test overlapping time segments to get more confident peak counting works.  Increase the number of segments per signal from 100 to 800\. Slide the segment window in 1,000 point steps rather 8,000 point steps. The result is two errors total (for both nc and dc).  See nc1 indices 199000-207000 and 200000-208000\.  1598 correct out of 1600 is 99.875% accuracy, i.e.  (1600-2)/1600*100\.  This is better accuracy than the fewer segments per signal scenario. [GO TO TABLE OF CONTENTS](#f386)
```
# ä½¿ç”¨ Lambda å‡½æ•°ä» SageMaker éƒ¨ç½² XGBoost æ¨¡å‹

> åŸæ–‡ï¼š<https://towardsdatascience.com/deploy-xgboost-models-from-sagemaker-using-lambda-functions-be58284ca0cf>

## å…³äºå¦‚ä½•å…¬å¼€ SageMaker ML æ¨¡å‹ç«¯ç‚¹ä¾›æ‰€æœ‰äººä½¿ç”¨çš„å¿«é€Ÿæ•™ç¨‹

![](img/b2e6c22a5202fbd166914fd61e8145ca.png)

æ°å…‹Â·æ³•ç”˜åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

åœ¨ Amazon SageMaker ä¸­åˆ›å»º ML æ¨¡å‹ç«¯ç‚¹éå¸¸æ£’ï¼Œä½†æ˜¯é™¤éæ‚¨èƒ½å¤Ÿè®©å…¶ä»–äººä½¿ç”¨å®ƒä»¬ï¼Œå¦åˆ™è¿™æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿåœ¨ä¸Šä¸€ä¸ªæ•™ç¨‹ä¸­:

> [**ç”¨ 4 ä¸ªç®€å•çš„æ­¥éª¤åœ¨äºšé©¬é€Š SageMaker ä¸­è®­ç»ƒ XGBoost æ¨¡å‹**](https://medium.com/@nikola.kuzmic945/train-xgboost-models-in-amazon-sagemaker-in-4-simple-steps-4eb3e104ee61)

æˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ª XGBoost åˆ†ç±»å™¨ï¼Œå®ƒå¯ä»¥æ ¹æ®ä¸€ä¸ªäººçš„æˆ¿å­é¢ç§¯æ¥é¢„æµ‹ä¸€åªå®Œç¾çš„å°ç‹—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºå°äº 500 å¹³æ–¹è‹±å°ºçš„æˆ¿å±‹ï¼Œæ¨¡å‹ä¼šæ¨èå°çŒçŠ¬(0)ï¼Œè€Œå¯¹äºå¤§äº 500 å¹³æ–¹è‹±å°ºçš„æˆ¿å±‹ï¼Œæ¨¡å‹ä¼šæ¨èå¾·å›½ç‰§ç¾ŠçŠ¬(1)ã€‚

![](img/78be886705ef0b3be4f83b926ceafbf9.png)

æ¥æº:å·¦[1]å’Œå³[2]

ç°åœ¨æ˜¯æ—¶å€™åœ¨äº’è”ç½‘ä¸Šéƒ¨ç½²è¿™ä¸ªç«¯ç‚¹äº†ï¼ä»¥ä¸‹æ˜¯æ–¹æ³•:

![](img/fd9a55c4cc3e71cdc130265b23cf51d9.png)

ä½œè€…å›¾ç‰‡

## ğŸ‘‰ç­–ç•¥

1.  åˆ›å»ºä¸€ä¸ª Lambda å‡½æ•°ï¼Œç”¨äºå¤„ç†ä¼ å…¥çš„è¯·æ±‚æœ‰æ•ˆè´Ÿè½½(å³ä½å®…åŒºè¾“å…¥)ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™ SageMaker ML æ¨¡å‹ç«¯ç‚¹
2.  ä½¿ç”¨ API ç½‘å…³åˆ›å»ºä¸€ä¸ª REST API æ¥æ¥å—å®¢æˆ·æœºè¯·æ±‚

è¿™æ˜¯æˆ‘ä»¬åŠªåŠ›å®ç°çš„æœ€ç»ˆç›®æ ‡ã€‚æˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿä»äº’è”ç½‘ä¸Šçš„ä»»ä½•åœ°æ–¹å‘æˆ‘ä»¬çš„ SageMaker ç«¯ç‚¹å‘é€ POST è¯·æ±‚:

```
curl -X POST https://<Your_API_Gateway_REST_API>/resource/method -H 'Content-Type: application/json' -d '{"area":"300"}'
```

å¹¶æ¥æ”¶ä»¥ä¸‹è¾“å‡ºå“åº”:

```
"beagle"
```

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ï¼

## 1.åˆ›å»º Lambda å‡½æ•°

åœ¨ AWS ä¸­åˆ›å»ºä¸€ä¸ª Lambda å‡½æ•°éå¸¸ç®€å•ï¼Œåªéœ€å‡ æ¬¡ç‚¹å‡»ã€‚ä»¥ä¸‹æ˜¯æ‚¨éœ€è¦çš„ä»£ç :

åœ¨è¿›å…¥ AWS æ§åˆ¶å°ä¸­çš„ Lambda é€‰é¡¹å¡ä¹‹å‰ï¼Œé¦–å…ˆç¡®ä¿**è®°ä¸‹**æ‚¨çš„ XGBoost **ç«¯ç‚¹åç§°**ï¼Œæ‚¨éœ€è¦å°†å®ƒä½œä¸ºç¯å¢ƒå˜é‡å­˜å‚¨åœ¨ Lambda å‡½æ•°ä¸­ã€‚

![](img/3eb69353ad68593b7ab948af570648f5.png)

è®©æˆ‘ä»¬åˆ›å»º Lambda å‡½æ•°

![](img/02a2e7d155f1a3d43378e8723cbefef5.png)![](img/fab6fb9d6906dd269047763f3389701d.png)![](img/303bdf95d243006914963de29cc127e4.png)![](img/e182b075fb1b7192d210a217d39b3aaf.png)

ä½ å¯ä»¥åœ¨è¿™é‡Œç²˜è´´ lambda ä»£ç :

![](img/396d5e608273c1a54cfc2b07d90fae90.png)

æ¥ä¸‹æ¥ï¼Œè¾“å…¥ SageMaker ç«¯ç‚¹åç§°(æ‚¨ä¹‹å‰å¤åˆ¶çš„)ä½œä¸ºç¯å¢ƒå˜é‡

![](img/206b6458d33c25776a4462ad6a24fed4.png)![](img/de67c0a64e4096c1dae3b283002190e3.png)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ç»™æˆ‘ä»¬çš„ Lambda å‡½æ•°æƒé™æ¥è°ƒç”¨ SageMaker ç«¯ç‚¹ã€‚åœ¨æƒé™ä¸‹ï¼Œå•å‡»æ‰§è¡Œè§’è‰²:

![](img/11b472b1eaf79af42b00333d7b7aa649.png)![](img/7b4b26a2eb5c979cee330f74386ea30b.png)

æˆ‘ä»¬å°†ç»™äºˆ Lambda å‡½æ•°å¯¹ SageMaker çš„å®Œå…¨è®¿é—®æƒ:

![](img/3082525018d8df2259fad33cb99290c3.png)

æˆ‘ä»¬çš„ Lambda å‡½æ•°ç°åœ¨çŸ¥é“**è¦è°ƒç”¨å“ªä¸ªç«¯ç‚¹**ï¼Œå¹¶ä¸”æ‹¥æœ‰**ç›¸åº”çš„æƒé™**æ¥è¿™æ ·åšã€‚æ˜¯æ—¶å€™åˆ›å»º REST API äº†ã€‚

## 2.ä½¿ç”¨ API ç½‘å…³åˆ›å»ºä¸€ä¸ª REST API

![](img/17a03d57ea8a3304160508e2901da0d1.png)![](img/f87f3d3c544f6cc8231dde304c8d93da.png)![](img/62de5afb52ce0baa886083881a20d6db.png)

é€‰æ‹©:

*   ä¼‘æ¯
*   æ–° API

ç»™å®ƒä¸€ä¸ª**åç§°**ï¼Œä¿ç•™é»˜è®¤ç±»å‹ä¸º**åŒºåŸŸ**å’Œ**ç‚¹å‡»:åˆ›å»º API**

![](img/e68e0cd814721243dfa274d201e2d3b3.png)

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦**åˆ›å»ºèµ„æº**ä½œä¸º REST API çš„ä¸€éƒ¨åˆ†:

![](img/9d537ce3df8a9ce3a8024d3ad782a6d5.png)![](img/bb045dd5ce614a909cd8b6d01c92b6be.png)

ç„¶å**åˆ›å»ºæ–¹æ³•**:

![](img/050574672fb6212bb8111081b2655ee3.png)

é€‰æ‹©å‘å¸ƒæ–¹æ³•:

![](img/4596cfb72881b1cb256cbd6459a5a1d2.png)

è®©æˆ‘ä»¬å°†è¿™ä¸ª REST API æŒ‡å‘æˆ‘ä»¬åœ¨ä¸Šä¸€æ­¥ä¸­åˆ›å»ºçš„ Lambda å‡½æ•°(â€œdemo1â€):

![](img/50411a4b54b85f0db18b280fb4e23e23.png)

ç°åœ¨æˆ‘ä»¬å°†**éƒ¨ç½² API**

![](img/4edaf2b97d74d132568a70cebb566fc1.png)![](img/80ffa4297dd622abaf9a1cdeb86446d4.png)

å¤åˆ¶ REST API url:

![](img/b04a905307905ebde0b9e33050b978ce.png)

ç„¶ååœ¨å‘é€è¯·æ±‚æ—¶ï¼Œç¡®ä¿å°†**æ–¹æ³•å**(å³ demo1)æ·»åŠ åˆ°å¤åˆ¶çš„ API url ä¸­

```
curl -X POST https://<Your_API_Gateway_REST_API>/test/demo1 -H 'Content-Type: application/json' -d '{"area":"300"}'**Output:**
"beagle"
```

## æœ€åçš„è¯

ç°åœ¨ä½ çŸ¥é“äº†ï¼ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»è¯æ˜ï¼Œæˆ‘ä»¬çš„ SageMaker æ¨¡å‹å·²ç»æˆåŠŸåœ°åœ¨äº’è”ç½‘ä¸Šå…¬å¼€ï¼Œä¾›æ¯ä¸ªäººä½¿ç”¨ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ Reactã€Vue.js æˆ– Angular frontend åº”ç”¨ç¨‹åºï¼Œå®ƒå°†èƒ½å¤Ÿæå‡ºç±»ä¼¼çš„è¯·æ±‚ï¼Œå¹¶ä¸ºç”¨æˆ·æä¾›å®Œç¾çš„å°ç‹—æ¨èã€‚

## æ¸…ç†ä»¥åœæ­¢äº§ç”Ÿæˆæœ¬ï¼

> 1.é€šè¿‡åœ¨ Jupyter ç¬”è®°æœ¬ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥åˆ é™¤å·²éƒ¨ç½²çš„ç«¯ç‚¹

```
xgb_predictor.delete_endpoint()
```

> 2.åœæ­¢ SageMaker ç¬”è®°æœ¬å®ä¾‹

> **æ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œå¦‚æœè¿™ç¯‡æ–‡ç« å¸®ä½ èŠ‚çœäº†æ—¶é—´æˆ–è€…è§£å†³äº†é—®é¢˜ï¼Œä¸€å®šè¦ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®ï¼æ€»æ˜¯éå¸¸æ„Ÿè°¢ã€‚**

## å›¾åƒæ¥æº

[1][https://commons . wikimedia . org/wiki/File:Beagle _ puppy _ cadet . jpg](https://commons.wikimedia.org/wiki/File:Beagle_puppy_Cadet.jpg)

[https://pxhere.com/en/photo/1003603](https://pxhere.com/en/photo/1003603)
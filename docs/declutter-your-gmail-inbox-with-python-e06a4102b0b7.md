# ä½¿ç”¨ Python æ•´ç†æ‚¨çš„ Gmail æ”¶ä»¶ç®±

> åŸæ–‡ï¼š<https://towardsdatascience.com/declutter-your-gmail-inbox-with-python-e06a4102b0b7>

## ä½¿ç”¨ ezgmail è‡ªåŠ¨é˜…è¯»å’Œåˆ é™¤ç”µå­é‚®ä»¶

![](img/dd41e46ccc7ec2b02e4f0a346005e30d.png)

æ–¯è’‚èŠ¬Â·è²åˆ©æ™®çš„ç…§ç‰‡[â€”](https://unsplash.com/@hostreviews?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

## ä»‹ç»

ä¸å¾—ä¸åœ¨ gmail åº”ç”¨ç¨‹åºä¸­æ‰‹åŠ¨åˆ é™¤ä¸€å°åˆä¸€å°ç”µå­é‚®ä»¶ç»å¯¹ä¸æ˜¯å¯¹æ—¶é—´çš„è‰¯å¥½åˆ©ç”¨ï¼Œå°¤å…¶æ˜¯å½“ä½ å¯ä»¥è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹çš„æ—¶å€™ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•è‡ªåŠ¨åˆ é™¤ä¸æƒ³è¦çš„é‚®ä»¶ï¼Œå¹¶å°†é‚®ä»¶æ ‡è®°ä¸ºå·²è¯»ã€‚è¿™æ ·ï¼Œå½“ä½ åœ¨åšä¸€ä»¶é‡è¦çš„äº‹æƒ…æˆ–è€…çœ‹ä½ æœ€å–œæ¬¢çš„ç”µè§†èŠ‚ç›®æ—¶ï¼Œä½ å¯ä»¥è®©ä¸€ä¸ªç¨‹åºæ¥å¸®ä½ åšè¿™ä»¶äº‹ğŸ˜‰ã€‚

å°±åœ¨ä¸ä¹…å‰ï¼Œæˆ‘å‘ç°äº†ç”± [Al Sweigart](https://twitter.com/AlSweigart) åˆ›å»ºçš„ [ezgmail](https://pypi.org/project/EZGmail/) python åŒ…ï¼Œæˆ‘è®¤ä¸ºä¸æˆ‘ä»¥å‰è§è¿‡çš„å…¶ä»–åŒ…ç›¸æ¯”ï¼Œå®ƒçš„åŠŸèƒ½éå¸¸ç®€å•ã€‚

## è¦æ±‚

*   å®‰è£…åœ¨æ‚¨ç”µè„‘ä¸Šçš„ python ç‰ˆæœ¬ã€‚å¦‚æœæ‚¨æ²¡æœ‰å®‰è£… pythonï¼Œè¯·æŒ‰ç…§è¿™é‡Œçš„è¯´æ˜[æ¥å®‰è£…ã€‚](https://www.youtube.com/watch?v=i-MuSAwgwCU)
*   æ‚¨é€‰æ‹©çš„ ideã€‚Jupyter ç¬”è®°æœ¬ï¼Œspyderï¼Œpycharm ç­‰ã€‚
*   å®‰è£… ezgmail åŒ…ï¼Œè¿™å¯ä»¥é€šè¿‡åœ¨ç»ˆç«¯ä¸­è¿è¡Œ`pip install EZgmail`æ¥å®Œæˆ

## è®¾ç½®æ‚¨çš„ gmail å¼€å‘è€…å¸æˆ·

æ‚¨ä¸èƒ½è·³è¿‡è¿™ä¸€æ­¥ï¼Œå¦åˆ™ ezgmail åŒ…å°†æ— æ³•å·¥ä½œã€‚è¿™ä¸€éƒ¨åˆ†å¾ˆé•¿ï¼Œä½†æ˜¯å½“ä½ è¯»åˆ°æœ€åçš„æ—¶å€™ï¼Œå®ƒæ˜¯å®Œå…¨å€¼å¾—çš„ã€‚

*   åˆ›å»ºä¸€ä¸ªæ‚¨å°†åœ¨å…¶ä¸­å·¥ä½œçš„æ–°æ–‡ä»¶å¤¹ã€‚`ezgmail_python`æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚
*   ç‚¹å‡»[æ­¤å¤„](https://developers.google.com/gmail/api/quickstart/python/#step_1_install_the_google_client_library)å¹¶ä½¿ç”¨æ‚¨çš„ gmail å¸æˆ·ç™»å½•ã€‚
*   **æŒ‰ç…§é¡µé¢ä¸Šçš„æ­¥éª¤ 1** è¿è¡Œ:

```
pip install --upgrade google-api-python-client google-auth-httplib2 google-auth-oauthlib
```

**æŒ‰ç…§é¡µé¢ä¸Šçš„æ­¥éª¤ 2** åˆ›å»º quickstart.py æ–‡ä»¶ï¼Œå¹¶å°†æ­¥éª¤ 2 ä¸­çš„ä»£ç æ·»åŠ åˆ°æ–‡ä»¶ä¸­ã€‚

*   å°† quickstart.py ä¿å­˜åœ¨å¼€å§‹æ—¶åˆ›å»ºçš„æ–‡ä»¶å¤¹ä¸­ã€‚`ezgmail_python`æ–‡ä»¶å¤¹
*   **ä¸è¦åƒé¡µé¢ä¸Šè¯´çš„é‚£æ ·è¿è¡Œ python quickstart.py** ï¼
*   å¦‚æœ‰å¿…è¦ï¼Œç‚¹å‡»[æ­¤å¤„](https://console.cloud.google.com/getting-started?)å¹¶ç™»å½•ã€‚
*   ç‚¹å‡»`Select a project -> New Project -> Enter a Project name in the field provided(Eg: ezgmail)`å¯ä»¥å¿½ç•¥ä½ç½®å­—æ®µ
*   ç‚¹å‡»`CREATE`
*   ä»å¼¹å‡ºçš„é€šçŸ¥ä¸­é€‰æ‹©æ‚¨çš„`ezgmail`é¡¹ç›®ã€‚æ‚¨å°†è¢«è½¬åˆ°ä»¥ä¸‹é¡µé¢:

![](img/8e32cb7caac64501ee01ef0c8f643f58.png)

ezgmail é¡¹ç›®çš„ä»ªè¡¨æ¿

*   åœ¨å±å¹•çš„å·¦çª—æ ¼ä¸­ï¼Œç‚¹å‡»`APIs & Services`->-`OAuth consent screen`ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:

![](img/ddb2bf7be7f964bfde4193ad334dbe0e.png)

é€‰æ‹© OAuth åŒæ„å±å¹•é€‰é¡¹

*   ä»æ˜¾ç¤ºçš„ OAuth åŒæ„å±å¹•ä¸­ï¼Œç‚¹å‡»`external` é€‰é¡¹ï¼Œç„¶åç‚¹å‡»`create` ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:

![](img/6fc74ec6ac44ba9e6f80f7e4656c6a43.png)

ä¸ºç”¨æˆ·ç±»å‹é€‰æ‹©â€œå¤–éƒ¨â€é€‰é¡¹

*   æ¥ä¸‹æ¥ä¼šå‡ºç°ä¸€ä¸ª**ç¼–è¾‘åº”ç”¨ç¨‹åºæ³¨å†Œ**è¡¨å•ã€‚å¡«å†™ä»¥ä¸‹å­—æ®µ:

**â€” App ä¿¡æ¯**

*   `App name` = ezgmail
*   `User support email` =ä½ è‡ªå·±çš„ gmail
*   App logo å¯ä»¥å¿½ç•¥

**â€”åº”ç”¨é¢†åŸŸ**

*   å¿½ç•¥æ­¤å¤„çš„æ‰€æœ‰å­—æ®µï¼Œå› ä¸ºå®ƒä»¬ä¸æ˜¯å¿…å¡«å­—æ®µ

**â€”æˆæƒåŸŸ**

*   å¿½ç•¥æ­¤éƒ¨åˆ†

â€”å¼€å‘äººå‘˜è”ç³»ä¿¡æ¯

*   `Enter your own email here`

å•å‡»ä¿å­˜å¹¶ç»§ç»­

å¿½ç•¥ä¸‹ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯å…³äºä½ çš„åº”ç”¨ç¨‹åºçš„**èŒƒå›´**çš„ã€‚

å•å‡»ä¿å­˜å¹¶ç»§ç»­

å¯¹äºä¸‹ä¸€éƒ¨åˆ†ï¼Œå³**æµ‹è¯•ç”¨æˆ·**éƒ¨åˆ†ï¼Œç‚¹å‡»`+Add Users`æŒ‰é’®å’Œ`add your own email address`ï¼Œç‚¹å‡»æ·»åŠ 

å•å‡»ä¿å­˜å¹¶ç»§ç»­

ä¹‹åï¼Œä½ æä¾›äº†ä½ æ‰€æä¾›çš„æ‰€æœ‰æ•°æ®çš„æ‘˜è¦ï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œç‚¹å‡» `BACK TO DASHBOARD`

ç°åœ¨ï¼Œç‚¹å‡»å±å¹•å·¦ä¾§çš„`Credentials` é€‰é¡¹ï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹å†…å®¹:

![](img/8b87832c2d2ee4a77e4a40c9bc1ee381.png)

â€œåˆ›å»ºèº«ä»½è¯æ˜â€é¡µ

ç‚¹å‡»ä¸Šé¢çš„`+CREATE CREDENTIALS`é€‰é¡¹ï¼Œç„¶åé€‰æ‹©`OAuth Client ID`é€‰é¡¹ã€‚ä»åº”ç”¨ç±»å‹ä¸‹æ‹‰åˆ—è¡¨ä¸­ï¼Œé€‰æ‹©`Desktop App`é€‰é¡¹ï¼Œæ‚¨å¯ä»¥ä¿ç•™åç§°ä¸å˜ã€‚ç‚¹å‡»`CREATE`ã€‚é¢„æœŸå±å¹•å¦‚ä¸‹æ‰€ç¤º:

![](img/d1cf2b142467af59ef487f8536121a59.png)

â€œåˆ›å»º OAuth å®¢æˆ·æœº IDâ€é¡µ

ç‚¹å‡»`CREATE`æŒ‰é’®åä¼šå‡ºç°å¦ä¸€ä¸ªå¼¹å‡ºçª—å£ï¼Œæ˜¾ç¤ºæ‚¨çš„å‡­è¯ï¼›ä½ çš„`Client ID`å’Œ`Client Secret`ã€‚ç¡®ä¿ä¸è¦ä¸ä»»ä½•äººåˆ†äº«è¿™äº›ã€‚ç‚¹å‡»`DOWNLOAD JSON`æŒ‰é’®ä¸‹è½½è¿™äº›å‡­è¯ã€‚è¯·åŠ¡å¿…å°†æ–‡ä»¶é‡å‘½åä¸º`credentials.json`ï¼Œå¹¶ä¿å­˜åœ¨æ‚¨å¼€å§‹åˆ›å»ºçš„`ezgmail_python`æ–‡ä»¶å¤¹ä¸­ã€‚

## ä½¿ç”¨ ezgmail åŒ…

æˆ‘å¼ºçƒˆå»ºè®®ä¸‹é¢çš„å‘½ä»¤åœ¨ç»ˆç«¯ä¸­è¿è¡Œï¼Œè€Œä¸æ˜¯åœ¨ä½ çš„ ide ä¸­ã€‚

ä½¿ç”¨`cd` å‘½ä»¤è¿›å…¥ä½ çš„`ezgmail_python`æ–‡ä»¶å¤¹ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤:

`python` - >è¿è¡Œè¿™ä¸ªå‘½ä»¤å¯ä»¥è®©æ‚¨å¼€å§‹åœ¨ç»ˆç«¯ä¸­ç¼–å†™ python ä»£ç 

`import ezgmail` - >è¿è¡Œæ­¤ç¨‹åºåï¼Œæµè§ˆå™¨ä¸­ä¼šæ‰“å¼€ä¸€ä¸ªçª—å£ï¼Œè¦æ±‚æ‚¨é€‰æ‹©å¸Œæœ›è®¿é—®æ‚¨çš„åº”ç”¨ç¨‹åºçš„ç”µå­é‚®ä»¶å¸æˆ·ã€‚é€‰æ‹©ä½ æƒ³è¦æ¸…ç†çš„è‡ªå·±çš„ç”µå­é‚®ä»¶ã€‚ç„¶åä½ ä¼šçœ‹åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œå‘Šè¯‰ä½ è¿™ä¸ªåº”ç”¨ç¨‹åºæ²¡æœ‰é€šè¿‡éªŒè¯ï¼Œä»¥åŠä½ æ˜¯å¦è¦ç»§ç»­ã€‚ç‚¹å‡»`continue`

![](img/09dfc480f79da2a0c48d9c679b35ece4.png)

å…³äºåº”ç”¨ç¨‹åºéªŒè¯çš„è°·æ­Œè­¦å‘Šé¡µé¢

å†æ¬¡ç‚¹å‡»`continue` ä»¥ç¡®ä¿æ‚¨å…è®¸ ezgmail è®¿é—®æ‚¨çš„ google å¸æˆ·ã€‚æœ‰ä¸€ä¸ªé¡µé¢è¯´:`The authentication flow has completed.`ä½ ä¹Ÿä¼šæ„è¯†åˆ°åœ¨æˆåŠŸè®¤è¯åï¼Œä½ çš„ ezgmail_python æ–‡ä»¶å¤¹ä¸­æœ‰ä¸€ä¸ªåä¸º`token.json`çš„æ–°æ–‡ä»¶ã€‚

![](img/5843f03851d3654f0859e9e932c0acfa.png)

å‘½ä»¤åœ¨ç»ˆç«¯ä¸­è¿è¡Œ

å¦‚æœä¸Šé¢çš„ `import ezgmail`æ­¥éª¤ä¸èµ·ä½œç”¨ï¼Œè¯·å°è¯•`ezgmail.init()`

åš„ğŸ˜…ï¼Œä½ éƒ½å‡†å¤‡å¥½äº†ï¼ä½¿ç”¨ä¸‹é¢ä»‹ç»çš„åŠŸèƒ½éå¸¸ç®€å•ã€‚å‡†å¤‡å¥½ä½“éªŒé­”æ³•äº†å—ï¼Ÿ

**å°†é‚®ä»¶æ ‡è®°ä¸ºå·²è¯»**

ä»¥ä¸‹ä»£ç ç°åœ¨å¯ä»¥åœ¨æ‚¨çš„ ide ä¸­è¿è¡Œï¼Œè€Œä¸æ˜¯åœ¨ç»ˆç«¯ä¸­è¿è¡Œã€‚

```
unreadThreads = ezgmail.unread(maxResults=300)
print(f'There are {len(unreadThreads)} unread emails in your account')
for unread in unreadThreads:
    print(ezgmail.summary(unread), â€˜\nâ€™)
    unread.markAsRead()
```

å°±è¿™ä¹ˆç®€å•ï¼ğŸ˜²åœ¨ä¸Šé¢ä»£ç ç‰‡æ®µçš„ç¬¬ä¸€è¡Œï¼Œæ‚¨å¯ä»¥å°†`maxResults` å‚æ•°æ›´æ”¹ä¸ºæ‚¨é€‰æ‹©çš„ä»»ä½•æ•°å­—ï¼Œå› ä¸ºå®ƒæ§åˆ¶ç€è¿”å›çš„æœªè¯»é‚®ä»¶çš„æ•°é‡ã€‚ä»é‚£é‡Œï¼Œæ”¶ä»¶ç®±ä¸­æœªè¯»é‚®ä»¶çš„å®é™…æ•°é‡è¢«è¿”å›å¹¶æ‰“å°åˆ°æ‚¨çš„å±å¹•ä¸Šã€‚ç¬¬å››è¡Œè¿”å›ä½ çš„æœªè¯»é‚®ä»¶çš„æ‘˜è¦ï¼Œåœ¨æœ€åä¸€è¡Œï¼Œè¿™äº›é‚®ä»¶è¢«ç¨‹åºæ ‡è®°ä¸ºå·²è¯»ã€‚

**åˆ é™¤é‚®ä»¶**

å¯¹äºåˆ é™¤ç”µå­é‚®ä»¶ï¼Œä½ å¿…é¡»éå¸¸ç¡®å®šï¼Œç„¶åå†ç»§ç»­ã€‚ä¸‹é¢çš„ä»£ç å¯ä»¥å¸®åŠ©ä½ åˆ é™¤ã€‚

*   **é€šè¿‡æŸ¥æ‰¾å…³é”®å­—åˆ é™¤ç”µå­é‚®ä»¶**

```
keywords = ['LinkedIn', 'Cesium Forum', 'ASOS']
for keyword in keywords: 
   threads = ezgmail.search(keyword, maxResults=300)
   print(fâ€™There are {len(threads)} emails with the keyword,     {keyword}â€™)
   ezgmail.summary(threads) #You can check a summary just to make sure youâ€™re not deleting anything important
    for i in range(len(threads)):
       if len(threads)==0:
          print(â€˜No \â€™{keyword}\â€™ messages to delete, moving on to the nextâ€™)
       else:
         threads[i].trash()
```

ä¸Šé¢çš„å…³é”®è¯åˆ—è¡¨åº”è¯¥è¢«ä½ æ„Ÿå…´è¶£çš„å…³é”®è¯æ‰€å–ä»£ï¼Œå®ƒä»¬å¯ä»¥æ˜¯ä½ æƒ³è¦çš„ä»»æ„å¤šçš„å•è¯ã€‚ä½¿ç”¨ for å¾ªç¯éå†å…³é”®å­—åˆ—è¡¨ï¼Œezgmail æœç´¢åŒ…å«è¿™äº›ç‰¹å®šå…³é”®å­—çš„æ¯å°ç”µå­é‚®ä»¶ï¼Œå¹¶è¿”å›å®ƒä»¬ã€‚å¯¹äºæ¯ä¸€ä¸ªå…³é”®è¯çº¿ç´¢ï¼Œåœ¨å®ƒä»¬æœ€ç»ˆè¢«åˆ é™¤ä¹‹å‰ï¼Œå­˜åœ¨çš„ç”µå­é‚®ä»¶çš„æ•°é‡è¢«è®¡æ•°ã€‚

å¦‚æœä½ æ„è¯†åˆ°ä½ åˆ é™¤äº†ä¸€äº›é‡è¦çš„ä¸œè¥¿ï¼Œä¸è¦æƒŠæ…Œï¼Œä½ å¯ä»¥åœ¨ gmail åº”ç”¨ç¨‹åºçš„åƒåœ¾ç®±ä¸­æ‰¾åˆ°è¢«åˆ é™¤çš„é‚®ä»¶ã€‚

*   **åˆ é™¤æœ€è¿‘çš„é‚®ä»¶**

```
threads = ezgmail.recent(maxResults=20)
print(fâ€™There are {len(threads)} recent emails in your inboxâ€™)
ezgmail.summary(threads) #You can check a summary just to make sure youâ€™re not deleting anything important
for i in range(len(threads)):
     if len(threads)==0:
        print(â€˜No recent emails')
     else:
        threads[i].trash()
```

ä»‹ç»äº†æœ€è¿‘çš„åŠŸèƒ½å’Œå…³é”®å­—çš„æ¦‚å¿µï¼Œå®ƒä¹Ÿå¯ä»¥ç”¨æ¥æ ‡è®°ç”µå­é‚®ä»¶ä¸ºå·²è¯»ï¼Œå¦‚æœä½ è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªæ›´å®‰å…¨çš„é€‰æ‹©ã€‚

## ç¦»åˆ«çš„æ€ç»ª

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»– ezgmail åŠŸèƒ½ï¼Œå¦‚`re`(ç”¨äºæ­£åˆ™è¡¨è¾¾å¼)ï¼Œå®ƒå¯ä»¥å¸®åŠ©æ‚¨åœ¨ç»§ç»­æ ‡è®°ä¸ºå·²è¯»æˆ–åˆ é™¤ä¹‹å‰ï¼Œåœ¨ç”µå­é‚®ä»¶ä¸­æŸ¥æ‰¾ç‰¹å®šæ¨¡å¼ã€‚å€¼å¾—æ¢è®¨ã€‚æˆ‘å¸Œæœ›åœ¨çœ‹å®Œè¿™ç¯‡æ–‡ç« åï¼Œä½ ä¼šé‡‡ç”¨ä¸€äº›æ¸…ç†æ”¶ä»¶ç®±çš„æ–¹æ³•ã€‚æ„Ÿè°¢é˜…è¯»ï¼ğŸ‘‹ğŸ¾

## æ¥æº

[Ezgmail æ–‡æ¡£](https://ezgmail.readthedocs.io/en/latest/)
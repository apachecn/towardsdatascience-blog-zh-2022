# å…è´¹è·å–å›å½’ç¥ç»ç½‘ç»œä¸­çš„ä¸ç¡®å®šæ€§ä¼°è®¡

> åŸæ–‡ï¼š<https://towardsdatascience.com/get-uncertainty-estimates-in-neural-networks-for-free-48f2edb82c8f>

## ç»™å®šæ­£ç¡®çš„æŸå¤±å‡½æ•°ï¼Œæ ‡å‡†çš„ç¥ç»ç½‘ç»œä¹Ÿå¯ä»¥è¾“å‡ºä¸ç¡®å®šæ€§

![](img/3f7d105ccb2d01a6120b580ec965dd5a.png)

Christina Deravedisian åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

W å½“æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä»¥è¿™æ ·çš„æ–¹å¼è®¾è®¡å®ƒï¼Œå®ƒè¾“å‡º**ä¸€ä¸ªå•ä¸€çš„æ•°å­—**ä½œä¸ºé¢„æµ‹ã€‚æ¥è‡ª [scikit-learn](https://scikit-learn.org/stable/) çš„å¤§å¤šæ•°æ¨¡å‹æ˜¯è¿™æ ·å·¥ä½œçš„:åŸºäºæ ‘çš„æ¨¡å‹ã€çº¿æ€§æ¨¡å‹ã€æœ€è¿‘é‚»ç®—æ³•ç­‰ç­‰ã€‚åŒæ ·é€‚ç”¨äº [XGBoost](https://xgboost.readthedocs.io/en/stable/) å’Œå…¶ä»– boosting ç®—æ³•ï¼Œä»¥åŠæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œå¦‚ [Tensorflow](https://www.tensorflow.org/) æˆ– [PyTorch](https://pytorch.org/) ã€‚

è™½ç„¶è¿™é€šå¸¸æ˜¯å¥½çš„ï¼Œä½†æœ€å¥½ä¹Ÿæœ‰ä¸€ä¸ªå›´ç»•è¿™ä¸ª*ç‚¹ä¼°è®¡*çš„ä¸ç¡®å®šæ€§åº¦é‡ã€‚è¿™æ˜¯å› ä¸ºâ€œæˆ‘ä»¬å°†é”€å”® 1000 è¾† 50 å‹æ±½è½¦â€å’Œâ€œæˆ‘ä»¬å°†é”€å”® 1000 è¾† 5000 è¾†æ±½è½¦â€ä¹‹é—´çš„å·®å¼‚æ˜¯å·¨å¤§çš„:ä»ç¬¬ä¸€ä¸ªé™ˆè¿°ä¸­ï¼Œä½ å¯ä»¥å¾—å‡ºè¯¥å…¬å¸å°†é”€å”® 1000 è¾†å·¦å³çš„æ±½è½¦ï¼Œæˆ–å¤šæˆ–å°‘ï¼Œè€Œç¬¬äºŒä¸ªé™ˆè¿°å‘Šè¯‰ä½ è¯¥è½¦å‹æ ¹æœ¬æ²¡æœ‰ä»»ä½•çº¿ç´¢ã€‚

> ***æ³¨:*** *è¾ƒä½çš„ä¸ç¡®å®šæ€§å¹¶ä¸æ„å‘³ç€æ¨¡å‹æ˜¯æ­£ç¡®çš„ã€‚ä½œä¸ºäººï¼Œå®ƒä¹Ÿå¯ä»¥å¯¹ä¸€äº›å®Œå…¨é”™è¯¯çš„äº‹æƒ…éå¸¸å›ºæ‰§å·±è§ã€‚å› æ­¤ï¼Œåƒå¾€å¸¸ä¸€æ ·ï¼Œè¯„ä¼°æ¨¡å‹çš„è´¨é‡æ˜¯è‡³å…³é‡è¦çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚*

# è´å¶æ–¯æ¨ç†

å¦‚æœä½ è¯»è¿‡æˆ‘å…³äºè´å¶æ–¯æ¨ç†çš„æ–‡ç« (*è°¢è°¢ï¼ä½ å·²ç»çŸ¥é“å¦‚ä½•åˆ›å»ºæ¨¡å‹ï¼Œä¸ä»…è¾“å‡ºä¸€ä¸ªç‚¹ï¼Œè€Œæ˜¯è¾“å‡ºä¸€ä¸ªå®Œæ•´çš„ç›®æ ‡åˆ†å¸ƒã€‚*

![](img/f9cc4c5566007b715e7d0c13378e373b.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

[](/a-gentle-introduction-to-bayesian-inference-6a7552e313cb) [## è´å¶æ–¯æ¨ç†çš„ç®€æ˜ä»‹ç»

### äº†è§£é¢‘ç‡ä¸»ä¹‰è€…å’Œè´å¶æ–¯æ¨ç†æ–¹æ³•ä¹‹é—´çš„åŒºåˆ«

towardsdatascience.com](/a-gentle-introduction-to-bayesian-inference-6a7552e313cb) [](/bayesian-linear-regression-in-python-via-pymc3-ab8c2c498211) [## é€šè¿‡ PyMC3 åœ¨ Python ä¸­å®ç°è´å¶æ–¯çº¿æ€§å›å½’

### äº†è§£å¦‚ä½•æ¨æ–­æ¨¡å‹å‚æ•°å¹¶å¯¹æ–°æ•°æ®è¿›è¡Œé¢„æµ‹ï¼ŒåŒ…æ‹¬ä¸ç¡®å®šæ€§ä¼°è®¡ï¼

towardsdatascience.com](/bayesian-linear-regression-in-python-via-pymc3-ab8c2c498211) 

æ­£å› ä¸ºå¦‚æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è§‚å¯Ÿé¢„æµ‹çš„åˆ†å¸ƒæˆ–ä¸€äº›å¯¼å‡ºçš„æ•°å­—(å¦‚æ ‡å‡†å·®)æ¥äº†è§£æ¨¡å‹ä½•æ—¶ä¸ç¡®å®šã€‚åˆ†å¸ƒè¶Šçª„(æ ‡å‡†å·®è¶Šå°)ï¼Œæ¨¡å‹è¶Šç¡®å®šã€‚

**ä¸è¿‡ï¼Œè¿™ä¸€æ¬¡æˆ‘ä»¬ä¸ä¼šå»è´æ°è¿™é‡Œã€‚**è™½ç„¶è´å¶æ–¯æ¨ç†æ˜¯æ‚¨åº”è¯¥åœ¨æŸä¸ªæ—¶å€™å­¦ä¹ çš„ä¸€ä¸ªå¾ˆå¥½çš„é¢†åŸŸï¼Œä½†å®ƒæœ‰å‡ ä¸ªç¼ºç‚¹:

*   å®ƒåœ¨è®¡ç®—ä¸Šç”šè‡³æ¯”ç¥ç»ç½‘ç»œæ›´å¤æ‚
*   æ•°å­¦ä¸Šæ›´éš¾ç†è§£ï¼Œè€Œä¸”
*   ä½ å¿…é¡»äº†è§£æ–°çš„å›¾ä¹¦é¦†ã€‚

å› æ­¤ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯ä¸ºé‚£äº›äº†è§£ä»–ä»¬çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œå¹¶å¸Œæœ›åœ¨æ²¡æœ‰å¤ªå¤šéº»çƒ¦çš„æƒ…å†µä¸‹åŒ…æ‹¬ä¸€äº›ä¸ç¡®å®šæ€§ä¼°è®¡çš„äººå‡†å¤‡çš„ã€‚ç„¶è€Œï¼Œå¦‚æœä½ æƒ³åœ¨æŸä¸ªæ—¶å€™è¿›å…¥**å®Œå…¨è´å¶æ–¯ç¥ç»ç½‘ç»œ**çš„é¢†åŸŸï¼Œè¯•è¯• PyTorch çš„ [Tensorflow Probability](https://www.tensorflow.org/probability) æˆ– [Pyro](https://pyro.ai/) ä¹‹ç±»çš„åº“ã€‚

# ä½¿ç¥ç»ç½‘ç»œæ­ç¤ºå®ƒä»¬çš„ä¸ç¡®å®šæ€§

> **å…è´£å£°æ˜:**åŒæ ·ï¼Œæˆ‘ä¸çŸ¥é“ä»¥ä¸‹æ–¹æ³•æ˜¯å¦å‡ºç°åœ¨ä»»ä½•è®ºæ–‡æˆ–ä¹¦ç±ä¸­ã€‚å®ƒåˆšåˆšå‡ºç°åœ¨æˆ‘çš„è„‘æµ·é‡Œï¼Œæˆ‘æƒ³æŠŠå®ƒå†™ä¸‹æ¥ã€‚å¦‚æœä½ çŸ¥é“ä»»ä½•æ¥æºï¼Œè¯·åœ¨è¯„è®ºä¸­ç»™æˆ‘ä¸€ä¸ªæç¤ºï¼Œæˆ‘ä¼šæ·»åŠ åˆ°æ–‡ç« ä¸­ã€‚è°¢è°¢ï¼
> ***æ›´æ–°:*** [*é©¬è’‚äºšæ–¯Â·ç“¦å°”å¾·å†…æ ¼ç½—Â·æ‰˜ç½—*](https://www.linkedin.com/in/tetris/matias-valdenegro-toro-29383717/) *æŒ‡å‡ºæˆ‘å³å°†ä»‹ç»çš„æŸå¤±åœ¨ä»–ä»¬çš„è®ºæ–‡* ä¸­è¢«ç§°ä¸ºæ–¹å·®è¡°å‡[*ã€‚*](https://arxiv.org/abs/2204.09308)

ä»ç°åœ¨å¼€å§‹ï¼Œè®©æˆ‘ä»¬åšæŒä½¿ç”¨æˆ‘ä»¬æœ€å–œæ¬¢çš„é¢åŒ…å’Œé»„æ²¹ç¥ç»ç½‘ç»œã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ Tensorflow ä»£ç ï¼Œä½†æ˜¯æ‚¨ä¹Ÿå¯ä»¥è½»æ¾åœ°å°†æ‰€æœ‰ä»£ç éƒ½ç”¨äº PyTorch æˆ–å…¶ä»–æ¡†æ¶ã€‚è¿™é‡Œæˆ‘ä»¬å°†è€ƒè™‘ä¸€ä¸ªå›å½’é—®é¢˜ï¼Œä½†æ˜¯ç±»ä¼¼çš„è®ºç‚¹ä¹Ÿå¯ä»¥ç”¨äºåˆ†ç±»ä»»åŠ¡ã€‚

## æ¨å¯¼å‡æ–¹è¯¯å·®

ä¸ºäº†ç†è§£å¦‚ä½•å¾—åˆ°ä¸ç¡®å®šæ€§ä¼°è®¡ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆç†è§£å¦‚ä½•å¾—åˆ°ç‚¹ä¼°è®¡ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†ä»¥ä¸€ç§ç®€å•çš„æ–¹å¼æ¦‚æ‹¬è¿™ä¸€æ€æƒ³ã€‚å› æ­¤ï¼Œç®€å•å›é¡¾ä¸€ä¸‹ï¼Œä¸‹é¢æ˜¯**å‡æ–¹è¯¯å·®** (MSE)æŸå¤±å‡½æ•°:

![](img/731baaa09d5b56471c7655503acb40c8.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿™å¾ˆç›´è§‚:æŸäº›çœŸå®å€¼ *yáµ¢* å’Œæ¨¡å‹é¢„æµ‹å€¼ *Å·áµ¢* ä¹‹é—´çš„å·®è·è¶Šå¤§ï¼ŒäºæŸå°±è¶Šé«˜ã€‚ä½†æ˜¯ï¼Œå½“æŒ‡æ•°ä¸­çš„ 2 æ›¿æ¢ä¸º 4 æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼è¿›è¡Œè®¨è®ºã€‚æˆ–è€…å»æ‰ 2ï¼Œç”¨ç»å¯¹å€¼|*yáµ¢*â€“*Å·áµ¢|*ä»£æ›¿([å¹³å‡ç»å¯¹è¯¯å·®](https://en.wikipedia.org/wiki/Mean_absolute_error)ï¼ŒMAE)ã€‚

é‚£ä¹ˆï¼ŒMSE æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„å‘¢ï¼Ÿå…¶ä¸­åŒ…å«å“ªäº›å‡è®¾ï¼Ÿè®©æˆ‘ä»¬æ¥æ‰¾å‡ºç­”æ¡ˆã€‚âš ï¸ **å±é™©:æ•°å­¦é¢†å…ˆã€‚å¦‚æœè¿™å¤ªå¤šï¼Œç›´æ¥è·³åˆ°å®ç°éƒ¨åˆ†ã€‚è¿™ä¸ªç»“æœå¾ˆå®¹æ˜“åº”ç”¨ï¼Œå³ä½¿ä½ è¿˜ä¸èƒ½ç†è§£è¿™ä¸ªç†è®ºã€‚** âš ï¸

å‡è®¾å¦‚ä¸‹:

> *ç»™å®šè¾“å…¥ç‰¹å¾* x *ï¼ŒçœŸæ ‡* y *æŒ‰æ­£æ€åˆ†å¸ƒ***ç”¨* ***è¡¨ç¤º*Î¼*(*x*)*******æ ‡å‡†å·®***ï¼Œ*å³*y~N(Î¼ *(* x *)ï¼Œ* Ïƒ)ã€‚*è¿™æ„å‘³ç€è§‚å¯Ÿåˆ°çš„æ ‡ç­¾æ¥è‡ªæŸä¸ªçœŸå€¼* Î¼ *(* x *)ï¼Œä½†è¢«æŸä¸ªè¯¯å·®ç ´åï¼Œæ ‡å‡†åå·®ä¸º* Ïƒã€‚*è¿™ä¸ªè¯¯å·®ä¹Ÿå«*å™ªå£°*ã€‚* ***æ³¨æ„ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å†™*** **Å· *è€Œä¸æ˜¯* Î¼ *(* x *)ã€‚*****

**ç¥ç»ç½‘ç»œ(å’Œå¤§å¤šæ•°å…¶ä»–æ¨¡å‹)çš„ä»»åŠ¡æ˜¯é¢„æµ‹è¿™ä¸ª***Î¼*(x)***ç»™å®š *x.* è¿™ä½¿å¾—å¹³å‡é¢„æµ‹æ­£ç¡®**ï¼Œè¿™æ˜¯æˆ‘ä»¬èƒ½åšçš„æœ€å¥½çš„äº‹æƒ…ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½é¢„æµ‹å™ªå£°ã€‚ç°åœ¨çš„è¡¨è¾¾*y*~*N*(*Î¼(*x*)ï¼ŒÏƒ* )åªæ˜¯è¡¨ç¤ºä»¥ä¸‹æ„æ€:*****

*****![](img/36bf76fcbcb617e1390c2ccf4eecaf70.png)*****

*****å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚*****

*****è¿™åªæ˜¯ç”¨å‡å€¼ *Å·=Î¼(* x *)* å’Œæ ‡å‡†å·® *Ïƒ* æè¿°å•ä¸ªæ ‡ç­¾ *y.* åˆ†å¸ƒçš„æ­£æ€åˆ†å¸ƒçš„å¯†åº¦å‡½æ•°ï¼Œç°åœ¨æˆ‘ä»¬æ²¡æœ‰å•ä¸ªè§‚æµ‹å€¼ *y* åŠå…¶å¯¹åº”çš„é¢„æµ‹å€¼ *Å·* ï¼Œè€Œæ˜¯å‡ ä¸ªï¼Œæ¯”å¦‚è¯´ *n* ã€‚å‡è®¾æ‰€æœ‰çš„è§‚å¯Ÿéƒ½æ˜¯éšæœºç‹¬ç«‹çš„ï¼Œæˆ‘ä»¬å¾—åˆ°*****

*****![](img/60d4e54787b9d789b55d7107791588d1.png)*****

*****å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚*****

*****ç°åœ¨è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œåŸºæœ¬ä¸Šæ„å‘³ç€ç»Ÿè®¡å­¦å®¶æ‰€è°“çš„*æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€‚*è¿™æ˜¯ä¸€ç§æ¯”è¾ƒèŠ±å“¨çš„è¯´æ³•æˆ‘ä»¬è¦**æœ€å¤§åŒ–**ä¸Šé¢çš„å¯†åº¦å‡½æ•°ï¼Œä¹Ÿå«*ä¼¼ç„¶å‡½æ•°*ã€‚*****

*****ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†æœ€å¤§ä¼¼ç„¶ä¼°è®¡ä¸ MSE æœ€å°åŒ–è”ç³»èµ·æ¥ï¼Œå¦‚ä¸‹æ‰€ç¤º:*****

1.  *****æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°*****
2.  *****æ„å‘³ç€æœ€å¤§åŒ–æœ€å³è¾¹çš„é¡¹*****
3.  *****æ„å‘³ç€æœ€å¤§åŒ– *e* çš„æŒ‡æ•°*****
4.  *****æ„å‘³ç€æœ€å°åŒ–æŒ‡æ•°ä¸­çš„å’Œï¼Œ*****
5.  *****æ„å‘³ç€æœ€å°åŒ– MSE(é™¤ä»¥ *n* ä¸ä¼šæ”¹å˜æœ€ä½³å‚æ•°)ã€‚*****

*****æˆ–è€…ä½œä¸ºä¸€å¼ å›¾ç‰‡:*****

*****![](img/5ba0f910062ef638b1af1a02a75605d5.png)*****

*****å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚*****

## *****æ¦‚åŒ– MSE æŸå¤±*****

*****å¦‚æœä½ ç†¬è¿‡äº†æœ€åä¸€èŠ‚ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œä½ å·²ç»èµ°å¾—å¾ˆè¿œäº†ï¼Œä½ å‡ ä¹è¾¾åˆ°äº†ä½ çš„ç›®æ ‡ï¼æˆ‘ä»¬åªéœ€è¦åšä¸€ä¸ªç®€å•çš„è§‚å¯Ÿ:*****

> *****æˆ‘ä»¬å°† *Ïƒè§†ä¸ºå¸¸æ•°ï¼Œåœ¨è¿›è¡Œæœ€å¤§ä¼¼ç„¶æ³•æ—¶åŸºæœ¬ä¸Šå°†å…¶å¿½ç•¥ã€‚******

*****ä½†æ˜¯ *Ïƒ* ä¹Ÿæ­£æ˜¯æˆ‘ä»¬æƒ³è¦ä¼°è®¡çš„ï¼è¿™æ˜¯å› ä¸ºå®ƒä»å®šä¹‰ä¸ŠæŠ“ä½äº†é¢„æµ‹ä¸­çš„ä¸ç¡®å®šæ€§ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬è®©æˆ‘ä»¬çš„æ¨¡å‹**åœ¨ *Î¼* ( *x* )** ä¹‹å¤–å†è¾“å‡ºä¸€ä¸ªå€¼ *Ïƒ* ( *x* )æ€ä¹ˆæ ·ï¼Ÿè¿™æ„å‘³ç€ï¼Œå³ä½¿å¯¹äºç®€å•çš„å›å½’ï¼Œæ¨¡å‹ä¹Ÿå°†æœ‰ä¸¤ä¸ªè¾“å‡º:ä¸€ä¸ªæ˜¯å¯¹çœŸå®å€¼ *Î¼* ( *x* )çš„ä¼°è®¡ï¼Œå¦ä¸€ä¸ªæ˜¯ç»™å®š *x* çš„ä¸ç¡®å®šæ€§ä¼°è®¡ *Ïƒ* ( *x* )ã€‚*****

*****![](img/82e645db3aaa331830446124019a001a.png)*****

*****å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚*****

*****ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ *Ïƒ* ( *xáµ¢* )ä»£æ›¿ä¸Šé¢ç­‰å¼ä¸­çš„æ‰€æœ‰ *Ïƒ* ï¼Œæˆ‘ä»¬æœ€ç»ˆå¾—åˆ°å¦‚ä¸‹é™ˆè¿°:æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°æ„å‘³ç€æœ€å¤§åŒ–è¯¥é¡¹*****

*****![](img/f5cd52a7cd9c994ac5a527045c3d975f.png)*****

*****å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚*****

*****è¿™åè¿‡æ¥æ„å‘³ç€æœ€å°åŒ–æŒ‡æ•°ä¸­çš„å·¨å¤§æ€»å’Œï¼Œè¿™æ˜¯æˆ‘ä»¬æœ€æ–°å¯¼å‡ºçš„æŸå¤±å‡½æ•°(æ²¡æœ‰å¸å¼•äººçš„åå­—ï¼Œè¯·åœ¨è¯„è®ºä¸­æå‡ºå»ºè®®)ğŸ˜‰):*****

*****![](img/0bb804a0134b39b4987c5eda1267d6c6.png)*****

*****å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚*****

*****æ³¨æ„ï¼Œæˆ‘åœ¨ä¸­åŠ å…¥äº† 1/ *n* ï¼Œä½†æ˜¯è¿™å¹¶æ²¡æœ‰æ”¹å˜æœ€ä¼˜è§£ï¼Œå°±åƒ MSE çš„æƒ…å†µä¸€æ ·ã€‚*****

> ********æ³¨:*** *è¿™ç§æŸå¤±æœ‰ä¸€äº›æœ‰è¶£çš„æ€§è´¨ã€‚é¦–å…ˆï¼Œå®ƒä»ç„¶åŒ…å« MSE ä½(*yáµ¢*â€“*Î¼*(*xáµ¢*))ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸¤ä¸ªæ¶‰åŠ* Ïƒ *çš„æœ¯è¯­:ln(* Ïƒ *(* x *))ä»¥åŠ 1/* Ïƒ *(* x *)ã€‚******
> 
> ******ä¸ºäº†ä¿æŒè¾ƒä½çš„æŸè€—ï¼Œ* ***å‹å·ä¸èƒ½è¾“å‡ºéå¸¸å¤§çš„å€¼ç»™**(*Ã—63)***ï¼Œå› ä¸ºéšç€*Ïƒ*(*Ã—T70)çš„å¢é•¿ï¼Œln(Ïƒ*(*Ã—)å¢åŠ è¯¥æ¨¡å‹ä¹Ÿä¸èƒ½è¾“å‡ºæ¥è¿‘äºé›¶çš„éå¸¸å°çš„å€¼ï¼Œå› ä¸ºè¿™æ ·ä¸€æ¥é¡¹ 1/ Ïƒ *(* x *)å°±å˜å¤§äº†ã€‚è¿™æ ·ï¼Œæ¨¡å‹è¢«è¿«è¾“å‡ºä¸€ä¸ª*åˆç†çš„*çŒœæµ‹ä¸º*Ïƒ*(*x*)**åˆ°* ***å¹³è¡¡ä¸¤é¡¹çš„ç½šå€¼*** *ã€‚******
> 
> *****åªæœ‰å½“(yáµ¢*â€”*Î¼*(*xáµ¢*))å¾ˆå°ï¼Œå³é¢„æµ‹å€¼éå¸¸æ¥è¿‘çœŸå®å€¼æ—¶ï¼Œæ¨¡å‹æ‰èƒ½å¤Ÿè¾“å‡ºå¾ˆå°çš„æ ‡å‡†å·®* Ïƒ *(* x *)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¨¡å‹å¯¹å…¶é¢„æµ‹ç›¸å½“æœ‰æŠŠæ¡ã€‚******

*****å¥½äº†ï¼Œç†è®ºåˆ°æ­¤ä¸ºæ­¢ã€‚æˆ‘ä»¬ç°åœ¨åº”è¯¥ç¼–ç äº†ï¼*****

# *****Tensorflow ä¸­çš„å®ç°*****

*****å¥½äº†ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤æ ·ä¸œè¥¿æ¥åˆ¶é€ ä¸€ä¸ªæ ‡å‡†çš„ç¥ç»ç½‘ç»œè¾“å‡ºä¸ç¡®å®šæ€§:*****

1.  *****åŒ…å«é¢„æµ‹æ ‡å‡†åå·®(=ä¸ç¡®å®šæ€§)çš„ç¬¬äºŒä¸ªè¾“å‡ºèŠ‚ç‚¹ï¼Œä»¥åŠ*****
2.  *****å¦‚ä¸Šæ‰€è¿°çš„å®¢æˆ·æŸå¤±å‡½æ•°ã€‚*****

*****åœ¨ä½ é€‰æ‹©çš„ä»»ä½•æ·±åº¦å­¦ä¹ æ¡†æ¶ä¸­å®ç°è¿™ä¸¤ä»¶äº‹åº”è¯¥éƒ½å¾ˆå®¹æ˜“ã€‚æˆ‘ä»¬å°†åœ¨ Tensorflow ä¸­è¿›è¡Œï¼Œå› ä¸ºä¸Šæ¬¡æˆ‘å·²ç»é€‰æ‹©äº† PyTorch æ¥è§£é‡Šå¯è§£é‡Šçš„ç¥ç»ç½‘ç»œã€‚ğŸ˜*****

*****[](/interpretable-neural-networks-with-pytorch-76f1c31260fe) [## PyTorch å¯è§£é‡Šç¥ç»ç½‘ç»œ

### äº†è§£å¦‚ä½•ä½¿ç”¨ PyTorch æ„å»ºå¯é€šè¿‡è®¾è®¡è§£é‡Šçš„å‰é¦ˆç¥ç»ç½‘ç»œ

towardsdatascience.com](/interpretable-neural-networks-with-pytorch-76f1c31260fe) 

è®©æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­å¼€å§‹ã€‚

## ä¸æ–­çš„å™ªéŸ³

é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç”± 1000 ä¸ªç‚¹ç»„æˆçš„ç©å…·æ•°æ®é›†ï¼Œé€šè¿‡

```
import tensorflow as tf

tf.random.set_seed(0)

X = tf.random.uniform(minval=-1, maxval=7, shape=(1000,))
y = tf.sin(X) + tf.random.normal(mean=0, stddev=0.3, shape=(1000,))
```

æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ•°æ®é›†å¯è§†åŒ–:

![](img/f433d41ea7a1b81ee71ab2b555f31d21.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¥½çš„ï¼Œæ‰€ä»¥å®ƒä»…ä»…æ˜¯ä¸€ä¸ªæ­£å¼¦æ³¢åŠ ä¸Šäº† *N* (0ï¼Œ0.3)åˆ†å¸ƒå™ªå£°ã€‚åœ¨æœ€å¥½çš„æƒ…å†µä¸‹ï¼Œæ¨¡å‹çš„å®é™…é¢„æµ‹éµå¾ªæ­£å¼¦æ³¢ï¼Œè€Œæ¯ä¸ªä¸ç¡®å®šæ€§ä¼°è®¡åœ¨ 0.3 å·¦å³ã€‚æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹æ–¹å¼å»ºç«‹ä¸€ä¸ªç®€å•çš„å‰é¦ˆç½‘ç»œ

```
model = tf.keras.Sequential([
    tf.keras.layers.Dense(32, activation='relu'),
    tf.keras.layers.Dense(32, activation='relu'),
    tf.keras.layers.Dense(32, activation='relu'),
    tf.keras.layers.Dense(2) # Output = (Î¼, ln(Ïƒ))
])
```

å¥½äº†ï¼Œæˆ‘ä»¬å·²ç»é€šè¿‡å®šä¹‰ä¸€ä¸ªæœ‰ä¸¤ä¸ªè¾“å‡ºçš„ç¥ç»ç½‘ç»œå¤„ç†äº†ç¬¬ä¸€ä¸ªè¦ç´ ã€‚***** 

*******ä¸ºäº†ç®€åŒ–è®¡ç®—ï¼Œæˆ‘ä»¬ç›´æ¥å‡è®¾ç¬¬äºŒä¸ªè¾“å‡ºä¸æ˜¯ *Ïƒ* ( *xáµ¢* )ï¼Œè€Œæ˜¯ ln( *Ïƒ* ( *xáµ¢* ))ã€‚**æˆ‘ä»¬è¿™æ ·åšæ˜¯å› ä¸ºæœ€åä¸€å±‚çš„ä¸¤ä¸ªç¥ç»å…ƒå¯ä»¥è¾“å‡ºä»»æ„çš„å®æ•°å€¼ï¼Œå°¤å…¶æ˜¯æ¯”é›¶å°**çš„æ•°å€¼ï¼Œè¿™å¯¹æ ‡å‡†å·®æ²¡æœ‰æ„ä¹‰ã€‚ä½†æ˜¯æ ‡å‡†åå·®çš„å¯¹æ•°å¯ä»¥æ˜¯ä»»ä½•å®æ•°ï¼Œå› æ­¤åŸŸåŒ¹é…ã€‚è€Œä¸”æˆ‘ä»¬æ— è®ºå¦‚ä½•éƒ½éœ€è¦æŸå¤±å‡½æ•°ä¸­çš„ ln( *Ïƒ* ( *xáµ¢* ))ï¼Œé‚£å°±å»äº‰å–å§ã€‚è¯´åˆ°æŸå¤±å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡*******

```
*****def loss(y_true, y_pred):
    mu = y_pred[:, :1] # first output neuron
    log_sig = y_pred[:, 1:] # second output neuron
    sig = tf.exp(log_sig) # undo the log

    return tf.reduce_mean(2*log_sig + ((y_true-mu)/sig)**2)*****
```

*****å‰©ä¸‹çš„å°±æ˜¯ä¸€åˆ‡ç…§æ—§äº†ã€‚ä½ ç”¨è¿™ä¸ªæŸå¤±å‡½æ•°å’Œæ‹Ÿåˆæ¥ç¼–è¯‘æ¨¡å‹ã€‚*****

```
*****model.compile(loss=loss)

model.fit(
    tf.reshape(X, shape=(1000, 1)),
    tf.reshape(y, shape=(1000, 1)),
    batch_size=32,
    epochs=100
)*****
```

*****è®©æˆ‘ä»¬æ£€æŸ¥æ¨¡å‹å·²ç»å­¦ä¹ çš„ä¸ç¡®å®šæ€§ä¼°è®¡:*****

```
*****print(tf.exp(model(X)[:20, 1]))

# Output:
# tf.Tensor(
# [0.29860803 0.27371496 0.32216415 0.32288837 0.31084406 0.30166912
# 0.32059005 0.3331769  0.31244662 0.31863096 0.30940703 0.32042852
# 0.3231969  0.29584357 0.31141806 0.32493973 0.3169802  0.32060665
# 0.30542135 0.31733593], shape=(20,), dtype=float32)*****
```

*****æˆ‘çœ‹ä¸é”™ï¼è¯¥æ¨¡å‹äº†è§£åˆ°å™ªå£°å…·æœ‰å¤§çº¦ 0.3 çš„æ ‡å‡†åå·®ã€‚è¿™æ˜¯æ¨¡å‹æ‰€å­¦å†…å®¹çš„å¯è§†åŒ–:*****

*****![](img/73239f49346e7b6a017ddf3049391f1e.png)*****

*****å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚*****

*****æˆ‘ä»¬å°±å–œæ¬¢è¿™æ ·ã€‚å®é™…é¢„æµ‹ *Î¼* éµå¾ªæ•°æ®ï¼Œè€Œä¸ç¡®å®šæ€§ *Ïƒ* åˆšå¥½é«˜åˆ°è¶³ä»¥æ•æ‰æ ‡ç­¾ *y* ä¸­çš„å™ªå£°ã€‚*****

## *****å˜åŒ–çš„å™ªå£°*****

*****æˆ‘ä»¬ç°åœ¨é€šè¿‡å¼•å…¥éæ’å®šå™ªå£°æ¥å¢åŠ ä¸€ç‚¹è¶£å‘³ï¼Œç»Ÿè®¡å­¦å®¶ç§°ä¹‹ä¸º*å¼‚æ–¹å·®*ã€‚çœ‹çœ‹è¿™ä¸ª:*****

```
*****tf.random.set_seed(0)

X = tf.random.uniform(minval=-1, maxval=7, shape=(1000,))
sig = 0.1*(X+1)
y = tf.sin(X) + tf.random.normal(mean=0, stddev=sig, shape=(1000,))*****
```

*****è¿™åˆ›å»ºäº†ä¸€ä¸ªæ•°æ®é›†ï¼Œå…¶ç‰¹å¾ *X* ä¸­çš„å™ªå£°å¢åŠ ã€‚*****

*****![](img/82415eca52a0a3c477a03342a2468c6e.png)*****

*****å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚*****

*****åŸºæœ¬äº‹å®ä»ç„¶æ˜¯ä¸€æ ·çš„:å®ƒæ˜¯ä¸€ä¸ªæ­£å¼¦æ³¢ï¼Œæ¨¡å‹åº”è¯¥èƒ½å¤Ÿæ•æ‰åˆ°è¿™ä¸€ç‚¹ã€‚ç„¶è€Œï¼Œè¯¥æ¨¡å‹è¿˜åº”è¯¥çŸ¥é“ï¼Œ *X* çš„å€¼è¶Šé«˜ï¼Œæ„å‘³ç€ä¸ç¡®å®šæ€§è¶Šé«˜ã€‚*****

*******å‰§é€:å¦‚æœä½ åœ¨æ–°çš„æ•°æ®é›†ä¸Šé‡æ–°è®­ç»ƒå¦‚ä¸Šç›¸åŒçš„æ¨¡å‹ï¼Œè¿™æ­£æ˜¯ä½ å°†çœ‹åˆ°çš„ã€‚*******

*****![](img/bc4c7e78f56b9c4351faac668508c9a7.png)*****

*****å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚*****

*****åœ¨æˆ‘çœ‹æ¥å¾ˆå¯çˆ±ã€‚*****

# *****ç»“è®º*****

*****åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨äº†è§£äº†å¦‚ä½•è°ƒæ•´ç¥ç»ç½‘ç»œï¼Œä½¿å…¶èƒ½å¤Ÿè¾“å‡ºå¯¹ä¸ç¡®å®šæ€§çš„ä¼°è®¡ä»¥åŠå®é™…é¢„æµ‹ã€‚å®ƒåªéœ€è¦ä¸€ä¸ªé¢å¤–çš„è¾“å‡ºç¥ç»å…ƒå’Œä¸€ä¸ªæ¯” MSE ç¨å¾®å¤æ‚ä¸€ç‚¹çš„æŸå¤±å‡½æ•°ã€‚*****

*****ä¸ç¡®å®šæ€§ä¼°è®¡çš„å¥½å¤„æ˜¯ï¼Œå®ƒä»¬è®©æ‚¨è¯„ä¼°æ¨¡å‹å¯¹å…¶é¢„æµ‹çš„ä¿¡å¿ƒï¼Œæ‚¨çŸ¥é“æ˜¯å¦å¯ä»¥ä¿¡ä»»æ¨¡å‹çš„é¢„æµ‹ã€‚å®ƒä»¬è¿˜å…è®¸æ‚¨æŠ¥å‘Šä¼°è®¡çš„ä¸‹é™æˆ–ä¸Šé™ï¼Œè¿™åœ¨è®¡ç®—æœ€å¥½æˆ–æœ€åçš„æƒ…å†µæ—¶å¾ˆæœ‰ä»·å€¼ã€‚*****

*****å¦ä¸€ç§è·å¾—ä¸ç¡®å®šæ€§ä¼°è®¡çš„æµè¡Œæ–¹æ³•æ˜¯ä½¿ç”¨è´å¶æ–¯æ¨ç†ã€‚ç„¶è€Œï¼Œæ•°å­¦æ›´å¤æ‚ï¼Œè€Œä¸”æ¯”æˆ‘åœ¨è¿™é‡Œå‘ä½ å±•ç¤ºçš„è§£å†³æ–¹æ¡ˆè¦æ…¢å¾—å¤šã€‚æ­¤å¤–ï¼Œæˆ‘å‘ç°(æ·±åº¦)è´å¶æ–¯å­¦ä¹ çš„è½¯ä»¶åŒ…ç›®å‰ä¸åƒ Tensorflow æˆ– PyTorch é‚£æ ·å®¹æ˜“ä½¿ç”¨ï¼Œå°½ç®¡è¿™å¯èƒ½ä¼šåœ¨è´å¶æ–¯æ–¹æ³•è·å¾—æ›´å¤šç‰µå¼•åŠ›æ—¶å‘ç”Ÿå˜åŒ–ã€‚ä¸è¿‡ï¼Œæˆ‘å–œæ¬¢è¿™ä¸ªè¯é¢˜ï¼Œæ‰€ä»¥ä¹Ÿæ¥çœ‹çœ‹å§ï¼ğŸ˜‰*****

*****æˆ‘åœ¨è¿™é‡Œç»™ä½ çš„æ˜¯ä¸€ä¸ªç®€å•çš„å·¥å…·ï¼Œè®©ä½ é¿å¼€è´å¶æ–¯çš„äº‰è®ºï¼Œä¸éœ€è¦ä½ æ”¹å˜å¤ªå¤šçš„æ—¥å¸¸è¡Œä¸ºï¼ŒåŒæ—¶ä»ç„¶ç»™ä½ ä¸€ä¸ªè´å¶æ–¯ä¸–ç•Œçš„å·¨å¤§å¥½å¤„ã€‚*****

*******å¥–é‡‘(æ„Ÿè°¢** [**çš„å·¨å¤§æŠ•å…¥)å¡æ´›æ–¯é˜¿é›…-è«é›·è¯º**](https://www.linkedin.com/in/carlosayam/)**:**è·å¾—ä¸ç¡®å®šæ€§ä¼°è®¡çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨è‡ªä¸¾ã€‚åŸºæœ¬ä¸Šï¼Œå¦‚æœä½ ä½¿ç”¨éšæœºæ£®æ—ï¼Œè¿™å°±æ˜¯æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…:ä½ é€šè¿‡å­é‡‡æ ·ä»ä½ çš„åŸå§‹æ•°æ®é›†åˆ›å»º *b* ä¸ªæ›´å°çš„æ•°æ®é›†ï¼Œåœ¨æ¯ä¸ªæ•°æ®é›†ä¸Šè®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œç„¶åä½ å¾—åˆ° *b* ä¸ªè¾“å…¥çš„ä¸åŒé¢„æµ‹ã€‚è¿™äº› *b* é¢„æµ‹çš„å¹³å‡å€¼æ˜¯ä½ çš„æœ€ç»ˆé¢„æµ‹ï¼Œè€Œè¿™äº› *b* é¢„æµ‹çš„æ ‡å‡†å·®æ˜¯ä¸ç¡®å®šæ€§çš„åº¦é‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‰€æœ‰ *b* æ¨¡å‹çš„è¾“å‡ºéƒ½å·®ä¸å¤šï¼Œé‚£ä¹ˆä¸ç¡®å®šæ€§å°±ä¼šå¾ˆå°ã€‚*****

*****ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•çš„é—®é¢˜æ˜¯ï¼Œä½ éœ€è¦è®­ç»ƒä¸åŒçš„è½¦å‹ï¼Œè¿™å¯èƒ½ç›¸å½“æ˜‚è´µã€‚åœ¨éšæœºæ£®æ—ä¸­ï¼Œå®ƒå·¥ä½œå¾—å¾ˆå¥½ï¼Œå› ä¸ºå•ä¸ªå†³ç­–æ ‘å¿«é€Ÿä¸”å®¹æ˜“é€‚åº”ã€‚å¯¹äºç¥ç»ç½‘ç»œæ¥è¯´ï¼Œäº‹æƒ…çœ‹èµ·æ¥æ›´é»‘æš—ã€‚æ°é‡Œç±³Â·å°¼å…‹æ¾(Jeremy Nixon)ç­‰äººä¹Ÿåšäº†[ç ”ç©¶](https://www.gatsby.ucl.ac.uk/~balaji/why_arent_bootstrapped_neural_networks_better.pdf)ï¼Œå³ä½¿æŠ›å¼€è®¡ç®—é—®é¢˜ï¼Œè‡ªä¸¾ç¥ç»ç½‘ç»œå¯èƒ½ä¹Ÿä¸ä¼šå¤ªæœ‰ç›Šã€‚*****

*****æˆ‘å¸Œæœ›ä½ ä»Šå¤©å­¦åˆ°äº†æ–°çš„ã€æœ‰è¶£çš„ã€æœ‰ç”¨çš„ä¸œè¥¿ã€‚æ„Ÿè°¢é˜…è¯»ï¼*****

*******ä½œä¸ºæœ€åä¸€ç‚¹ï¼Œå¦‚æœä½ *******

1.  *******æƒ³æ”¯æŒæˆ‘å¤šå†™ç‚¹æœºå™¨å­¦ä¹ å’Œ*******
2.  *******æ— è®ºå¦‚ä½•éƒ½è®¡åˆ’è·å¾—ä¸€ä¸ªä¸­ç­‰è®¢é˜…ï¼Œ*******

*******ä¸ºä»€ä¹ˆä¸åš** [**é€šè¿‡è¿™ä¸ªç¯èŠ‚**](https://dr-robert-kuebler.medium.com/membership) **ï¼Ÿè¿™å°†å¯¹æˆ‘å¸®åŠ©å¾ˆå¤§ï¼ğŸ˜Š*******

******è¯´ç™½äº†ï¼Œç»™ä½ çš„ä»·æ ¼ä¸å˜ï¼Œä½†å¤§çº¦ä¸€åŠçš„è®¢é˜…è´¹ç›´æ¥å½’æˆ‘ã€‚******

*****éå¸¸æ„Ÿè°¢ï¼Œå¦‚æœä½ è€ƒè™‘æ”¯æŒæˆ‘çš„è¯ï¼*****

> ******å¦‚æœ‰é—®é¢˜ï¼Œåœ¨*[*LinkedIn*](https://www.linkedin.com/in/dr-robert-k%C3%BCbler-983859150/)*ä¸Šå†™æˆ‘ï¼******
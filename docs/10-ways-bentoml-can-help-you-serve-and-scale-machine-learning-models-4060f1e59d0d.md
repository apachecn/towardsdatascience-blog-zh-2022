# å¦‚ä½•è½»æ¾åœ°æœåŠ¡å’Œéƒ¨ç½²æœºå™¨å­¦ä¹ æ¨¡å‹

> åŸæ–‡ï¼š<https://towardsdatascience.com/10-ways-bentoml-can-help-you-serve-and-scale-machine-learning-models-4060f1e59d0d>

## `Moving from Jupyter notebooks to production is not that difficult`æ¯•ç«Ÿ

![](img/99eeeac9ec933e73821acbe0dac1de79.png)

å¼—å…°Â·é›…å…‹è€¶åœ¨ Unsplash[ä¸Šçš„ç…§ç‰‡](https://unsplash.com?utm_source=medium&utm_medium=referral)

å¦‚æœæ‚¨æ˜¯ä¸€åæ•°æ®ç§‘å­¦å®¶ï¼Œæ‚¨å¯èƒ½ä¼šèŠ±å¤§é‡æ—¶é—´å¼€å‘å¤æ‚çš„ Jupyter ç¬”è®°æœ¬æ¥æ‰§è¡Œæ•°æ®åˆ†æã€æ„å»ºå¤æ‚çš„åŸ¹è®­ç®¡é“æˆ–è®¡ç®—ç»Ÿè®¡æ•°æ®ã€‚

Jupyter ç¬”è®°æœ¬åœ¨è¿™æ–¹é¢éå¸¸æ£’ï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥ç«‹åˆ»æ„å»ºå‡ºæƒ³æ³•çš„åŸå‹ã€‚

**ä½†æ˜¯ï¼Œä¸€æ—¦æ‚¨å®Œæˆäº†è¿™é¡¹å·¥ä½œï¼Œå¹¶ä¸”å¯¹ä¿å­˜çš„ ML æ¨¡å‹æ„Ÿåˆ°æ»¡æ„ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼ŸğŸ¤”**

è¿™æ˜¯æ‚¨å¼€å§‹è€ƒè™‘å°†å®ƒä»¬éƒ¨ç½²åˆ°ç”Ÿäº§ä¸­çš„åœ°æ–¹ã€‚ä½ å¼€å§‹å·¥ä½œçš„æ—¶å€™æœ‰æ²¡æœ‰æƒ³æ¸…æ¥šè¿™ä¸€ç‚¹ï¼Ÿ

å¤§æ¦‚ä¸ä¼šã€‚è¿™ä¸æ€ªä½ ï¼Œå› ä¸ºè¿™ä¸æ˜¯æ•°æ®ç§‘å­¦å®¶çš„æ ¸å¿ƒä¸“é•¿ã€‚(å°½ç®¡è¡Œä¸šç›®å‰æ­£æœç€è¿™ä¸ªæ–¹å‘å‘å±•)

> åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•ä½¿ç”¨ä¸€ä¸ªåä¸º BentoML çš„ Python åº“æ¥æ‰“åŒ…æ‚¨çš„æœºå™¨å­¦ä¹ æ¨¡å‹å¹¶è½»æ¾éƒ¨ç½²å®ƒä»¬ã€‚
> 
> ***æˆ‘å…ˆç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹åˆ¶ä½œ ML çš„æ¦‚å¿µã€‚ç„¶åï¼Œæˆ‘å°†å‘æ‚¨ä»‹ç»è¯¥å·¥å…·ï¼Œå¹¶æ¶µç›– BentoML å¯ä»¥è®©æ‚¨çš„ç”Ÿæ´»å˜å¾—æ›´è½»æ¾çš„ 10 ç§æ–¹å¼ã€‚***

*PS:è¿™ä¸æ˜¯ä¸€ç¯‡ clickbait çš„æ–‡ç« :æ‰€æœ‰è¿™äº›ç†ç”±éƒ½æ˜¯æœ‰æ•ˆçš„ã€æœ‰æ®å¯æŸ¥çš„ç†ç”±ã€‚å¯¹äºæ¯ä¸€ä¸ªï¼Œæˆ‘å°†åˆ†äº«ä»£ç ï¼Œè§£é‡Šå’Œæˆ‘çš„å°è±¡ã€‚*

äº‹ä¸å®œè¿Ÿï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ğŸ”

# ä¸€æ—¦ä½ çš„æ¨¡å‹è¢«è®­ç»ƒåä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

ä¸€æ—¦ä½ è®­ç»ƒäº†ä¸€ä¸ªæ¨¡å‹ï¼Œä½ éœ€è¦å¼€å§‹è€ƒè™‘ä¸å…¶ä»–å›¢é˜Ÿåˆ†äº«å®ƒã€‚

å¦‚æœæ‚¨å›¢é˜Ÿä¸­çš„å…¶ä»–å¼€å‘äººå‘˜(ä¾‹å¦‚åç«¯æˆ–å‰ç«¯å¼€å‘äººå‘˜)æƒ³è¦ä½¿ç”¨å®ƒï¼Œä»–ä»¬éœ€è¦ä¸åŒ…è£…å®ƒçš„æŸç§ API è¿›è¡Œäº¤äº’ã€‚è¿™ä¸ª API å¿…é¡»æ¸…æ™°å¹¶æœ‰æ–‡æ¡£è®°å½•ï¼Œæœ‰æ˜ç¡®çš„é”™è¯¯è®°å½•å’Œæ•°æ®éªŒè¯ã€‚

å¦‚æœ DevOps å›¢é˜Ÿæƒ³è¦ç®¡ç†æ‚¨çš„æ¨¡å‹çš„éƒ¨ç½²ï¼Œå®ƒéœ€è¦å¤„ç†å®ƒçš„ä¾èµ–å…³ç³»ã€‚å®ƒé€šå¸¸æœŸæœ›è‡³å°‘æœ‰ä¸€ä¸ªè¿è¡Œå¹¶æœåŠ¡äºæ‚¨çš„æ¨¡å‹çš„ Docker æ˜ åƒã€‚

å¦‚æœäº§å“å›¢é˜Ÿæƒ³è¦å¯¹æ‚¨çš„æ¨¡å‹è¿›è¡Œå‹åŠ›æµ‹è¯•æˆ–è€…å‘å®¢æˆ·å±•ç¤ºï¼Œé‚£ä¹ˆ API å¿…é¡»èƒ½å¤Ÿé€‚åº”è®¸å¤šå¹¶å‘è¯·æ±‚ã€‚

![](img/a4cd4f27f7ad861d53cff364507d1a8d.png)

æ¥ä¸‹æ¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½œè€…å›¾ç‰‡

è¿™é‡Œæ€»ç»“ä¸€ä¸‹ã€‚

å°†ä¸€ä¸ª ML æ¨¡å‹å¸¦å…¥ç”Ÿæ´»(å³ç”Ÿäº§)ä¼šæœ‰å¾ˆå¤šé™åˆ¶:

*   å¤š ML æ¡†æ¶çš„ä½¿ç”¨å’Œæ”¯æŒ(å’„ï¼)
*   åˆ›å»º API å¹¶ä»¥æœ€ä½çš„æ€§èƒ½æ°´å¹³ä¸ºå…¶æœåŠ¡
*   å†ç°æ€§å’Œä¾èµ–æ€§ç®¡ç†
*   API æ–‡æ¡£
*   ç›‘æ§ã€æ—¥å¿—è®°å½•ã€æŒ‡æ ‡ç­‰ã€‚

åŠ¿ä¸å¯æŒ¡ä¸æ˜¯å—ï¼Ÿ

åœ¨æ¥ä¸‹æ¥çš„ 10 èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡æ¦‚å¿µã€æœ‰ç”¨çš„å‘½ä»¤å’Œ ML ç›¸å…³çš„ç‰¹æ€§æ¥æ¢ç´¢ BentoML æ˜¯å¦‚ä½•å®ç°è¿™ä¸€ç‚¹çš„ã€‚

# 1â€” BentoMLğŸ±:åˆ†å‘æ‚¨çš„ ML æ¨¡å‹çš„æ ‡å‡†åŒ–æ ¼å¼

[**BentoML**](https://www.bentoml.com/) æ˜¯æ¨¡å‹æœåŠ¡å’Œéƒ¨ç½²çš„ç«¯åˆ°ç«¯è§£å†³æ–¹æ¡ˆã€‚å®ƒæ—¨åœ¨å¸®åŠ©æ•°æ®ç§‘å­¦å®¶åˆ©ç”¨é€šç”¨ MLOps æœ€ä½³å®è·µæ„å»ºç”Ÿäº§å°±ç»ªå‹ç»ˆç«¯ã€‚

> å®ƒæ˜¯å¦ä¸€ä¸ª web æ¡†æ¶å—ï¼Ÿ

ä¸å®Œå…¨æ˜¯ã€‚BentoML å°† ML é¡¹ç›®ä¸­éœ€è¦çš„æ‰€æœ‰ä¸œè¥¿æ‰“åŒ…æˆä¸€ä¸ªåä¸º ***çš„åˆ†å‘æ ¼å¼ğŸ±***

**æ›´å‡†ç¡®åœ°è¯´ï¼Œä¾¿å½“æ˜¯ä¸€ä¸ªæ–‡ä»¶æ¡£æ¡ˆï¼ŒåŒ…å«æ‚¨çš„æ¨¡å‹è®­ç»ƒçš„æ‰€æœ‰**æºä»£ç **å’Œæ‚¨å®šä¹‰çš„ç”¨äºæœåŠ¡çš„**API**ï¼Œä¿å­˜çš„**äºŒè¿›åˆ¶æ¨¡å‹**ï¼Œ**æ•°æ®æ–‡ä»¶**ï¼Œ**docker æ–‡ä»¶**ï¼Œ**ä¾èµ–å…³ç³»**ï¼Œä»¥åŠé™„åŠ çš„**é…ç½®**ã€‚**

**æ‰€æœ‰çš„ä¸œè¥¿éƒ½ç»„åˆæˆä¸€ä¸ªå•å…ƒï¼Œå¹¶æ‰“åŒ…æˆä¸€ç§æ ‡å‡†åŒ–çš„æ ¼å¼ã€‚**

**ä½ å¯ä»¥æŠŠä¾¿å½“æƒ³è±¡æˆ Docker å›¾åƒï¼Œä½†æ˜¯å¯¹äº MLã€‚**

**![](img/8073127282f9321820e391db6837d49d.png)**

**BentoML â€”ä½œè€…å›¾ç‰‡**

**ä¸€ä»½ç›’é¥­ä¹Ÿæ˜¯è‡ªå¸¦çš„ã€‚è¿™ç®€åŒ–äº†ä»»ä½•äº‘åŸºç¡€æ¶æ„çš„æ¨¡å‹æœåŠ¡å’Œéƒ¨ç½²ã€‚**

**å½“ä½ çš„ä¾¿å½“è¢«æ„å»ºæ—¶(æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚çœ‹åˆ°è¿™æ„å‘³ç€ä»€ä¹ˆ)ï¼Œä½ å¯ä»¥æŠŠå®ƒå˜æˆä¸€ä¸ª Docker é•œåƒï¼Œä½ å¯ä»¥éƒ¨ç½²åœ¨äº‘ä¸Šï¼Œæˆ–è€…ä½¿ç”¨`[**bentoctl**](https://github.com/bentoml/bentoctl)` ï¼Œå®ƒä¾èµ–äºå¹•åçš„ Terraformï¼Œå¹¶æŠŠä½ çš„ä¾¿å½“éƒ¨ç½²åˆ°ä»»ä½•äº‘æœåŠ¡å’ŒåŸºç¡€è®¾æ–½(AWS Lambda æˆ– EC2ï¼ŒGCP äº‘è¿è¡Œï¼ŒAzure å‡½æ•°ï¼Œç­‰ç­‰)ã€‚**

**![](img/e4b8d0713efbb0249407558966b88191.png)**

**å¦‚ä½•éƒ¨ç½²ä¾¿å½“â€”ä½œè€…å›¾ç‰‡**

# **2-å°†æ¨¡å‹ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨å¹¶è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ğŸ’¾**

**é¦–å…ˆï¼Œä½ éœ€è¦è¿è¡Œ:`**pip install bentoml**`**

***ä¸€æ—¦å®‰è£…å®Œæ¯•ï¼Œ* `*bentoml*` *å‘½ä»¤å°±ä¼šè¢«æ·»åŠ åˆ°æ‚¨çš„ shell ä¸­:è¿™åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ä¼šå¾ˆæœ‰ç”¨ã€‚***

**å½“æ‚¨çš„æ¨¡å‹å®Œæˆè®­ç»ƒæ—¶ï¼Œæ‚¨é€šå¸¸ä¼šå¼€å§‹ä½¿ç”¨ BentoML(è¿™ä¸€éƒ¨åˆ†ä¸å—å½±å“)**

**äº‹å®ä¸Šï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ BentoML å°†æ¨¡å‹ä¿å­˜åœ¨ç‰¹å®šçš„æ–‡ä»¶å¤¹ä¸­(ç§°ä¸ºæ¨¡å‹å­˜å‚¨)ï¼Œè€Œä¸æ˜¯ä¿å­˜åœ¨æ–‡ä»¶ç³»ç»Ÿçš„æŸä¸ªåœ°æ–¹ã€‚è¿™æœ‰åŠ©äºä¸ºæ¨¡å‹çš„æ¯ä¸ªç‰ˆæœ¬æä¾›å”¯ä¸€çš„æ ‡ç­¾ï¼Œå¹¶ç¡®ä¿å¯å†ç°æ€§ã€‚**

**åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¿å­˜äº†ä¸€ä¸ªåœ¨ iris æ•°æ®é›†ä¸Šè®­ç»ƒçš„ SVC æ¨¡å‹ã€‚**

**è¿™å°†ç”Ÿæˆä¸€ä¸ªæƒŸä¸€çš„æ¨¡å‹æ ‡è®°ï¼Œå…è®¸æ‚¨ç¨åè·å–ç›¸åº”çš„æ¨¡å‹ã€‚**

**![](img/18960d8b08f6cad244e1a3aebf8556b4.png)**

**å®ƒè¿˜ä¼šåˆ›å»ºä¸€ä¸ªä»¥æ¨¡å‹æ ‡è®°å‘½åçš„æ–‡ä»¶å¤¹ã€‚å¦‚æœæŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬ä¼šå‘ç°äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸€ä¸ªåä¸º`model.yaml`çš„ Yaml æ–‡ä»¶ï¼Œå®ƒæè¿°äº†æ¨¡å‹å…ƒæ•°æ®ã€‚**

**![](img/40d07de2eb113334dfafba15a007e208.png)**

**ä½œè€…å›¾ç‰‡**

# ****3â€”åˆ›å»ºæ¨ç†æœåŠ¡ï¼Œå°†æ¨¡å‹å…¬å¼€ä¸º APIâš™ï¸****

**ä¸€æ—¦æ¨¡å‹è¢«åˆ›å»ºå¹¶ä¿å­˜åœ¨æ¨¡å‹å­˜å‚¨ä¸­ï¼Œæ‚¨å°±å¯ä»¥å°†å®ƒè½¬æ¢æˆæ‚¨å¯ä»¥è¯·æ±‚çš„ API ç«¯ç‚¹ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œé¦–å…ˆå¿…é¡»åˆ›å»ºä¸€ä¸ªè°ƒç”¨æ¨¡å‹è¿è¡Œå™¨çš„æœåŠ¡ï¼Œç„¶åç”¨å®ƒæ¥ä¿®é¥°ä¸€ä¸ªå‡½æ•°ã€‚**

**åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå½“æœ‰æ•ˆè´Ÿè½½æ•°æ®(NumpyNdarray ç±»å‹)é€šè¿‡ HTTP POST è¯·æ±‚å‘é€åˆ°`/classify`ç«¯ç‚¹è·¯å¾„æ—¶ï¼Œç”¨`api`æ–¹æ³•ä¿®é¥°çš„ ***classify*** å‡½æ•°è¿è¡Œä»£ç ã€‚**

**ç„¶åï¼Œé€šè¿‡ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡ŒæœåŠ¡ï¼Œæ‚¨å¯ä»¥åœ¨æœ¬åœ°ä¸ºæ¨¡å‹æä¾›æœåŠ¡:**

```
bentoml serve service:svc --reload
```

**![](img/3b10f7c2e3c27c665b4ab41d2e631c30.png)**

**è¿™å°†æ‰“å¼€ä¸€ä¸ª HTTP æœ¬åœ°æœåŠ¡å™¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Python è¯·æ±‚å®ƒ**

**æˆ–ç•Œé¢(ç›´æ¥è®¿é—® [http://localhost:3000)](http://localhost:3000))**

**![](img/1553fc0868f2ab24fb799e56a57db122.png)****![](img/f4a5b0d07e1bdd6e4ad54099248aa860.png)**

**é€šè¿‡ Swagger UI è¯·æ±‚â€”ä½œè€…æä¾›çš„å›¾ç‰‡**

# ****4â€”åˆ¶ä½œå¹¶å®šåˆ¶æ‚¨çš„ä¾¿å½“ğŸ—****

**åœ¨è¿™é‡Œä½ å¯ä»¥æ„å»ºä¸€ä¸ªä¾¿å½“ï¼Œçœ‹çœ‹é‡Œé¢æœ‰ä»€ä¹ˆæ–‡ä»¶ã€‚è¿™ä¸ºæ‚¨çš„æ‰€æœ‰é¡¹ç›®æä¾›äº†ä¸€ä¸ªç‹¬ç«‹äºåº•å±‚å·¥å…·çš„æ ‡å‡†åŒ–ç»“æ„ã€‚**

**è¦æ„å»ºæ‚¨çš„ä¾¿å½“ï¼Œæ‚¨é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªåä¸º`bentofile.yaml`çš„æ–‡ä»¶**

**è¿™ä¸ªæ–‡ä»¶é…ç½®å¦‚ä½•æ„å»ºä¾¿å½“:å®ƒåŒ…æ‹¬å…ƒæ•°æ®ï¼Œåˆ—å‡ºæœ‰ç”¨çš„æºä»£ç ï¼Œå¹¶å®šä¹‰åŒ…åˆ—è¡¨ã€‚**

**è¦æ„å»ºä¾¿å½“ï¼Œåœ¨åŒ…å«`bentofile.yaml`çš„æ–‡ä»¶å¤¹ä¸­è¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚**

```
bentoml build
```

**![](img/28138f12cc277884ad5c46fbc03ad0f2.png)**

**ä½œè€…å›¾ç‰‡**

**ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬æŸ¥çœ‹ä¾¿å½“å¹¶æ£€æŸ¥é‡Œé¢æœ‰ä»€ä¹ˆï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä»¥ä¸‹æ–‡ä»¶å¤¹ç»“æ„ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹å†…å®¹:**

*   **API çš„æè¿°å’Œæ¨¡å¼**
*   **æ„å»º Docker æ˜ åƒæ‰€éœ€çš„ Docker æ–‡ä»¶**
*   **Python éœ€æ±‚**
*   **ç»è¿‡è®­ç»ƒçš„æ¨¡å‹åŠå…¶å…ƒæ•°æ®**
*   **è´Ÿè´£è®­ç»ƒæ¨¡å‹å’Œå®šä¹‰ API è·¯çº¿çš„æºä»£ç **
*   **æŒ‡å®šä¾¿å½“æ„å»ºé€‰é¡¹çš„é…ç½®(`**bentoml.yaml**`)**

**![](img/d368b7f3fd1acc5a7639c6996068b9b2.png)**

**ä½œè€…å›¾ç‰‡**

# ****5â€”å°†ä¾¿å½“è£…å…¥ Docker å›¾åƒä¸­ğŸ³****

**ä¸€æ—¦åˆ›å»ºäº†ä¾¿å½“ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`dockerize`å‘½ä»¤æ¥æ„å»ºä¸€ä¸ªå¥å£®çš„ Docker æ˜ åƒã€‚è¿™æ˜¯ bentoml æä¾›çš„ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç‰¹æ€§ã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ FastAPIï¼Œé‚£ä¹ˆæ‚¨å¿…é¡»æ‰‹åŠ¨å®Œæˆè¿™é¡¹å·¥ä½œã€‚**

**BentoML æä¾›äº†è¿™ä¸ªç®€å•çš„å‘½ä»¤æ¥ä¸ºæ‚¨æ„å»ºå›¾åƒã€‚**

```
 bentoml containerize iris_classifier:latest
```

**![](img/c690ff02d40fbab7949e99362a661844.png)**

**å°†ä¾¿å½“å®¹å™¨åŒ–â€”â€”ä½œè€…çš„å½¢è±¡**

**ä¸€æ—¦æ„å»ºäº†æ˜ åƒï¼Œæ‚¨å°±å¯ä»¥åœ¨æ‚¨çš„ç³»ç»Ÿä¸Šæ£€æŸ¥å®ƒ:**

**![](img/25fa5ccbe4537dd1a479e5b860a4be4d.png)**

**ä½œè€…å›¾ç‰‡**

**è¿™ä¸ª Docker æ˜ åƒæ˜¯è‡ªåŒ…å«çš„ï¼Œç”¨äºåœ¨æœ¬åœ°æä¾›ä¾¿å½“æˆ–å°†å…¶éƒ¨ç½²åˆ°äº‘ä¸­ã€‚**

```
docker run -it --rm -p 3000:3000 iris_classifier:jclapisz2s6qyhqa serve --production
```

**![](img/efc894ff8bf6860a42a97d1a35963fa2.png)**

**ä»å®¹å™¨åˆ°ä¸»äººç«¯ä¸Šä¾¿å½“â€”â€”å›¾ç‰‡ç”±ä½œè€…æä¾›**

# ****6â€”â€”ä½¿ç”¨è·‘æ­¥è€…ç‹¬ç«‹äº web è¯·æ±‚æ‰©å±•æ¨ç†ğŸš€****

**Runners æ˜¯ç‰¹å®šäº ML çš„è®¡ç®—å•å…ƒï¼Œå®ƒå…è®¸æ¨ç†è¿‡ç¨‹ç‹¬ç«‹äº web æœåŠ¡å™¨è¿›è¡Œæ‰©å±•ã€‚**

**è¿™æ„å‘³ç€æ¨ç†å’Œ web è¯·æ±‚å¤„ç†è¿è¡Œåœ¨ä¸¤ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ä¸Šã€‚**

**è¿™ä¹Ÿæ„å‘³ç€æ‚¨çš„æ¨ç†ç®¡é“å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„è¿è¡Œå™¨ï¼Œå¹¶ä¸”å¯ä»¥å‚ç›´ä¼¸ç¼©(é€šè¿‡åˆ†é…æ›´å¤šçš„ CPU)ã€‚æ¯ä¸ªè¿è¡Œå™¨ä¹Ÿå¯ä»¥æœ‰ç‰¹å®šçš„é…ç½®(RAMã€CPU ä¸ GPU ç­‰ã€‚)**

**ä¾‹å¦‚ï¼Œè¿™ç§æ¶æ„å…è®¸ä½ æ‹¥æœ‰ä¸€ä¸ªä¾èµ–äºä¸‰ä¸ªç‹¬ç«‹çš„è¿è¡Œè€…æ¥å¤„ç†ä¸åŒäº‹æƒ…çš„æœåŠ¡ã€‚**

**åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œä¸¤ä¸ªè¿è¡Œå™¨(ä¸€ä¸ªæ‰§è¡Œ OCR ä»»åŠ¡ï¼Œå¦ä¸€ä¸ªæ‰§è¡Œæ–‡æœ¬åˆ†ç±»)åœ¨è¾“å…¥å›¾åƒä¸Šé¡ºåºè¿è¡Œã€‚**

**ä½ å¯ä»¥åœ¨è¿™é‡Œäº†è§£æ›´å¤šå…³äºè·‘æ­¥è€…çš„ä¿¡æ¯[ã€‚](https://docs.bentoml.org/en/latest/concepts/runner.html)**

# ****7 â€”æ”¯æŒè‡ªé€‚åº”æ‰¹å¤„ç†****

**æ‰¹å¤„ç†æ˜¯å¯¹ä¸€ç»„ N ä¸ªè¾“å…¥è¿è¡Œé¢„æµ‹è€Œä¸æ˜¯å¯åŠ¨ N ä¸ªé¡ºåºé¢„æµ‹çš„æœ¯è¯­ã€‚
è¿™å…·æœ‰ä¼˜åŠ¿:å®ƒ**æé«˜äº†æ€§èƒ½**å’Œ**ååé‡**å’Œ**åˆ©ç”¨åŠ é€Ÿç¡¬ä»¶**(GPU å› åŠ é€ŸçŸ¢é‡åŒ–è¿ç®—è€Œé—»å)**

**FastAPIã€Flask æˆ– Django ç­‰ Web æ¡†æ¶æ²¡æœ‰å¤„ç†æ‰¹å¤„ç†çš„æœºåˆ¶ã€‚**

**å¦ä¸€æ–¹é¢ï¼ŒBentoML ä¸ºæ­¤æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚**

**äº‹æƒ…æ˜¯è¿™æ ·çš„:**

*   **å¤šä¸ªè¾“å…¥è¯·æ±‚å¹¶è¡Œè¿è¡Œ**
*   **ä»£ç†(å³è´Ÿè½½å¹³è¡¡å™¨)åœ¨å·¥ä½œå™¨ä¹‹é—´åˆ†å‘è¯·æ±‚(å·¥ä½œå™¨æ˜¯ API æœåŠ¡å™¨çš„è¿è¡Œå®ä¾‹)**
*   **æ¯ä¸ªå·¥ä½œäººå‘˜å°†è¯·æ±‚åˆ†å‘ç»™è´Ÿè´£æ¨ç†çš„æ¨¡å‹è¿è¡Œäººå‘˜**
*   **æ¯ä¸ªè¿è¡Œå™¨é€šè¿‡åœ¨å»¶è¿Ÿå’Œååé‡ä¹‹é—´æ‰¾åˆ°ä¸€ä¸ªæŠ˜è¡·ï¼ŒåŠ¨æ€åœ°å°†è¯·æ±‚åˆ†æ‰¹åˆ†ç»„**
*   **è·‘æ­¥è€…å¯¹æ¯ä¸€æ‰¹è¿›è¡Œé¢„æµ‹**
*   **ç„¶åï¼Œæ‰¹é‡é¢„æµ‹è¢«æ‹†åˆ†å¹¶ä½œä¸ºå•ç‹¬çš„å“åº”å‘å¸ƒ**

**è¿™ä¸€ç‚¹çš„ç¾å¦™ä¹‹å¤„åœ¨äºï¼Œå¯¹äºå‘é€å¤šä¸ªå¹¶è¡Œè¯·æ±‚çš„å®¢æˆ·æœºæ¥è¯´ï¼Œè¿™æ˜¯å®Œå…¨é€æ˜çš„ã€‚**

**![](img/8b925447a71b77fa9e73ee4cb90bf560.png)**

**å›¾ç‰‡ç”±ä½œè€…ä¿®æ”¹**

**è¦å¯ç”¨æ‰¹å¤„ç†ï¼Œæ‚¨éœ€è¦å°†`batchable`å‚æ•°è®¾ç½®ä¸º Trueã€‚ç¤ºä¾‹:**

**ç‚¹å‡» ***äº†è§£æ›´å¤šé…æ–™ [***ã€‚***](https://docs.bentoml.org/en/latest/guides/batching.html)*****

# **8 â€”å¹³è¡Œæ¨ç†**

**è·‘æ­¥è€…æœ‰ä¸€ç§ä¼˜é›…çš„æ°”è´¨ã€‚æ‚¨å¯ä»¥æ ¹æ®éœ€è¦ç»„åˆå®ƒä»¬ï¼Œä»¥åˆ›å»ºå¯å®šåˆ¶çš„æ¨ç†å›¾ã€‚åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çœ‹äº†ä¸¤ä¸ªè·‘æ­¥è€…ä¾æ¬¡è·‘æ­¥ã€‚(OCR ->æ–‡æœ¬åˆ†ç±»)ã€‚**

**åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†é€šè¿‡åˆ©ç”¨å¼‚æ­¥è¯·æ±‚ï¼Œè¿è¡Œè€…ä¹Ÿå¯ä»¥å¹¶å‘è¿è¡Œã€‚**

**![](img/04a4dd7c198a5a9464eb0c2d00acb843.png)**

**å¹³è¡Œæ¨ç†â€”â€”ä½œè€…å›¾ç‰‡**

**æƒ³æƒ³æœ‰å¤šå°‘æ¬¡ä½ ä¸å¾—ä¸å°† ML æ¨¡å‹åˆå¹¶åˆ°ä¸€ä¸ªé¢„æµ‹ç®¡é“ä¸­ã€‚ä½¿ç”¨ BentoMLï¼Œæ‚¨å¯ä»¥åŒæ—¶è¿è¡Œè¿™äº›æ¨¡å‹ï¼Œå¹¶åœ¨æœ€åæ”¶é›†ç»“æœã€‚**

# **9â€”éƒ¨ç½²åˆ°ä»»ä½•äº‘åŸºç¡€æ¶æ„**

**![](img/e4b8d0713efbb0249407558966b88191.png)**

**å¦‚ä½•éƒ¨ç½²ä¾¿å½“â€”ä½œè€…å›¾ç‰‡**

**ä¾¿å½“çš„å¥½å¤„åœ¨äºï¼Œå½“å®ƒè¢«æ„å»ºæ—¶ï¼Œä½ å¯ä»¥ç”¨ä¸¤ç§æ–¹å¼éƒ¨ç½²å®ƒ:**

1.  **é€šè¿‡å°† Docker æ˜ åƒæ¨é€åˆ°æ³¨å†Œè¡¨å¹¶å°†å…¶éƒ¨ç½²åˆ°äº‘ä¸­**
2.  **é€šè¿‡ä½¿ç”¨ BentoML å›¢é˜Ÿå¼€å‘çš„å®ç”¨ç¨‹åºåº“[bento TL](https://github.com/bentoml/bentoctl)æ¥åŠ é€Ÿéƒ¨ç½²è¿‡ç¨‹**

**å¼ºçƒˆæ¨èä½¿ç”¨ bentoctlã€‚å®ƒæœ‰åŠ©äºå°†ä»»ä½•æ„å»ºå¥½çš„ä¾¿å½“ä½œä¸ºç”Ÿäº§å°±ç»ªçš„ API ç«¯ç‚¹éƒ¨ç½²åœ¨äº‘ä¸Šã€‚å®ƒæ”¯æŒè®¸å¤šäº‘æä¾›å•†(AWSã€GCSã€Azureã€Heroku)ä»¥åŠåŒä¸€äº‘ä¸­çš„å¤šä¸ªæœåŠ¡(AWS Lambdaã€EC2 ç­‰)ã€‚)**

**æˆ‘æœ€è¿‘ç”¨ spaCy æ¨¡å‹ä¸º AWS Lambda éƒ¨ç½²äº†ä¸€ä¸ª(æ— æœåŠ¡å™¨)API ç«¯ç‚¹ã€‚å®ƒéå¸¸ç®¡ç”¨ï¼Œæˆ‘åªéœ€è¦ä¸€ä¸ªç°æˆçš„ä¾¿å½“ã€‚**

**ä½ å¯ä»¥é€šè¿‡[æ–‡æ¡£](https://github.com/bentoml/bentoctl/blob/main/docs/quickstart.md)æ¥è®©å®ƒå·¥ä½œï¼Œä½†æ˜¯ç®€å•æ¥è¯´ä½ éœ€è¦åšçš„å°±æ˜¯ä¸‹é¢è¿™äº›:**

*   **å®‰è£… bentoml**
*   **å®‰è£… terraform(æ£€æŸ¥æ­¤[é“¾æ¥](https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli)**
*   **è®¾ç½® AWS CLI å¹¶é…ç½®æ‚¨çš„å‡­è¯(å‚è§[å®‰è£…æŒ‡å—](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html))**
*   **å®‰è£… bentoctl ( `pip install bentoctl`)**
*   **åšäº†ä½ çš„ä¾¿å½“**
*   **å®‰è£…å…è®¸åœ¨ AWS Lambda ä¸Šéƒ¨ç½²çš„ aws-lambda æ“ä½œç¬¦(bentoctl ä¹Ÿæ”¯æŒå…¶ä»–æ“ä½œç¬¦):`bentoctl operator install aws-lambda`**
*   **è¿è¡Œ`bentoctl init`ç”Ÿæˆéƒ¨ç½²æ–‡ä»¶ã€‚è¿™ä¸€æ­¥äº¤äº’åœ°è¦æ±‚æ‚¨é…ç½® Lambda å‡½æ•°çš„éƒ¨ç½²(è®¾ç½®åŒºåŸŸã€å†…å­˜ã€è¶…æ—¶ç­‰)**
*   **é€šè¿‡è¿è¡Œ`bentoctl build`
    æ„å»ºéƒ¨ç½²æ‰€éœ€çš„æ˜ åƒè¿™ä¸€æ­¥å‡†å¤‡ä¸€ä¸ª Docker æ˜ åƒå¹¶å°†å…¶æ¨é€åˆ°éƒ¨ç½²æ³¨å†Œä¸­å¿ƒã€‚**
*   **é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤éƒ¨ç½²åˆ° LambdağŸš€`bentoctl apply -f deployment_config.yaml`ã€‚é…ç½®éƒ¨ç½²åï¼Œè¿™ä¸€æ­¥ä¾èµ–äº Terraform æ¥åº”ç”¨æ›´æ”¹**

**éƒ¨ç½²å®Œæˆåï¼Œä¼šæç¤ºæ‚¨ä¸€ä¸ª API URLï¼Œæ‚¨å¯ä»¥è¯·æ±‚å®ƒä¸æ‚¨çš„æ¨¡å‹è¿›è¡Œäº¤äº’ã€‚**

**![](img/a078fc438a2a6ec97284f9def30fb1c1.png)**

**ä½œè€…æˆªå›¾**

**è¦åˆ é™¤ Lambda å‡½æ•°ï¼Œåªéœ€è¿è¡Œ`bentoctl destroy -f deployment_config.yaml`å³å¯ã€‚**

# ****10 â€”API æ–‡æ¡£å’Œäº¤äº’ UI****

**å½“æ‚¨éƒ¨ç½² BentoML æœåŠ¡æˆ–åœ¨æœ¬åœ°ä¸ºå…¶æä¾›æœåŠ¡æ—¶ï¼Œæ‚¨å¯ä»¥è®¿é—®ä¸€ä¸ª [Swagger](https://swagger.io/tools/swagger-ui/) UIï¼Œè¯¥ UI å…è®¸æ‚¨åœ¨æ²¡æœ‰ä»»ä½•å®ç°é€»è¾‘çš„æƒ…å†µä¸‹å¯è§†åŒ– API èµ„æºå¹¶ä¸ä¹‹äº¤äº’ã€‚**

**è¿™æ˜¯ç”±å¸¦æœ‰å¯è§†åŒ–æ–‡æ¡£çš„ OpenAPI è§„èŒƒç”Ÿæˆçš„ï¼Œä¾¿äºåç«¯å®ç°å’Œå®¢æˆ·ç«¯ä½¿ç”¨ã€‚**

**![](img/a3610ae3315ceeea6f35c13bf3e9fd38.png)**

**å¤§æ‘‡å¤§æ‘†çš„ç”¨æˆ·ç•Œé¢ç¤ºä¾‹â€”â€”ä½œè€…çš„å›¾ç‰‡**

# **èµ„æº:**

*   **[https://towards data science . com/comprehensive-guide-to-deploying-any-ml-model-as-APIs-with-python-and-AWS-lambda-b441d 257 f1 EC](/comprehensive-guide-to-deploying-any-ml-model-as-apis-with-python-and-aws-lambda-b441d257f1ec)**
*   **[https://towards data science . com/bento ml-create-an-ml-powered-prediction-service-in-minutes-23d 135 D6 ca 76](/bentoml-create-an-ml-powered-prediction-service-in-minutes-23d135d6ca76)**
*   **[https://neptune.ai/blog/ml-model-serving-best-tools](https://neptune.ai/blog/ml-model-serving-best-tools)**
*   **[https://www . Reddit . com/r/mlops/comments/w4v l6 r/hello _ from _ bentoml](https://www.reddit.com/r/mlops/comments/w4vl6r/hello_from_bentoml/)**
*   **[https://docs . bentoml . org/en/latest/concepts/service . html # runners](https://docs.bentoml.org/en/latest/concepts/service.html#runners)**
*   **[https://github.com/bentoml/BentoML/tree/main/examples](https://github.com/bentoml/BentoML/tree/main/examples)**
*   **[https://model serving . com/blog/breaking-with-flask-amp-fastapi-why-ml-model-serving-requires-a-specialized-framework](https://modelserving.com/blog/breaking-up-with-flask-amp-fastapi-why-ml-model-serving-requires-a-specialized-framework)**

# **æ–°åˆ°ä¸­ï¼Ÿä½ å¯ä»¥æ¯æœˆè®¢é˜… 5 ç¾å…ƒï¼Œå¹¶è§£é”å„ç§ä¸»é¢˜çš„æ— é™æ–‡ç« (æŠ€æœ¯ã€è®¾è®¡ã€åˆ›ä¸šâ€¦â€¦)ä½ å¯ä»¥é€šè¿‡ç‚¹å‡»æˆ‘çš„æ¨èé“¾æ¥[æ¥æ”¯æŒæˆ‘](https://ahmedbesbes.medium.com/membership)**

**[](https://ahmedbesbes.medium.com/membership) [## åŠ å…¥æˆ‘çš„ä»‹ç»é“¾æ¥åª’ä½“-è‰¾å“ˆè¿ˆå¾·è´æ–¯

### é˜…è¯» Ahmed Besbes çš„æ¯ä¸€ä¸ªæ•…äº‹(ä»¥åŠåª’ä½“ä¸Šæˆåƒä¸Šä¸‡çš„å…¶ä»–ä½œå®¶)ã€‚æ‚¨çš„ä¼šå‘˜è´¹ç›´æ¥æ”¯æŒâ€¦

ahmedbesbes.medium.com](https://ahmedbesbes.medium.com/membership)**
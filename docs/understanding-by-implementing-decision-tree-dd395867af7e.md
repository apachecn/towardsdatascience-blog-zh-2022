# é€šè¿‡å®æ–½äº†è§£:å†³ç­–æ ‘

> åŸæ–‡ï¼š<https://towardsdatascience.com/understanding-by-implementing-decision-tree-dd395867af7e>

## å»ºç«‹ä½ è‡ªå·±çš„æ¨¡å‹

## äº†è§£å†³ç­–æ ‘æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¹¶ç”¨ Python å®ç°å®ƒ

![](img/14ac3b0cc0735f26b8fe9d7b9eab4dbc.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

M ä»»ä½•å…ˆè¿›çš„æœºå™¨å­¦ä¹ æ¨¡å‹å¦‚éšæœºæ£®æ—æˆ–æ¢¯åº¦å¢å¼ºç®—æ³•å¦‚ XGBoostã€CatBoost æˆ– LightGBM(ç”šè‡³[è‡ªåŠ¨ç¼–ç å™¨](https://medium.com/towards-data-science/building-a-simple-auto-encoder-via-decision-trees-28ba9342a349)ï¼)ä¾èµ–äºä¸€ä¸ªè‡³å…³é‡è¦çš„å…±åŒå› ç´ :T4 å†³ç­–æ ‘ï¼

ä¸ç†è§£å†³ç­–æ ‘ï¼Œå°±ä¸å¯èƒ½ç†è§£å‰é¢æåˆ°çš„ä»»ä½•é«˜çº§ bagging æˆ–æ¢¯åº¦æ¨è¿›ç®—æ³•ï¼Œè¿™å¯¹ä»»ä½•æ•°æ®ç§‘å­¦å®¶æ¥è¯´éƒ½æ˜¯ä¸€ç§è€»è¾±ï¼ğŸ˜å› æ­¤ï¼Œè®©æˆ‘ä»¬é€šè¿‡ç”¨ Python å®ç°ä¸€ä¸ªå†³ç­–æ ‘æ¥æ­å¼€å†³ç­–æ ‘å†…éƒ¨å·¥ä½œçš„ç¥ç§˜é¢çº±ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæ‚¨å°†äº†è§£åˆ°

*   å†³ç­–æ ‘ä¸ºä»€ä¹ˆä»¥åŠå¦‚ä½•æ‹†åˆ†æ•°æ®ï¼Œ
*   ä¿¡æ¯å¢ç›Šï¼Œä»¥åŠ
*   å¦‚ä½•ç”¨ NumPy åœ¨ Python ä¸­å®ç°å†³ç­–æ ‘ï¼Ÿ

> ä½ å¯ä»¥åœ¨ [my Github](https://github.com/Garve/Towards-Data-Science---Notebooks/blob/main/TDS%20-%20Decision%20Tree.ipynb) ä¸Šæ‰¾åˆ°ä»£ç ã€‚

# è¯¥ç†è®º

ä¸ºäº†è¿›è¡Œé¢„æµ‹ï¼Œå†³ç­–æ ‘ä¾é **ä»¥é€’å½’æ–¹å¼å°†**æ•°æ®é›†åˆ†å‰²æˆæ›´å°çš„éƒ¨åˆ†ã€‚

![](img/ee11cff1788df5fbf5faf193fe588e92.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

åœ¨ä¸Šå›¾ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåˆ†å‰²ç¤ºä¾‹ï¼Œå³åŸå§‹æ•°æ®é›†è¢«åˆ†æˆä¸¤éƒ¨åˆ†ã€‚åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œè¿™ä¸¤ä¸ªéƒ¨åˆ†å†æ¬¡è¢«åˆ†å‰²ï¼Œä»¥æ­¤ç±»æ¨ã€‚è¿™ä¸€ç›´æŒç»­åˆ°æ»¡è¶³æŸç§åœæ­¢æ ‡å‡†ï¼Œä¾‹å¦‚ï¼Œ

*   å¦‚æœåˆ†å‰²å¯¼è‡´ä¸€éƒ¨åˆ†ä¸ºç©º
*   å¦‚æœè¾¾åˆ°äº†æŸä¸ªé€’å½’æ·±åº¦
*   å¦‚æœ(åœ¨ä¹‹å‰çš„åˆ†å‰²ä¹‹å)æ•°æ®é›†ä»…åŒ…å«å°‘æ•°å…ƒç´ ï¼Œåˆ™æ— éœ€è¿›ä¸€æ­¥åˆ†å‰²ã€‚

æˆ‘ä»¬å¦‚ä½•æ‰¾åˆ°è¿™äº›åˆ†è£‚ï¼Ÿæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦åœ¨ä¹å‘¢ï¼Ÿè®©æˆ‘ä»¬æ‰¾å‡ºç­”æ¡ˆã€‚

## åŠ¨æœº

è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æƒ³è¦è§£å†³ä¸€ä¸ª**äºŒå…ƒ** **åˆ†ç±»é—®é¢˜**æˆ‘ä»¬ç°åœ¨è‡ªå·±åˆ›å»º:

```
import numpy as np

np.random.seed(0)

X = np.random.randn(100, 2) # features
y = ((X[:, 0] > 0) * (X[:, 1] < 0)) # labels (0 and 1)
```

äºŒç»´æ•°æ®å¦‚ä¸‹æ‰€ç¤º:

![](img/61e3050f5c906140d3544735de05393a.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªä¸åŒçš„ç±»åˆ«â€”â€”ç´«è‰²çº¦å  75%,é»„è‰²çº¦å  25%ã€‚å¦‚æœæ‚¨å°†è¿™äº›æ•°æ®è¾“å…¥å†³ç­–æ ‘**åˆ†ç±»å™¨**ï¼Œè¯¥æ ‘æœ€åˆä¼šæœ‰ä»¥ä¸‹æƒ³æ³•:

> â€œæœ‰ä¸¤ä¸ªä¸åŒçš„æ ‡ç­¾ï¼Œå¯¹æˆ‘æ¥è¯´å¤ªä¹±äº†ã€‚æˆ‘æƒ³é€šè¿‡å°†æ•°æ®åˆ†æˆä¸¤éƒ¨åˆ†æ¥æ¸…ç†è¿™ç§æ··ä¹±â€”â€”è¿™äº›éƒ¨åˆ†åº”è¯¥æ¯”ä¹‹å‰çš„å®Œæ•´æ•°æ®æ›´å¹²å‡€ã€‚â€â€”è·å¾—æ„è¯†çš„æ ‘

è¿™æ£µæ ‘ä¹Ÿæ˜¯å¦‚æ­¤ã€‚

![](img/4949c5c5dcd219219793839538bfddb5.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æ ‘å†³å®šå¤§è‡´æ²¿ç€ *x* è½´è¿›è¡Œåˆ†å‰²ã€‚è¿™æ ·åšçš„æ•ˆæœæ˜¯ï¼Œæ•°æ®çš„é¡¶éƒ¨ç°åœ¨æ˜¯å®Œå…¨å¹²å‡€çš„ï¼Œ **æ„å‘³ç€ä½ åªåœ¨é‚£é‡Œæ‰¾åˆ°*ä¸€ä¸ªå•ç‹¬çš„ç±»*(åœ¨æœ¬ä¾‹ä¸­ä¸ºç´«è‰²)ã€‚**

ä¸è¿‡åº•éƒ¨è¿˜æ˜¯*ä¹±*ï¼ŒæŸç§æ„ä¹‰ä¸Šç”šè‡³æ¯”ä»¥å‰æ›´ä¹±ã€‚åœ¨å®Œæ•´çš„æ•°æ®é›†ä¸­ï¼Œç±»çš„æ¯”ä¾‹æ›¾ç»æ˜¯å¤§çº¦ 75:25ï¼Œä½†æ˜¯åœ¨è¿™ä¸ªæ›´å°çš„éƒ¨åˆ†ä¸­ï¼Œå®ƒæ˜¯å¤§çº¦ 50:50ï¼Œè¿™æ˜¯å®ƒèƒ½å¾—åˆ°çš„æœ€å¤§æ··åˆ

> *âš ï¸* åªæ˜¯å°† ***ä¸¤éƒ¨åˆ†ä¸­ä¸åŒæ ‡ç­¾*** *çš„åŸå§‹æ•°é‡è¿›è¡Œè®¡æ•°ã€‚*

![](img/ab97cd9808a0c233ebb93ea4f3b7fc3e.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œå¯¹äºè¿™æ£µæ ‘æ¥è¯´ï¼Œè¿™å·²ç»æ˜¯è¶³å¤Ÿå¥½çš„ç¬¬ä¸€æ­¥äº†ï¼Œæ‰€ä»¥å®ƒä¼šç»§ç»­ä¸‹å»ã€‚è™½ç„¶å®ƒä¸ä¼šåœ¨é¡¶éƒ¨åˆ›å»ºå¦ä¸€ä¸ªåˆ†å‰²ï¼Œ*æ¸…ç†*éƒ¨åˆ†ï¼Œå®ƒå¯ä»¥åœ¨åº•éƒ¨åˆ›å»ºå¦ä¸€ä¸ªåˆ†å‰²æ¥æ¸…ç†å®ƒã€‚

![](img/1eaaf35aff9c396a6fce0630ac3226c8.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ç§ï¼Œä¸‰ä¸ªç‹¬ç«‹çš„éƒ¨åˆ†éƒ½æ˜¯å®Œå…¨å¹²å‡€çš„ï¼Œå› ä¸ºæˆ‘ä»¬å‘ç°æ¯ä¸ªéƒ¨åˆ†åªæœ‰ä¸€ç§é¢œè‰²(æ ‡ç­¾)ã€‚

ç°åœ¨åšé¢„æµ‹çœŸçš„å¾ˆå®¹æ˜“:å¦‚æœä¸€ä¸ªæ–°çš„æ•°æ®ç‚¹è¿›æ¥ï¼Œä½ åªéœ€æ£€æŸ¥å®ƒä½äºä¸‰ä¸ªéƒ¨åˆ†ä¸­çš„å“ªä¸€ä¸ªï¼Œå¹¶ç»™å®ƒç›¸åº”çš„é¢œè‰²ã€‚è¿™ä¸ªç°åœ¨å·¥ä½œå¾—å¾ˆå¥½ï¼Œå› ä¸ºæ¯ä¸ªéƒ¨åˆ†éƒ½å¾ˆå¹²å‡€ã€‚å¾ˆç®€å•ï¼Œå¯¹å§ï¼Ÿ

![](img/aaf14c9bc28e6faa9762e7d5c8569113.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¥½çš„ï¼Œæˆ‘ä»¬æ­£åœ¨è°ˆè®º*å¹²å‡€çš„*å’Œ*æ‚ä¹±çš„*æ•°æ®ï¼Œä½†æ˜¯åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™äº›è¯ä»…ä»…ä»£è¡¨ä¸€äº›æ¨¡ç³Šçš„æ¦‚å¿µã€‚ä¸ºäº†å®ç°ä»»ä½•äº‹æƒ…ï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾åˆ°å®šä¹‰*æ¸…æ´åº¦*çš„æ–¹æ³•ã€‚

## æ¸…æ´æªæ–½

å‡è®¾æˆ‘ä»¬æœ‰ä¸€äº›æ ‡ç­¾ï¼Œä¾‹å¦‚

```
y_1 = [0, 0, 0, 0, 0, 0, 0, 0]
y_2 = [1, 0, 0, 0, 0, 0, 1, 0]
y_3 = [1, 0, 1, 1, 0, 0, 1, 0]
```

ç›´è§‰ä¸Šï¼Œ *y* â‚æ˜¯æœ€å¹²å‡€çš„ä¸€ç»„æ ‡ç­¾ï¼Œå…¶æ¬¡æ˜¯ *y* â‚‚ï¼Œç„¶åæ˜¯ *y* â‚ƒ.åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡é¡ºåˆ©ï¼Œä½†æ˜¯æˆ‘ä»¬å¦‚ä½•å¯¹è¿™ç§è¡Œä¸ºè¿›è¡Œé‡åŒ–å‘¢ï¼Ÿå¯èƒ½æƒ³åˆ°çš„æœ€ç®€å•çš„äº‹æƒ…æ˜¯ä¸‹é¢è¿™äº›:

> æ•°æ•° 0 å’Œ 1 çš„æ•°é‡ã€‚è®¡ç®—å®ƒä»¬çš„ç»å¯¹å·®å€¼ã€‚ä¸ºäº†ä½¿å®ƒæ›´å¥½ï¼Œé€šè¿‡é™¤ä»¥æ•°ç»„çš„é•¿åº¦æ¥è§„èŒƒåŒ–å®ƒã€‚

ä¾‹å¦‚ï¼Œ *y* â‚‚æ€»å…±æœ‰ 8 ä¸ªæ¡ç›®â€”â€”6 ä¸ª 0 å’Œ 2 ä¸ª 1ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„**æ¸…æ´åº¦å¾—åˆ†**å°†æ˜¯|6 - 2| / 8 = 0.5ã€‚å¾ˆå®¹æ˜“è®¡ç®—å‡º *y* â‚å’Œ *y* â‚ƒçš„æ¸…æ´åº¦å¾—åˆ†åˆ†åˆ«ä¸º 1.0 å’Œ 0.0ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šç”¨å…¬å¼:

![](img/b6d9b8e4ef2c024308b14a65a74bbe43.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿™é‡Œï¼Œ *n* â‚€å’Œ *n* â‚åˆ†åˆ«æ˜¯ 0 å’Œ 1 çš„ä¸ªæ•°ï¼Œ*n*=*n*â‚€+*n*â‚æ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œ*p*â‚=*n*â‚/*n*æ˜¯ 1 ä¸ªæ ‡ç­¾çš„ä»½é¢*ã€‚*

è¿™ä¸ªå…¬å¼çš„é—®é¢˜æ˜¯**æ˜¯ä¸“é—¨ä¸ºä¸¤ä¸ªç±»**çš„æƒ…å†µå®šåˆ¶çš„ï¼Œä½†æ˜¯æˆ‘ä»¬é€šå¸¸å¯¹å¤šç±»åˆ†ç±»æ„Ÿå…´è¶£ã€‚ä¸€ä¸ªéå¸¸æœ‰æ•ˆçš„å…¬å¼æ˜¯**åŸºå°¼ç³»æ•°**

![](img/9ea0dac94e086213cc2c7aef85d33deb.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æˆ–è€…ä¸€èˆ¬æƒ…å†µä¸‹:

![](img/87c0225c509a5ead3cf2b49a68fc0283.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å®ƒå·¥ä½œå¾—éå¸¸å¥½ï¼Œä»¥è‡³äº scikit-learn [å°†å®ƒä½œä¸ºå…¶`DecisionTreeClassifier`ç±»çš„é»˜è®¤åº¦é‡](https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html)ã€‚

![](img/9a84eab94c537f2e2b74bb47840c97af.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

> *âš ï¸* ***æ³¨:*** *åŸºå°¼ç³»æ•°* ***è„ä¹±åº¦*** *è€Œéæ´ç™–ã€‚ä¾‹å¦‚:å¦‚æœä¸€ä¸ªåˆ—è¡¨åªåŒ…å«ä¸€ä¸ªç±»(=éå¸¸å¹²å‡€çš„æ•°æ®ï¼)ï¼Œåˆ™æ€»å’Œä¸­çš„æ‰€æœ‰é¡¹éƒ½ä¸ºé›¶ï¼Œå› æ­¤æ€»å’Œä¸ºé›¶ã€‚æœ€ç³Ÿç³•çš„æƒ…å†µæ˜¯æ‰€æœ‰ç±»åˆ«å‡ºç°çš„æ¬¡æ•°å®Œå…¨ç›¸åŒï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸºå°¼ç³»æ•°æ˜¯ 1â€“1/*C*ï¼Œå…¶ä¸­* C *æ˜¯ç±»åˆ«çš„æ•°é‡ã€‚*

ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªè¡¡é‡å¹²å‡€/è„ä¹±çš„æ ‡å‡†ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç”¨å®ƒæ¥æ‰¾åˆ°å¥½çš„åˆ†å‰²ã€‚

## æŸ¥æ‰¾æ‹†åˆ†

æœ‰å¾ˆå¤šåŠˆå‰å¯ä¾›æˆ‘ä»¬é€‰æ‹©ï¼Œä½†å“ªä¸€ä¸ªæ˜¯å¥½çš„å‘¢ï¼Ÿè®©æˆ‘ä»¬å†æ¬¡ä½¿ç”¨æˆ‘ä»¬çš„åˆå§‹æ•°æ®é›†ï¼Œè¿åŒåŸºå°¼ç³»æ•°æ‚è´¨æµ‹é‡ã€‚

![](img/61e3050f5c906140d3544735de05393a.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æˆ‘ä»¬ç°åœ¨ä¸ç®—ç‚¹æ•°ï¼Œå…ˆå‡è®¾ 75%æ˜¯ç´«è‰²ï¼Œ25%æ˜¯é»„è‰²ã€‚ä½¿ç”¨åŸºå°¼ç³»æ•°çš„å®šä¹‰ï¼Œå®Œæ•´æ•°æ®é›†çš„æ‚è´¨ä¸º

![](img/a47c0f073afeb148d88c3ccb312608db.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¦‚æœæˆ‘ä»¬æ²¿ç€ *x* è½´åˆ†å‰²æ•°æ®é›†ï¼Œå¦‚å‰æ‰€è¿°:

![](img/69d8660b873d66e8db2a16e437f42b04.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

**é¡¶éƒ¨çš„åŸºå°¼ç³»æ•°ä¸º 0.0** ï¼Œåº•éƒ¨

![](img/ef1733240ca06ba6a9bf0db24eef8bd8.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¹³å‡è€Œè¨€ï¼Œè¿™ä¸¤éƒ¨åˆ†çš„åŸºå°¼ç³»æ•°ä¸º(0.0 + 0.5) / 2 = 0.25ï¼Œæ¯”ä¹‹å‰æ•´ä¸ªæ•°æ®é›†çš„ 0.375 è¦å¥½ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ‰€è°“çš„**ä¿¡æ¯å¢ç›Š**æ¥è¡¨è¾¾:

> è¿™ç§åˆ†è£‚çš„ä¿¡æ¯å¢ç›Šæ˜¯ 0.375â€“0.25 = 0.125ã€‚

å°±è¿™ä¹ˆç®€å•ã€‚ä¿¡æ¯å¢ç›Šè¶Šé«˜(å³åŸºå°¼ç³»æ•°è¶Šä½)ï¼Œæ•ˆæœè¶Šå¥½ã€‚

> ***æ³¨æ„:*** *å¦ä¸€ä¸ªåŒæ ·å¥½çš„åˆå§‹åˆ†å‰²ä¼šæ²¿ç€ y è½´ã€‚*

éœ€è¦è®°ä½çš„ä¸€ä¸ªé‡è¦çš„äº‹æƒ…æ˜¯**ç”¨é›¶ä»¶çš„å¤§å°æ¥è¡¡é‡é›¶ä»¶çš„åŸºå°¼æ‚è´¨æ˜¯æœ‰ç”¨çš„**ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬å‡è®¾

*   ç¬¬ 1 éƒ¨åˆ†ç”± 50 ä¸ªæ•°æ®ç‚¹ç»„æˆï¼ŒåŸºå°¼ç³»æ•°ä¸º 0.0
*   ç¬¬äºŒéƒ¨åˆ†ç”± 450 ä¸ªæ•°æ®ç‚¹ç»„æˆï¼ŒåŸºå°¼ç³»æ•°ä¸º 0.5ï¼Œ

é‚£ä¹ˆå¹³å‡åŸºå°¼æ‚è´¨å°±ä¸åº”è¯¥æ˜¯(0.0 + 0.5) / 2 = 0.25 è€Œæ˜¯ 50/(50+450)* 0.0+450/(50+450)* 0.5 =**0.45**ã€‚

å¥½å§ï¼Œé‚£æˆ‘ä»¬æ€ä¹ˆæ‰¾åˆ°æœ€å¥½çš„åˆ†å‰²å‘¢ï¼Ÿç®€å•ä½†å‘äººæ·±çœçš„ç­”æ¡ˆæ˜¯:

> å°è¯•æ‰€æœ‰çš„æ‹†åˆ†ï¼Œç„¶åé€‰æ‹©ä¿¡æ¯å¢ç›Šæœ€é«˜çš„ä¸€ä¸ªã€‚è¿™åŸºæœ¬ä¸Šæ˜¯ä¸€ç§è›®åŠ›çš„æ–¹æ³•ã€‚

æ›´å‡†ç¡®åœ°è¯´ï¼Œæ ‡å‡†å†³ç­–æ ‘ä½¿ç”¨æ²¿åæ ‡è½´çš„**åˆ†è£‚ï¼Œå³ *xáµ¢* = *c* ç”¨äºæŸäº›ç‰¹å¾ *i* å’Œé˜ˆå€¼*cã€‚*è¿™æ„å‘³ç€**

*   åˆ†å‰²æ•°æ®çš„ä¸€éƒ¨åˆ†ç”±æ‰€æœ‰æ•°æ®ç‚¹ *x* å’Œ *xáµ¢* < *c* ç»„æˆ
*   æ‰€æœ‰ç‚¹çš„å¦ä¸€éƒ¨åˆ† *x* åŒ *xáµ¢* â‰¥ *c.*

è¿™äº›ç®€å•çš„æ‹†åˆ†è§„åˆ™åœ¨å®è·µä¸­å·²ç»è¯æ˜è¶³å¤Ÿå¥½äº†ï¼Œä½†æ˜¯ä½ å½“ç„¶ä¹Ÿå¯ä»¥æ‰©å±•è¿™ä¸ªé€»è¾‘æ¥åˆ›å»ºå…¶ä»–çš„æ‹†åˆ†(ä¾‹å¦‚åƒ *xáµ¢ + 2xâ±¼ = 3* è¿™æ ·çš„å¯¹è§’çº¿)ã€‚

å¤ªå¥½äº†ï¼Œè¿™äº›éƒ½æ˜¯æˆ‘ä»¬ç°åœ¨éœ€è¦çš„åŸæ–™ï¼

# å®æ–½

æˆ‘ä»¬ç°åœ¨å°†å®ç°å†³ç­–æ ‘ã€‚å› ä¸ºå®ƒç”±èŠ‚ç‚¹ç»„æˆï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ª`Node`ç±»ã€‚

```
from dataclasses import dataclass

@dataclass
class Node:
    feature: int = None # feature for the split
    value: float = None # split threshold OR final prediction
    left: np.array = None # store one part of the data
    right: np.array = None # store the other part of the data
```

èŠ‚ç‚¹çŸ¥é“å®ƒç”¨äºåˆ†è£‚çš„ç‰¹å¾(`feature`)ä»¥åŠåˆ†è£‚å€¼(`value`)ã€‚`value`ä¹Ÿç”¨ä½œå†³ç­–æ ‘æœ€ç»ˆé¢„æµ‹çš„å­˜å‚¨ã€‚ç”±äºæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹éœ€è¦çŸ¥é“å®ƒçš„å·¦å³å­èŠ‚ç‚¹ï¼Œæ­£å¦‚å­˜å‚¨åœ¨`left`å’Œ`right`ä¸­çš„é‚£æ ·ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åšå®é™…çš„å†³ç­–æ ‘å®ç°ã€‚æˆ‘è®©å®ƒå…¼å®¹ scikit-learnï¼Œå› æ­¤æˆ‘ä½¿ç”¨äº†ä¸€äº›æ¥è‡ª`sklearn.base`çš„ç±»ã€‚å¦‚æœæ‚¨å¯¹æ­¤ä¸ç†Ÿæ‚‰ï¼Œè¯·æŸ¥çœ‹æˆ‘å…³äºå¦‚ä½•æ„å»º scikit-learn å…¼å®¹æ¨¡å‹çš„æ–‡ç« :

[](/build-your-own-custom-scikit-learn-regression-5d0d718f289) [## æ„å»ºæ‚¨è‡ªå·±çš„å®šåˆ¶ scikit-å­¦ä¹ å›å½’

### ç¼–å†™ä¸€ä¸ªå›å½’å˜é‡ï¼Œå¹¶ä» scikit-learn ç”Ÿæ€ç³»ç»Ÿçš„æ‰€æœ‰å¼ºå¤§å·¥å…·ä¸­å—ç›Šï¼Œå¦‚ç®¡é“ã€ç½‘æ ¼æœç´¢â€¦

towardsdatascience.com](/build-your-own-custom-scikit-learn-regression-5d0d718f289) 

æ¥å®æ–½å§ï¼

```
import numpy as np
from sklearn.base import BaseEstimator, ClassifierMixin

class DecisionTreeClassifier(BaseEstimator, ClassifierMixin):
    def __init__(self):
        self.root = Node()

    @staticmethod
    def _gini(y):
        """Gini impurity."""
        counts = np.bincount(y)
        p = counts / counts.sum()

        return (p * (1 - p)).sum()

    def _split(self, X, y):
        """Bruteforce search over all features and splitting points."""
        best_information_gain = float("-inf")
        best_feature = None
        best_split = None

        for feature in range(X.shape[1]):
            split_candidates = np.unique(X[:, feature])
            for split in split_candidates:
                left_mask = X[:, feature] < split
                X_left, y_left = X[left_mask], y[left_mask]
                X_right, y_right = X[~left_mask], y[~left_mask]

                information_gain = self._gini(y) - (
                    len(X_left) / len(X) * self._gini(y_left)
                    + len(X_right) / len(X) * self._gini(y_right)
                )

                if information_gain > best_information_gain:
                    best_information_gain = information_gain
                    best_feature = feature
                    best_split = split

        return best_feature, best_split

    def _build_tree(self, X, y):
        """The heavy lifting."""
        feature, split = self._split(X, y)

        left_mask = X[:, feature] < split

        X_left, y_left = X[left_mask], y[left_mask]
        X_right, y_right = X[~left_mask], y[~left_mask]

        if len(X_left) == 0 or len(X_right) == 0:
            return Node(value=np.argmax(np.bincount(y)))
        else:
            return Node(
                feature,
                split,
                self._build_tree(X_left, y_left),
                self._build_tree(X_right, y_right),
            )

    def _find_path(self, x, node):
        """Given a data point x, walk from the root to the corresponding leaf node. Output its value."""
        if node.feature == None:
            return node.value
        else:
            if x[node.feature] < node.value:
                return self._find_path(x, node.left)
            else:
                return self._find_path(x, node.right)

    def fit(self, X, y):
        self.root = self._build_tree(X, y)
        return self

    def predict(self, X):
        return np.array([self._find_path(x, self.root) for x in X])
```

å°±æ˜¯è¿™æ ·ï¼ä½ å¯ä»¥åšæ‰€æœ‰ä½ å–œæ¬¢çš„å…³äº scikit çš„äº‹æƒ…â€”â€”ç«‹å³äº†è§£:

```
dt = DecisionTreeClassifier().fit(X, y)
print(dt.score(X, y)) # accuracy

# Output
# 1.0
```

ç”±äºæ ‘æ˜¯ä¸è§„åˆ™çš„ï¼Œå®ƒè¿‡åº¦æ‹Ÿåˆäº†å¾ˆå¤šï¼Œå› æ­¤æ˜¯å®Œç¾çš„è®­ç»ƒåˆ†æ•°ã€‚å¯¹äºçœ‹ä¸è§çš„æ•°æ®ï¼Œå‡†ç¡®æ€§ä¼šæ›´å·®ã€‚æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡

```
print(dt.root)

# Output (prettified manually):
# Node(
#   feature=1,
#   value=-0.14963454032767076,
#   left=Node(
#          feature=0,
#          value=0.04575851730144607,
#          left=Node(
#                 feature=None,
#                 value=0,
#                 left=None,
#                 right=None
#          ),
#          right=Node(
#                  feature=None,
#                  value=1,
#                  left=None,
#                  right=None
#          )
#        ),
#   right=Node(
#           feature=None,
#           value=0,
#           left=None,
#           right=None
#   )
# )
```

ä½œä¸ºä¸€å¼ å›¾ç‰‡ï¼Œåº”è¯¥æ˜¯è¿™æ ·çš„:

![](img/f676bb31f5cd261f2a7a6aa02feb266c.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

# ç»“è®º

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»è¯¦ç»†äº†è§£äº†å†³ç­–æ ‘æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æˆ‘ä»¬ä»ä¸€äº›æ¨¡ç³Šä½†ç›´è§‚çš„æƒ³æ³•å¼€å§‹ï¼Œç„¶åå°†å®ƒä»¬è½¬åŒ–ä¸ºå…¬å¼å’Œç®—æ³•ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬èƒ½å¤Ÿä»å¤´å¼€å§‹å®ç°ä¸€ä¸ªå†³ç­–æ ‘ã€‚

ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯:æˆ‘ä»¬çš„å†³ç­–æ ‘è¿˜ä¸èƒ½è¢«æ­£åˆ™åŒ–ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å¸Œæœ›æŒ‡å®šå¦‚ä¸‹å‚æ•°

*   æœ€å¤§æ·±åº¦
*   å¶å­å¤§å°
*   å’Œæœ€å°çš„ä¿¡æ¯å¢ç›Š

è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™äº›äº‹æƒ…å®ç°èµ·æ¥å¹¶ä¸å›°éš¾ï¼Œè¿™è®©å®ƒæˆä¸ºä½ çš„å®Œç¾ä½œä¸šã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æŒ‡å®š`leaf_size=10`ä½œä¸ºå‚æ•°ï¼Œé‚£ä¹ˆåŒ…å«è¶…è¿‡ 10 ä¸ªæ ·æœ¬çš„èŠ‚ç‚¹å°±ä¸åº”è¯¥å†è¢«åˆ†å‰²ã€‚æ­¤å¤–ï¼Œè¿™ç§å®ç°æ–¹å¼**æ•ˆç‡ä¸é«˜**ã€‚é€šå¸¸ï¼Œæ‚¨ä¸å¸Œæœ›åœ¨èŠ‚ç‚¹ä¸­å­˜å‚¨æ•°æ®é›†çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ˜¯åªå­˜å‚¨ç´¢å¼•ã€‚å› æ­¤ï¼Œæ‚¨çš„(å¯èƒ½å¾ˆå¤§çš„)æ•°æ®é›†åªåœ¨å†…å­˜ä¸­å­˜åœ¨ä¸€æ¬¡ã€‚

å¥½çš„ä¸€é¢æ˜¯ï¼Œç°åœ¨ä½ å¯ä»¥ç–¯ç‹‚åœ°ä½¿ç”¨è¿™ä¸ªå†³ç­–æ ‘æ¨¡æ¿ã€‚æ‚¨å¯ä»¥:

*   å®æ–½å¯¹è§’çº¿åˆ†å‰²ï¼Œå³ *xáµ¢ + 2xâ±¼ = 3* è€Œä¸æ˜¯ä»…ä»… *xáµ¢ = 3ï¼Œ*
*   æ”¹å˜å¶å­å†…éƒ¨å‘ç”Ÿçš„é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¯ä»¥åœ¨æ¯ä¸ªå¶å­å†…éƒ¨è¿è¡Œé€»è¾‘å›å½’ï¼Œè€Œä¸ä»…ä»…æ˜¯è¿›è¡Œå¤šæ•°æŠ•ç¥¨ï¼Œè¿™å°±ç»™å‡ºäº†ä¸€ä¸ª[çº¿æ€§æ ‘](https://github.com/cerlymarco/linear-tree)
*   æ”¹å˜åˆ†è£‚ç¨‹åºï¼Œå³ä¸è¦ä½¿ç”¨è›®åŠ›ï¼Œå°è¯•ä¸€äº›éšæœºç»„åˆå¹¶æŒ‘é€‰æœ€å¥½çš„ä¸€ä¸ªï¼Œè¿™ç»™äº†ä½ ä¸€ä¸ª[é¢å¤–æ ‘åˆ†ç±»å™¨](https://scikit-learn.org/stable/modules/generated/sklearn.tree.ExtraTreeClassifier.html#sklearn.tree.ExtraTreeClassifier)
*   è¿˜æœ‰æ›´å¤šã€‚

æ­¤å¤–ï¼Œæ£€æŸ¥æˆ‘çš„åŸºæœ¬æœºå™¨å­¦ä¹ ç®—æ³•çš„å…¶ä»–å®ç°ï¼

[](/understanding-by-implementing-k-nearest-neighbors-469d6f84b8a9) [## é€šè¿‡å®ç°æ¥ç†è§£:k-æœ€è¿‘é‚»

### äº†è§£ k-æœ€è¿‘é‚»åˆ†ç±»å™¨çš„å·¥ä½œåŸç†å¹¶åœ¨ Python ä¸­å®ç°å®ƒ

towardsdatascience.com](/understanding-by-implementing-k-nearest-neighbors-469d6f84b8a9) [](/learning-by-implementing-gaussian-naive-bayes-3f0e3d2c01b2) [## é€šè¿‡å®æ–½å­¦ä¹ :é«˜æ–¯æœ´ç´ è´å¶æ–¯

### äº†è§£é«˜æ–¯æœ´ç´ è´å¶æ–¯çš„å·¥ä½œåŸç†ï¼Œå¹¶ç”¨ Python å®ç°å®ƒï¼

towardsdatascience.com](/learning-by-implementing-gaussian-naive-bayes-3f0e3d2c01b2) 

æˆ‘å¸Œæœ›ä½ ä»Šå¤©å­¦åˆ°äº†æ–°çš„ã€æœ‰è¶£çš„ã€æœ‰ç”¨çš„ä¸œè¥¿ã€‚æ„Ÿè°¢é˜…è¯»ï¼

**ä½œä¸ºæœ€åä¸€ç‚¹ï¼Œå¦‚æœä½ **

1.  **æƒ³æ”¯æŒæˆ‘å¤šå†™ç‚¹æœºå™¨å­¦ä¹ å’Œ**
2.  **æ— è®ºå¦‚ä½•éƒ½è¦è®¡åˆ’è·å¾—ä¸­ç­‰è®¢é˜…é‡ï¼Œ**

**ä¸ºä»€ä¹ˆä¸åš** [**é€šè¿‡è¿™ä¸ªç¯èŠ‚**](https://dr-robert-kuebler.medium.com/membership) **ï¼Ÿè¿™å°†å¯¹æˆ‘å¸®åŠ©å¾ˆå¤§ï¼ğŸ˜Š**

é€æ˜åœ°è¯´ï¼Œç»™ä½ çš„ä»·æ ¼ä¸å˜ï¼Œä½†å¤§çº¦ä¸€åŠçš„è®¢é˜…è´¹ç›´æ¥å½’æˆ‘ã€‚

éå¸¸æ„Ÿè°¢ï¼Œå¦‚æœä½ è€ƒè™‘æ”¯æŒæˆ‘çš„è¯ï¼

> *æœ‰é—®é¢˜å°±åœ¨*[*LinkedIn*](https://www.linkedin.com/in/dr-robert-k%C3%BCbler-983859150/)*ä¸Šå†™æˆ‘ï¼*
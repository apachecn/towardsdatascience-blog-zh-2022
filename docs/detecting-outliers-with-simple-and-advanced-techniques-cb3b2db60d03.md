# ç”¨ç®€å•å’Œå…ˆè¿›çš„æŠ€æœ¯æ£€æµ‹å¼‚å¸¸å€¼

> åŸæ–‡ï¼š<https://towardsdatascience.com/detecting-outliers-with-simple-and-advanced-techniques-cb3b2db60d03>

## å…³äºå¦‚ä½•ä½¿ç”¨æ ‡å‡†å·®ã€å››åˆ†ä½æ•°èŒƒå›´ã€éš”ç¦»æ£®æ—ã€DBSCAN å’Œå±€éƒ¨å¼‚å¸¸å€¼å› å­æ£€æµ‹å¼‚å¸¸å€¼çš„æ•™ç¨‹

![](img/965c462b6efe8684d956cbe211302068.png)

ç”±[æœ¬æ°æ˜Â·æ²ƒç½—æ–¯](https://unsplash.com/@vorosbenisop?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) æ‹æ‘„çš„ç…§ç‰‡

[ç¦»ç¾¤å€¼](https://en.wikipedia.org/wiki/Outlier)æ˜¯è¿œç¦»æ•°æ®é›†ä¸­å¤§å¤šæ•°è§‚å¯Ÿå€¼çš„æ•°æ®ç‚¹ã€‚å¼‚å¸¸å€¼çš„å‡ºç°æœ‰å¤šç§åŸå› ï¼Œä¾‹å¦‚ç¾¤ä½“è¡Œä¸ºçš„è‡ªç„¶åå·®ã€æ¬ºè¯ˆæ´»åŠ¨ä»¥åŠäººä¸ºæˆ–ç³»ç»Ÿé”™è¯¯ã€‚ç„¶è€Œï¼Œåœ¨è¿è¡Œä»»ä½•ç»Ÿè®¡åˆ†ææˆ–ä¸ºè®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹å‡†å¤‡æ•°æ®ä¹‹å‰ï¼Œæ£€æµ‹å’Œè¯†åˆ«å¼‚å¸¸å€¼æ˜¯å¿…ä¸å¯å°‘çš„ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å•å˜é‡å’Œå¤šå˜é‡å¼‚å¸¸å€¼ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ç»Ÿè®¡æ–¹æ³•å’Œè‡ªåŠ¨åŒ–å¼‚å¸¸æ£€æµ‹æŠ€æœ¯æ¥è¯†åˆ«å®ƒä»¬ã€‚æˆ‘ä»¬å°†çœ‹åˆ°ç”¨äºæ£€æµ‹å•å˜é‡å¼‚å¸¸å€¼å’Œéš”ç¦»æ£®æ—çš„å››åˆ†ä½è·å’Œæ ‡å‡†å·®æ–¹æ³•ã€ç”¨äºæ£€æµ‹å¤šå˜é‡å¼‚å¸¸å€¼çš„ DBSCAN(å¸¦å™ªå£°çš„åŸºäºå¯†åº¦çš„åº”ç”¨ç¨‹åºç©ºé—´èšç±»)å’Œ LOF(å±€éƒ¨å¼‚å¸¸å€¼å› å­)ã€‚

åœ¨é˜…è¯»æœ¬æ–‡çš„åŒæ—¶ï¼Œæˆ‘é¼“åŠ±æ‚¨æŸ¥çœ‹æˆ‘çš„ GitHub ä¸Šçš„ [Jupyter ç¬”è®°æœ¬](https://github.com/Idilismiguzel/Machine-Learning/blob/master/Outlier%20Detection/Outlier_Detection.ipynb)ä»¥è·å¾—å®Œæ•´çš„åˆ†æå’Œä»£ç ã€‚

æˆ‘ä»¬æœ‰å¾ˆå¤šè¦è®²çš„ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼ğŸš€

# æ•°æ®

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ª UCI çš„[ç»ç’ƒè¯†åˆ«æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†å…·æœ‰ 8 ä¸ªä¸ç»ç’ƒå«é‡å’Œç»ç’ƒç±»å‹ç›¸å…³çš„å±æ€§(å³â€œNaâ€)ã€‚](https://www.kaggle.com/uciml/glass)

```
import pandas as pdglass = pd.read_csv('glass.csv')
```

![](img/b30f2d1152612ca07edfe39ac0836d71.png)

# å•å˜é‡å’Œå¤šå˜é‡å¼‚å¸¸å€¼

é€šè¿‡ä½¿ç”¨`seabornâ€™s pairplot`,æˆ‘ä»¬å¯ä»¥ç»˜åˆ¶ç»ç’ƒå«é‡ä¹‹é—´çš„æˆå¯¹å…³ç³»ï¼Œé€šè¿‡è¿™ç§è§†è§‰ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„åŸºç¡€æ•°æ®çš„åˆ†å¸ƒæƒ…å†µã€‚

```
import seaborn as snssns.pairplot(glass, diag_kws={'color':'red'})
```

![](img/84f9d5e8c34d05305ce622a1601060fc.png)![](img/34fb56b9d7a6e6688f92c665304eac83.png)

å˜é‡ä¹‹é—´çš„æˆå¯¹å…³ç³»

å¦‚æœæˆ‘ä»¬ä»”ç»†è§‚å¯Ÿä¸Šé¢çš„å›¾ï¼Œæˆ‘ä»¬ä¼šå‘ç°ç»ç’ƒå±æ€§ä½äº x è½´å’Œ y è½´ä¸Šã€‚æ²¿ç€çº¢è‰²çš„å¯¹è§’çº¿ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¾ç¤ºåˆ†å¸ƒçš„ç›´æ–¹å›¾ã€‚

å¦‚æ‚¨æ‰€è§ï¼Œå¹¶éæ‰€æœ‰å±æ€§éƒ½éµå¾ªé’Ÿå½¢æ›²çº¿çš„æ­£æ€åˆ†å¸ƒï¼Œä½†äº‹å®ä¸Šï¼Œå¤§å¤šæ•°å±æ€§éƒ½åå‘è¾ƒä½å€¼(å¦‚ Baã€Fe)æˆ–è¾ƒé«˜å€¼(å¦‚ Mg)ã€‚ä¸ºäº†æ£€æµ‹**å•å˜é‡å¼‚å¸¸å€¼**ï¼Œæˆ‘ä»¬åº”è¯¥å…³æ³¨å•ä¸ªå±æ€§çš„åˆ†å¸ƒï¼Œå¹¶æ‰¾åˆ°è¿œç¦»è¯¥å±æ€§å¤§éƒ¨åˆ†æ•°æ®çš„æ•°æ®ç‚¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬é€‰æ‹©â€œNaâ€å¹¶ç»˜åˆ¶ä¸€ä¸ªç®±çº¿å›¾ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å“ªäº›æ•°æ®ç‚¹åœ¨èƒ¡é¡»ä¹‹å¤–ï¼Œå¯ä»¥æ ‡è®°ä¸ºå¼‚å¸¸å€¼ã€‚

![](img/a5ec0b4bf91acf215dee7815706fa19c.png)

Na çš„ç®±çº¿å›¾â€”æ˜¾ç¤ºæ™¶é¡»å¤–éƒ¨çš„æ•°æ®ç‚¹ã€‚

ç›¸åï¼Œä¸ºäº†æ£€æµ‹å¤šå…ƒå¼‚å¸¸å€¼ï¼Œæˆ‘ä»¬åº”è¯¥å…³æ³¨ n ç»´ç©ºé—´ä¸­è‡³å°‘ä¸¤ä¸ªå˜é‡çš„ç»„åˆã€‚ä¾‹å¦‚ï¼Œåœ¨ç»ç’ƒæ•°æ®é›†ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»ç’ƒçš„æ‰€æœ‰å…«ä¸ªå±æ€§ï¼Œå¹¶åœ¨ n ç»´ç©ºé—´ä¸­ç»˜åˆ¶å®ƒä»¬ï¼Œå¹¶é€šè¿‡æ£€æµ‹å“ªäº›æ•°æ®ç‚¹è½åœ¨è¿œå¤„æ¥æ‰¾åˆ°å¤šå…ƒå¼‚å¸¸å€¼ã€‚

ç”±äºç»˜åˆ¶è¶…è¿‡ä¸‰ä¸ªç»´åº¦æ˜¯ä¸å¯èƒ½çš„ï¼Œæˆ‘ä»¬åº”è¯¥æ‰¾åˆ°ä¸€ç§æ–¹æ³•å°†å…«ä¸ªç»´åº¦è½¬æ¢åˆ°ä¸€ä¸ªæ›´ä½ç»´åº¦çš„ç©ºé—´ã€‚PCA â€”ä¸»æˆåˆ†åˆ†ææ˜¯ä¸€ç§é™ç»´æŠ€æœ¯ï¼Œå®ƒé€šè¿‡æœ€å¤§åŒ–ä½ç»´è¡¨ç¤ºä¸­çš„æ–¹å·®æ¥æ‰§è¡Œé«˜ç»´ç©ºé—´åˆ°ä½ç»´ç©ºé—´çš„çº¿æ€§æ˜ å°„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç”¨`n_components=3.`æ‰§è¡Œ PCA å°†å…«ä¸ªç»´åº¦è½¬æ¢æˆä¸‰ç»´ç©ºé—´

![](img/719801f8f2ceb044a74483a1e25d3ee0.png)

å…·æœ‰ 3 ç§æˆåˆ†çš„ PCA å¯è§†åŒ–(é¢œè‰²ä»£è¡¨ç»ç’ƒçš„â€œç±»å‹â€)

æ‚¨å¯ä»¥åœ¨å›¾ä¸­çœ‹åˆ°ï¼Œæœ‰äº›æ•°æ®ç‚¹å½¼æ­¤é è¿‘(æ„æˆå¯†é›†åŒºåŸŸ)ï¼Œæœ‰äº›è¿œç¦»ï¼Œå¯èƒ½æ˜¯*å¤šå…ƒ*å¼‚å¸¸å€¼ã€‚

æˆ‘ä»¬éœ€è¦éµå¾ªä¸åŒçš„ç¨‹åºæ¥æ£€æµ‹å•å˜é‡å’Œå¤šå˜é‡å¼‚å¸¸å€¼ã€‚è®©æˆ‘ä»¬ä»å•å˜é‡å¼‚å¸¸å€¼å¼€å§‹ï¼Œå­¦ä¹ æ ‡å‡†å·®å’Œå››åˆ†ä½è·æ–¹æ³•æ¥æ£€æµ‹å®ƒä»¬ã€‚

# å•å˜é‡å¼‚å¸¸æ£€æµ‹

## 1.æ ‡å‡†åå·®æ³•

å‡è®¾ä¸€ä¸ªå˜é‡(å‡ ä¹)æ˜¯æ­£æ€åˆ†å¸ƒçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå…¶ç›´æ–¹å›¾åº”éµå¾ªé’Ÿå½¢æ›²çº¿ï¼Œ68.3%çš„æ•°æ®å€¼ä½äºå¹³å‡å€¼çš„ä¸€ä¸ªæ ‡å‡†åå·®å†…ï¼Œ95.4%çš„æ•°æ®å€¼ä½äºå¹³å‡å€¼çš„ä¸¤ä¸ªæ ‡å‡†åå·®å†…ï¼Œ99.7%çš„æ•°æ®å€¼ä½äºå¹³å‡å€¼çš„ä¸‰ä¸ªæ ‡å‡†åå·®å†…ã€‚

![](img/c4e19dcef43eb059c9aab7beb3ad5967.png)

å› æ­¤ï¼Œå¦‚æœæ•°æ®ç‚¹è·ç¦»å¹³å‡å€¼è¶…è¿‡ä¸‰ä¸ªæ ‡å‡†å·®ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ£€æµ‹å‡ºå¼‚å¸¸å€¼ã€‚

é€šè¿‡ä½¿ç”¨æ ‡å‡†åå·®æŠ€æœ¯ï¼Œæˆ‘ä»¬æ ¹æ®â€œNaâ€å˜é‡çš„åˆ†å¸ƒ(è¿™æ˜¯ä¸€ä¸ªæå€¼)åˆ é™¤äº†ä¸¤ä¸ªè®°å½•ã€‚æ‚¨å¯ä»¥æ‰©å±•å¹¶è¦†ç›–æ‰€æœ‰å…¶ä»–å±æ€§ï¼Œä»¥ç§»é™¤å•å˜é‡å¼‚å¸¸å€¼ã€‚

```
Shape of original dataset: (213, 9) 
Shape of dataset after removing outliers in Na column: (211, 9)
```

## 2.å››åˆ†ä½æå·®æ³•

å››åˆ†ä½è·æ–¹æ³•(æœ€å¥½ä½¿ç”¨ç®±çº¿å›¾æ˜¾ç¤º)é€šè¿‡å®šä¹‰ä¸‰ä¸ªç‚¹å°†æ•°æ®åˆ†æˆå››åˆ†ä½:

> å››åˆ†ä½æ•° 1 (Q1)ä»£è¡¨ç¬¬ 25 ç™¾åˆ†ä½
> å››åˆ†ä½æ•° 2 (Q2)ä»£è¡¨ç¬¬ 50 ç™¾åˆ†ä½
> å››åˆ†ä½æ•° 3 (Q3)ä»£è¡¨ç¬¬ 75 ç™¾åˆ†ä½

ç®±çº¿å›¾ä¸­çš„æ–¹æ¡†è¡¨ç¤º IQR èŒƒå›´ï¼Œå…¶è¢«å®šä¹‰ä¸º Q1 å’Œ Q3 ä¹‹é—´çš„èŒƒå›´ï¼›`IQR = Q3 â€” Q1`å’Œä½äº`Q1 - 1.5*IQR`æˆ–é«˜äº`Q3 + 1.5*IQR`çš„æ•°æ®ç‚¹è¢«å®šä¹‰ä¸ºå¼‚å¸¸å€¼ã€‚

åœ¨æ–¹æ¡†å›¾ä¸­ï¼Œ`Q1 - 1.5*IQR`å’Œ`Q3 + 1.5*IQR`ç”¨è§¦é¡»è¡¨ç¤ºï¼Œå¼‚å¸¸å€¼ç”¨ä¸Šæ–¹æˆ–ä¸‹æ–¹çš„ç‚¹è¡¨ç¤ºã€‚

![](img/730335250a406e09b9225f39a660363f.png)

```
Shape of original dataset: (213, 9) 
Shape of dataset after removing outliers in Na column: (206, 9)
```

é€šè¿‡ä½¿ç”¨ IQR æŠ€æœ¯ï¼Œæˆ‘ä»¬æ ¹æ®â€œNaâ€å˜é‡çš„åˆ†å¸ƒåˆ é™¤äº†ä¸ƒä¸ªè®°å½•ã€‚æ­£å¦‚ä½ å¯ä»¥æ³¨æ„åˆ°çš„ï¼Œæ ‡å‡†å·®æ–¹æ³•åªèƒ½æ‰¾åˆ° 2 ä¸ªå¼‚å¸¸å€¼ï¼Œè¿™æ˜¯çœŸæ­£çš„æå€¼ç‚¹ï¼Œä½†ä½¿ç”¨ IQR æ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ£€æµ‹åˆ°æ›´å¤š(5 ä¸ªä¸é‚£ä¹ˆæç«¯çš„è®°å½•)ã€‚ç”±æ‚¨å’Œæ‚¨çš„ç”¨ä¾‹æ¥å†³å®šå“ªç§æ–¹æ³•å¯¹æ•°æ®é›†æ›´å¥½ï¼Œä»¥åŠæ‚¨æ˜¯å¦æœ‰ç©ºé—´ä¸¢å¼ƒæ›´å¤šçš„æ•°æ®ç‚¹ã€‚

è®©æˆ‘ä»¬ç»§ç»­è®¨è®ºå¤šå…ƒå¼‚å¸¸å€¼ï¼Œäº†è§£éš”ç¦»æ£®æ—ã€DBSCAN(å«å™ªå£°çš„åŸºäºå¯†åº¦çš„åº”ç”¨ç¨‹åºç©ºé—´èšç±»)å’Œ LOF(æœ¬åœ°å¼‚å¸¸å€¼å› å­)ã€‚

# å¤šå…ƒå¼‚å¸¸æ£€æµ‹

## 1.éš”ç¦»æ£®æ—æ³•

[éš”ç¦»æ£®æ—](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html)æ˜¯ä¸€ç§åŸºäºéšæœºæ£®æ—çš„æ— ç›‘ç£æœºå™¨å­¦ä¹ ç®—æ³•ã€‚ä½ å¯èƒ½çŸ¥é“ï¼Œéšæœºæ£®æ—æ˜¯ä¸€ä¸ª[é›†æˆå­¦ä¹ ](https://medium.com/towards-data-science/practical-guide-to-ensemble-learning-d34c74e022a0)æ¨¡å‹ï¼Œå®ƒä½¿ç”¨åŸºæœ¬æ¨¡å‹(æ¯”å¦‚ 100 æ£µå†³ç­–æ ‘)å’Œåœ¨æœ€ç»ˆå†³ç­–ä¸­æƒé‡è¾ƒé«˜çš„æ¨¡å‹çš„é›†æˆã€‚

> å¦‚æœä½ éœ€è¦ä¸€ä¸ªå…³äºé›†åˆå­¦ä¹ çš„å¤ä¹ ï¼Œä½ å¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ã€‚

</practical-guide-to-ensemble-learning-d34c74e022a0>  

éš”ç¦»æ—éµå¾ªéšæœºæ—çš„æ–¹æ³•ï¼Œä½†ç›¸åï¼Œå®ƒæ£€æµ‹(æˆ–æ¢å¥è¯è¯´éš”ç¦»)å¼‚å¸¸æ•°æ®ç‚¹ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œå®ƒåšäº†ä¸¤ä¸ªåŸºæœ¬å‡è®¾:ç¦»ç¾¤å€¼æ˜¯å°‘æ•°ï¼Œä»–ä»¬æ˜¯ä¸å¯»å¸¸çš„ã€‚

éš”ç¦»æ—é€šè¿‡éšæœºé€‰æ‹©ä¸€ä¸ªåŠŸèƒ½ï¼Œç„¶åéšæœºé€‰æ‹©ä¸€ä¸ªæ‹†åˆ†è§„åˆ™æ¥åˆ†éš”æ‰€é€‰åŠŸèƒ½çš„å€¼ï¼Œä»è€Œåˆ›å»ºå†³ç­–æ ‘ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸€ç›´æŒç»­åˆ°è¾¾åˆ°è®¾å®šçš„è¶…å‚æ•°å€¼ã€‚ç„¶åï¼Œéš”ç¦»æ—è€ƒè™‘å¦‚æœæ ‘æ›´çŸ­å¹¶ä¸”åˆ†åŒºæ›´å°‘ï¼Œåˆ™ç›¸åº”çš„å€¼æ˜¯å¼‚å¸¸å€¼(å°‘æ•°å’Œä¸å¯»å¸¸)ã€‚

![](img/cba421998158d926570d406d386e1300.png)

å­¤ç«‹æ£®æ—å¼‚å¸¸æ£€æµ‹å›¾è§£

è®©æˆ‘ä»¬çœ‹çœ‹ä½¿ç”¨æ¥è‡ª [scikit-learn](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html) çš„`IsolationForest`ç±»çš„å®ç°ã€‚

```
from sklearn.ensemble import IsolationForestIsolationForest(*n_estimators=100*, *max_samples='auto'*, *contamination='auto'*, *max_features=1.0*, *bootstrap=False*, *n_jobs=None*, *random_state=None*, *verbose=0*, *warm_start=False*)
```

éš”ç¦»æ£®æ—ç®—æ³•æœ‰å‡ ä¸ªè¶…å‚æ•°ï¼Œä¾‹å¦‚ç”¨äºé›†æˆçš„åŸºæœ¬ä¼°è®¡é‡æ•°é‡çš„ **n_estimators** ã€ç”¨äºè®­ç»ƒæ¨¡å‹çš„æ ·æœ¬æ•°é‡çš„ **max_samples** ã€ç”¨äºå®šä¹‰æ•°æ®ä¸­å¼‚å¸¸å€¼æ¯”ä¾‹çš„ **contamination** ã€ç”¨äºä»æ•°æ®ä¸­æå–ç”¨äºè®­ç»ƒçš„ç‰¹å¾æ•°é‡çš„ **max_features** ã€‚å…¶ä½™çš„å¯ä»¥çœ‹[æ–‡æ¡£](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html)ã€‚

æˆ‘ä»¬é€šè¿‡å°†åŸºæœ¬æ¨¡å‹çš„æ•°é‡è®¾ç½®ä¸º 100ï¼Œå°†æœ€å¤§ç‰¹å¾çš„æ•°é‡è®¾ç½®ä¸ºç‰¹å¾çš„æ€»æ•°ï¼Œå°†æ±¡æŸ“è®¾ç½®ä¸º`'auto'`æ¥å¯åŠ¨éš”ç¦»æ—ï¼Œè¯¥éš”ç¦»æ—ä½¿ç”¨åŸå§‹æ–‡ä»¶ä¸­ç¡®å®šçš„åç§»å’Œæ±¡æŸ“é˜ˆå€¼ã€‚å¦‚æœæ±¡æŸ“ä¸º 0.1ï¼Œé‚£ä¹ˆæ•°æ®é›†çš„ 10%å°†è¢«å®šä¹‰ä¸ºå¼‚å¸¸å€¼ã€‚

é€šè¿‡è°ƒç”¨`glass['outlier'].value_counts()`ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ 19 æ¡è®°å½•è¢«æ ‡è®°ä¸º`-1`â€”â€”å¼‚å¸¸å€¼ï¼Œå…¶ä½™ 195 æ¡è®°å½•è¢«æ ‡è®°ä¸º`1`â€”â€”éå¼‚å¸¸å€¼ã€‚

![](img/4c8b78c2eaef9c681e114622ef876a3f.png)

å¦‚å‰æ‰€è¿°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸»æˆåˆ†åˆ†æå°†ç‰¹å¾æ•°é‡å‡å°‘åˆ°ä¸‰ä¸ªåˆ†é‡æ¥å¯è§†åŒ–å¼‚å¸¸å€¼ã€‚

![](img/8bdf2c5af21b6097496788c1399dc539.png)

éš”ç¦»æ—æ£€æµ‹åˆ°å¼‚å¸¸å€¼(é»„è‰²)(n ä¼°è®¡å€¼=100ï¼Œæ±¡æŸ“=â€œè‡ªåŠ¨â€)

> ä¸ºäº†ä¿æŒå†…å®¹çš„é‡ç‚¹ï¼Œæˆ‘ä¸ä¼šå±•ç¤ºå¦‚ä½•è°ƒä¼˜è¶…å‚æ•°ï¼Œä½†æ˜¯å¦‚æœæ‚¨æ„Ÿå…´è¶£ï¼Œå¯ä»¥æŸ¥çœ‹æœ¬æ–‡ã€‚

## 2.åŸºäºå¯†åº¦çš„å«å™ªå£°åº”ç”¨ç©ºé—´èšç±»(DBSCAN)æ–¹æ³•

[DBSCAN](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html?highlight=dbscan#sklearn.cluster.DBSCAN) æ˜¯ä¸€ç§æµè¡Œçš„èšç±»ç®—æ³•ï¼Œé€šå¸¸ç”¨ä½œ K-means çš„æ›¿ä»£ç®—æ³•ã€‚å®ƒæ˜¯*åŸºäºå¯†åº¦çš„*ï¼Œè¿™æ„å‘³ç€å®ƒä¾§é‡äºè®¸å¤šæ•°æ®ç‚¹æ‰€åœ¨çš„é«˜å¯†åº¦åŒºåŸŸã€‚å®ƒé€šè¿‡æµ‹é‡æ•°æ®ä¹‹é—´çš„ç‰¹å¾ç©ºé—´è·ç¦»(å³æ¬§å‡ é‡Œå¾·è·ç¦»)æ¥æ‰§è¡Œ*ç©ºé—´èšç±»*ï¼Œä»¥è¯†åˆ«å“ªäº›å¯ä»¥è¢«èšç±»åœ¨ä¸€èµ·ã€‚å®ƒå…è®¸æœ‰å™ªå£°çš„åº”ç”¨ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å¯¹æœ‰å™ªå£°çš„æ•°æ®ä½¿ç”¨ DBSCANã€‚ä½†è¿™è¿˜ä¸æ˜¯å…¨éƒ¨ï¼ŒDBSCAN çš„æœ€å¤§ä¼˜åŠ¿ä¹‹ä¸€æ˜¯æˆ‘ä»¬ä¸éœ€è¦é¢„å…ˆå®šä¹‰é›†ç¾¤çš„æ•°é‡ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ä½¿ç”¨ [scikit-learn](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html) ä¸­çš„`DBSCAN`ç±»çš„å®ç°ã€‚

```
from sklearn.cluster import DBSCANDBSCAN(*eps=0.5*, *min_samples=5*, *metric=â€™euclideanâ€™*, *metric_params=None*, *algorithm=â€™autoâ€™*, *leaf_size=30*, *p=None*, *n_jobs=None*)
```

DBSCAN æœ‰å‡ ä¸ªè¶…å‚æ•°ï¼Œä¾‹å¦‚ç”¨äºåœ¨åŒä¸€ä¸ªèšç±»ä¸­è€ƒè™‘çš„ä¸¤ä¸ªæ•°æ®ç‚¹ä¹‹é—´çš„æœ€å¤§è·ç¦»çš„**EPS(Îµ)**ã€ç”¨äºè¢«è®¤ä¸ºæ˜¯æ ¸å¿ƒç‚¹çš„ç‚¹çš„æ¥è¿‘æ•°æ®ç‚¹çš„æ•°é‡çš„ **min_samples** ã€ç”¨äºè®¡ç®—ç‚¹ä¹‹é—´è·ç¦»çš„**åº¦é‡**ã€‚å…¶ä½™çš„å¯ä»¥çœ‹[æ–‡æ¡£](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html?highlight=dbscan#sklearn.cluster.DBSCAN)ã€‚

å¯åŠ¨ DBSCAN æ—¶ï¼Œä»”ç»†é€‰æ‹©è¶…å‚æ•°éå¸¸é‡è¦ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ eps å€¼é€‰æ‹©å¾—å¤ªå°ï¼Œé‚£ä¹ˆå¤§å¤šæ•°æ•°æ®å¯ä»¥è¢«å½’ç±»ä¸ºå¼‚å¸¸å€¼ï¼Œå› ä¸ºé‚»åŸŸé¢ç§¯è¢«å®šä¹‰ä¸ºæ›´å°ã€‚ç›¸åï¼Œå¦‚æœ eps å€¼é€‰æ‹©å¾—å¤ªå¤§ï¼Œåˆ™å¤§å¤šæ•°ç‚¹å¯ä»¥èšé›†åœ¨ä¸€èµ·ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½ä½äºç›¸åŒçš„é‚»åŸŸä¸­ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨[k-è·ç¦»å›¾é€‰æ‹© eps ä¸º 0.4ã€‚](https://stackoverflow.com/questions/43160240/how-to-plot-a-k-distance-graph-in-python)

![](img/8fa71b4e02ada7c7cf1b7a2f8459fdb7.png)

k-è·ç¦»å›¾ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†æ•°æ®è·ç¦»ç¬¬ 10 ä¸ªæœ€è¿‘çš„é‚»å±…ä¸è¶…è¿‡ 0.4 ä¸ªå•ä½

æ­¤å¤–ï¼Œmin_samples æ˜¯ä¸€ä¸ªé‡è¦çš„è¶…å‚æ•°ï¼Œé€šå¸¸ç­‰äºæˆ–å¤§äº 3ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹é€‰æ‹©ä¸º D+1ï¼Œå…¶ä¸­ D æ˜¯æ•°æ®é›†çš„ç»´æ•°ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°† min_samples è®¾ç½®ä¸º 10ã€‚

å› ä¸º DBSCAN é€šè¿‡å¯†åº¦æ¥è¯†åˆ«èšç±»ï¼Œæ‰€ä»¥é«˜å¯†åº¦åŒºåŸŸæ˜¯èšç±»å‘ç”Ÿçš„åœ°æ–¹ï¼Œä½å¯†åº¦åŒºåŸŸæ˜¯å¼‚å¸¸å€¼å‘ç”Ÿçš„åœ°æ–¹ã€‚é€šè¿‡è°ƒç”¨`glass['outlier'].value_counts()`ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ 22 æ¡è®°å½•è¢«æ ‡è®°ä¸º`-1`â€”â€”å¼‚å¸¸å€¼ï¼Œå…¶ä½™ 192 æ¡è®°å½•è¢«æ ‡è®°ä¸º`1`â€”â€”éå¼‚å¸¸å€¼ã€‚

![](img/0d8841d9e0db60c1c715efd6fe4d9419.png)

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸»æˆåˆ†åˆ†ææ¥å¯è§†åŒ–å¼‚å¸¸å€¼ã€‚

![](img/d882d686d830de44613a85d92f46dce0.png)

DBSCAN æ£€æµ‹åˆ°å¼‚å¸¸å€¼(é»„è‰²)(eps=0.4ï¼Œmin_samples=10)

## 3.æœ¬åœ°å¼‚å¸¸å› ç´ (LOF)

[LOF](https://scikit-learn.org/stable/auto_examples/neighbors/plot_lof_outlier_detection.html#sphx-glr-auto-examples-neighbors-plot-lof-outlier-detection-py) æ˜¯ä¸€ç§æµè¡Œçš„æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹ç®—æ³•ï¼Œå®ƒè®¡ç®—æ•°æ®ç‚¹ç›¸å¯¹äºå…¶é‚»å±…çš„å±€éƒ¨å¯†åº¦åå·®ã€‚è®¡ç®—åï¼Œå¯†åº¦è¾ƒä½çš„ç‚¹è¢«è§†ä¸ºå¼‚å¸¸å€¼ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ä½¿ç”¨æ¥è‡ª [scikit-learn](https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.LocalOutlierFactor.html) çš„`LOF`ç±»çš„å®ç°ã€‚

```
from sklearn.neighbors import LocalOutlierFactor*LocalOutlierFactor(n_neighbors=20, algorithm='auto', leaf_size=30, metric='minkowski', p=2, metric_params=None, contamination='auto', novelty=False, n_jobs=None)*
```

LOF æœ‰å‡ ä¸ªè¶…å‚æ•°ï¼Œå¦‚ **n_neighbors** ç”¨äºé€‰æ‹©é»˜è®¤ç­‰äº 20 çš„é‚»åŸŸæ•°ï¼Œä»¥åŠ**contaminance**ç”¨äºå®šä¹‰å¼‚å¸¸å€¼çš„æ¯”ä¾‹ï¼Œå®ƒå¯ä»¥ç­‰äº(0ï¼Œ0.5)èŒƒå›´å†…çš„`'float'`æˆ–ä½¿ç”¨åŸå§‹è®ºæ–‡ä¸­ç¡®å®šçš„åç§»å’Œæ±¡æŸ“é˜ˆå€¼çš„`'auto'`ã€‚

é€šè¿‡è°ƒç”¨`glass['outlier'].value_counts()`ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ 34 æ¡è®°å½•è¢«æ ‡è®°ä¸º`-1`â€”â€”å¼‚å¸¸å€¼ï¼Œå…¶ä½™ 180 æ¡è®°å½•è¢«æ ‡è®°ä¸º`1`â€”â€”éå¼‚å¸¸å€¼ã€‚

![](img/dab1e636e00802a740c34544bc44df2a.png)

æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸»æˆåˆ†åˆ†ææ¥å¯è§†åŒ–è¿™äº›å¼‚å¸¸å€¼ã€‚

![](img/e13c79ea6358b6aa76a31b5901144174.png)

LOF æ£€æµ‹åˆ°å¼‚å¸¸å€¼(é»„è‰²)(n_neighbors=20ï¼Œæ±¡æŸ“=â€œè‡ªåŠ¨â€)

# ç»“è®º

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢äº†ä¸åŒçš„æ–¹æ³•æ¥æ£€æµ‹æ•°æ®é›†ä¸­çš„å¼‚å¸¸å€¼ã€‚æˆ‘ä»¬ä»å•å˜é‡å¼‚å¸¸å€¼æ£€æµ‹æŠ€æœ¯å¼€å§‹ï¼Œæ¶µç›–äº†æ ‡å‡†å·®å’Œå››åˆ†ä½é—´è·æ–¹æ³•ã€‚æˆ‘ä»¬å¯¹ç»ç’ƒé‰´å®šæ•°æ®é›†ä¸­çš„â€œNaâ€åˆ—æ‰§è¡Œäº†è¿™äº›æ–¹æ³•ã€‚ç„¶åï¼Œæˆ‘ä»¬è½¬å‘å¤šå…ƒå¼‚å¸¸æ£€æµ‹æŠ€æœ¯ï¼Œæ¶µç›–äº†éš”ç¦»æ£®æ—ã€DBSCAN å’Œå±€éƒ¨å¼‚å¸¸å› ç´ ã€‚é€šè¿‡è¿™äº›æ–¹æ³•ï¼Œæˆ‘ä»¬å­¦ä¼šäº†å¦‚ä½•ä½¿ç”¨ç‰¹å¾ç©ºé—´ä¸­çš„æ‰€æœ‰ç»´åº¦æ¥æ£€æµ‹å¼‚å¸¸å€¼ã€‚é™¤äº†å¼‚å¸¸å€¼æ£€æµ‹ï¼Œæˆ‘ä»¬è¿˜å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ PCAâ€”â€”ä¸€ç§é™ç»´æŠ€æœ¯æ¥å¯è§†åŒ– n ç»´æ•°æ®ã€‚

åœ¨ä»‹ç»è¿™äº›æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬æ²¡æœ‰èŠ±å¤ªå¤šæ—¶é—´è°ƒä¼˜è¶…å‚æ•°ã€‚ç„¶è€Œï¼Œè¶…å‚æ•°è°ƒæ•´æ˜¯ ML æ¨¡å‹å¼€å‘ä¸­çš„ä¸€ä¸ªé‡è¦æ­¥éª¤ã€‚å¦‚æœä½ æƒ³å­¦ä¹ æˆ–è€…åˆ·æ–°ä¸€ä¸‹çŸ¥è¯†ï¼Œå¯ä»¥çœ‹çœ‹ä¸‹é¢è¿™ç¯‡æ–‡ç« ã€‚

</hyperparameter-tuning-with-grid-search-and-random-search-6e1b5e175144>  

æˆ‘å¸Œæœ›æ‚¨å–œæ¬¢é˜…è¯»å¼‚å¸¸å€¼æ£€æµ‹ï¼Œå¹¶å‘ç°è¿™ç¯‡æ–‡ç« å¯¹æ‚¨çš„å·¥ä½œæœ‰ç”¨ï¼

*å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯ä»¥**[***åœ¨è¿™é‡Œé˜…è¯»æˆ‘çš„å…¶ä»–æ–‡ç« ***](https://medium.com/@idilismiguzel)**å’Œ* [***å…³æ³¨æˆ‘ä¸Šåª’***](http://medium.com/@idilismiguzel/follow)*å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚âœ¨***

***å–œæ¬¢è¿™ç¯‡æ–‡ç« å—ï¼Ÿ [**æˆä¸ºä¼šå‘˜æ±‚æ›´ï¼**](https://idilismiguzel.medium.com/membership)***

***å‚è€ƒ***

1.  ***[éš”ç¦»æ£®æ—ç”± Scikit-Learn](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html)***
2.  ***[é€šè¿‡ Scikit-Learn è¿›è¡Œæ•°æ®åº“æ‰«æ](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html?highlight=dbscan#sklearn.cluster.DBSCAN)***
3.  ***[sci kit-Learn çš„å±€éƒ¨å¼‚å¸¸å› å­](https://scikit-learn.org/stable/auto_examples/neighbors/plot_lof_outlier_detection.html#sphx-glr-auto-examples-neighbors-plot-lof-outlier-detection-py)***
4.  ***ç”±[æœ¬æ°æ˜Â·æ²ƒç½—æ–¯](https://unsplash.com/@vorosbenisop?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) æ‹æ‘„çš„æ ‡é¢˜ç…§ç‰‡***
5.  ***æ‰€æœ‰å…¶ä»–å›¾ç‰‡å‡ç”±ä½œè€…æä¾›***
6.  ***[æ¥è‡ª Kaggle](https://www.kaggle.com/datasets/uciml/glass) çš„ç»ç’ƒé‰´å®šæ•°æ®é›†ä½œè€…:Duaï¼Œd .å’Œ Graffï¼ŒC. (2019)ã€‚UCI æœºå™¨å­¦ä¹ çŸ¥è¯†åº“[http://archive . ics . UCI . edu/ml]ã€‚åŠ å·æ¬§æ–‡:åŠ å·å¤§å­¦ä¿¡æ¯ä¸è®¡ç®—æœºç§‘å­¦å­¦é™¢ã€‚***
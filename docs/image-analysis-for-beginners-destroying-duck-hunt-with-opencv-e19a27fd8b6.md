# ç”¨ OpenCV ç ´åçŒé¸­â€”â€”åˆå­¦è€…çš„å›¾åƒåˆ†æ

> åŸæ–‡ï¼š<https://towardsdatascience.com/image-analysis-for-beginners-destroying-duck-hunt-with-opencv-e19a27fd8b6>

## ç¼–å†™ä»£ç ï¼Œå°†å‡»è´¥æ¯ä¸€ä¸ªé¸­å­ç‹©çŒé«˜åˆ†

![](img/90b876f72aa586ccc687dfc6e6091cf8.png)

è®©æˆ‘ä»¬è®©è¿™åªç‹—å·¥ä½œå§ï¼(å›¾ç‰‡ç”±ä½œè€…æä¾›)

çŒé¸­è¾›è‹¦ï¼›è®©æˆ‘ä»¬å†™ä¸€äº›ä»£ç ï¼Œç”šè‡³ä¸éœ€è¦è§¦æ‘¸æˆ‘ä»¬çš„é¼ æ ‡å°±å¯ä»¥è·å¾—é«˜åˆ†ï¼æˆ‘ä»¬å°†åº”ç”¨ä¸€äº› OpenCV æŠ€æœ¯æ¥åˆ†ææˆ‘ä»¬çš„å±å¹•ï¼Œæœç´¢é¸­å­å¹¶é€šè¿‡ç‚¹å‡»å®ƒä»¬æ¥æ‹æ‘„å®ƒä»¬ã€‚å®ƒæ¯ç§’é’Ÿä¼šè¿™æ ·åšå¾ˆå¤šæ¬¡ï¼Œæ‰€ä»¥ä¸è¦æŒ‡æœ›å†çœ‹åˆ°é‚£åªç‹—å˜²ç¬‘ä½ äº†ï¼

åœ¨è¿™ç¯‡æ–‡ç« çš„ç»“å°¾ï¼Œä½ å°†èƒ½å¤Ÿåœ¨ä¸æ¥è§¦é¼ æ ‡çš„æƒ…å†µä¸‹å‡»è´¥ä½ è‡ªå·±çš„æ¸¸æˆçš„é«˜åˆ†ã€‚ç‚¹å‡»æŸ¥çœ‹æœ€ç»ˆç»“æœ[ã€‚](https://www.youtube.com/watch?v=__wGNbPZzvE)

![](img/31f072736f3600f915c4b184718fb333.png)

æ€ªç‰©æ€æ­»:æˆ‘ä»¬æ¯å¸§æ‹æ‘„å¤šåªé¸Ÿï¼(å›¾ç‰‡ç”±ä½œè€…æä¾›)

## ç³»åˆ—

æœ¬æ–‡æ˜¯å…³äº OpenCV å›¾åƒå¤„ç†ç³»åˆ—çš„ä¸€éƒ¨åˆ†ã€‚æŸ¥çœ‹å…¶ä»–æ–‡ç« :

*   [*è¯»å–å›¾åƒã€è§†é¢‘ã€å±å¹•å’Œç½‘ç»œæ‘„åƒå¤´*](https://mikehuls.medium.com/image-analysis-for-beginners-how-to-read-images-video-webcam-and-screen-3778e26760e2)
*   [*æ£€æµ‹å’Œæ¨¡ç³Šäººè„¸*](https://mikehuls.medium.com/image-analysis-for-beginners-detect-and-blur-faces-with-a-simple-function-60ba60753487)
*   *ç”¨æ¨¡æ¿åŒ¹é…ç ´åçŒé¸­(ğŸ“ä½ åœ¨è¿™é‡Œï¼)*
*   [*åˆ›å»ºè¿åŠ¨æ£€æµ‹å™¨*](https://mikehuls.medium.com/image-analysis-for-beginners-creating-a-motion-detector-with-opencv-4ca6faba4b42)
*   *æ£€æµ‹æ²¡æœ‰ AI çš„å½¢çŠ¶(åœ¨å»ºï¼›å³å°†æ¨å‡º)*
*   *ä»å›¾åƒä¸­æ£€æµ‹å’Œè¯»å–æ–‡æœ¬*(æ­£åœ¨å»ºè®¾ä¸­ï¼›å³å°†æ¨å‡º)

# çŒé¸Ÿ

å¾ˆæ˜æ˜¾æˆ‘ä»¬ä¸æ˜¯åœ¨ç©åŸæ¥çš„æ¸¸æˆã€‚é‚£éœ€è¦ç”¨ [NES Zapper](https://www.google.com/search?q=nes+zapper) æ¥æ¼”å¥ã€‚æˆ‘ä»¬å°†ä¼šç©ä¸€ä¸ªåœ¨çº¿ç‰ˆæœ¬ï¼Œåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­æˆ‘ä»¬åªéœ€è¦ç‚¹å‡»é¸Ÿå°±å¯ä»¥äº†ã€‚æˆ‘ä»¬çš„ç›®æ ‡å¦‚ä¸‹:

1.  è®°å½•æˆ‘ä»¬çš„å±å¹•ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥åˆ†æå¸§
2.  é¢„å¤„ç†å¸§å¹¶æ‰¾åˆ°ä¸€åªé¸Ÿ
3.  å¦‚æœå‘ç°ä¸€åªé¸Ÿ:ç§»åŠ¨é¼ æ ‡åˆ°é‚£ä¸ªä½ç½®å¹¶ç‚¹å‡»

é¦–å…ˆï¼Œæˆ‘ä»¬å®‰è£…æˆ‘ä»¬çš„ä¾èµ–é¡¹ï¼Œè¿™å¾ˆç®€å•:

```
pip install opencv-python pillow
```

æˆ‘ä»¬çš„è¿›å£çœ‹èµ·æ¥åƒè¿™æ ·:

```
import math
import cv2
import numpy as np
from PIL import ImageGrab
```

[](/why-is-python-so-slow-and-how-to-speed-it-up-485b5a84154e)  

## 1.è®°å½•æˆ‘ä»¬çš„å±å¹•

åœ¨è¿™æ–¹é¢ï¼Œæˆ‘ä»¬å°†ä»æˆ‘ä»¬çš„åŠŸèƒ½ï¼Œå¯ä»¥æ‰¾åˆ°å¹¶æ‹æ‘„é¸Ÿç±»(å®Œæ•´çš„ä»£ç å¯åœ¨åº•éƒ¨)ã€‚

åœ¨å‰å‡ è¡Œä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†å‡ ä¸ªå¸¸é‡ã€‚åœ¨ç¬¬ 4â€“7 è¡Œï¼Œæˆ‘ä»¬æŒ‡å®šäº†æˆ‘ä»¬æƒ³è¦è®°å½•çš„å±å¹•éƒ¨åˆ†ã€‚æˆ‘ä»¬å°†è¿™ä¸ªè¾¹ç•Œæ¡†ä¼ é€’ç»™ç¬¬ 19 è¡Œçš„ ImageGrab æ–¹æ³•ï¼›è¿™å°†åœ¨è¿™äº›åæ ‡ä¸Šâ€œæˆªå±â€æˆ‘ä»¬çš„å±å¹•ã€‚è¯·æ³¨æ„ï¼Œè¿™æ˜¯ä¸€ä¸ª BGR æ ¼å¼çš„å›¾åƒï¼Œè€Œä¸æ˜¯ RGBã€‚æ›´å¤šåœ¨ [**è¿™ç¯‡æ–‡ç« **](https://mikehuls.medium.com/image-analysis-for-beginners-how-to-read-images-video-webcam-and-screen-3778e26760e2) è®²çš„æ˜¯ä¸ºä»€ä¹ˆï¼Œæˆ‘ä»¬åªè¦è®°ä½æœ€åè¦æ¢ç®—å°±è¡Œäº†ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰æ¨¡æ¿ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:

![](img/0a2ef339b496644c649db82946bbccb8.png)

é¸­å­çš„çœ¼ç›ï¼›æˆ‘ä»¬ä»£ç çš„æ¨¡æ¿(å›¾ç‰‡ç”±ä½œè€…æä¾›)

è¿™æ˜¯é¸Ÿçœ¼å¤§éƒ¨åˆ†æ—¶é—´çš„æ ·å­(é™¤éæ˜¯æ°´å¹³é£è¡Œï¼Œæˆ‘ä»¬åé¢ä¼šçœ‹åˆ°)ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œé¸Ÿçš„çœ¼ç›çœ‹èµ·æ¥ä¸ä¸€æ ·ï¼Œå½“ä»–ä»¬æ­»äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸è¦æµªè´¹å¼¹è¯å°„å‡»å·²ç»è¢«å‡»ä¸­çš„é¸Ÿã€‚æˆ‘ä»¬è¿˜æå–æ¨¡æ¿çš„é«˜åº¦å’Œå®½åº¦ä»¥å¤‡åç”¨ã€‚

åœ¨ç¬¬ 13 è¡Œï¼Œæˆ‘ä»¬å¼€å§‹è®°å½•æˆ‘ä»¬çš„å±å¹•ã€‚æˆ‘ä»¬ä¸éœ€è¦æ¯ä¸€å¸§éƒ½æœç´¢é¸Ÿ(æ¯ç§’è¶…è¿‡ 30 æ¬¡ï¼Œå–å†³äºä½ çš„ç¡¬ä»¶)ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ¯éš” 5 å¸§æ‰æ‰§è¡Œä¸€æ¬¡ä»£ç (ç¬¬ 15-17 è¡Œ)ï¼Œè¿™å¯¹é‚£äº›è®¨åŒçš„é¸Ÿæ¥è¯´å·²ç»è¶³å¤Ÿå¿«äº†ã€‚

[](https://medium.com/geekculture/applying-python-multiprocessing-in-2-lines-of-code-3ced521bac8f)  

## 2.é¢„å¤„ç†å’Œæ¨¡æ¿åŒ¹é…

é¢„å¤„ç†éƒ¨åˆ†éå¸¸å°ï¼›æˆ‘ä»¬åªæ˜¯[è½¬æ¢æˆç°è‰²ï¼Œä½¿æ‰§è¡Œé€Ÿåº¦æ›´å¿«ä¸€ç‚¹](https://mikehuls.medium.com/image-analysis-for-beginners-how-to-read-images-video-webcam-and-screen-3778e26760e2)ã€‚

åœ¨ç¬¬ 5 è¡Œï¼Œæˆ‘ä»¬ç”¨`cv2.matchTemplate`æ–¹æ³•æ‰§è¡Œå®é™…çš„æ¨¡æ¿åŒ¹é…ã€‚è¿™å°†è¿”å›ä¸€ç»„å¯èƒ½çš„å€™é€‰é¡¹ã€‚å¯¹äºä¸‹ä¸€è¡Œï¼Œæˆ‘ä»¬åªä¿ç•™é‚£äº›å‡†ç¡®ç‡è¶…è¿‡ 70%çš„å€™é€‰é¡¹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¾ªç¯éå†æ‰€æœ‰çš„é¸Ÿï¼Œæå–åæ ‡å¹¶ä½¿ç”¨è¿™äº›åæ ‡åœ¨ä¸Šé¢ç”»ä¸€ä¸ªåœ†å’Œä¸€ä¸ªæ ‡è®°

å¦‚æœè¿˜æœ‰ä»»ä½•å€™é€‰äººï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç¬¬ 8 è¡Œä¸­çš„åæ ‡ã€‚åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åœ¨æ‰¾åˆ°çš„æ¨¡æ¿ä¸Šç”»ä¸€ä¸ªåå­—æ ‡è®°å’Œä¸€ä¸ªåœ†åœˆï¼Œåœ¨é¸Ÿä¸Šæ”¾ä¸€ä¸ªåå­—å‡†çº¿ã€‚

å‰©ä¸‹çš„ä»£ç åŒ…æ‹¬å°† BGR è½¬æ¢ä¸º RGBï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°åŸå§‹çš„é¢œè‰²ï¼Œå¹¶ç¡®ä¿æˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‰ escape é€€å‡ºã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹ç»“æœ:

![](img/c33e26065ee5590648ecfa4724eafb9b.png)

æˆ‘ä»¬å·²ç»æˆåŠŸåœ°æ‰¾åˆ°äº†æˆ‘ä»¬çš„ç›®æ ‡ï¼Œè®©æˆ‘ä»¬é”å®šå’ŒåŠ è½½(Gif ä½œè€…)

æ­£å¦‚ä½ åœ¨ä¸Šé¢çš„ GIF ä¸­çœ‹åˆ°çš„ï¼Œæ¨¡æ¿åŒ¹é…å‡½æ•°æ­£åœ¨åšå®ƒåº”è¯¥åšçš„äº‹æƒ…:è¯†åˆ«é¸Ÿç±»å¹¶åœ¨å®ƒä»¬èº«ä¸Šåšæ ‡è®°ã€‚åœ¨æ¥ä¸‹æ¥çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æ‹æ‘„é¸Ÿç±»ã€‚

[](/docker-for-absolute-beginners-the-difference-between-an-image-and-a-container-7e07d4c0c01d)  

## 3.å°„é¸Ÿ

åœ¨å‰ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†é¸Ÿå’Œå®ƒä»¬çš„ x-y ä½ç½®ã€‚åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬åªéœ€å°†é¼ æ ‡ç§»åŠ¨åˆ°è¯¥ä½ç½®å¹¶å•å‡»ã€‚

é¦–å…ˆï¼Œåœ¨ç¬¬ 3 è¡Œï¼Œæˆ‘ä»¬å°†åæ ‡ä»æ¡†æ¶åæ ‡è½¬æ¢åˆ°å±å¹•åæ ‡ã€‚æˆ‘ä»¬å¸Œæœ›å°†é¼ æ ‡ç§»åŠ¨åˆ°å±å¹•ä¸Šçš„æŸä¸ªä½ç½®ï¼Œè€Œé¸Ÿçš„åæ ‡æ˜¯ç›¸å¯¹äºæ¡†æ¶çš„(å› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†è¾¹ç•Œæ¡†ï¼Œæ‰€ä»¥å®ƒæ˜¯å±å¹•ä¸Šè¾ƒå°çš„ä¸€éƒ¨åˆ†)ã€‚è¿™å°±æ˜¯æˆ‘ä»¬å¿…é¡»å°†è¾¹ç•Œæ¡†åæ ‡æ·»åŠ åˆ°é¸Ÿåæ ‡æ¥è·å¾—å±å¹•åæ ‡çš„åŸå› ã€‚

ä»ç¬¬ 6 è¡Œå¼€å§‹ï¼Œæˆ‘ä»¬æ£€æŸ¥åæ ‡æ˜¯å¦å¤ªé è¿‘æˆ‘ä»¬ä¹‹å‰ç‚¹å‡»çš„ä½ç½®(åœ¨åŒä¸€å¸§ä¸­)ã€‚è¿™æ ·åšæ˜¯å› ä¸ºæœ‰æ—¶æ¨¡æ¿åŒ¹é…ç®—æ³•ä¼šåœ¨å·¦ä¾§ä»…ä¸€ä¸ªåƒç´ å¤„æ‰¾åˆ°å¦ä¸€ä¸ªåŒ¹é…ï¼›æˆ‘ä»¬ä¸æƒ³ä¸¤æ¬¡å‡»ä¸­åŒä¸€åªé¸Ÿè€Œæµªè´¹å¼¹è¯ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬åœ¨é¡¶éƒ¨å®šä¹‰çš„`just_shot_coords`åˆ—è¡¨ã€‚

æœ€åï¼Œæˆ‘ä»¬è®¾ç½®å…‰æ ‡ä½ç½®å¹¶ç‚¹å‡» ctypes åº“ã€‚

[](/cython-for-absolute-beginners-30x-faster-code-in-two-simple-steps-bbb6c10d06ad)  

# æœ€ç»ˆç»“æœ

æˆ‘ä»¬å»æ‰“çŒå§ï¼åœ¨ä¸‹é¢çš„ gif ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·¥ä½œç®—æ³•çš„ä¸€ä¸ªå°äº®ç‚¹ã€‚æˆ‘å·²ç»æŠŠæ•´ä¸ª 2 åˆ†é’Ÿçš„æ¸¸æˆæ”¾åœ¨ YouTube ä¸Šäº†ã€‚æ£€æŸ¥ä¸€ä¸‹ [**è¿™é‡Œ**](https://www.youtube.com/watch?v=__wGNbPZzvE) (åŸè°…å¯æ€•çš„æ¸¸æˆå£°éŸ³)æˆ–è€… [**è¿™é‡Œ**](https://www.youtube.com/watch?v=5msRyIneNj0) æˆ‘è°ƒæ•´äº†ä¸€äº›å‚æ•°ä»¥æ‹å¾—æ›´å¿«ã€‚

![](img/9f9c62a172d734f830686a1186949af7.png)

# ç»“è®º

åœ¨æœ¬ç³»åˆ—çš„è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†æ¨¡æ¿åŒ¹é…ï¼›ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„åŠŸèƒ½ï¼Œå¯ä»¥è®©ä½ åœ¨å›¾ç‰‡ä¸­æœç´¢å›¾ç‰‡ã€‚ä¸€è·¯ä¸Šï¼Œæˆ‘ä»¬å­¦åˆ°äº†å¾ˆå¤šå…³äºä½¿ç”¨è¾¹æ¡†å’ŒæŠ“å–å±å¹•ï¼Œé¢œè‰²è½¬æ¢å’Œé™åˆ¶æ‰§è¡Œâ€œæ¯ x å¸§ä¸€æ¬¡â€çš„çŸ¥è¯†ã€‚

> åˆ«å¿˜äº†æŸ¥çœ‹æœ¬ç³»åˆ—çš„[å…¶ä»–æ–‡ç« ](https://mikehuls.com/articles?tags=opencv)ï¼

å¦‚æœä½ æœ‰å»ºè®®/æ¾„æ¸…ï¼Œè¯·è¯„è®ºï¼Œä»¥ä¾¿æˆ‘å¯ä»¥æ”¹è¿›è¿™ç¯‡æ–‡ç« ã€‚åŒæ—¶ï¼Œè¯·æŸ¥çœ‹æˆ‘çš„ [**å…³äºå„ç§ç¼–ç¨‹ç›¸å…³ä¸»é¢˜çš„å…¶ä»–æ–‡ç« **](https://www.mikehuls.com) ï¼Œä¾‹å¦‚:

*   [ç»å¯¹åˆå­¦è€…å¦‚ä½•ç”¨ Python åšæ•°æ®åº“è¿æ¥](https://mikehuls.medium.com/how-to-make-a-database-connection-in-python-for-absolute-beginners-e2bfd8e4e52)
*   [Python ä¸­çš„é«˜çº§å¤šä»»åŠ¡å¤„ç†:åº”ç”¨çº¿ç¨‹æ± å’Œè¿›ç¨‹æ± å¹¶è¿›è¡ŒåŸºå‡†æµ‹è¯•](https://mikehuls.medium.com/advanced-multi-tasking-in-python-applying-and-benchmarking-threadpools-and-processpools-90452e0f7d40)
*   [ç¼–å†™è‡ªå·±çš„ C æ‰©å±•æ¥åŠ é€Ÿ Python x100](https://mikehuls.medium.com/write-your-own-c-extension-to-speed-up-python-x100-626bb9d166e7)
*   [cyt hon å…¥é—¨:å¦‚ä½•ç”¨ Python æ‰§è¡Œ>æ¯ç§’ 17 äº¿æ¬¡è®¡ç®—](https://mikehuls.medium.com/getting-started-with-cython-how-to-perform-1-7-billion-calculations-per-second-in-python-b83374cfcf77)
*   [ç”¨ FastAPI ç”¨ 5 è¡Œä»£ç åˆ›å»ºä¸€ä¸ªå¿«é€Ÿè‡ªåŠ¨å½’æ¡£ã€å¯ç»´æŠ¤ä¸”æ˜“äºä½¿ç”¨çš„ Python API](https://mikehuls.medium.com/create-a-fast-auto-documented-maintainable-and-easy-to-use-python-api-in-5-lines-of-code-with-4e574c00f70e)
*   [åˆ›å»ºå¹¶å‘å¸ƒä½ è‡ªå·±çš„ Python åŒ…](https://mikehuls.medium.com/create-and-publish-your-own-python-package-ea45bee41cdc)
*   [åˆ›å»ºæ‚¨çš„å®šåˆ¶ç§æœ‰ Python åŒ…ï¼Œæ‚¨å¯ä»¥ä»æ‚¨çš„ Git åº“ PIP å®‰è£…è¯¥åŒ…](https://mikehuls.medium.com/create-your-custom-python-package-that-you-can-pip-install-from-your-git-repository-f90465867893)
*   [é¢å‘ç»å¯¹åˆå­¦è€…çš„è™šæ‹Ÿç¯å¢ƒâ€”â€”ä»€ä¹ˆæ˜¯è™šæ‹Ÿç¯å¢ƒä»¥åŠå¦‚ä½•åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ(+ç¤ºä¾‹)](https://mikehuls.medium.com/virtual-environments-for-absolute-beginners-what-is-it-and-how-to-create-one-examples-a48da8982d4b)
*   [é€šè¿‡ç®€å•çš„å‡çº§å¤§å¤§æé«˜æ‚¨çš„æ•°æ®åº“æ’å…¥é€Ÿåº¦](https://mikehuls.medium.com/dramatically-improve-your-database-inserts-with-a-simple-upgrade-6dfa672f1424)

ç¼–ç å¿«ä¹ï¼

â€”è¿ˆå…‹

é¡µï¼ˆpage çš„ç¼©å†™ï¼‰å­¦ç”Ÿ:æ¯”å¦‚æˆ‘æ­£åœ¨åšçš„äº‹æƒ…ï¼Ÿ[è·Ÿç€æˆ‘ï¼](https://mikehuls.medium.com/membership)

[](https://mikehuls.medium.com/membership) 
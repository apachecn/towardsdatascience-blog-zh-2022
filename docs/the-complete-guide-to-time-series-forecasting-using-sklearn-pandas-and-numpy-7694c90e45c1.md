# ä½¿ç”¨ Sklearnã€Pandas å’Œ Numpy è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹çš„å®Œæ•´æŒ‡å—

> åŽŸæ–‡ï¼š<https://towardsdatascience.com/the-complete-guide-to-time-series-forecasting-using-sklearn-pandas-and-numpy-7694c90e45c1>

## åœ¨ Python ä¸­ä½¿ç”¨ä»»ä½• scikit-learn æ¨¡åž‹è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹çš„å®žè·µæ•™ç¨‹å’Œæ¡†æž¶

![](img/098817154456f673a9701e9cade7f619.png)

[çŽ‹ç¦¹](https://unsplash.com/@stanyw?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹ç…§

# ä»‹ç»

æ—¶é—´åºåˆ—é¢„æµ‹æœ‰å¾ˆå¤šæ‰€è°“çš„*ä¼ ç»Ÿ*æ¨¡åž‹ï¼Œæ¯”å¦‚ [SARIMAX](https://www.datasciencewithmarco.com/blog/time-series-forecasting-with-sarima-in-python) ç³»åˆ—æ¨¡åž‹ã€[æŒ‡æ•°å¹³æ»‘](https://www.datasciencewithmarco.com/offers/G6ULNc7n)ï¼Œæˆ–è€… [BATS å’Œ TBATS](https://www.datasciencewithmarco.com/blog/how-to-forecast-time-series-with-multiple-seasonalities) ã€‚

ç„¶è€Œï¼Œæˆ‘ä»¬å¾ˆå°‘æåˆ°æœ€å¸¸è§çš„å›žå½’æœºå™¨å­¦ä¹ æ¨¡åž‹ï¼Œå¦‚å†³ç­–æ ‘ï¼Œéšæœºæ£®æž—ï¼Œæ¢¯åº¦æŽ¨è¿›ï¼Œç”šè‡³æ”¯æŒå‘é‡å›žå½’æœºã€‚æˆ‘ä»¬çœ‹åˆ°è¿™äº›æ¨¡åž‹å¹¿æ³›åº”ç”¨äºŽå…¸åž‹çš„å›žå½’é—®é¢˜ï¼Œä½†ä¸æ˜¯æ—¶é—´åºåˆ—é¢„æµ‹ã€‚

å› æ­¤å†™è¿™ç¯‡æ–‡ç« çš„åŽŸå› ï¼åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªæ¡†æž¶ï¼Œå°†ä¸€ä¸ªæ—¶é—´åºåˆ—é—®é¢˜æ¡†å®šä¸ºä¸€ä¸ªç›‘ç£å­¦ä¹ é—®é¢˜ï¼Œå…è®¸æˆ‘ä»¬ä»Žæˆ‘ä»¬æœ€å–œæ¬¢çš„åº“ä¸­ä½¿ç”¨ä»»ä½•æˆ‘ä»¬æƒ³è¦çš„æ¨¡åž‹: *scikit-learn* ï¼

åˆ°æœ¬æ–‡ç»“æŸæ—¶ï¼Œæ‚¨å°†æ‹¥æœ‰å°†ä»»ä½•æœºå™¨å­¦ä¹ æ¨¡åž‹ä¸Žä¸Šè¿°ç»Ÿè®¡æ¨¡åž‹ä¸€èµ·åº”ç”¨äºŽæ—¶é—´åºåˆ—é¢„æµ‹çš„å·¥å…·å’ŒçŸ¥è¯†ã€‚

æˆ‘ä»¬å¼€å§‹å§ï¼

å®Œæ•´çš„æºä»£ç å¯ä»¥åœ¨ [GitHub](https://github.com/marcopeix/datasciencewithmarco/blob/master/sklearn_time_series.ipynb) ä¸ŠèŽ·å¾—ã€‚

> ***ç”¨æˆ‘çš„*** [***å…è´¹æ—¶é—´åºåˆ—å°æŠ„***](https://www.datasciencewithmarco.com/pl/2147608294) ***åœ¨ Python ä¸­å­¦ä¹ æœ€æ–°çš„æ—¶é—´åºåˆ—åˆ†æžæŠ€å·§ï¼èŽ·å¾—ç»Ÿè®¡å’Œæ·±åº¦å­¦ä¹ æŠ€æœ¯çš„å®žçŽ°ï¼Œå…¨éƒ¨åœ¨ Python å’Œ TensorFlow ä¸­ï¼***

# å‡†å¤‡æ•°æ®é›†

é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼å…¥å®Œæˆæ•™ç¨‹æ‰€éœ€çš„æ‰€æœ‰åº“ã€‚

```
import numpy as np
import pandas as pd
import statsmodels.api as sm
import matplotlib.pyplot as plt
```

è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ *statsmodels* åº“æ¥å¯¼å…¥æ•°æ®é›†ï¼Œè¿™æ˜¯ä»Ž 1958 å¹´åˆ° 2001 å¹´çš„æ¯å‘¨ CO2 æµ“åº¦ã€‚

```
data = sm.datasets.co2.load_pandas().data
```

ä¸€ä¸ªå¥½çš„ç¬¬ä¸€æ­¥æ˜¯ç”¨ä¸‹é¢çš„ä»£ç å—å¯è§†åŒ–æˆ‘ä»¬çš„æ•°æ®ã€‚

```
fig, ax = plt.subplots(figsize=(16, 11))ax.plot(data['co2'])
ax.set_xlabel('Time')
ax.set_ylabel('CO2 concentration (ppmw)')fig.autofmt_xdate()
plt.tight_layout()
```

![](img/9946243fcbf2d45770e1b88199a5b797.png)

1958 å¹´è‡³ 2001 å¹´çš„å‘¨ CO2 æµ“åº¦(ppmv)ã€‚æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œç”±äºŽå­£èŠ‚çš„åŽŸå› ï¼Œæ•°æ®ä¸­å­˜åœ¨æ˜Žæ˜¾çš„å¹´åº¦å­£èŠ‚æ€§(å†¬å­£çš„ CO2 æµ“åº¦é«˜äºŽå¤å­£)ã€‚è¿˜æœ‰ä¸€ä¸ªæ˜Žæ˜¾çš„ç§¯æžè¶‹åŠ¿ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°æ•°æ®é›†å¼€å§‹æ—¶æœ‰ä¸€äº›ç¼ºå¤±çš„æ•°æ®ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ä»Žä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°æ•°æ®ä¸­æ˜Žæ˜¾çš„ç§¯æžè¶‹åŠ¿ï¼Œå› ä¸ºæµ“åº¦éšç€æ—¶é—´çš„æŽ¨ç§»è€Œå¢žåŠ ã€‚æˆ‘ä»¬è¿˜è§‚å¯Ÿåˆ°ä¸€ç§å¹´åº¦å­£èŠ‚æ€§æ¨¡å¼ã€‚è¿™æ˜¯ç”±äºŽå­£èŠ‚çš„å˜åŒ–ï¼Œå†¬å­£çš„ CO2 æµ“åº¦é«˜äºŽå¤å­£ã€‚æœ€åŽï¼Œæˆ‘ä»¬åœ¨æ•°æ®é›†çš„å¼€å¤´çœ‹åˆ°ä¸€äº›ç¼ºå¤±çš„æ•°æ®ã€‚

ç„¶åŽï¼Œè®©æˆ‘ä»¬ç”¨æ’å€¼æ³•å¤„ç†ç¼ºå¤±çš„æ•°æ®ã€‚æˆ‘ä»¬å°†ç®€å•åœ°åœ¨ä¸¤ä¸ªå·²çŸ¥ç‚¹ä¹‹é—´è¿›è¡Œçº¿æ€§æ’å€¼æ¥å¡«å……ç¼ºå¤±å€¼ã€‚

```
data = data.interpolate()
```

æ—¢ç„¶æˆ‘ä»¬æ²¡æœ‰ä¸¢å¤±æ•°æ®ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å»ºæ¨¡äº†ï¼

# ä½¿ç”¨ scikit å»ºæ¨¡-å­¦ä¹ 

æ­£å¦‚æ‚¨å°†çœ‹åˆ°çš„ï¼Œç”¨ scikit-learn é¢„æµ‹æ—¶é—´åºåˆ—çš„æœ€å¤§æŒ‘æˆ˜æ˜¯æ­£ç¡®è®¾ç½®é—®é¢˜ã€‚

æœ‰ 3 ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥å°†æ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜æž„å»ºä¸ºç›‘ç£å­¦ä¹ é—®é¢˜:

1.  ä½¿ç”¨ä¹‹å‰çš„è§‚å¯Ÿé¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥
2.  ä½¿ç”¨ä¸€ç³»åˆ—è¿‡åŽ»çš„è§‚å¯Ÿç»“æžœé¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥
3.  ä½¿ç”¨ä¸€ç³»åˆ—è¿‡åŽ»çš„è§‚æµ‹å€¼é¢„æµ‹ä¸€ç³»åˆ—æœªæ¥çš„æ—¶é—´æ­¥é•¿

è®©æˆ‘ä»¬è¯¦ç»†æŽ¢è®¨æ¯ç§æƒ…å†µï¼

## ä½¿ç”¨ä¹‹å‰çš„è§‚å¯Ÿé¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥

è¿™æ˜¯æœ€åŸºæœ¬çš„è®¾ç½®ã€‚è¯¥æ¨¡åž‹è¾“å‡ºä¸‹ä¸€ä¸ªæ—¶é—´æ­¥é•¿çš„é¢„æµ‹ï¼Œä»…ç»™å‡ºå‰ä¸€ä¸ªè§‚å¯Ÿå€¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

![](img/693143ded3f467d59ffd1db9b4a07e6f.png)

æ ¹æ®å‰é¢çš„è§‚å¯Ÿï¼Œæ¨¡åž‹è¢«è®­ç»ƒæ¥é¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿™æ˜¯ä¸€ä¸ªå‡ ä¹Žæ²¡æœ‰å®žé™…åº”ç”¨çš„ç®€å•ç”¨ä¾‹ï¼Œå› ä¸ºä¸€ä¸ªæ¨¡åž‹å¾ˆå¯èƒ½ä¸ä¼šä»…ä»…ä»Žä¹‹å‰çš„è§‚å¯Ÿä¸­*å­¦åˆ°*ä»»ä½•ä¸œè¥¿ã€‚ç„¶è€Œï¼Œå®ƒå¯ä»¥ä½œä¸ºä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ï¼Œå¸®åŠ©æˆ‘ä»¬ç†è§£åŽé¢æ›´å¤æ‚çš„åœºæ™¯ã€‚

çŽ°åœ¨ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†çœ‹èµ·æ¥åƒè¿™æ ·:

![](img/07af37657d66a5c2d29dd54ed112750e.png)

ä½œè€…å›¾ç‰‡

è¿™ä¸æ˜¯å¾ˆæœ‰ç”¨ã€‚æ²¡é”™ï¼Œæ‰€æœ‰çš„å€¼éƒ½åœ¨ä¸€åˆ—ä¸­ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æ ¼å¼åŒ–æ•°æ®é›†ï¼Œä½¿å¾—å½“å‰è§‚å¯Ÿå€¼æ˜¯é¢„æµ‹ä¸‹ä¸€ä¸ªè§‚å¯Ÿå€¼(ç›®æ ‡)çš„ç‰¹å¾ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬æ·»åŠ äº†ç¬¬äºŒåˆ—ï¼Œè¯¥åˆ—ç®€å•åœ°ç§»åŠ¨äº† *co2* åˆ—ï¼Œä½¿å¾— 1958â€“03â€“29 çš„å€¼çŽ°åœ¨æ˜¯ 1958â€“04â€“05 çš„å€¼çš„é¢„æµ‹å€¼ã€‚

```
df = data.copy()df['y'] = df['co2'].shift(-1)
```

![](img/c299f90373aae3006eb96d3b12b9d310.png)

æ•°æ®é›†æ²¡æœ‰è¢«æ ¼å¼åŒ–ä¸ºç›‘ç£å­¦ä¹ é—®é¢˜ï¼Œå…¶ä¸­å½“å‰è§‚å¯Ÿæ˜¯ç‰¹å¾ï¼Œä¸‹ä¸€ä¸ªè§‚å¯Ÿæ˜¯ç›®æ ‡ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†çŽ°åœ¨å·²ç»æ ¼å¼åŒ–ï¼Œå› æ­¤æ¯ä¸ªå½“å‰è§‚å¯Ÿéƒ½æ˜¯ä¸‹ä¸€ä¸ªè§‚å¯Ÿçš„é¢„æµ‹å€¼ï¼è¯·æ³¨æ„ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†æœ«å°¾ç¼ºå°‘ä¸€ä¸ªå€¼ã€‚è¿™å¯¹äºŽæœ€åŽå·²çŸ¥çš„è§‚å¯Ÿæ¥è¯´æ˜¯æ­£å¸¸çš„ã€‚æˆ‘ä»¬å°†åœ¨ä»¥åŽçš„æ­¥éª¤ä¸­åˆ é™¤è¯¥è¡Œã€‚

çŽ°åœ¨ï¼Œè®©æˆ‘ä»¬å°†æ•°æ®é›†åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œä»¥ä¾¿è¿è¡Œæˆ‘ä»¬çš„æ¨¡åž‹å¹¶å¯¹å®ƒä»¬è¿›è¡Œè¯„ä¼°ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨æœ€è¿‘ä¸¤å¹´çš„æ•°æ®ä½œä¸ºè®­ç»ƒé›†ã€‚ç”±äºŽæˆ‘ä»¬æœ‰æ¯å‘¨æ•°æ®ï¼Œå¹¶ä¸”ä¸€å¹´æœ‰ 52 å‘¨ï¼Œè¿™æ„å‘³ç€æœ€åŽ 104 ä¸ªæ ·æœ¬è¢«ä¿ç•™ç”¨äºŽæµ‹è¯•é›†ã€‚

```
train = df[:-104]
test = df[-104:]
test = test.drop(test.tail(1).index) # Drop last row
```

**åŸºçº¿æ¨¡åž‹**

å½“ç„¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåŸºçº¿æ¨¡åž‹æ¥ç¡®å®šä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡åž‹æ˜¯å¦æ›´å¥½ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å¤©çœŸåœ°é¢„æµ‹ä¸‹ä¸€ä¸ªè§‚å¯Ÿå€¼å°†ä¸Žå½“å‰è§‚å¯Ÿå€¼ç›¸åŒã€‚

æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ç®€å•åœ°å°† *co2* åˆ—è®¾å®šä¸ºæˆ‘ä»¬çš„åŸºçº¿é¢„æµ‹ã€‚

```
test = test.copy()
test['baseline_pred'] = test['co2']
```

![](img/95c52a963639d3935e7393343cddfcf3.png)

åŸºçº¿é¢„æµ‹åªæ˜¯ç®€å•åœ°é‡å¤æœªæ¥å·²çŸ¥çš„è§‚å¯Ÿã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¤ªå¥½äº†ï¼å®Œæˆè¿™ä¸€æ­¥åŽï¼Œè®©æˆ‘ä»¬ç»§ç»­æ›´å¤æ‚çš„æ¨¡åž‹ã€‚

**å†³ç­–æ ‘**

è¿™é‡Œï¼Œè®©æˆ‘ä»¬åº”ç”¨ä¸€ä¸ªå†³ç­–æ ‘å›žå½’å™¨ã€‚è¿™ä¸ªæ¨¡åž‹å¯ä»¥è¢« scikit-learn åº“ä¸­æ‚¨æƒ³è¦çš„ä»»ä½•æ¨¡åž‹æ›¿æ¢ï¼è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨éšæœºçŠ¶æ€æ¥ç¡®ä¿å¯é‡å¤æ€§ã€‚

```
from sklearn.tree import DecisionTreeRegressorX_train = train['co2'].values.reshape(-1,1)
y_train = train['y'].values.reshape(-1,1)
X_test = test['co2'].values.reshape(-1,1)# Initialize the model
dt_reg = DecisionTreeRegressor(random_state=42)# Fit the model
dt_reg.fit(X=X_train, y=y_train)# Make predictions
dt_pred = dt_reg.predict(X_test)# Assign predictions to a new column in test
test['dt_pred'] = dt_pred
```

![](img/1dbe5cbad14b3a65d320468861d8645f.png)

æµ‹è¯•é›†çŽ°åœ¨æœ‰æ¥è‡ªå†³ç­–æ ‘æ¨¡åž‹çš„é¢„æµ‹ï¼å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æ³¨æ„ï¼Œæˆ‘ä»¬ä¿æŒå»ºæ¨¡éƒ¨åˆ†ç®€å•ã€‚æˆ‘ä»¬ä¸æ‰§è¡Œä»»ä½•äº¤å‰éªŒè¯æˆ–è¶…å‚æ•°è°ƒæ•´ï¼Œå°½ç®¡è¿™äº›æŠ€æœ¯å¯ä»¥æ­£å¸¸åº”ç”¨äºŽæ­¤ï¼Œå°±åƒåœ¨ä»»ä½•å…¶ä»–å›žå½’é—®é¢˜ä¸­ä¸€æ ·ã€‚

éšæ„è¿ç”¨è¿™äº›æŠ€å·§ï¼Œçœ‹çœ‹ä½ æ˜¯å¦èƒ½å¾—åˆ°æ›´å¥½çš„è¡¨çŽ°ã€‚

**æ¢¯åº¦å¢žå¼º**

ä¸ºäº†å°è¯•ä¸åŒçš„æ¨¡åž‹ï¼Œè®©æˆ‘ä»¬çŽ°åœ¨åº”ç”¨æ¢¯åº¦æŽ¨è¿›ã€‚

```
from sklearn.ensemble import GradientBoostingRegressorgbr = GradientBoostingRegressor(random_state=42)gbr.fit(X_train, y=y_train.ravel())gbr_pred = gbr.predict(X_test)test['gbr_pred'] = gbr_pred
```

![](img/b45e54666046e16672c1154175c45da7.png)

æµ‹è¯•é›†çŽ°åœ¨å…·æœ‰æ¥è‡ªæ¢¯åº¦æŽ¨è¿›æ¨¡åž‹çš„é¢„æµ‹ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¤ªå¥½äº†ï¼æˆ‘ä»¬çŽ°åœ¨æœ‰äº†æ¥è‡ªä¸¤ä¸ªæœºå™¨å­¦ä¹ æ¨¡åž‹å’Œä¸€ä¸ªåŸºçº¿çš„é¢„æµ‹ã€‚æ˜¯æ—¶å€™è¯„ä¼°æ¯ç§æ–¹æ³•çš„æ€§èƒ½äº†ã€‚

**è¯„ä¼°**

è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®(MAPE)ã€‚è¿™æ˜¯ä¸€ä¸ªç‰¹åˆ«æœ‰ç”¨è¯¯å·®æŒ‡æ ‡ï¼Œå› ä¸ºå®ƒè¿”å›žä¸€ä¸ªç™¾åˆ†æ¯”ï¼Œå¾ˆå®¹æ˜“è§£é‡Šã€‚ç¡®ä¿åªåœ¨æ²¡æœ‰æŽ¥è¿‘ 0 çš„å€¼æ—¶åº”ç”¨å®ƒï¼Œè¿™é‡Œå°±æ˜¯è¿™ç§æƒ…å†µã€‚

ä¸å¹¸çš„æ˜¯ï¼ŒMAPE è¿˜æ²¡æœ‰åœ¨ *scikit-learn* ä¸­å®žçŽ°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æ‰‹å·¥å®šä¹‰è¿™ä¸ªå‡½æ•°ã€‚

```
def mape(y_true, y_pred):
    return round(np.mean(np.abs((y_true - y_pred) / y_true)) * 100, 2)
```

ç„¶åŽï¼Œæˆ‘ä»¬å¯ä»¥è¯„ä¼°æ¯ä¸ªæ¨¡åž‹ï¼Œå¹¶ç”Ÿæˆä»¥ä¸‹æ¡å½¢å›¾:

```
baseline_mape = mape(test['y'], test['baseline_pred'])
dt_mape = mape(test['y'], test['dt_pred'])
gbr_mape = mape(test['co2'], test['gbr_pred'])# Generate bar plot
fig, ax = plt.subplots(figsize=(7, 5))x = ['Baseline', 'Decision Tree', 'Gradient Boosting']
y = [baseline_mape, dt_mape, gbr_mape]ax.bar(x, y, width=0.4)
ax.set_xlabel('Regressor models')
ax.set_ylabel('MAPE (%)')
ax.set_ylim(0, 0.3)for index, value in enumerate(y):
    plt.text(x=index, y=value + 0.02, s=str(value), ha='center')

plt.tight_layout()
```

![](img/77e7a5f1503edec4676ea950318c8601.png)

æ¯ç§é¢„æµ‹æ–¹æ³•çš„ MAPEã€‚è¿™é‡Œï¼ŒåŸºçº¿æä¾›äº†æœ€ä½³æ€§èƒ½ï¼Œå› ä¸ºå®ƒå…·æœ‰æœ€ä½Žçš„ MAPEã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

çœ‹ä¸Šé¢çš„å›¾ï¼Œæˆ‘ä»¬çœ‹åˆ°åŸºçº¿å…·æœ‰æœ€å¥½çš„æ€§èƒ½ï¼Œå› ä¸ºå®ƒå…·æœ‰æœ€ä½Žçš„ MAPEã€‚è¿™æ˜¯æœ‰é“ç†çš„ï¼Œå› ä¸ºäºŒæ°§åŒ–ç¢³æµ“åº¦ä¼¼ä¹Žä¸ä¼šä»Žä¸€å‘¨åˆ°å¦ä¸€å‘¨å‘ç”Ÿå‰§çƒˆå˜åŒ–ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡åž‹å¹¶æ²¡æœ‰ç»™æˆ‘ä»¬å¸¦æ¥ä»»ä½•é™„åŠ å€¼ã€‚åŒæ ·ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºæ¨¡åž‹ä»…ä»Žä¸€ä¸ªè§‚å¯Ÿä¸­å­¦ä¹ æ¥åšå‡ºé¢„æµ‹ã€‚æœ€å¥½ç»™å®ƒä¸€ä¸ªåºåˆ—ä½œä¸ºè¾“å…¥ï¼Œä»¥ä¾¿é¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ã€‚

è¿™å°±æŠŠæˆ‘ä»¬å¸¦åˆ°äº†ä¸‹ä¸€ä¸ªåœºæ™¯ï¼

## ä½¿ç”¨ä¸€ç³»åˆ—è¿‡åŽ»çš„è§‚å¯Ÿç»“æžœé¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥

æ­£å¦‚æˆ‘ä»¬åœ¨å‰é¢çš„ä¾‹å­ä¸­æ‰€çœ‹åˆ°çš„ï¼Œä½¿ç”¨å•ä¸ªè§‚å¯Ÿå€¼æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥å¹¶ä¸æ˜¯å¾ˆå¥½ã€‚çŽ°åœ¨ï¼Œè®©æˆ‘ä»¬å°è¯•ä½¿ç”¨ä¸€ä¸ªåºåˆ—ä½œä¸ºæ¨¡åž‹çš„è¾“å…¥ï¼Œå¹¶é¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œå¦‚ä¸‹æ‰€ç¤º

![](img/0021d64d5ebd64273ca202026b3becc6.png)

é‡‡ç”¨è¾“å…¥åºåˆ—é¢„æµ‹ä¸‹ä¸€æ—¶é—´æ­¥çš„æ¨¡åž‹çš„æ¨¡å¼ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

åŒæ ·ï¼Œæˆ‘ä»¬å¿…é¡»æ ¼å¼åŒ–æˆ‘ä»¬çš„æ•°æ®é›†ï¼Œä»¥ä¾¿æˆ‘ä»¬æœ‰ä¸€ç³»åˆ—è¿‡åŽ»çš„è§‚å¯Ÿå€¼ä½œä¸ºä¸‹ä¸€ä¸ªæ—¶é—´æ­¥çš„é¢„æµ‹å€¼ã€‚

æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œé€šè¿‡æ·»åŠ ç§»ä½çš„åˆ—æ¥èŽ·å¾—æ‰€éœ€çš„è¾“å…¥é•¿åº¦ã€‚

```
def window_input(window_length: int, data: pd.DataFrame) -> pd.DataFrame:

    df = data.copy()

    i = 1
    while i < window_length:
        df[f'x_{i}'] = df['co2'].shift(-i)
        i = i + 1

    if i == window_length:
        df['y'] = df['co2'].shift(-i)

    # Drop rows where there is a NaN
    df = df.dropna(axis=0)

    return df
```

è®©æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªå‡½æ•°è¾“å…¥ 5 ä¸ªè§‚æµ‹å€¼ï¼Œä»¥ä¾¿é¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ã€‚

```
new_df = window_input(5, data)
```

![](img/8487c5cf88a62cda779bac98a53e21a5.png)

ç»“æžœæ•°æ®é›†ã€‚å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬çŽ°åœ¨æœ‰ 5 ä¸ªè§‚æµ‹å€¼ä½œä¸ºä¸‹ä¸€ä¸ªæ—¶é—´æ­¥çš„é¢„æµ‹å€¼ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

æŸ¥çœ‹ä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ•°æ®é›†ä»¥è¿™æ ·çš„æ–¹å¼æŽ’åˆ—ï¼Œæˆ‘ä»¬æœ‰äº”ä¸ªè§‚å¯Ÿå€¼æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œå­˜å‚¨åœ¨ *y* åˆ—ä¸­ã€‚

è¿™åŸºæœ¬ä¸Šè§£å†³äº†æœ€éš¾çš„éƒ¨åˆ†ï¼çŽ°åœ¨ï¼Œç®€å•çš„é—®é¢˜æ˜¯åº”ç”¨ä¸åŒçš„æ¨¡åž‹ï¼Œçœ‹çœ‹å“ªä¸ªè¡¨çŽ°æœ€å¥½ã€‚

åœ¨è¿›å…¥è¿™ä¸€æ­¥ä¹‹å‰ï¼Œè®©æˆ‘ä»¬é¦–å…ˆå°†æ•°æ®åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚

```
from sklearn.model_selection import train_test_split

X = new_df[['co2', 'x_1', 'x_2', 'x_3', 'x_4']].values
y = new_df['y'].values

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42, shuffle=False)
```

**åŸºçº¿æ¨¡åž‹**

åŒæ ·ï¼Œè®©æˆ‘ä»¬ä¸ºè¿™ç§æƒ…å†µå®šä¹‰ä¸€ä¸ªåŸºçº¿æ¨¡åž‹ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å°†ç®€å•åœ°é¢„æµ‹è¾“å…¥åºåˆ—çš„å¹³å‡å€¼

```
baseline_pred = []

for row in X_test:
    baseline_pred.append(np.mean(row))
```

**å†³ç­–æ ‘**

åŒæ ·ï¼Œè®©æˆ‘ä»¬åº”ç”¨å†³ç­–æ ‘å›žå½’å™¨ã€‚è¿™ä¸Žå‰é¢çš„å®žçŽ°ä¸€æ ·ç®€å•ã€‚

```
dt_reg_5 = DecisionTreeRegressor(random_state=42)

dt_reg_5.fit(X_train, y_train)

dt_reg_5_pred = dt_reg_5.predict(X_test)
```

**æ¢¯åº¦å¢žå¼º**

ä¸ºäº†ä¿æŒä¸€è‡´ï¼Œæˆ‘ä»¬ä¹Ÿæ¥è¯•è¯•æ¢¯åº¦æå‡ã€‚

```
gbr_5 = GradientBoostingRegressor(random_state=42)

gbr_5.fit(X_train, y_train.ravel())

gbr_5_pred = gbr_5.predict(X_test)
```

**è¯„ä¼°**

æˆ‘ä»¬çŽ°åœ¨å¯ä»¥è¯„ä¼°æ¯ä¸ªæ¨¡åž‹çš„æ€§èƒ½ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä½¿ç”¨ MAPE å¹¶å°†ç»“æžœç»˜åˆ¶åœ¨æŸ±çŠ¶å›¾ä¸­ã€‚è¿™åŸºæœ¬ä¸Šæ˜¯å’Œä»¥å‰ä¸€æ ·çš„ä»£ç ã€‚

```
baseline_mape = mape(y_test, baseline_pred)
dt_5_mape = mape(y_test, dt_reg_5_pred)
gbr_5_mape = mape(y_test, gbr_5_pred)# Generate the bar plotfig, ax = plt.subplots()

x = ['Baseline', 'Decision Tree', 'Gradient Boosting']
y = [baseline_mape, dt_5_mape, gbr_5_mape]

ax.bar(x, y, width=0.4)
ax.set_xlabel('Regressor models')
ax.set_ylabel('MAPE (%)')
ax.set_ylim(0, 2.5)

for index, value in enumerate(y):
    plt.text(x=index, y=value + 0.1, s=str(value), ha='center')

plt.tight_layout()
```

![](img/fad02fc909c775538915819c6e2d1a0c.png)

MAPE é’ˆå¯¹ä¸åŒçš„é¢„æµ‹æ–¹æ³•ä½¿ç”¨äº”ä¸ªè§‚æµ‹å€¼æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ã€‚åŒæ ·ï¼Œæœºå™¨å­¦ä¹ æ¨¡åž‹å¹¶æ²¡æœ‰è¶…è¶ŠåŸºçº¿ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œä»Žä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°æœºå™¨å­¦ä¹ æ¨¡åž‹å¹¶æ²¡æœ‰è¶…è¶ŠåŸºçº¿ã€‚

è™½ç„¶è¶…å‚æ•°è°ƒæ•´å¯èƒ½ä¼šæé«˜ ML æ¨¡åž‹çš„æ€§èƒ½ï¼Œä½†æˆ‘æ€€ç–‘è¾“å…¥çª—å£å¤ªçŸ­ã€‚äº”å‘¨çš„è¾“å…¥ä¸è¶³ä»¥è®©æ¨¡åž‹èŽ·å¾—è¶‹åŠ¿å’Œå­£èŠ‚æ€§æˆåˆ†ï¼Œå› æ­¤æˆ‘ä»¬å¯èƒ½éœ€è¦æ›´é•¿çš„æ—¶é—´çª—å£ã€‚

æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ä¸ªåœºæ™¯ä¸­å°è¯•è¿™æ ·åšï¼

## ä½¿ç”¨ä¸€ç³»åˆ—è¿‡åŽ»çš„è§‚æµ‹å€¼é¢„æµ‹ä¸€ç³»åˆ—æœªæ¥çš„æ—¶é—´æ­¥é•¿

æœ€åŽä¸€ä¸ªåœºæ™¯æ˜¯ä½¿ç”¨ä¸€ç³»åˆ—è§‚å¯Ÿå€¼æ¥é¢„æµ‹ä¸€ç³»åˆ—æœªæ¥çš„æ—¶é—´æ­¥é•¿ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

![](img/ce911d67a6df7bd6a194a2e4204fa4af.png)

é‡‡ç”¨è¾“å…¥åºåˆ—å¹¶é¢„æµ‹æœªæ¥æ—¶é—´æ­¥é•¿åºåˆ—çš„æ¨¡åž‹æž¶æž„ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿™é‡Œï¼Œæˆ‘ä»¬çš„æ¨¡åž‹éœ€è¦è¾“å‡ºä¸€ç³»åˆ—é¢„æµ‹ã€‚è¿™å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªå¤šè¾“å‡ºå›žå½’é—®é¢˜ã€‚

å› æ­¤ï¼Œç¬¬ä¸€æ­¥æ˜¯é€‚å½“åœ°æ ¼å¼åŒ–æˆ‘ä»¬çš„æ•°æ®é›†ã€‚æˆ‘ä»¬å¼€å‘äº†å¦ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä½¿ç”¨ *shift* æ–¹æ³•å°†æ•°æ®é›†æ ¼å¼åŒ–ä¸ºå¤šè¾“å‡ºå›žå½’é—®é¢˜ã€‚

```
def window_input_output(input_length: int, output_length: int, data: pd.DataFrame) -> pd.DataFrame:

    df = data.copy()

    i = 1
    while i < input_length:
        df[f'x_{i}'] = df['co2'].shift(-i)
        i = i + 1

    j = 0
    while j < output_length:
        df[f'y_{j}'] = df['co2'].shift(-output_length-j)
        j = j + 1

    df = df.dropna(axis=0)

    return df
```

è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ 26 ä¸ªè§‚æµ‹å€¼çš„åºåˆ—æ¥é¢„æµ‹æŽ¥ä¸‹æ¥çš„ 26 ä¸ªæ—¶é—´æ­¥ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬è¾“å…¥åŠå¹´æ¥é¢„æµ‹ä¸‹åŠå¹´ã€‚æ³¨æ„ï¼Œè¾“å…¥å’Œè¾“å‡ºåºåˆ—ä¸éœ€è¦å…·æœ‰ç›¸åŒçš„é•¿åº¦ã€‚è¿™æ˜¯æˆ‘çš„ä¸€ä¸ªæ­¦æ–­çš„å†³å®šã€‚

```
seq_df = window_input_output(26, 26, data)
```

![](img/2e77186633396ab3dcd1dc004b11d6d5.png)

æ•°æ®é›†æœªæ ¼å¼åŒ–ï¼Œå› æ­¤ 26 ä¸ªè§‚å¯Ÿå€¼æ˜¯æŽ¥ä¸‹æ¥ 26 ä¸ªæ—¶é—´æ­¥çš„é¢„æµ‹å€¼ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬çŽ°åœ¨æœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­ 26 ä¸ªè§‚æµ‹å€¼ç”¨ä½œæŽ¥ä¸‹æ¥ 26 ä¸ªæ—¶é—´æ­¥é•¿çš„é¢„æµ‹å€¼ã€‚

åœ¨ç»§ç»­å»ºæ¨¡ä¹‹å‰ï¼Œæˆ‘ä»¬å†æ¬¡å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä¸ºæµ‹è¯•é›†ä¿ç•™æœ€åŽä¸¤è¡Œï¼Œå› ä¸ºå®ƒç»™äº†æˆ‘ä»¬ 52 ä¸ªæµ‹è¯•æ ·æœ¬ã€‚

```
X_cols = [col for col in seq_df.columns if col.startswith('x')]

X_cols.insert(0, 'co2')

y_cols = [col for col in seq_df.columns if col.startswith('y')]X_train = seq_df[X_cols][:-2].values
y_train = seq_df[y_cols][:-2].values

X_test = seq_df[X_cols][-2:].values
y_test = seq_df[y_cols][-2:].values
```

**åŸºçº¿æ¨¡åž‹**

ä½œä¸ºåŸºçº¿æ¨¡åž‹ï¼Œæˆ‘ä»¬å°†ç®€å•åœ°é‡å¤è¾“å…¥åºåˆ—ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬èŽ·å–è¾“å…¥åºåˆ—å¹¶è¾“å‡ºä¸ŽåŸºçº¿é¢„æµ‹ç›¸åŒçš„åºåˆ—ã€‚

è¿™æ˜¯ä¸€ä¸ªéžå¸¸çç¢Žçš„é¢„æµ‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†åœ¨å‡†å¤‡è¯„ä¼°æ¨¡åž‹æ—¶å®žçŽ°å®ƒã€‚

**å†³ç­–æ ‘**

åŒæ ·ï¼Œè®©æˆ‘ä»¬å°è¯•åº”ç”¨å†³ç­–æ ‘ã€‚æ³¨æ„ï¼Œå†³ç­–æ ‘å¯ä»¥äº§ç”Ÿå¤šè¾“å‡ºé¢„æµ‹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦åœ¨è¿™é‡Œåšä»»ä½•é¢å¤–çš„å·¥ä½œã€‚

```
dt_seq = DecisionTreeRegressor(random_state=42)

dt_seq.fit(X_train, y_train)

dt_seq_preds = dt_seq.predict(X_test)
```

**æ¢¯åº¦æŽ¨è¿›**

çŽ°åœ¨ï¼Œæ¢¯åº¦æŽ¨è¿›éœ€è¦ä¸€ç‚¹é¢å¤–çš„å·¥ä½œã€‚å®ƒä¸èƒ½å¤„ç†å¤šè¾“å‡ºç›®æ ‡ã€‚è¯•å›¾ç«‹å³æ‹Ÿåˆæ¢¯åº¦å¢žå¼ºæ¨¡åž‹å°†å¯¼è‡´é”™è¯¯ã€‚

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¿…é¡»åŒ…è£…æ¨¡åž‹ï¼Œä»¥ä¾¿å®ƒçš„é¢„æµ‹è¢«ç”¨ä½œä¸‹ä¸€ä¸ªé¢„æµ‹çš„è¾“å…¥ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨æ¥è‡ª *scikit-learn* çš„*å›žå½’é“¾*åŒ…è£…å™¨å®žçŽ°çš„ã€‚

```
from sklearn.multioutput import RegressorChain

gbr_seq = GradientBoostingRegressor(random_state=42)

chained_gbr = RegressorChain(gbr_seq)

chained_gbr.fit(X_train, y_train)

gbr_seq_preds = chained_gbr.predict(X_test)
```

è¿™å…è®¸è®­ç»ƒæ¨¡åž‹å¹¶è¿›è¡Œé¢„æµ‹ï¼Œè€Œä¸ä¼šé‡åˆ°ä»»ä½•é”™è¯¯ã€‚æ­£å¦‚æˆ‘æåˆ°çš„ï¼Œåœ¨å¹•åŽï¼Œæ¨¡åž‹é¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œå¹¶ä½¿ç”¨è¯¥é¢„æµ‹è¿›è¡Œä¸‹ä¸€æ¬¡é¢„æµ‹ã€‚è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯ï¼Œå¦‚æžœç¬¬ä¸€ä¸ªé¢„æµ‹æ˜¯åçš„ï¼Œé‚£ä¹ˆåºåˆ—çš„å…¶ä½™éƒ¨åˆ†å¾ˆå¯èƒ½ä¹Ÿæ˜¯åçš„ã€‚

çŽ°åœ¨æˆ‘ä»¬æ¥è¯„ä»·ä¸€ä¸‹æ¯ä¸€æ¬¾ã€‚

**è¯„ä¼°**

åŒæ ·ï¼Œæˆ‘ä»¬ä½¿ç”¨ MAPE æ¥è¯„ä¼°æˆ‘ä»¬çš„é¢„æµ‹æ–¹æ³•ã€‚

```
mape_dt_seq = mape(dt_seq_preds.reshape(1, -1), y_test.reshape(1, -1))
mape_gbr_seq = mape(gbr_seq_preds.reshape(1, -1), y_test.reshape(1, -1))
mape_baseline = mape(X_test.reshape(1, -1), y_test.reshape(1, -1))# Generate the bar plotfig, ax = plt.subplots()

x = ['Baseline', 'Decision Tree', 'Gradient Boosting']
y = [mape_baseline, mape_dt_seq, mape_gbr_seq]

ax.bar(x, y, width=0.4)
ax.set_xlabel('Regressor models')
ax.set_ylabel('MAPE (%)')
ax.set_ylim(0, 1)

for index, value in enumerate(y):
    plt.text(x=index, y=value + 0.05, s=str(value), ha='center')

plt.tight_layout()
```

![](img/31ac1e26ed758f6d0fcc460c089647c3.png)

æ‰€æœ‰å¤šè¾“å‡ºå›žå½’æ¨¡åž‹çš„ MAPEã€‚è¿™é‡Œï¼ŒML æ¨¡åž‹ä¼˜äºŽåŸºçº¿ï¼Œå†³ç­–æ ‘æ˜¯æœ€å¥½çš„æ¨¡åž‹ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

ä»Žä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬ç»ˆäºŽæˆåŠŸè®­ç»ƒå‡ºäº†è·‘èµ¢åŸºçº¿çš„ ML æ¨¡åž‹ï¼åœ¨è¿™é‡Œï¼Œå†³ç­–æ ‘æ¨¡åž‹æ˜¯å† å†›æ¨¡åž‹ï¼Œå› ä¸ºå®ƒå®žçŽ°äº†æœ€ä½Žçš„ MAPEã€‚

æˆ‘ä»¬å¯ä»¥é€‰æ‹©å°†åŽ»å¹´çš„é¢„æµ‹å¯è§†åŒ–ã€‚

```
fig, ax = plt.subplots(figsize=(16, 11))ax.plot(np.arange(0, 26, 1), X_test[1], 'b-', label='input')
ax.plot(np.arange(26, 52, 1), y_test[1], marker='.', color='blue', label='Actual')
ax.plot(np.arange(26, 52, 1), X_test[1], marker='o', color='red', label='Baseline')
ax.plot(np.arange(26, 52, 1), dt_seq_preds[1], marker='^', color='green', label='Decision Tree')
ax.plot(np.arange(26, 52, 1), gbr_seq_preds[1], marker='P', color='black', label='Gradient Boosting')ax.set_xlabel('Timesteps')
ax.set_ylabel('CO2 concentration (ppmv)')plt.xticks(np.arange(1, 104, 52), np.arange(2000, 2002, 1))
plt.legend(loc=2)fig.autofmt_xdate()
plt.tight_layout()
```

![](img/5fd9bd8407c409fffeee1d9321c0cbaa.png)

å¯è§†åŒ–åŽ»å¹´æ¯ä¸ªæ¨¡åž‹çš„é¢„æµ‹ã€‚æ˜¾ç„¶ï¼ŒåŸºçº¿åç¦»å¾—å¾ˆè¿œï¼Œè€Œå†³ç­–æ ‘å’Œæ¢¯åº¦æŽ¨è¿›æ›´æŽ¥è¿‘å®žé™…å€¼ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

è¿›ä¸€æ­¥æ”¯æŒ MAPEï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å†³ç­–æ ‘å’Œæ¢¯åº¦æŽ¨è¿›æ¯”åŸºçº¿é¢„æµ‹æ›´æŽ¥è¿‘å®žé™…å€¼ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•å°†æ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜æž„å»ºä¸ºä¸€ä¸ªå›žå½’é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ *scikit-learn* å›žå½’æ¨¡åž‹æ¥è§£å†³è¯¥é—®é¢˜ã€‚

æˆ‘ä»¬æŽ¢è®¨äº†ä»¥ä¸‹åœºæ™¯:

1.  ä½¿ç”¨ä¹‹å‰çš„è§‚å¯Ÿé¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥
2.  ä½¿ç”¨ä¸€ç³»åˆ—è¿‡åŽ»çš„è§‚å¯Ÿç»“æžœé¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥
3.  ä½¿ç”¨ä¸€ç³»åˆ—è¿‡åŽ»çš„è§‚æµ‹å€¼é¢„æµ‹ä¸€ç³»åˆ—æœªæ¥çš„æ—¶é—´æ­¥é•¿

æˆ‘ä»¬çŽ°åœ¨æœ‰äº†ä¸€ä¸ªæ¡†æž¶ï¼Œå¯ä»¥å°†ä»»ä½•æ—¶é—´åºåˆ—é¢„æµ‹é—®é¢˜æž„å»ºä¸ºä¸€ä¸ªç›‘ç£å­¦ä¹ é—®é¢˜ï¼Œåœ¨è¿™ä¸ªæ¡†æž¶ä¸­ï¼Œæ‚¨å¯ä»¥åº”ç”¨æ¥è‡ª *scikit-learn* çš„ä»»ä½•å›žå½’æ¨¡åž‹ã€‚

æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼

ä¸€å®šè¦ä¸‹è½½æˆ‘ç”¨ Python å†™çš„[å…è´¹æ—¶é—´åºåˆ—é¢„æµ‹å°æŠ„](https://www.datasciencewithmarco.com/pl/2147608294)ï¼Œæ¶µç›–ç»Ÿè®¡å’Œæ·±åº¦å­¦ä¹ æ¨¡åž‹ï¼

å¹²æ¯ï¼ðŸº
# NumPy é‡å¡‘å¯ä»¥æ‰“ç ´ä½ çš„å¿ƒ

> åŸæ–‡ï¼š<https://towardsdatascience.com/numpy-reshape-can-break-your-heart-96fcc47c6894>

# NumPy é‡å¡‘å¯ä»¥æ‰“ç ´ä½ çš„å¿ƒ

## NumPy reshape å¯èƒ½ä¸ä¼šçœŸçš„è®©ä½ å¿ƒç¢ï¼Œä½†å®ƒå¯ä»¥å¯¹å¿ƒç”µå›¾(ECG)ç­‰æ—¶é—´åºåˆ—åšå‡ºæ— æ„çš„æ”¹å˜ï¼Œå¹¶å¯¼è‡´ç”Ÿç†å±æ€§çš„å·¨å¤§å˜åŒ–

![](img/bed868cc0253c7369a258c361446acad.png)

å›¾ 1:[å‡¯åˆ©Â·è¥¿å…‹ç›](https://unsplash.com/@kellysikkema?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

æˆ‘å°†è¦è®²è¿°çš„ä»–çš„æ•…äº‹ï¼Œæ¥æºäºä¸€æ¬¡å‚åŠ ç”Ÿç†ç½‘æŒ‘æˆ˜èµ› [2020](https://physionetchallenges.org/2020/) å’Œ [2021](https://physionetchallenges.org/2021/) çš„ç»å†ã€‚è¿™é¡¹æœºå™¨å­¦ä¹ æŒ‘æˆ˜çš„ä»»åŠ¡æ˜¯ä»å¿ƒç”µå›¾(ECG)ä¸­å¯¹å¿ƒè„ç›¸å…³ç–¾ç—…è¿›è¡Œåˆ†ç±»ã€‚æˆ‘ä»¬çš„å›¢é˜Ÿå†³å®šä½¿ç”¨ 1D å·ç§¯ç¥ç»ç½‘ç»œå¯¹ 12 å¯¼è”å¿ƒç”µå›¾ä¸­çš„ 30 ç§ä¸åŒçš„å¿ƒè„ç–¾ç—…è¿›è¡Œåˆ†ç±»(ä½ å¯ä»¥åœ¨æˆ‘ä»¬çš„[é¢„å°æœ¬è®ºæ–‡](https://www.researchgate.net/publication/355855233_Multi-label_ECG_classification_using_Convolutional_Neural_Networks_in_a_Classifier_Chain)ä¸­é˜…è¯»æ›´å¤šå…³äºè¿™ç§æ–¹æ³•çš„ä¿¡æ¯)ã€‚

åœ¨æˆ‘ä»¬å°†æ•°æ®é›†å¯¼å…¥åˆ° NumPy æ•°ç»„ä¸­ï¼Œç„¶åä¸å¾—ä¸æ ¹æ®ä»¥ä¸‹å†…å®¹å¯¹æ•°ç»„è¿›è¡Œæ•´å½¢ä¹‹åï¼Œé—®é¢˜å‡ºç°äº†:

> (n _ æ‚£è€… x n _ é€šé“ x n _ ä¿¡å·é•¿åº¦)

åˆ°

> (n ä¸ªæ‚£è€… x n ä¸ªä¿¡å·é•¿åº¦ x n ä¸ªé€šé“)

è¿™å¯¹äºä½¿é˜µåˆ—ç¬¦åˆ 1D å·ç§¯ç¥ç»ç½‘ç»œçš„è¾“å…¥å½¢çŠ¶æ˜¯å¿…è¦çš„ã€‚åœ¨ä»¥å‰çš„é¡¹ç›®ä¸­ï¼Œåœ¨å¤„ç†å›¾åƒæ•°æ®æ—¶ï¼Œæˆ‘å·²ç»ä½¿ç”¨ NumPy çš„ reshape æ–¹æ³•åšåˆ°äº†è¿™ä¸€ç‚¹ï¼Œæ•ˆæœéå¸¸å¥½ã€‚ä¸‹é¢çš„ä»£ç æ˜¾ç¤ºäº†åœ¨é‡æ–°è°ƒæ•´æ•°ç»„å½¢çŠ¶ä¹‹å‰ï¼Œå¦‚ä½•ç»˜åˆ¶å›¾ 2 æ‰€ç¤ºçš„ä¸‰ä¸ª MNIST æ•°å­—ç¤ºä¾‹ã€‚

```
Image_data = pd.read_csv("/kaggle/input/digit-recognizer/train.csv")
Image_data = Image_data.iloc[:,1:]
# Image_data shape = (42000, 28, 28, 1)for i **in** range(3):
    plt.imshow(Image_data[i][:,:,0])
    plt.axis("off")
    plt.show()
```

![](img/e28139857dbda87d69df2099df551cd5.png)![](img/cc38822cf2022c2c517c96d6ddb89486.png)![](img/43e91ed35a9d3ff5d70d9c80d6cb8e76.png)

å›¾ 2:æœªç»ä»»ä½•é¢„å¤„ç†çš„ MNIST æ•°å­—|ä½œè€…å›¾ç‰‡

ç„¶åï¼Œè®©æˆ‘ä»¬å°è¯•å°† reshape æ–¹æ³•åº”ç”¨äºç›¸åŒçš„ä¸‰ä¸ªæ•°å­—ï¼Œç„¶åå†æ¬¡ç»˜åˆ¶å®ƒã€‚

```
Image_data_reshaped= Image_data.reshape(42000,28,1,28)for i **in** range(3):
    plt.imshow(Image_data_reshaped[i][:,0,:])
    plt.axis("off")
    plt.show()
```

![](img/e28139857dbda87d69df2099df551cd5.png)![](img/cc38822cf2022c2c517c96d6ddb89486.png)![](img/43e91ed35a9d3ff5d70d9c80d6cb8e76.png)

å›¾ 3:é‡å¡‘åçš„ MNIST æ•°å­—|ä½œè€…å›¾ç‰‡

å›¾ 3 æ˜¾ç¤ºäº†ä½¿ç”¨ NumPy reshape æ–¹æ³•åï¼Œå›¾ 2 ä¸­ç»˜åˆ¶çš„ 3 ä¸ªç›¸åŒçš„å›¾å½¢ã€‚è¿˜æœ‰â€¦tada:

# æ²¡åŒºåˆ«ï¼ğŸ‰

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ‡æ¢å› ECG æ¡ˆä¾‹ï¼Œåœ¨ ECG é˜µåˆ—ä¸Šå°è¯•åŒæ ·çš„æ–¹æ³•ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»€ä¹ˆæ˜¯å¿ƒç”µå›¾:

> ECG åæ˜ äº†å¿ƒè„çš„ç”µæ´»åŠ¨ï¼Œå¹¶ä¸”å¯¹è¯¥è®°å½•çš„è§£é‡Šå¯ä»¥æ­ç¤ºå¿ƒè„çš„è®¸å¤šç—…ç†ã€‚

é€šè¿‡åœ¨æ‚£è€…ä¸Šèº«çš„ä¸åŒä½ç½®æ”¾ç½® 10 ä¸ªç”µææ¥æµ‹é‡ 12 å¯¼è” ECGã€‚è¿™è®©æˆ‘ä»¬å¯ä»¥ä»ä¸åŒçš„è§’åº¦æµ‹é‡å¿ƒè„çš„ç”µæ´»åŠ¨ã€‚

![](img/392080ad6f700f854ae7e7bb808f3c7d.png)

å›¾ 4:æ‰‹åŠ¨è§£è¯»çš„ 12 å¯¼è”å¿ƒç”µå›¾ã€‚ [Towfiqu barbhuiya](https://unsplash.com/@towfiqu999999?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹ç…§

ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æ•°æ®é›†ä¸­ç¬¬ä¸€ä½æ‚£è€…çš„ 12 ä¸ªå¿ƒç”µå›¾å¯¼è”ã€‚ä¸‹é¢çš„ä»£ç æ˜¾ç¤ºäº†å¦‚ä½•é€‰æ‹©ä¸€åæ‚£è€…çš„ 12 å¯¼è”å¿ƒç”µå›¾ï¼Œå¹¶åœ¨æ²¡æœ‰ä»»ä½•æ•´å½¢çš„æƒ…å†µä¸‹ç»˜åˆ¶ã€‚å›¾ 5 æ˜¾ç¤ºäº†ç»˜åˆ¶çš„ç»“æœï¼Œæ¯ä¸ªå­å›¾æ˜¾ç¤ºäº† 12 ä¸ªå¯¼è”ä¸­çš„æ¯ä¸€ä¸ªã€‚

```
# ecg_array shape is equal to (21832,12,5000)single_ecg = ecg_array[0]for i **in** range(12):
    ecg_plot.plot_1(single_ecg[i,:])
    plt.show()
```

![](img/102eae62e0a794699530669aa4446a0d.png)![](img/9839847eb976660d24619eddf664cb2e.png)![](img/985c7e2122f2f5487b728bc5d18f1ee8.png)![](img/7cc347d3e09e375736bf25d871ccbbd3.png)![](img/26a6dffb61b46cd3d9d8d7659f1413b9.png)![](img/78b9755737ba89fbfde6f761849b8ce3.png)![](img/efdc3a60db7937fad8ba067f6b4191fe.png)![](img/6c88d8ee0c7f871653c7bf6e33463b7f.png)![](img/1c805a76baf3da2f80e2228755279453.png)![](img/c9400ef01f162ec69589809fec32ff83.png)![](img/29acda24a014cbde6a2a0b39398ad7bb.png)![](img/26c7184f49e7f2e39b4ff99c5add2418.png)

å›¾ 5:é¢„å¤„ç†å‰çš„å¿ƒç”µå›¾

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å¯¹ ECG ä½¿ç”¨æ•´å½¢æ–¹æ³•ã€‚

```
# single_ecg shape = (12,5000)
reshaped_ecg = single_ecg.reshape(single_ecg.shape[1],single_ecg.shape[0])
# reshaped_ecg shape = (5000,12)for i **in** range(12):
    ecg_plot.plot_1(reshaped_ecg[:,i])
    plt.show()
```

å›¾ 6 æ˜¾ç¤ºäº†ç»˜åˆ¶æ•´å½¢åçš„ ECG é˜µåˆ—åå¾—åˆ°çš„ 12 ä¸ªå¯¼è”

![](img/62e7aad07881a51f7efef3f34c1ab841.png)![](img/e1af2f3ed8c27afdec16333f96035238.png)![](img/787720bab24c7df6a73b09f09d5888de.png)![](img/331b5526b2329e5bd25bf5a024611fd5.png)![](img/f1493fc9e71f92773317d07518d61732.png)![](img/1f9e2445d1c77493b40a7a85b6e35a7d.png)![](img/90fc54fe6463c25435b3a01c21b081bb.png)![](img/caa56dbdc63f3b1f5177eef3345e5406.png)![](img/f51262b45ecbb07b9e8b3e1911263c1c.png)![](img/f366b17cbb41c3221760503e278c1926.png)![](img/675f66d9bf9193640d42b79222100ae9.png)![](img/37cf75d506c555e256c93cfc90f883f5.png)

å›¾ 6:ä½¿ç”¨æ•´å½¢æ–¹æ³•åçš„å¿ƒç”µå›¾|ä½œè€…å›¾ç‰‡

å—¯ï¼ˆè¡¨ç¤ºè¸Œèº‡ç­‰ï¼‰...å¥‡æ€ªçš„äº‹æƒ…å‘ç”Ÿäº†ã€‚è®©æˆ‘ä»¬æ”¾å¤§å…¶ä¸­ä¸€ä¸ªå¿ƒç”µå›¾ã€‚å›¾ 7 æ˜¾ç¤ºäº†åº”è¯¥æ˜¯å¯¼è” I çš„éƒ¨åˆ†ï¼Œå®ƒçœ‹èµ·æ¥ä»ç„¶åƒ ECGï¼Œä½†ä¸æ˜¯æˆ‘ä»¬é¢„æœŸçš„é‚£æ ·ã€‚å¦‚æœæˆ‘ä»¬å†æ¬¡ä»”ç»†è§‚å¯Ÿå›¾ 4 ä¸­çš„ 12 ä¸ªå¯¼è”ï¼Œæˆ‘ä»¬ä¼šå‘ç°ç°åœ¨æ‰€æœ‰å¯¼è”éƒ½å®Œå…¨ç›¸åŒã€‚

![](img/5000cf3e23e1e9b44143b35e49219823.png)

å›¾ 7:æ”¾å¤§ä½¿ç”¨ NumPy æ•´å½¢æ–¹æ³•å¤„ç†çš„ä¸€ä¸ª ECG å¯¼è”|ä½œè€…å›¾ç‰‡

æ˜¾ç¤ºç»“æœçš„æœ€ä½³æ–¹å¼æ˜¯å¹³å¦åŒ–åŸå§‹ ECG ä¿¡å·ï¼Œå¹¶å°†å…¶é‡æ–°é‡‡æ ·ä¸º 5000 ä¸ªæ ·æœ¬ï¼Œç„¶åå°†å…¶ä¸æ•´å½¢åçš„ä¿¡å·è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚å›¾ 8 æ‰€ç¤ºã€‚

```
# single_ecg.ravel() shape = 60000 (12 x 5000)
from scipy import signal#resample signal from 60000 to 5000
resamp_sig = signal.resample(single_ecg.ravel(), 5000) 
plt.plot(reshaped_ecg[:,0], label="reshaped signal")
plt.plot(resamp_sig, label="resampled signal")
plt.show()
```

![](img/154581cadf4564249ff300985c11e60f.png)

å›¾ 8:æ•´å½¢ä¿¡å·ä¸é‡é‡‡æ ·ä¿¡å·|ä½œè€…å›¾ç‰‡

ä»å›¾ 8 ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ•´å½¢æ–¹æ³•å®é™…ä¸Šä¸ä»…æ•´å½¢äº†æ•°ç»„ï¼Œè¿˜å¯¹æ‰€æœ‰åŸå§‹çš„ 12 ä¸ªå¯¼è”è¿›è¡Œäº†é‡æ–°é‡‡æ ·ï¼Œç„¶åä½¿å…¶é€‚åˆäºå•ä¸ªå¯¼è”ï¼Œç„¶ååˆ¶ä½œäº† 12 ä¸ªå‰¯æœ¬ã€‚

å¥½å§ï¼Œæ‰€ä»¥ NumPy reshape å¯èƒ½ä¸ä¼šçœŸçš„è®©ä½ å¿ƒç¢ï¼Œä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæ— æ„ä¸­æ”¹å˜äº†å¿ƒç”µå›¾ï¼Œä¹Ÿå¯¹ç”Ÿç†ç‰¹æ€§äº§ç”Ÿäº†å·¨å¤§çš„å½±å“ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå°†æµ‹å¾—çš„å¿ƒç‡æé«˜äº† 12 å€ï¼Œä½†æˆ‘ä»¬å¦‚ä½•å…‹æœè¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ

## ç”¨ n **umpy.moveaxis** ä»£æ›¿ï¼

```
# single_ecg shape = (12,5000)
ecg_moveaxis = np.moveaxis(single_ecg, 0, -1)
# ecg_moveaxis.shape = (5000,12)
```
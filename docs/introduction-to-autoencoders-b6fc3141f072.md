# è‡ªåŠ¨ç¼–ç å™¨ç®€ä»‹

> åŸæ–‡ï¼š<https://towardsdatascience.com/introduction-to-autoencoders-b6fc3141f072>

## [è‡ªåŠ¨ç¼–ç å™¨](https://medium.com/tag/autoencoder)

## å¦‚ä½•ä½¿ç”¨ Tensorflow ç®€åŒ–æ‚¨çš„æ•°æ®

![](img/71a3705da36bbcccb7f02cbab87e3fb0.png)

ç”±[è’‚å§†Â·æ–¯è’‚å¤«](https://unsplash.com/@timstief?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

æˆ‘æƒ³è±¡ä½ æœ‰ä¸€ä¸ªæ•°æ®é›†( *X* ï¼Œ *y* )ï¼Œå…¶ä¸­åŒ…å«äº†**å¤§é‡çš„ç‰¹å¾**ï¼Œä½ æƒ³ç”¨å®ƒä»¬æ¥è§£å†³ä¸€ä¸ªä»»åŠ¡ï¼Œæ¯”å¦‚å›å½’æˆ–åˆ†ç±»ã€‚è™½ç„¶æ‹¥æœ‰æ›´å¤šçš„**è§‚å¯Ÿå€¼**æ€»æ˜¯æ›´å¥½ï¼Œä½†æ˜¯åœ¨ä¸€ä¸ªæ¨¡å‹ä¸­åŒ…å«å¤ªå¤šçš„**ç‰¹æ€§**å¯èƒ½ä¼šé€‚å¾—å…¶åï¼Œæ— è®ºæ˜¯å¯¹äºå¯è§£é‡Šæ€§è¿˜æ˜¯ç”šè‡³æ˜¯æ¨¡å‹çš„æ€§èƒ½ã€‚è€ƒè™‘è¿™ä¸ªç®€å•çš„ä¾‹å­:

```
import numpy as np

np.random.seed(0)

X = np.random.randn(1000, 900)
y = 2*X[:, 0] + 1 + 0.1*np.random.randn(1000)
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ•°æ®é›†( *X* ï¼Œ *y* )ï¼ŒåŒ…å« 1000 ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æœ‰ 900 ä¸ªç‰¹å¾ *x* â‚€ï¼Œâ€¦ï¼Œ *x* â‚ˆâ‚‰â‚‰ã€‚æˆ‘ä»¬æƒ³çŸ¥é“çš„äº‹å®æ˜¯ *y* = 2 *x* â‚€ + 1ï¼Œç”±äºè¯¯å·®ä¹Ÿå¾ˆå°ï¼Œçº¿æ€§å›å½’åº”è¯¥å®Œå…¨è¾¾åˆ°æ¥è¿‘ 1 çš„ *r* ã€‚ç„¶è€Œï¼Œè¿›è¡Œäº¤å‰éªŒè¯ä¼šäº§ç”Ÿ

```
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import cross_val_score

print(cross_val_score(LinearRegression(), X, y))

# Output:
# [0.88558154 0.87775961 0.87564832 0.86230888 0.8796105]
```

çœ‹ä¸è§çš„æ•°æ®ä¸Šçš„ *r* çº¦ä¸º 0.87ï¼Œç¦» 1 ç›¸å½“è¿œã€‚å½“å°†æ¨¡å‹é™åˆ¶ä¸ºä»…ä½¿ç”¨å‰ 10 ä¸ªå˜é‡æ—¶ï¼Œé€šè¿‡è¿›è¡Œç›¸åŒçš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ¸…æ¥šåœ°çœ‹åˆ°è¿™æœ‰å¤šç³Ÿç³•:

```
print(cross_val_score(LinearRegression(), X[:, :10], y))

# Output:
# [0.99701015 0.99746395 0.99780414 0.99752536 0.99745693]
```

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸¢å¼ƒç‰¹å¾å°†æ€§èƒ½æé«˜åˆ°å¤§çº¦ 0.997ã€‚è¿™æ„å‘³ç€å³ä½¿åƒçº¿æ€§å›å½’è¿™æ ·ç®€å•çš„ç®—æ³•ä¹Ÿå¯èƒ½æ·¹æ²¡åœ¨ç‰¹æ€§ä¸­ã€‚

æœ‰å‡ ç§æŠ€æœ¯å¯ä»¥å‡å°‘ç‰¹æ€§çš„æ•°é‡ï¼Œæ¯”è¾ƒæµè¡Œçš„æœ‰

*   ä»…ä»…æ ¹æ®è¯¸å¦‚å•å˜é‡åˆ†æ(å³ä¸ç›®æ ‡ *y* çš„ç›¸å…³æ€§)æˆ–é‡è¦æ€§åˆ†æ•°(*p*-å€¼ã€åŸºäºæ ‘çš„ç®—æ³•çš„ç‰¹å¾é‡è¦æ€§ã€Shapley å€¼ç­‰)çš„è§„åˆ™æ¥ä¸¢å¼ƒä¸€äº›ç‰¹å¾ï¼Œä»¥åŠ
*   [ä¸»æˆåˆ†åˆ†æ](https://en.wikipedia.org/wiki/Principal_component_analysis) (PCA)ï¼Œä½¿ç”¨ç‰¹æ®Šçš„çº¿æ€§æ˜ å°„å°†æ•°æ®è½¬æ¢åˆ°ä½ç»´ç©ºé—´(å³ï¼Œå°†æ•°æ®çŸ©é˜µ *X* ä¹˜ä»¥å¦ä¸€ä¸ªçŸ©é˜µ *W* )ã€‚æ³¨æ„è¿™é‡Œæˆ‘ä»¬**ä¸éœ€è¦*y*ã€‚**

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£åˆ°*ç±»* **å¯¹ PCA** çš„å¦ä¸€ç§æ¨å¹¿æ–¹æ³•:[å†…æ ¸ PCA](https://en.wikipedia.org/wiki/Kernel_principal_component_analysis) ã€‚

å¼€ç©ç¬‘ï¼Œæˆ‘æŒ‡çš„å½“ç„¶æ˜¯**è‡ªåŠ¨ç¼–ç å™¨**ï¼*(ä¸è¿‡å†…æ ¸ PCA æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„é€‰æ‹©ã€‚)*

# è‡ªåŠ¨ç¼–ç å™¨

é‚£ä¹ˆï¼Œè¿™äº›ç¥ç§˜çš„è‡ªåŠ¨ç¼–ç å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬é¦–å…ˆè¦å…³å¿ƒå‘¢ï¼Ÿè®©æˆ‘ä»¬æ¥æ‰¾å‡ºç­”æ¡ˆã€‚

## ç›´è§‰

é€šå¸¸ï¼Œæ‰‹è¾¹çš„æ•°æ®åŒ…å«äº† T4 å†—ä½™ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°å‹ç¼©è€Œä¸ä¼šä¸¢å¤±å¤ªå¤šä¿¡æ¯ã€‚æƒ³è±¡ä¸€ä¸ªæ•°æ®é›†ï¼Œå®ƒå…·æœ‰ä»¥å˜ç±³ä¸ºå•ä½çš„**é«˜åº¦å’Œä»¥ç±³ä¸ºå•ä½çš„**é«˜åº¦ã€‚è¿™ä¸¤ä¸ªè¦ç´ åŒ…å«ç›¸åŒçš„ä¿¡æ¯ï¼Œä½†æ˜¯å¦‚æœå®ƒä»¬éƒ½æœ‰ä¸åŒç§ç±»çš„å™ªå£°ï¼Œå¯èƒ½ä¼šå½±å“æ¨¡å‹æ€§èƒ½ã€‚æ‰€ä»¥ï¼Œè¿˜æ˜¯é€‰è¿™ä¸¤ä¸ªä¸­çš„ä¸€ä¸ªæ¯”è¾ƒå¥½ã€‚

è™½ç„¶è¿™ç§æƒ…å†µå¾ˆæ˜æ˜¾ï¼Œä½†è‡ªåŠ¨ç¼–ç å™¨å¯ä»¥æ‰¾åˆ°æ›´ç»†å¾®çš„å†—ä½™ï¼Œå¹¶å°†å…¶å‹ç¼©æ‰ã€‚æˆ‘ä»¬å¸Œæœ›çš„æ˜¯ï¼Œè‡ªåŠ¨ç¼–ç å™¨ä¸­é—´æ‰€è°“çš„**ä¿¡æ¯ç“¶é¢ˆ**(æ½œåœ¨ç©ºé—´ï¼Œè§ä¸‹æ–‡)ä¸ä¼šè¿‡æ»¤æ‰å¿…è¦çš„ä¿¡æ¯ï¼Œè€Œåªæ˜¯å†—ä½™ä¿¡æ¯ã€‚ä¸€ä¸ªç®€å•çš„æ£€æŸ¥æ˜¯é€šè¿‡æŸ¥çœ‹æ‰€æœ‰çš„ *x* å’Œ *x* ä¹‹é—´çš„**é‡å»ºè¯¯å·®**ã€‚ä¸€ä¼šå„¿å°±å˜å¾—æ›´å…·ä½“äº†ã€‚

## å®šä¹‰

å¯¹äºä»€ä¹ˆæ˜¯è‡ªåŠ¨ç¼–ç å™¨ï¼Œæ²¡æœ‰ä¸€ä¸ªçœŸæ­£çš„æ•°å­¦å®šä¹‰ï¼Œè‡³å°‘æˆ‘æ‰¾ä¸åˆ°ã€‚ä¸è¿‡ï¼Œæˆ‘å¯ä»¥ç»™ä½ ä¸€ä¸ªè¶³å¤Ÿå¥½çš„ç›´è§‰ã€‚

è‡ªåŠ¨ç¼–ç å™¨ç”±**ä¸¤ä¸ªåŠŸèƒ½ *e* (ç¼–ç å™¨çš„ç®€ç§°)å’Œ *d* (è§£ç å™¨çš„ç®€ç§°)**ç»„æˆï¼Œå…¶è¡Œä¸ºå¦‚ä¸‹:

1.  *e* å°†ä¸€ä¸ªå…·æœ‰ *n* ç‰¹å¾çš„è§‚æµ‹å€¼ *x* ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†å…¶æ˜ å°„åˆ°ä¸€ä¸ªç»´åº¦ä¸º *m* â‰¤ *n* çš„**ä½ç»´**å‘é‡ *z* ï¼Œç§°ä¸º *x* çš„*æ½œåœ¨å‘é‡*ã€‚
2.  *d* å–æ½œåœ¨å‘é‡ *z* å¹¶å†æ¬¡è¾“å‡ºä¸€ä¸ªå°ºå¯¸ä¸º *n* çš„*x*â€™ã€‚

å¦å¤–ï¼Œæˆ‘ä»¬å¸Œæœ› ***x* å’Œ *x* æ¥è¿‘ï¼Œå³*x*â‰ˆ*x*â€™ï¼Œ**å³**é‡å»ºè¯¯å·®åº”è¯¥å¾ˆå°**ã€‚ç”¨é€šä¿—çš„è¯­è¨€æ¥è¯´:

> ç¼–ç å™¨å‹ç¼©åŸå§‹è§‚å¯Ÿå€¼ x *ã€‚è§£ç å™¨å†æ¬¡è§£åŒ…ã€‚è¿™ä¸ªæ‰“åŒ…å’Œæ‹†åŒ…çš„è¿‡ç¨‹ä¸è¦å¤ªæ‰­æ›² x(å¹³å‡)ã€‚*

![](img/8297e1fd1722d7ba87c9ef5a7553ae0d.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

åƒ zip å’Œ rar è¿™æ ·çš„å‹ç¼©å·¥å…·ä¹Ÿè¯•å›¾è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªæ›´ä¸¥æ ¼çš„æ¡ä»¶:x = xâ€™ã€‚ PNG æ˜¯å¦ä¸€ç§*æ— æŸ*æ ¼å¼ï¼Œè™½ç„¶ jpeg æˆ– mp3 ç­‰æ ¼å¼å¹¶éæ— æŸï¼Œä½†*è¶³å¤Ÿå¥½*è®©äººç±»çœ‹ä¸å‡ºåŒºåˆ«ï¼Œè‡³å°‘å¦‚æœå‹ç¼©ä¸æ˜¯å¤ªæ¿€è¿›ï¼Œå³ *m* ä¸æ˜¯å¤ªå°ã€‚

åœ¨æˆ‘ä»¬è½¬å‘é€šç”¨è‡ªåŠ¨ç¼–ç å™¨ä¹‹å‰ï¼Œè®©æˆ‘ä»¬é‡å¤ä¸€ä¸‹ PCA åœ¨é«˜å±‚æ¬¡ä¸Šåšä»€ä¹ˆâ€”â€”ä»¥åŠå®ƒå¤±è´¥çš„æ—¶å€™ã€‚

## ä½•å¿…å‘¢ï¼Ÿ

å¥½çš„ï¼Œæˆ‘ä»¬çŸ¥é“æ‹¥æœ‰å¤ªå¤šçš„ç‰¹æ€§*å¯èƒ½æ˜¯ä¸€ä»¶æ¶ˆæçš„äº‹æƒ…ã€‚æˆ‘ä»¬è¿˜è°ˆåˆ°äº† PCA èƒ½å¤Ÿå‡å°‘ç‰¹å¾çš„æ•°é‡ã€‚ç„¶è€Œï¼ŒPCAâ€”â€”ä½œä¸ºçº¿æ€§å˜æ¢â€”â€”å…·æœ‰æœ‰é™çš„è¡¨è¾¾èƒ½åŠ›ã€‚æé†’ä¸€ä¸‹ PCA æ˜¯å¦‚ä½•å·¥ä½œçš„:*

![](img/909fe43844784c8ebc2cc611cfe945f3.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

> *åœ¨ autoencoders çš„è¯­è¨€ä¸­ï¼Œ* ***å·¦ä¸‹è§’çš„å›¾åƒæ˜¾ç¤ºç¼–ç *** *(å®ƒåªæ˜¯ä¸€ç»´è€Œä¸æ˜¯äºŒç»´)ï¼Œå³ä¸‹è§’çš„* ***å›¾åƒæ˜¾ç¤ºè§£ç *** *(å›åˆ°åŸæ¥çš„äºŒç»´)ã€‚ä¸¤ä¸ªé¡¶éƒ¨å›¾åƒéƒ½åŒ…å«åŸå§‹è¾“å…¥æ•°æ®ã€‚*

å¦‚æœæ•°æ®æ¥è¿‘äºåœ¨ä¸€ä¸ªç»´åº¦ä¸º *m çš„*çº¿æ€§å­ç©ºé—´*(å³ç›´çº¿ã€å¹³é¢ã€è¶…å¹³é¢)ä¸­ï¼Œå…·æœ‰ *m* åˆ†é‡çš„* PCA å·¥ä½œå¾—å¾ˆå¥½ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸è¿™æ ·åšï¼Œæˆ‘ä»¬å¯èƒ½ä¼šä¸¢å¤±è®¸å¤šå…³äºåŸå§‹æ•°æ®çš„ä¿¡æ¯ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨è¿™é‡Œçœ‹åˆ°çš„:

![](img/1524966fc782a0321752ccf8bf7d8830.png)

å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

å¥½å§ï¼Œå¦‚æœçº¿æ€§å˜æ¢çš„ç®€å•æ€§æ˜¯ç“¶é¢ˆï¼Œè®©æˆ‘ä»¬ä½¿ç”¨æ›´å¤æ‚çš„ç¼–ç å™¨å’Œè§£ç å™¨ï¼å®ç°è¿™ä¸€ç‚¹çš„ä¸€ä¸ªç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ç¥ç»ç½‘ç»œï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å¼€å§‹å§ã€‚

> ***æ³¨:*** *é€šå¸¸ï¼Œå½“äººä»¬è°ˆè®ºè‡ªåŠ¨ç¼–ç å™¨æ—¶ï¼Œä»–ä»¬æŒ‡çš„æ˜¯* ***åŸºäºç¥ç»ç½‘ç»œçš„è‡ªåŠ¨ç¼–ç å™¨*** *ã€‚ä½†æ˜¯è¿™å¹¶ä¸æ˜¯å”¯ä¸€çš„é€‰æ‹©:åªè¦ä½ æœ‰ä¸€ä¸ªè§£ç å™¨å’Œä¸€ä¸ªç¼–ç å™¨ï¼Œä¸€åˆ‡éƒ½æ˜¯å…è®¸çš„ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æ ¹æ®ä¸‹é¢çš„å†³ç­–æ ‘æ¥æ£€æŸ¥ä¸€ä¸ªå¥‡ç‰¹çš„è‡ªåŠ¨ç¼–ç å™¨ã€‚ç„¶è€Œï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†åšæŒä½¿ç”¨ä¼ ç»Ÿçš„*è‡ªåŠ¨ç¼–ç å™¨ã€‚**

[](/building-a-simple-auto-encoder-via-decision-trees-28ba9342a349)  

# Tensorflow ä¸­çš„å®ç°

ç¼–ç æ—¶é—´åˆ°äº†ï¼é¦–å…ˆï¼Œè®©æˆ‘ä»¬åšä¸€äº›åŸºæœ¬çš„äº‹æƒ…ï¼Œç”¨ä»¥ä¸‹æ–¹å¼å®šä¹‰ä¸€ä¸ªå…·æœ‰ 4 ä¸ªç‰¹å¾çš„æ•°æ®é›† *X* :

```
import tensorflow as tf

tf.random.set_seed(0) # keep things reproducible

Z = tf.random.uniform(shape=(10000, 1), minval=-5, maxval=5)
X = tf.concat([Z**2, Z**3, tf.math.sin(Z), tf.math.exp(Z)], 1)
```

å¦‚æœä½ æƒ³ä¸€æƒ³ï¼Œä½ èƒ½å¦‚ä½•å‹ç¼© *X* çš„ç»´åº¦ï¼Ÿç”¨æ›´å°‘çš„ç‰¹å¾é‡æ„ *X* æœ‰ä»€ä¹ˆå¿…è¦ï¼Ÿ

å—¯ï¼Œæˆ‘ä»¬åªéœ€è¦ *Z* ï¼Œå³**ä¸€ä¸ªå•ä¸€ç‰¹å¾**ã€‚ *X* å¹¶ä¸åŒ…å«æ¯” *Z* æ›´å¤šçš„ä¿¡æ¯ï¼Œæˆ‘ä»¬åªéœ€å¯¹ *Z* åº”ç”¨æŸç§ç¡®å®šæ€§å‡½æ•°å°±å¯ä»¥å¾—åˆ° *X* çš„ç‰¹å¾ã€‚

ç¼–ç å™¨å¯ä»¥è®¡ç®—å‡ºå¦‚ä½•æ‰¾åˆ°å‡½æ•°çš„*é€†*ï¼Œå³ä» *x* = ( *z* ï¼Œ *z* ï¼Œ *sin* ( *z* )ï¼Œ *exp* ( *z* ))åˆ°*z*ï¼Œè§£ç å™¨å¯ä»¥å­¦ä¹ å–ä¸€ä¸ªæ•° *z* å¹¶å°†å…¶è½¬åŒ–ä¸º

ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°æˆ‘åœ¨è¿™é‡Œæ˜¯å¦‚ä½•ä½¿ç”¨*è¿™ä¸ªè¯çš„ï¼Ÿå¯¹æˆ‘ä»¬æ¥è¯´ï¼Œè¿™å°†æ˜¯æ˜¾è€Œæ˜“è§çš„è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“å¦‚ä½•ä» *Z* ç”Ÿæˆ *X* ã€‚ç„¶è€Œï¼Œè‡ªåŠ¨ç¼–ç å™¨ä¸çŸ¥é“è¿™ä¸€ç‚¹ï¼Œå¯èƒ½ä¼šæ‰¾åˆ°å¦ä¸€ç§æ–¹æ³•æ¥å‹ç¼©æ•°æ®ã€‚æ¯”å¦‚å®ƒå¯ä»¥æƒ³åŠæ³•æŠŠ *x* = ( *z* ï¼Œ *z* ï¼Œ *sin* ( *z* )ï¼Œ *exp* ( *z* ))å‹ç¼©æˆ *z -* 3ï¼Œè§£ç å™¨å¯ä»¥é‡æ–°å­¦ä¹ è§£ç è¿™ä¸ªï¼Œä¸€æ ·å¥½ã€‚*

*å¥½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿå»ºç«‹ä¸€ä¸ªåªæœ‰ä¸€ä¸ªæ½œåœ¨ç»´åº¦çš„æ€§èƒ½è‰¯å¥½çš„è‡ªåŠ¨ç¼–ç å™¨ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åšåˆ°è¿™ä¸€ç‚¹*

```
*class AutoEncoder(tf.keras.Model):
    def __init__(self):
        super().__init__()

        self.encoder = tf.keras.Sequential([
            tf.keras.layers.Dense(100, activation='relu'),
            tf.keras.layers.Dense(100, activation='relu'),
            tf.keras.layers.Dense(100, activation='relu'),
            tf.keras.layers.Dense(1), # compress into 1 dimension
        ])
        self.decoder = tf.keras.Sequential([
            tf.keras.layers.Dense(100, activation='relu'),
            tf.keras.layers.Dense(100, activation='relu'),
            tf.keras.layers.Dense(100, activation='relu'),
            tf.keras.layers.Dense(4), # unpack into 4 dimensions
        ])
    def call(self, x):
        latent_x = self.encoder(x) # compress
        decoded_x = self.decoder(latent_x) # unpack
        return decoded_x

tf.random.set_seed(0) # keep things reproducible

ae = AutoEncoder()

ae.compile(
    optimizer=tf.keras.optimizers.Adam(learning_rate=0.0001),
    loss='mse'
)

ae.fit(
    X, # input
    X, # equals output
    validation_split=0.2, # prevent overfitting
    epochs=1000,
    callbacks=[
        tf.keras.callbacks.EarlyStopping(patience=10) # early stop
    ]
)

# Output:
# [...]
# Epoch 69/1000
# 250/250 [==============================] - 0s 1ms/step - loss:          # 0.0150 - val_loss: 0.0276*
```

*çœ‹èµ·æ¥ä¸é”™ï¼Œæ¨¡å‹å¯ä»¥å­¦ä¹ åº•å±‚ç»“æ„ï¼æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ£€æŸ¥è‡ªåŠ¨ç¼–ç å™¨äº§ç”Ÿçš„æœ€å¤§è¯¯å·®*

```
*print(tf.reduce_max(tf.math.abs(X-ae(X))))

# Output:
# tf.Tensor(0.89660645, shape=(), dtype=float32)*
```

*ä¸é”™ï¼Œè€ƒè™‘åˆ°æœ‰äº›åŠŸèƒ½è¦ä¸Šç™¾ä¸ªã€‚ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†è‡ªåŠ¨ç¼–ç å™¨çš„å·¥ä½œåŸç†ï¼Œè®©æˆ‘ä»¬åšä¸€äº›æ›´æœ‰è¶£çš„äº‹æƒ…ã€‚*

## *å‹ç¼©æ•°å­—*

*è‡ªåŠ¨ç¼–ç å™¨çš„ä¸€ä¸ªç»å…¸ä¾‹å­æ˜¯ä½¿ç”¨æ‰‹å†™æ•°å­—çš„ MNIST æ•°æ®é›†ã€‚è®©æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–æ•°æ®é›†*

```
*(X_train, _), (X_test, _) = tf.keras.datasets.mnist.load_data()
X_train = X_train.reshape(-1, 28, 28, 1) / 255\. # value range=[0,1]
X_test = X_test.reshape(-1, 28, 28, 1) / 255\.   # shape=(28, 28, 1)*
```

*ç”»å‡ ä¸ªæ•°å­—:*

```
*import matplotlib.pyplot as plt

for i in range(3):
    plt.imshow(X_train[i])
    plt.show()*
```

*![](img/65b82717fdcc604ea60b2ef94c58f9d9.png)**![](img/6126516f0f5b67738a19de1b43e1ab30.png)**![](img/a9078a0afb6a7bc202efa469804ccd16.png)

MNIST æ•°æ®é›†ä¸­çš„æ•°å­—ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚* 

*æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œæ•°æ®é›†ç”±æ‰‹å†™æ•°å­—ç»„æˆï¼Œç¡®åˆ‡åœ°è¯´æ˜¯ 28x28 åƒç´ ã€‚ç”±äºæ¯ä¸ªåƒç´ éƒ½æ˜¯ä¸€ä¸ªç‰¹å¾ï¼Œæ‰€ä»¥æˆ‘ä»¬é¢å¯¹çš„æ˜¯ä¸€ä¸ª 28*28= **784 ç»´çš„**æ•°æ®é›†ï¼Œå¯¹äºä¸€ä¸ªå›¾åƒæ•°æ®é›†æ¥è¯´ï¼Œè¿™ç”šè‡³*éå¸¸ä½*ã€‚*

*æˆ‘ä»¬ç°åœ¨å°†ä¸ºè¿™ä¸ªæ•°æ®é›†æ„å»ºä¸€ä¸ªè‡ªåŠ¨ç¼–ç å™¨ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æˆåŠŸå‘¢ï¼Ÿç­”æ¡ˆæ˜¯æ‰‹å†™æ•°å­—æ˜¯æ‰€æœ‰æ½œåœ¨ 28x28 åƒç´ å›¾ç‰‡çš„**éå¸¸å°çš„å­é›†**ã€‚å®ƒä»¬æœ‰éå¸¸ç‰¹æ®Šçš„åƒç´ æ¨¡å¼ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå°½ç®¡ä»¥ä¸‹å›¾åƒæ˜¯ 28x28 åƒç´ çš„å›¾åƒï¼Œä½†å®ƒä»¬ç»ä¸ä¼šè¢«è§†ä¸ºæ•°å­—:*

*![](img/7a97a2d9ff9eb6dd2f5a3c0aa29bd8ae.png)**![](img/27df9018cbfc5949e047b66402a2298f.png)**![](img/b022f0f23432d648215be7571978ac19.png)

ä¸æ˜¯æ•°å­—ã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚* 

*ä½†æ˜¯æˆ‘ä»¬éœ€è¦å¤šå°‘ä¸ªç»´åº¦æ¥è¡¨è¾¾ MNIST æ•°æ®é›†å‘¢ï¼Ÿä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªé—®é¢˜æ²¡æœ‰é€šç”¨çš„ç­”æ¡ˆã€‚é€šå¸¸ï¼Œæˆ‘ä»¬è¯•å›¾ä½¿ç»´åº¦å°½å¯èƒ½å°ï¼Œä»¥ä½¿é‡å»º(è§£ç )è¶³å¤Ÿå¥½ã€‚*

*æˆ‘ä»¬ç°åœ¨å¯ä»¥å†æ¬¡æ„å»ºå¦ä¸€ä¸ªç®€å•çš„å‰é¦ˆè‡ªåŠ¨ç¼–ç å™¨ï¼Œæˆ‘é¼“åŠ±æ‚¨è¿™æ ·åšã€‚æˆ‘ä»¬è¦åšçš„æ˜¯ä½¿ç”¨**å·ç§¯å±‚**å»ºç«‹ä¸€ä¸ªè‡ªåŠ¨ç¼–ç å™¨ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨è¿™é‡Œå¤„ç†å›¾åƒæ•°æ®ã€‚è¿™äº›ç±»å‹çš„è‡ªåŠ¨ç¼–ç å™¨è¢«æ–¹ä¾¿åœ°ç§°ä¸º**å·ç§¯è‡ªåŠ¨ç¼–ç å™¨**ã€‚å¼€é—¨è§å±±ï¼Œå¯¹å§ï¼Ÿ*

*æ³¨æ„ï¼Œå›¾åƒçš„åƒç´ å€¼åœ¨ 0 å’Œ 1 ä¹‹é—´ï¼Œç”¨äºæ›´å¿«å’Œç¨³å®šçš„è®­ç»ƒï¼Œå¹¶ä¸”å•ä¸ªå›¾åƒçš„å½¢çŠ¶ä¸º(*é«˜* = 28ï¼Œ*å®½* = 28ï¼Œ*é€šé“* = 1)ï¼Œç”¨äºå·ç§¯å±‚å·¥ä½œã€‚*

```
*from tensorflow.keras import layers

class ConvolutionalAutoEncoder(tf.keras.Model):
    def __init__(self):
        super().__init__()

        self.encoder = tf.keras.Sequential([
            layers.Conv2D(4, 5, activation='relu'),
            layers.Conv2D(4, 5, activation='relu'),
            layers.Conv2D(1, 5, activation='relu'),
        ])
        self.decoder = tf.keras.Sequential([
            layers.Conv2DTranspose(4, 5, activation='relu'),
            layers.Conv2DTranspose(4, 5, activation='relu'),
            layers.Conv2DTranspose(1, 5, activation='sigmoid'),
        ])
    def call(self, x):
        latent_x = self.encoder(x)
        decoded_x = self.decoder(latent_x)
        return decoded_x

tf.random.set_seed(0)

ae = ConvolutionalAutoEncoder()

ae.compile(optimizer='adam', loss='bce')

ae.fit(
    X_train, 
    X_train,
    batch_size=128,
    epochs=1000,
    validation_data=(X_test, X_test),
    callbacks=[
        tf.keras.callbacks.EarlyStopping(patience=1)
    ]
)

# Output:
# [...]
# Epoch 12/1000
# 469/469 [==============================] - 91s 193ms/step - loss: # 0.0815 - val_loss: 0.0813*
```

*æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ƒæ¥æŸ¥çœ‹æ½œåœ¨ç©ºé—´æœ‰å¤šå¤§*

```
*print(ae.summary())*
```

*æˆ‘ä»¬çœ‹åˆ°ç¬¬ä¸€å±‚(å³ç¼–ç å™¨)çš„è¾“å‡ºå½¢çŠ¶ä¸º(Noneï¼Œ16ï¼Œ16ï¼Œ1 ),è¿™æ„å‘³ç€è¾“å‡ºæ˜¯ 16 * 16 * 1 = 256 ç»´ï¼Œä¹Ÿå¯ä»¥è§£é‡Šä¸ºå•é€šé“çš„ 16x16 åƒç´ å›¾åƒã€‚*

*åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ‰‹åŠ¨æ£€æŸ¥ä¸€äº›å›¾åƒé‡å»º:*

```
*n = 10

decoded_images = ae.predict(X_test[:n])
latent_images = ae.encoder(X_test[:n])

plt.figure(figsize=(20, 4))

for i in range(n):
    ax = plt.subplot(3, n, i + 1)
    plt.imshow(X_test[i])
    ax.get_xaxis().set_visible(False)
    ax.get_yaxis().set_visible(False)

    ax = plt.subplot(3, n, i + 1 + n)
    plt.imshow(latent_images[i] / tf.reduce_max(latent_images[i]))
    ax.get_xaxis().set_visible(False)
    ax.get_yaxis().set_visible(False)
    ax = plt.subplot(3, n, i + 1 + 2*n)
    plt.imshow(decoded_images[i])
    ax.get_xaxis().set_visible(False)
    ax.get_yaxis().set_visible(False)

plt.show()*
```

*![](img/56d48f8ba4f48919ae436cfb7ef850f6.png)*

*é¡¶è¡Œ:åŸå§‹ï¼Œä¸­è¡Œ:å‹ç¼©ï¼Œåº•è¡Œ:é‡å»ºã€‚å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚*

*æ•´ä½“çœ‹èµ·æ¥è¿˜è¿‡å¾—å»ï¼å®ƒåˆ°å¤„éƒ½æœ‰ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚ 2ï¼Œä½†å»ºç«‹ä¸€ä¸ªæ›´å¥½çš„ç½‘ç»œæ¶æ„å¯èƒ½ä¼šä½¿å®ƒå˜å¾—æ›´å¥½ã€‚æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°ï¼ŒåŸå§‹å›¾åƒçš„æ½œåœ¨ç‰ˆæœ¬ä»ç„¶éå¸¸ç±»ä¼¼äºåŸå§‹æ•°å­—ï¼Œåªæ˜¯åˆ†è¾¨ç‡æ›´å·®ï¼Œå› ä¸ºå®ƒæ˜¯ 16x16 è€Œä¸æ˜¯ 28x28 åƒç´ ã€‚è™½ç„¶æƒ…å†µå¹¶ä¸æ€»æ˜¯è¿™æ ·ï¼Œä½†æ˜¯åœ¨è¿™é‡Œï¼Œautoencoder ç¢°å·§å‘ç°è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‹ç¼©ã€‚*

*æˆ‘å‘ç°æœ‰è¶£çš„æ˜¯ï¼Œè‡ªåŠ¨ç¼–ç å™¨äº†è§£åˆ°å›¾åƒçš„è¾¹ç•Œä¸åŒ…å«æœ‰ç”¨çš„ä¿¡æ¯ã€‚å®ƒåªæ˜¯æ”¾å¤§æ•°å­—ï¼Œè®©å®ƒä»¬å¡«å……å®Œæ•´çš„å›¾åƒï¼Œè¿™å¾ˆæœ‰æ„ä¹‰â€”â€”æˆ‘å¯èƒ½ä¼šåƒäººç±»ä¸€æ ·åšåŒæ ·çš„äº‹æƒ…ã€‚ç„¶è€Œï¼Œå’Œç¥ç»ç½‘ç»œä¸€æ ·ï¼Œå®ƒä¸ä¸€å®šæ˜¯è¿™æ ·çš„ã€‚åœ¨è¿™é‡Œï¼Œè¿™åªæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å°å·§åˆã€‚*

## *æ›´å¤šæ¶æ„*

*æˆ‘ä»¬ç°åœ¨å·²ç»çœ‹åˆ°äº†æ™®é€šçš„è‡ªåŠ¨ç¼–ç å™¨ï¼Œä»¥åŠå·ç§¯è‡ªåŠ¨ç¼–ç å™¨ã€‚ä½ å¯èƒ½å·²ç»çŒœåˆ°ï¼Œé€šè¿‡æ”¹å˜è‡ªåŠ¨ç¼–ç å™¨çš„ç»“æ„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»º **LSTM è‡ªåŠ¨ç¼–ç å™¨æˆ–åºåˆ—åˆ°åºåˆ—è‡ªåŠ¨ç¼–ç å™¨**ã€**å˜å‹å™¨è‡ªåŠ¨ç¼–ç å™¨**ç­‰ç­‰ã€‚*

*è¿˜æœ‰**ç¨€ç–è‡ªåŠ¨ç¼–ç å™¨**ï¼Œå¦‚æœç¼–ç å™¨ä¸€æ¬¡ä½¿ç”¨å¤ªå¤šçš„æ½œåœ¨ç»´åº¦ï¼Œå®ƒä¼šæƒ©ç½šç¼–ç å™¨ã€‚æ‚¨å¯ä»¥é€šè¿‡`activity_regularizer`å…³é”®å­—å°†æ´»åŠ¨æ­£åˆ™åŒ–æ·»åŠ åˆ°å›¾å±‚ä¸­ã€‚*

*å°½ç®¡ä¸»è¦æ€æƒ³æ€»æ˜¯ç›¸åŒçš„:è·å–ä¸€ä¸ªè¾“å…¥å¹¶ä½¿å…¶å˜å°ã€‚ç„¶åå°½ä½ æ‰€èƒ½æŠŠå®ƒæ”¾å¤§ä¸€å€ï¼ŒåŸºæœ¬ä¸Šå°±åƒæ¯ä¸ªçŠ¯ç½ªç³»åˆ—é‡Œä¸€æ ·(è¿™æ˜¯çœŸçš„ï¼):*

*![](img/6ca58312986538e2b338ec84c1654b28.png)*

*å›¾ç‰‡ç”±[ä¿¡ä»»å·](https://imgur.com/user/trustno2)åœ¨[https://imgur.com/gallery/zVq9W7u](https://imgur.com/gallery/zVq9W7u)ä¸Šã€‚*

*å¦ä¸€ç§å€¼å¾—æ³¨æ„çš„æˆ‘éå¸¸å–œæ¬¢çš„è‡ªåŠ¨ç¼–ç å™¨æ˜¯**å˜ä½“è‡ªåŠ¨ç¼–ç å™¨ã€‚**å®ƒä¸ä»…èƒ½å¤Ÿé‡å»ºæ•°æ®ï¼Œç”šè‡³èƒ½å¤Ÿ**åˆ›å»ºæ–°æ•°æ®**ï¼Œè¿™ä½¿å…¶æˆä¸º**åˆ›æˆå¼æ¨¡å‹**ã€‚ä½¿ç”¨å®ƒä»¬ï¼Œæ‚¨å¯ä»¥åˆ›å»ºå‚¬çœ å›¾ç‰‡ï¼Œå¦‚*

*![](img/74c5d0f4d77d710754373159a0c2856f.png)*

*[https://www.tensorflow.org/tutorials/generative/cvae](https://www.tensorflow.org/tutorials/generative/cvae)*

# *ç»“è®º*

*æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œæ•°æ®å¯èƒ½å¸¦æœ‰å¤§é‡å†—ä½™ã€‚è¿™å¢åŠ äº†å¤„ç†æ‰€è¿°æ•°æ®æ‰€éœ€çš„å†…å­˜å’Œè®¡ç®—èƒ½åŠ›ï¼Œç”šè‡³å¯èƒ½é™ä½æ¨¡å‹çš„æ€§èƒ½ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ é™¤ä¸€äº›åŠŸèƒ½æˆ–ä½¿ç”¨ PCA ç­‰æ–¹æ³•æ¥æ‘†è„±å›°å¢ƒã€‚*

*ç„¶è€Œï¼Œè¿™äº›æ–¹æ³•å¯èƒ½è¿‡äºç®€å•ï¼Œæ— æ³•ä»æ•°æ®ä¸­æ°å½“åœ°æå–ç›¸å…³ä¿¡æ¯â€”â€”å®ƒä»¬å­˜åœ¨ä¸è¶³ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªåŠ¨ç¼–ç å™¨ï¼Œå®ƒå¯ä»¥æŒ‰ç…§æˆ‘ä»¬éœ€è¦çš„å¤æ‚ç¨‹åº¦æ¥è½¬æ¢æ•°æ®ã€‚å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬ä½¿ç”¨ç¥ç»ç½‘ç»œæ„å»ºè‡ªåŠ¨ç¼–ç å™¨ï¼Œä½†ä¹Ÿå­˜åœ¨å…¶ä»–æ–¹æ³•ï¼Œä¾‹å¦‚ä½¿ç”¨å†³ç­–æ ‘çš„ã€‚*

*ç„¶åï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ç”¨ Tensorflow ç”¨å‡ è¡Œä»£ç æ„å»ºä¸€ä¸ªæ™®é€šçš„å·ç§¯è‡ªåŠ¨ç¼–ç å™¨ã€‚æ‚¨è¿˜çœ‹åˆ°äº†æ›´å¤šçš„è‡ªåŠ¨ç¼–ç å™¨ç±»å‹ï¼Œè¿™å–å†³äºæ‚¨å¦‚ä½•å®šä¹‰æ‚¨çš„ç¼–ç å™¨å’Œè§£ç å™¨ã€‚*

*ç°åœ¨ï¼Œæ‚¨å¯ä»¥å¼€å§‹è‡ªå·±æ¢ç´¢è‡ªåŠ¨ç¼–ç å™¨ï¼Œä½¿ç”¨å®ƒä»¬ï¼Œçœ‹çœ‹æ‚¨æ˜¯å¦èƒ½ä»å®ƒä»¬ä¸­å—ç›Šï¼Œè§£å†³æ‚¨çš„é—®é¢˜ã€‚ç©å¾—å¼€å¿ƒï¼*

*æˆ‘å¸Œæœ›ä½ ä»Šå¤©å­¦åˆ°äº†æ–°çš„ã€æœ‰è¶£çš„ã€æœ‰ç”¨çš„ä¸œè¥¿ã€‚æ„Ÿè°¢é˜…è¯»ï¼*

***ä½œä¸ºæœ€åä¸€ç‚¹ï¼Œå¦‚æœä½ ***

1.  ***æƒ³æ”¯æŒæˆ‘å¤šå†™ç‚¹æœºå™¨å­¦ä¹ å’Œ***
2.  ***æ— è®ºå¦‚ä½•éƒ½è¦è®¡åˆ’è·å¾—ä¸­ç­‰è®¢é˜…é‡ï¼Œ***

***ä¸ºä»€ä¹ˆä¸åš** [**é€šè¿‡è¿™ä¸ªç¯èŠ‚**](https://dr-robert-kuebler.medium.com/membership) **ï¼Ÿè¿™å°†å¯¹æˆ‘å¸®åŠ©å¾ˆå¤§ï¼ğŸ˜Š***

*é€æ˜åœ°è¯´ï¼Œç»™ä½ çš„ä»·æ ¼ä¸å˜ï¼Œä½†å¤§çº¦ä¸€åŠçš„è®¢é˜…è´¹ç›´æ¥å½’æˆ‘ã€‚*

*éå¸¸æ„Ÿè°¢ï¼Œå¦‚æœä½ è€ƒè™‘æ”¯æŒæˆ‘çš„è¯ï¼*

> **æœ‰é—®é¢˜å°±åœ¨*[*LinkedIn*](https://www.linkedin.com/in/dr-robert-k%C3%BCbler-983859150/)*ä¸Šå†™æˆ‘ï¼**
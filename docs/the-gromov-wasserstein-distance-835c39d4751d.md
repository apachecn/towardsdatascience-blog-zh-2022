# æ ¼ç½—è«å¤«-æ²ƒç‘Ÿæ–¯å¦è·ç¦»

> åŸæ–‡ï¼š<https://towardsdatascience.com/the-gromov-wasserstein-distance-835c39d4751d>

# æ ¼ç½—è«å¤«-æ²ƒç‘Ÿæ–¯å¦è·ç¦»

## Python ä¸­å¯¹è±¡åŒ¹é…çš„åº¦é‡ä¸å®ä¾‹

![](img/8c7c9265f8e49d07123f56e4f2959718.png)

ä½œè€…ä½¿ç”¨äººå·¥æ™ºèƒ½å·¥å…· Dreamstudio ç”Ÿæˆçš„å°é¢ç…§ç‰‡(æˆæƒä¸º[https://creativecommons.org/publicdomain/zero/1.0/](https://creativecommons.org/publicdomain/zero/1.0/)

åœ¨è¿‡å»çš„å‡ åå¹´é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°åœ¨æˆ‘ä»¬å¯èƒ½æƒ³åˆ°çš„æ¯ä¸€ä¸ªé¢†åŸŸçš„æ•°æ®æ”¶é›†éƒ½å–å¾—äº†çªç ´ï¼ŒåŒ…æ‹¬è¿è¾“ã€é›¶å”®ã€é‡‘èã€ç”Ÿç‰©ä¿¡æ¯å­¦ã€è›‹ç™½è´¨ç»„å­¦å’ŒåŸºå› ç»„å­¦ã€æœºå™¨äººå­¦ã€æœºå™¨è§†è§‰ã€æ¨¡å¼åŒ¹é…ç­‰ã€‚ä¸ºäº†åˆ†æå’Œç»„ç»‡è¿™äº›æ•°æ®ï¼Œå®šä¹‰å¯¹è±¡æˆ–æ•°æ®é›†ç›¸ä¼¼æ€§çš„æ¦‚å¿µå¾ˆé‡è¦ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†äº’æ¢ä½¿ç”¨å¯¹è±¡å’Œæ•°æ®é›†ã€‚åœ¨è¿™æ–¹é¢ï¼Œæˆ‘ä»¬å¯ä»¥æå‡ºä»¥ä¸‹å‡ ç‚¹æ¥ç•Œå®š:

1.  é€‰æ‹©åˆé€‚çš„æ•°æ®é›†è¡¨ç¤º
2.  å®šä¹‰ä¸¤ä¸ªæ•°æ®é›†ä¹‹é—´ç›¸ç­‰çš„æ¦‚å¿µ
3.  å®šä¹‰ä¸€ä¸ªåº¦é‡ç©ºé—´ï¼Œä½¿æ‰€æœ‰å¯¹è±¡çš„ç©ºé—´ã€‚åº¦é‡å¿…é¡»ä½¿å¾—åˆ°å¯¹è±¡çš„è·ç¦»ä¸ºé›¶ï¼Œå¯¹è±¡æ˜¯ç›¸ç­‰çš„ã€‚å…¶ä¸­ä¸€ä¸ªè·ç¦»æ˜¯æ ¼ç½—è«å¤«-æ²ƒç‘Ÿæ–¯å¦è·ç¦»ã€‚

å¯¹è±¡åŒ¹é…çš„æ¦‚å¿µä¸ä»…æœ‰åŠ©äºå»ºç«‹ä¸¤ä¸ªæ•°æ®é›†ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œä¹Ÿæœ‰åŠ©äºå…¶ä»–ç±»å‹çš„é—®é¢˜ï¼Œå¦‚èšç±»ã€‚

ä¸ºäº†ç†è§£æ ¼ç½—è«å¤«-æ²ƒç‘Ÿæ–¯å¦è·ç¦»ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰åº¦é‡æµ‹åº¦ç©ºé—´ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬è¿›å…¥åº¦é‡ç©ºé—´ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å®šä¹‰ä¸€äº›æœ¯è¯­ã€‚

**åº¦é‡:**é›†åˆ *X* ä¸Šçš„ä¸€ä¸ªåº¦é‡ *d* æ˜¯ä¸€ä¸ªå‡½æ•°ä½¿å¾— *d(xï¼Œy) = 0* if *x = yï¼Œx* âˆˆ *Xï¼Œ*Yâˆˆ*Yï¼Œ*å¹¶ä¸”æ»¡è¶³[å¯¹ç§°æ€§](https://en.wikipedia.org/wiki/Symmetric_function)å’Œ [*ä¸‰è§’å½¢ä¸ç­‰å¼*å®ƒä¹Ÿè¢«ç§°ä¸º ***è·ç¦»åŠŸèƒ½*** ã€‚](https://en.wikipedia.org/wiki/Triangle_inequality)

åº¦é‡ç©ºé—´:åº¦é‡ç©ºé—´æ˜¯ä¸€ä¸ªéç©ºé›†ï¼Œå…¶ä¸Šå®šä¹‰äº†åº¦é‡ã€‚å®ƒå¯ä»¥è¢«è®¤ä¸ºæ˜¯æœ‰åºå¯¹(mï¼Œ *d* ï¼Œä½¿å¾—*d*:m**Ã—**m â„.æˆ‘ä»¬ç”¨â„æ¥è¡¨ç¤ºå®æ•°é›†ã€‚

ç°åœ¨æˆ‘ä»¬å®šä¹‰åº¦é‡æµ‹åº¦ç©ºé—´ã€‚

# åº¦é‡åº¦é‡ç©ºé—´

ä¸åº¦é‡ç©ºé—´ç›¸åï¼Œåº¦é‡åº¦é‡ç©ºé—´æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„(Mï¼Œ *d* ï¼Œ *p* )ï¼Œå…¶ä¸­ *p* æ˜¯ä¸€ä¸ªæ¦‚ç‡åº¦é‡ã€‚åº¦é‡æµ‹åº¦ç©ºé—´ç±»ä¼¼äºåº¦é‡ç©ºé—´ï¼Œä½†æ˜¯è¢«èµ‹äºˆäº†æ¦‚ç‡çš„æ¦‚å¿µã€‚æˆ‘æ¥è§£é‡Šä¸€ä¸‹ã€‚åœ¨è®¸å¤šåº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å–œæ¬¢å°†æƒé‡ä¸æ¯ä¸ªç‚¹ç›¸å…³è”ï¼Œå¦‚å›¾ 1 æ‰€ç¤ºã€‚æƒé‡å¯èƒ½ä»£è¡¨æˆ‘ä»¬å¯¹è¿™äº›æ•°æ®ç‚¹çš„ä¿¡ä»»ç¨‹åº¦ã€‚å¦‚å›¾ 1 æ‰€ç¤ºï¼Œæˆ‘ä»¬è€ƒè™‘ä¸¤ä¸ªåº¦é‡åº¦é‡ç©ºé—´(ç®€ç§° mm-space)ï¼Œæ¯ä¸ªç©ºé—´æœ‰ä¸¤ä¸ªç‚¹ã€‚è¿™é‡Œæˆ‘ä»¬å®šä¹‰*pâ‚*=[ï¼›]è€Œ *pâ‚‚* = [ï¼Œ]ï¼Œæ€»å’Œå¿…é¡»æ˜¯æ¦‚ç‡(æˆ–Ïƒä»£æ•°)è§„åˆ™å®šä¹‰çš„ 1ã€‚

![](img/acc2529494b07e9c454f61844edefbc1.png)

å›¾ä¸€ã€‚ç”±ä½œè€…åˆ›å»º

[](/manifold-alignment-c67fc3fc1a1c) [## æ­§ç®¡å¯¹é½

### å¤šä¸ªæ•°æ®é›†çš„ç»Ÿä¸€

towardsdatascience.com](/manifold-alignment-c67fc3fc1a1c) 

è®©æˆ‘ä»¬å†å®šä¹‰å‡ ä¸ªæœ¯è¯­:

**ç­‰è·:**å‡è®¾ä¸ºåŒå°„çš„åº¦é‡ç©ºé—´ä¹‹é—´çš„è·ç¦»ä¿æŒå˜æ¢ã€‚**ç­‰è·å˜æ¢**å°†å…ƒç´ æ˜ å°„åˆ°ç›¸åŒæˆ–ä¸åŒçš„åº¦é‡ç©ºé—´ï¼Œä½¿å¾—æ–°ç©ºé—´ä¸­å…ƒç´ ä¹‹é—´çš„è·ç¦»ä¸åŸå§‹å…ƒç´ ä¹‹é—´çš„è·ç¦»ç›¸åŒã€‚

**åŒæ„:**åŒæ„æ˜¯ä¿ç»“æ„æ˜ å°„ã€‚åœ¨çº¿æ€§ä»£æ•°çš„æ„ä¹‰ä¸Šï¼Œæ­£å¦‚å¤§å¤šæ•°æ•°æ®ç§‘å­¦å®¶æ‰€ç†Ÿæ‚‰çš„ï¼Œä¸¤ä¸ªå‘é‡ç©ºé—´ *V* å’Œ *W* è¢«ç§°ä¸ºåŒæ„ï¼Œå¦‚æœå­˜åœ¨ä» *V* åˆ° *W* çš„å¯é€†çº¿æ€§å˜æ¢(**ç§°ä¸º**åŒæ„)ï¼ŒTã€‚è€ƒè™‘å›¾ 2ã€‚åœ¨å›¾ 2 ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸¤å¥—å›½é™…è±¡æ£‹ã€‚å®ƒä»¬åœ¨å›½é™…è±¡æ£‹æ¸¸æˆä¸­æ˜¯åŒæ„çš„ï¼Œå°½ç®¡æ£‹å­çœ‹èµ·æ¥å¯èƒ½ä¸åŒã€‚

ä¸¤ä¸ª mm-ç©ºé—´æ˜¯åŒæ„çš„ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªç­‰è·æ˜ å°„*Ïˆ:Xâ†’y*

![](img/e4f708498f33a2c7da30f0461a0586f1.png)

å›¾äºŒã€‚æ¥æºã€‚å·¦:ã€https://unsplash.com/photos/WtdIwprWnB4ã€‘T2ï¼Œå³:[https://unsplash.com/photos/R0t2pAukP9E](https://unsplash.com/photos/R0t2pAukP9E)

**å‰æ¨æµ‹åº¦:**è€ƒè™‘ä¸¤ä¸ªåº¦é‡ç©ºé—´ X å’Œ Y ä¹‹é—´çš„å¯æµ‹æ˜ å°„ *f: X â†’ Y* å’Œ *p* çš„æ¦‚ç‡æµ‹åº¦ã€‚å‰æ¨æµ‹åº¦æ˜¯é€šè¿‡å°†ä¸€ä¸ªæµ‹åº¦(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ¦‚ç‡)ä»ä¸€ä¸ªå¯æµ‹ç©ºé—´è½¬ç§»åˆ°å¦ä¸€ä¸ªå¯æµ‹ç©ºé—´è€Œè·å¾—çš„æµ‹åº¦ã€‚å®ƒè¢«è¡¨ç¤ºä¸º f# *p(A) = p(f* â» (A))å…¶ä¸­ A = ğ”…(Y)ï¼Œğ”…æ˜¯Ïƒ-ä»£æ•°(ä¸ºäº†ç®€å•èµ·è§ï¼Œå°±è®¤ä¸ºÏƒ-ä»£æ•°å®šä¹‰äº†æˆ‘ä»¬æ‰€çŸ¥é“çš„æ¦‚ç‡çš„æ¦‚å¿µã€‚æˆ‘å‚è€ƒäº†ä¹”æ²»Â·å¡å¡æ‹‰æ–¯çš„ç»Ÿè®¡æ¨è®ºä»¥è·å¾—å…³äºè¿™ä¸ªä¸»é¢˜çš„æ›´å¤šç»†èŠ‚)ã€‚æˆ‘ä»¬å¯ä»¥æŠŠ mm ç©ºé—´çš„å‰æ¨åº¦é‡å†™æˆ *Ïˆ#(pâ‚) = pâ‚‚.*

è€ƒè™‘ *R âŠ‚ X Ã— Y* æ˜¯ *X* å’Œ *Y* ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚ç„¶åæˆ‘ä»¬å®šä¹‰ *Ï€â‚(R) = X* å’Œ *Ï€â‚‚(R) = Y* ã€‚ä¸€ä¸ªæ¦‚ç‡åº¦é‡ *pï¼Œ*å¯¹ *X Ã— Y* æ˜¯ *pâ‚* å’Œ *pâ‚‚ã€*ä¹‹é—´çš„è€¦åˆï¼Œå¦‚æœ *Ï€â‚#(pâ‚) = pï¼ŒÏ€â‚‚#(pâ‚‚)= pã€‚*æŠŠğ“¤ ( *pâ‚ï¼Œpâ‚‚* )çœ‹ä½œæ˜¯ *pâ‚* å’Œ*p 8832ã€‘*ä¹‹é—´æ‰€æœ‰è€¦åˆçš„é›†åˆã€‚

# **å®šä¹‰**æ ¼ç½—è«å¤«-æ²ƒç‘Ÿæ–¯å¦è·ç¦»

è€ƒè™‘åº¦é‡åº¦é‡ç©ºé—´ä¸Šçš„ä¸¤ç‚¹(xï¼Œy)å’Œ(xâ€™ï¼Œyâ€™)ã€‚è¿›ä¸€æ­¥ï¼Œè€ƒè™‘ç‚¹ q â‰¥ 1ã€‚

(xï¼Œyï¼Œx 'ï¼Œy' ) â†¦ |dâ‚“(xï¼Œx ')â€”dáµ§(yï¼Œy' )|^q å¹¶æŒ‘é€‰ä¸€ä¸ª *p* âˆˆ ğ“¤ ( *pâ‚ï¼Œpâ‚‚* )ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®šä¹‰ q é˜¶çš„æ ¼ç½—è«å¤«-ç“¦ç‘Ÿæ–¯å¦è·ç¦»ä¸º:

![](img/0a5357363a9a99d7ad10e0cf62977a8e.png)

# æ ¼ç½—è«å¤«-ç“¦ç‘Ÿæ–¯å¦è·ç¦»çš„åº”ç”¨

æ ¼ç½—è«å¤«-æ²ƒç‘Ÿæ–¯å¦è·ç¦»å¯ç”¨äºè®¸å¤šä¸æ•°æ®ç§‘å­¦ã€æ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ ç›¸å…³çš„ä»»åŠ¡ã€‚ä¸‹é¢åˆ—ä¸¾äº†å‡ ä¸ªä¾‹å­:

*   ç»Ÿä¸€å¤šä¸ªæ•°æ®é›†çš„æµå½¢å¯¹é½ã€‚
*   å½¢çŠ¶åˆ†æ
*   [åŸå­ç¯å¢ƒçš„åˆ†ç±»](https://doi.org/10.1016/j.commatsci.2020.110144)
*   [ç”¨äºç”Ÿç‰©æ•°æ®çš„å¤šæ¨¡æ€åˆ†æ](https://doi.org/10.1101/2020.04.28.066787)
*   [å›¾å½¢å¯¹é½](https://arxiv.org/pdf/2003.06048.pdf)
*   [ç‚¹äº‘åˆ†æ](https://doi.org/10.1109/3DV50981.2020.00057)

# Python ä¸­çš„æ ¼ç½—è«å¤«-ç“¦ç‘Ÿæ–¯å¦è·ç¦»

æˆ‘ä»¬å°†ä½¿ç”¨`POT` python åŒ…ä½œä¸º GW è·ç¦»çš„æ•°å€¼ç¤ºä¾‹ã€‚å®ƒå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®‰è£…:

```
pip install POT
```

ä½¿ç”¨ GWdistanceï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—ä¸å±äºåŒä¸€åº¦é‡ç©ºé—´çš„æ ·æœ¬çš„è·ç¦»ã€‚æˆ‘ä»¬åœ¨äºŒç»´å’Œä¸‰ç»´ç©ºé—´ä¸­é‡‡æ ·ä¸¤ä¸ªé«˜æ–¯åˆ†å¸ƒã€‚

![](img/7b1257fb8110420dceb6f1fb8645eb52.png)

å›¾ 4ã€‚ä½œè€…ç”¨ Python ä»£ç ç”»çš„å›¾

ç°åœ¨ï¼Œè®©æˆ‘ä»¬è®¡ç®—è·ç¦»æ ¸ï¼Œå¹¶å°†å…¶å½’ä¸€åŒ–ã€‚

![](img/5e0a6fa49ae0ae143dac90a71444888a.png)

å›¾ 5ã€‚ä½œè€…ç”¨ Python ä»£ç ç”»çš„å›¾

ç°åœ¨ï¼Œæˆ‘ä»¬è®¡ç®— GW è·ç¦»:

ä¸Šè¿°ä»£ç çš„è¾“å‡ºæ˜¯:

```
It.  |Loss        |Relative loss|Absolute loss
------------------------------------------------
    0|6.935296e-02|0.000000e+00|0.000000e+00
    1|3.779906e-02|8.347803e-01|3.155391e-02
    2|2.791583e-02|3.540367e-01|9.883228e-03
    3|2.214951e-02|2.603359e-01|5.766313e-03
    4|2.100683e-02|5.439603e-02|1.142688e-03
    5|2.093137e-02|3.605042e-03|7.545845e-05
    6|2.093137e-02|0.000000e+00|0.000000e+00
Gromov-Wasserstein distances: 0.020931367451704774
```

![](img/911b3260f99e109d46f44b6ba1dbd09e.png)

å›¾ 6ã€‚ä½œè€…ç”¨ Python ä»£ç ç”»çš„å›¾

æ‰§è¡Œä¸Šè¿° GW æ¨¡æ‹Ÿçš„å®Œæ•´è„šæœ¬å¯ä»¥ä»[https://github . com/rahulbhadani/medium . com/blob/master/01 _ 26 _ 2022/GW _ distance . py](https://github.com/rahulbhadani/medium.com/blob/master/01_26_2022/GW_distance.py)è·å¾—ã€‚

https://github.com/PythonOT/POT/blob/master/ot/gromov.py[ä¸­æä¾›äº† GW è·ç¦»çš„è¯¦ç»†å®ç°ã€‚](https://github.com/PythonOT/POT/blob/master/ot/gromov.py)

å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰ç”¨ï¼Œä½ å¯èƒ½ä¹Ÿä¼šå–œæ¬¢æˆ‘å…³äº[æ­§ç®¡å¯¹é½](/manifold-alignment-c67fc3fc1a1c)çš„æ–‡ç« ã€‚

> *æ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚å¦‚æœä½ å–œæ¬¢æˆ‘çš„æ–‡ç« å¹¶æƒ³æ”¯æŒæˆ‘çš„å†…å®¹ï¼Œæˆ‘è¯·æ±‚ä½ é€šè¿‡*[*ã€https://rahulbhadani.medium.com/membership*](https://rahulbhadani.medium.com/membership)*è®¢é˜… Mediumã€‚*

# å‚è€ƒ

1.  æ¢…è«åˆ©ï¼Œæ³•å­”å¤šã€‚"æ ¼ç½—è«å¤«-ç“¦ç‘Ÿæ–¯å¦è·ç¦»å’Œç‰©ä½“åŒ¹é…çš„åº¦é‡æ–¹æ³•."è®¡ç®—æ•°å­¦åŸºç¡€ 11.4(2011):417â€“487ã€‚
2.  æ¢…è«åˆ©ï¼Œæ³•å­”å¤šã€‚"æ ¼ç½—è«å¤«-æ²ƒç‘Ÿæ–¯å¦è·ç¦»:æ¦‚è¿°."*å…¬ç†*3.3(2014):335â€“341ã€‚
3.  åŒæ„(æŠ½è±¡ä»£æ•°):[https://www.youtube.com/watch?v=BAmWgVjSosY](https://www.youtube.com/watch?v=BAmWgVjSosY)
4.  [https://optimal transport . github . io/slides-peyre/gromovwasserstein . pdf](https://optimaltransport.github.io/slides-peyre/GromovWasserstein.pdf)
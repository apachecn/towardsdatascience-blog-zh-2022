# Python ä¸­çš„ K-Medoid èšç±»ç®—æ³•

> åŸæ–‡ï¼š<https://towardsdatascience.com/k-medoid-clustering-pam-algorithm-in-python-with-solved-example-c0dcb35b3f46>

## ä¸€æ­¥ä¸€æ­¥çš„æ•™ç¨‹-æœ‰ä¸€ä¸ªè§£å†³çš„ä¾‹å­

![](img/ce88be8b3e670d731908fa8deef8d4a9.png)

å›¾ç‰‡æ¥æºâ€”â€”ç”±ä½œè€…ä½¿ç”¨ Jupyter ç¬”è®°æœ¬å‡†å¤‡ã€‚

# 1.ä»‹ç»

## 1.1K-å‡å€¼èšç±»ä¸æŒ‘æˆ˜

å¤§è§„æ¨¡æ•°æ®çš„èšç±»æ˜¯å®ç°åŸºäºåˆ†æ®µçš„ç®—æ³•çš„å…³é”®ã€‚ç»†åˆ†å¯ä»¥åŒ…æ‹¬è¯†åˆ«å®¢æˆ·ç¾¤ä»¥ä¿ƒè¿›æœ‰é’ˆå¯¹æ€§çš„è¥é”€ï¼Œè¯†åˆ«å¤„æ–¹è€…ç¾¤ä»¥å…è®¸åŒ»ç–—ä¿å¥å‚ä¸è€…å‘ä»–ä»¬ä¼ è¾¾æ­£ç¡®çš„ä¿¡æ¯ï¼Œä»¥åŠè¯†åˆ«æ•°æ®ä¸­çš„æ¨¡å¼æˆ–å¼‚å¸¸å€¼ã€‚ *K* -Means æ˜¯è·¨ä¸åŒé—®é¢˜é¢†åŸŸé‡‡ç”¨çš„æœ€æµè¡Œçš„èšç±»ç®—æ³•ï¼Œä¸»è¦æ˜¯ç”±äºå®ƒçš„è®¡ç®—æ•ˆç‡å’Œç®—æ³•çš„æ˜“äºç†è§£æ€§ã€‚ *K-* æ„å‘³ç€ä¾èµ–äºä»æ•°æ®ä¸­è¯†åˆ«èšç±»ä¸­å¿ƒã€‚å®ƒä½¿ç”¨æ¬§å‡ é‡Œå¾·è·ç¦»åº¦é‡åœ¨å‘è¿™äº›èšç±»ä¸­å¿ƒåˆ†é…ç‚¹ä¹‹é—´äº¤æ›¿ï¼Œå¹¶é‡æ–°è®¡ç®—èšç±»ä¸­å¿ƒï¼Œç›´åˆ°è¾¾åˆ°æ”¶æ•›æ ‡å‡†ã€‚ç„¶è€Œï¼Œ*K*-å‡å€¼èšç±»æœ‰ä¸€ç³»åˆ—çš„ç¼ºç‚¹:

1.  *K*-è¡¨ç¤ºèšç±»ä¸ä½¿ç”¨é™¤æ¬§å‡ é‡Œå¾·è·ç¦»ä¹‹å¤–çš„ä»»ä½•å…¶ä»–è·ç¦»åº¦é‡ã€‚åœ¨ä½¿ç”¨ç¨€ç–æ•°æ®çš„æ¨èç³»ç»Ÿä¸­ï¼Œç»å¸¸ä½¿ç”¨ä¸åŒçš„è·ç¦»åº¦é‡ï¼Œå¦‚ä½™å¼¦è·ç¦»ã€‚
2.  åœ¨èšç±»ä¸­ï¼Œæœ€ç»ˆä¸­å¿ƒä¸ä¸€å®šæ˜¯æ¥è‡ªæ•°æ®çš„æ•°æ®ç‚¹ï¼Œè€Œæ˜¯å¯¹ä¸åŒåº”ç”¨é¢†åŸŸ(å¦‚è®¡ç®—æœºè§†è§‰ä¸­çš„å›¾åƒ)çš„å¯è§£é‡Šæ€§çš„ç“¶é¢ˆã€‚

# 2.æ°´æ¯å‘¨å›´çš„åˆ†åŒº(PAM)

PAM ä»£è¡¨â€œå›´ç»• Medoids çš„åˆ†åŒºâ€PAM å°† PAM çš„æ¯ä¸€æ­¥ä»ç¡®å®šæ€§è®¡ç®—é—®é¢˜è½¬åŒ–ä¸ºç»Ÿè®¡ä¼°è®¡é—®é¢˜ï¼Œå¹¶å°†æ ·æœ¬å¤§å°çš„å¤æ‚åº¦ä» *n* é™ä½åˆ° *O(n log n)* ã€‚ *Medoids æ˜¯é€‰æ‹©ä½œä¸ºèšç±»ä¸­å¿ƒçš„æ•°æ®ç‚¹ã€‚K-* è¡¨ç¤ºèšç±»çš„ç›®çš„æ˜¯æœ€å°åŒ–ç±»å†…è·ç¦»(é€šå¸¸ç§°ä¸ºæ€»å¹³æ–¹è¯¯å·®)ã€‚ç›¸åï¼ŒK-Medoid æœ€å°åŒ–äº†èšç±»ä¸­çš„ç‚¹å’Œè¢«è®¤ä¸ºæ˜¯è¯¥èšç±»çš„ä¸­å¿ƒçš„ç‚¹ä¹‹é—´çš„ä¸ç›¸ä¼¼æ€§ã€‚

> å½“ä¸”ä»…å½“æ•°æ®é›†ä¸­çš„ä»»æ„ç‚¹ä¸èšç±»ä¸­æ‰€æœ‰å…¶ä»–æ•°æ®ç‚¹çš„ä¸ç›¸ä¼¼æ€§æœ€å°æ—¶ï¼Œè¯¥ç‚¹æ‰å¯è¢«è§†ä¸º medoidã€‚

PAM çš„åŸºæœ¬æ¦‚å¿µåŒ…æ‹¬:

1.  ä»*å¤§å° n* (n ä¸ºè®°å½•æ•°)çš„æ•°æ®ç‚¹ä¸­æ‰¾å‡ºä¸€ç»„ *k* çš„ Medoids ( *k ä¸ºèšç±»æ•°ï¼ŒM ä¸º medoids* çš„é›†åˆ)ã€‚
2.  ä½¿ç”¨ä»»ä½•è·ç¦»åº¦é‡(æ¯”å¦‚ dã€‚)ï¼Œå¯èƒ½æ˜¯æ¬§å‡ é‡Œå¾·ï¼Œæ›¼å“ˆé¡¿ç­‰ã€‚)ï¼Œå°è¯•å®šä½ä½¿æ•°æ®ç‚¹åˆ°æœ€è¿‘çš„ Medoid çš„æ€»è·ç¦»æœ€å°çš„ med oidã€‚
3.  æœ€åï¼Œåœ¨æ‰€æœ‰å¯èƒ½çš„ *k(n-k)* å¯¹ä¸­äº¤æ¢é™ä½æŸå¤±å‡½æ•° L çš„ä¸­å€¼å’Œéä¸­å€¼å¯¹ã€‚æŸå¤±å‡½æ•°å®šä¹‰ä¸º:

![](img/62a4c08c6ffb7cf2758f8027d4af7296.png)

å›¾ä¸€ã€‚è¯´æ˜äº† PAM ç®—æ³•ä½¿ç”¨çš„æŸå¤±å‡½æ•°ã€‚

æ›´æ–°è´¨å¿ƒ:åœ¨ K-Means çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ­£åœ¨è®¡ç®—èšç±»ä¸­æ‰€æœ‰ç‚¹çš„å¹³å‡å€¼ã€‚ä½†æ˜¯å¯¹äº PAM ç®—æ³•ï¼Œè´¨å¿ƒçš„æ›´æ–°æ˜¯ä¸åŒçš„ã€‚å¦‚æœåœ¨ä¸€ä¸ªèšç±»ä¸­æœ‰ m ä¸ªç‚¹ï¼Œåˆ™ç”¨æ‰€æœ‰å…¶ä»–(m-1)ä¸ªç‚¹äº¤æ¢å…ˆå‰çš„è´¨å¿ƒï¼Œå¹¶å°†è¯¥ç‚¹æœ€ç»ˆç¡®å®šä¸ºå…·æœ‰æœ€å°æŸå¤±çš„æ–°è´¨å¿ƒã€‚æœ€å°æŸå¤±ç”±å›¾ 1 æ‰€ç¤ºçš„æˆæœ¬å‡½æ•°è®¡ç®—å¾—å‡ºã€‚ä¸‹é¢åˆ—å‡ºäº†ä¸€ä¸ªç›¸åŒçš„å·¥ä½œç¤ºä¾‹(GeeksforGeeksï¼Œ2019)ã€‚

## 2.1 ç®—æ³•â€”æ•°æ®é›†

è®©æˆ‘ä»¬è€ƒè™‘ä¸€ç»„æ•°æ®ç‚¹å’Œç‰¹å¾ã€‚

![](img/f80f9bb8bd72f3573104a0faadc50175.png)

å›¾äºŒã€‚æ˜¾ç¤ºäº† 7 ä¸ªæ•°æ®ç‚¹çš„ä¸€ç»„å‡è®¾ç‰¹å¾ã€‚ä½œè€…ä½¿ç”¨ Jupyter å’Œ Markdown åˆ¶ä½œçš„å›¾åƒã€‚

## 2.2 åˆå§‹åŒ–æ­¥éª¤

1.  è®©æˆ‘ä»¬éšæœºé€‰æ‹©ä¸¤ä¸ª medoidsï¼Œæ‰€ä»¥é€‰æ‹©ğ¾= 2ï¼Œè®© M1 =(4ï¼Œ5)ï¼ŒM2 =(9ï¼Œ10)æ˜¯è¿™ä¸¤ä¸ª medoidsã€‚æ³¨é‡Šèšç±»ç®—æ³•ä»æ•°æ®ä¸­é€‰æ‹©æ•°æ®ç‚¹ä½œä¸ºä¸­é—´ç‚¹
2.  è®¡ç®—æ‰€æœ‰ç‚¹åˆ° M1 å’Œ M2 çš„è·ç¦»ã€‚æ³¨:ç›¸å¼‚åº¦çš„è®¡ç®—æ–¹æ³•æ˜¯å°† medoids å’Œæ•°æ®ç‚¹ä¹‹é—´çš„ç»å¯¹å·®å€¼è¿›è¡Œ**æ±‚å’Œã€‚ä¾‹å¦‚ D=|Mx â€”ç‰¹å¾ X| + |My â€”ç‰¹å¾ Y|**

![](img/600e3bbabf5e31f2aa0ce7fb2fb69e0a.png)

å›¾ 3ã€‚è¯´æ˜äº†ç›¸å¼‚åº¦è®¡ç®—ã€‚ä½œè€…ä½¿ç”¨ Jupyter å’Œ Markdown åˆ¶ä½œçš„å›¾åƒã€‚

## 2.3 åˆ†é…æ­¥éª¤

å°†æ•°æ®ç‚¹åˆ†é…ç»™å…·æœ‰è¾ƒä½ç›¸å¼‚åº¦(æˆæœ¬)çš„ Medoidsã€‚æ•°æ®ç‚¹ 0 å’Œ 2 æŒ‡å‘ M2ï¼Œæ•°æ®ç‚¹ 3ã€4 å’Œ 5 æŒ‡å‘ M1ã€‚**æ€»æˆæœ¬=æˆæœ¬/åˆ†é…ç»™ M1 çš„ç§¯åˆ†å·®å¼‚+æˆæœ¬/åˆ†é…ç»™ M2 çš„ç§¯åˆ†å·®å¼‚ã€‚**

æ€»æˆæœ¬=(4+3+4)+(4+7)= 22ï¼›M1 çš„æˆæœ¬=ç‚¹ 3 ä¸ M1 çš„å·®å¼‚(4) +ç‚¹ 4 ä¸ M1 çš„å·®å¼‚(3)+ç‚¹ 5 ä¸ M1 çš„å·®å¼‚(4)ã€‚å¯¹ M2 é‡å¤åŒæ ·çš„è®¡ç®—ã€‚

## 2.4 è´¨å¿ƒé‡æ–°ç¼–è¯‘æ­¥éª¤

éšæœºé€‰æ‹©ä¸€ä¸ªé medoid ç‚¹å¹¶é‡æ–°è®¡ç®—æˆæœ¬ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€‰æ‹©æ•°æ®ç‚¹ 5 M1 as (2ï¼Œ3)ä½œä¸ºä¸­é—´ç‚¹ï¼Œå¹¶é‡æ–°è®¡ç®—æˆæœ¬ã€‚

![](img/e5a5d9514bbbb42fb7da80d32ec5cffc.png)

å›¾ 4ã€‚ç¤ºå‡ºäº†ä½¿ç”¨æ›´æ–°çš„è´¨å¿ƒçš„ç›¸å¼‚åº¦è®¡ç®—ï¼Œå³ï¼Œä½¿ç”¨æ•°æ®ç‚¹ 5 (2ï¼Œ3)ä½œä¸º M1ã€‚ä½œè€…ä½¿ç”¨ Jupyter å’Œ Markdown åˆ¶ä½œçš„å›¾åƒã€‚

ç°åœ¨åªæœ‰ 4 åˆ†å’Œ 6 åˆ†å»äº† M1ï¼Œå…¶ä½™çš„åˆ†éƒ½å»äº† M2ã€‚æ€»æˆæœ¬=(7+4)+(4+7+6)=28ï¼Œäº¤æ¢æˆæœ¬=æ–°æˆæœ¬-ä»¥å‰çš„æˆæœ¬= 28â€“22 = 6ã€‚

æˆ‘ä»¬å°†å–æ¶ˆäº¤æ¢ï¼Œå› ä¸ºäº¤æ¢æˆæœ¬å¤§äº 0ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸€ç›´æŒç»­åˆ°æ»¡è¶³æ”¶æ•›æ ‡å‡†ã€‚

# 3.ä½¿ç”¨ Python å®ç°

æˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ª scikit-learn-extra çš„ [K-Medoid ç®—æ³•æ¥æ¨¡æ‹Ÿä¸Šé¢çš„ä¾‹å­ã€‚å¾ˆå°‘ä»£ç å’Œæ¦‚å¿µï¼Œçµæ„Ÿæ¥è‡ªè½¯ä»¶åŒ…æ–‡æ¡£(scikit-learn-extraï¼Œ2019)](https://scikit-learn-extra.readthedocs.io/en/stable/generated/sklearn_extra.cluster.KMedoids.html)

```
# â€” â€” â€” â€” â€” â€” -Importing Packages â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -import matplotlib.pyplot as plt
import numpy as npfrom sklearn_extra.cluster import KMedoids# â€” â€” â€” â€” â€” â€” -Assigning Initial Centers â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -
centers = [[4, 5], [9, 10]]# â€” â€” â€” â€” â€” â€” -Assigning Data: Dummy Data used in example above â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” 
df=np.array([[7,8], [9,10], [11,5], [4,9], [7,5], [2,3], [4,5]])# â€” â€” â€” â€” â€” â€” -Fit KMedoids clustering â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -
KMobj = KMedoids(n_clusters=2).fit(df)# â€” â€” â€” â€” â€” â€” -Assigning Cluster Labels â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -
labels = KMobj.labels_
```

å¯è§†åŒ–é›†ç¾¤ã€‚

```
# â€” â€” â€” â€” â€” â€” -Extracting Unique Labels â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -unq_lab = set(labels)# â€” â€” â€” â€” â€” â€” -Setting Up Color Codes â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -
colors_plot = [
 plt.cm.Spectral(each) for each in np.linspace(0, 1, len(unq_lab))
]for k, col in zip(unq_lab, colors_plot):class_member_mask = labels == k

 # â€” â€” â€” â€” â€” â€” -Setting datapoint Feature X and Feature Y â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -xy = df[class_member_mask]

 # â€” â€” â€” â€” â€” â€” -Plotting Feature X and Feature Y for each cluster labels â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -

 plt.plot(
 xy[:, 0],
 xy[:, 1],
 â€œoâ€,
 markerfacecolor=tuple(col),
 markeredgecolor=â€whiteâ€,
 markersize=10,
 );# â€” â€” â€” â€” â€” â€” -Annotate Centroids â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -plt.plot(
 KMobj.cluster_centers_[:, 0],
 KMobj.cluster_centers_[:, 1],
 â€œoâ€,
 markerfacecolor=â€orangeâ€,
 markeredgecolor=â€kâ€,
 markersize=10,
);# â€” â€” â€” â€” â€” â€” -Add title to the plot â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -plt.title(â€œKMedoids clustering on Dummy Data- Medoids are represented in Orange.â€, fontsize=14);
```

![](img/ce88be8b3e670d731908fa8deef8d4a9.png)

å›¾ 5ã€‚ä½¿ç”¨ K-Medoids æ¼”ç¤ºäº†æœ€ç»ˆçš„ç°‡å½¢å¿ƒã€‚å›¾ç‰‡ç”±ä½œè€…ä½¿ç”¨ Jupyter ç¬”è®°æœ¬åˆ¶ä½œã€‚

# **å‚è€ƒ**

1.  scikit-learn-extraã€‚(2019). *KMedoids æ¼”ç¤ºâ€” scikit-learn-extra 0.2.0 æ–‡æ¡£*ã€‚sci kit-Learn-extra . readthedocs . io .[https://sci kit-Learn-extra . readthedocs . io/en/stable/auto _ examples/plot _ kmedoids . html # sphx-glr-auto-examples-plot-kmedoids-py](https://scikit-learn-extra.readthedocs.io/en/stable/auto_examples/plot_kmedoids.html#sphx-glr-auto-examples-plot-kmedoids-py)
2.  æå®¢ä¹‹ç¦ã€‚(2019 å¹´ 5 æœˆ 17 æ—¥)ã€‚ *ML | K-Medoids èšç±»ä¸æ±‚è§£å®ä¾‹*ã€‚æå®¢ä¹‹ç¦ã€‚[https://www . geeks forgeeks . org/ml-k-med OIDs-clustering-with-example/](https://www.geeksforgeeks.org/ml-k-medoids-clustering-with-example/)

*å…³äºä½œè€…:é«˜çº§åˆ†æä¸“å®¶å’Œç®¡ç†é¡¾é—®ï¼Œé€šè¿‡å¯¹ç»„ç»‡æ•°æ®çš„ä¸šåŠ¡ã€æŠ€æœ¯å’Œæ•°å­¦çš„ç»„åˆï¼Œå¸®åŠ©å…¬å¸æ‰¾åˆ°å„ç§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ä¸€ä¸ªæ•°æ®ç§‘å­¦çˆ±å¥½è€…ï¼Œåœ¨è¿™é‡Œåˆ†äº«ã€å­¦ä¹ ã€è´¡çŒ®ï¼›å¯ä»¥å’Œæˆ‘åœ¨* [*ä¸Šè”ç³»*](https://www.linkedin.com/in/angel-das-9532bb12a/) *å’Œ* [*æ¨ç‰¹*](https://twitter.com/dasangel07_andy)*ï¼›*
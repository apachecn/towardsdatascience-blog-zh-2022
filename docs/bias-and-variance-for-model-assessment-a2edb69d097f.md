# æ¨¡å‹è¯„ä¼°çš„åå·®-æ–¹å·®åˆ†è§£

> åŸæ–‡ï¼š<https://towardsdatascience.com/bias-and-variance-for-model-assessment-a2edb69d097f>

## æœºå™¨å­¦ä¹ ç®—æ³•çš„åå·®-æ–¹å·®åˆ†è§£åŠå…¶åœ¨ Python ä¸­çš„å®é™…åº”ç”¨

![](img/603539f21cbed439567ffdcab5ac1c11.png)

ç…§ç‰‡ç”±[å¢å¡æ–¯](https://www.pexels.com/@goumbik)åœ¨[åƒç´ ](https://www.pexels.com/photo/chart-close-up-data-desk-590022/)ä¸Šæ‹æ‘„

*åå·®*å’Œ*æ–¹å·®*æ˜¯æœºå™¨å­¦ä¹ æ¨¡å‹è¯„ä¼°ä¸­çš„ä¸¤ä¸ªå…³é”®æ¦‚å¿µï¼Œå› ä¸ºå®ƒä»¬ä¸æ¨¡å‹åœ¨æœªçŸ¥æ•°æ®ä¸Šçš„æ€§èƒ½å¯†åˆ‡ç›¸å…³ã€‚åå·®å’Œæ–¹å·®éƒ½æ˜¯é¢„æµ‹è¯¯å·®çš„è¯¯å·®ç±»å‹ã€‚ç¬¬ä¸‰ç§è¯¯å·®æ˜¯ä¸å¯çº¦è¯¯å·®ï¼Œè¿™æ˜¯æ•°æ®ä¸­å›ºæœ‰çš„è¯¯å·®ï¼Œæ— è®ºä½¿ç”¨ä»€ä¹ˆç®—æ³•éƒ½æ— æ³•å‡å°‘ã€‚

æ•°æ®ç§‘å­¦å®¶åœ¨å®æ–½æ–°æ¨¡å‹æ—¶é¢ä¸´çš„ä¸»è¦å›°éš¾ä¹‹ä¸€æ˜¯æ‰€è°“çš„*åå·®-æ–¹å·®å›°å¢ƒ*æˆ–*åå·®-æ–¹å·®é—®é¢˜*ã€‚è¿™åŒ…æ‹¬åœ¨ç›‘ç£å­¦ä¹ ç®—æ³•ä¸­æœ€å°åŒ–ä¸¤ä¸ªè¯¯å·®æºçš„å†²çªï¼Œå¯ä»¥ç”¨*åå·®-æ–¹å·®åˆ†è§£*æ–¹æ³•è¿›è¡Œè¯„ä¼°ã€‚

åœ¨æ•´ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æµè§ˆè¿™äº›æ¦‚å¿µï¼Œå¹¶ä»¥æœ¬æ–‡çš„ä¸»è¦è´¡çŒ®ç»“æŸï¼Œæœ¬æ–‡è§£é‡Šäº†åå·®-æ–¹å·®åˆ†è§£ï¼Œå¹¶ä¸ºä»»ä½•å¯¹å®ç°æ¨¡å‹åˆ†è§£æ„Ÿå…´è¶£çš„äººæä¾›äº†ä¸€ä¸ª Python å®è·µç¤ºä¾‹ã€‚

# åå·®å’Œæ–¹å·®

*åå·®*è¢«å®šä¹‰ä¸ºæ¨¡å‹é¢„æµ‹å’Œå®é™…æƒ…å†µä¹‹é—´çš„å·®å¼‚ã€‚é«˜åå·®ä¼šå¯¼è‡´ç®—æ³•é”™è¿‡ç‰¹å¾å’Œç›®æ ‡è¾“å‡ºä¹‹é—´çš„ç›¸å…³å…³ç³»(æ¬ æ‹Ÿåˆ)ã€‚

*æ–¹å·®*å®šä¹‰ä¸ºå¯¹è®­ç»ƒé›†ä¸­æ³¢åŠ¨çš„æ•æ„Ÿåº¦ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯æŒ‡å½“è®­ç»ƒæ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç»“æœçš„å˜åŒ–æœ‰å¤šå¤§ã€‚é«˜æ–¹å·®è¡¨æ˜éšç€è®­ç»ƒæ•°æ®é›†çš„å˜åŒ–ï¼Œç›®æ ‡å‡½æ•°çš„ä¼°è®¡å€¼ä¼šæœ‰å¤§çš„å˜åŒ–(è¿‡åº¦æ‹Ÿåˆ)ã€‚

ç”¨æ•°å­¦è¡¨ç¤ºçš„ä¸¤ä¸ªæœ¯è¯­éƒ½å¯¹åº”äºä»¥ä¸‹å…¬å¼:

![](img/2ad47ce693e484cecfe2aa25f57d7b41.png)

è¿™ä¸¤é¡¹éƒ½å¯ä»¥å¾ˆå®¹æ˜“åœ°ä»å‡æ–¹è¯¯å·®(MSE)å…¬å¼ä¸­å¯¼å‡º:

![](img/e006f3708eb3d984ddb89e28ac4c49c9.png)

> å¦‚ä½•è§£é‡Šè¿™äº›å…¬å¼çš„ä¾‹å­æ˜¾ç¤ºåœ¨æ–‡ç« çš„ç»“å°¾ã€‚

è¿™æ˜¯ä¸€ä¸ªå›¾è¡¨ï¼ŒåŒ…å«é«˜ä½åå·®å’Œé«˜ä½æ–¹å·®çš„å››ç§ä¸åŒæƒ…å†µã€‚è€ƒè™‘åˆ°æˆ‘ä»¬æ”¶é›†çš„è®­ç»ƒæ•°æ®ä¸­çš„æœºä¼šå¯å˜æ€§ï¼Œæ¯ä¸ªå‘½ä¸­ä»£è¡¨æˆ‘ä»¬æ¨¡å‹çš„ä¸€ä¸ªå•ç‹¬å®ç°[1]ã€‚ç›®æ ‡çš„ä¸­å¿ƒæ„å‘³ç€æ¨¡å‹å®Œç¾åœ°é¢„æµ‹äº†è¿™äº›å€¼ã€‚

![](img/483f2b6737648a992b494a8bdd89228b.png)

**å›¾ä¸€ã€‚**åå·®-æ–¹å·®ã€‚å‚è€ƒ:å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

# åå·®-æ–¹å·®æƒè¡¡

å°½ç®¡æœ€ä½³ä»»åŠ¡æ˜¯å°½å¯èƒ½ä½¿åå·®å’Œæ–¹å·®æœ€å°ï¼Œä½†åœ¨å®è·µä¸­ï¼Œä¸¤ç§è¯¯å·®ä¹‹é—´å­˜åœ¨æ˜æ˜¾çš„æƒè¡¡ã€‚åœ¨è¿™ä¸¤ä¸ªæœ¯è¯­ä¹‹é—´æ‰¾åˆ°ä¸€ä¸ªå¹³è¡¡ç‚¹å°±æ˜¯æ‰€è°“çš„*åå·®-æ–¹å·®æƒè¡¡*ã€‚

å¯¹äºæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œåå·®å’Œæ–¹å·®ä¸æ¨¡å‹çš„å¤æ‚æ€§å¯†åˆ‡ç›¸å…³ï¼Œç„¶åä¸æ¨¡å‹ä½•æ—¶è¿‡åº¦æ‹Ÿåˆæˆ–æ¬ æ‹Ÿåˆè®­ç»ƒæ•°æ®ç›¸å…³è”ã€‚å¦‚å›¾ 2 æ‰€ç¤ºï¼Œå½“æ¨¡å‹å¤æ‚æ€§è¶…è¿‡æœ€ä½³ç‚¹æ—¶ï¼Œæˆ‘ä»¬çš„æ¨¡å‹ä¼šè¿‡åº¦æ‹Ÿåˆè®­ç»ƒæ•°æ®ï¼Œè€Œå¦‚æœæ¨¡å‹å¤æ‚æ€§ä¸è¶³ï¼Œåˆ™æ¨¡å‹ä¼šå¯¹æ•°æ®æ‹Ÿåˆä¸è¶³ã€‚

![](img/b011b188873da31ecb299a37bb3b3783.png)

**å›¾äºŒ**ã€‚åå·®å’Œæ–¹å·®éšæ¨¡å‹å¤æ‚æ€§çš„å˜åŒ–ã€‚**å‚è€ƒå·**:å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚

åœ¨å®é™…åœºæ™¯ä¸­ï¼Œæ²¡æœ‰æ‰¾åˆ°æœ€ä½³ç‚¹çš„åˆ†ææ–¹æ³•ï¼Œå› æ­¤éœ€è¦æµ‹è¯•å‡ ä¸ªå…·æœ‰ä¸åŒå¤æ‚æ€§çš„æ¨¡å‹ï¼Œå¹¶é€‰æ‹©ä¸€ä¸ªä½¿æ€»ä½“è¯¯å·®æœ€å°çš„æ¨¡å‹ã€‚

# åå·®-æ–¹å·®åˆ†è§£

åå·®-æ–¹å·®åˆ†è§£æ˜¯ç†è§£ç®—æ³•æ€§èƒ½çš„ä¸€ç§æœ‰ç”¨æ–¹æ³•ã€‚

è¿™ç§æ–¹æ³•èƒŒåçš„ä¸»è¦æ€æƒ³æ˜¯å½“ç”¨ä¸åŒçš„è®­ç»ƒé›†è®­ç»ƒç›¸åŒçš„æ¨¡å‹å¹¶åœ¨ç›¸åŒçš„æµ‹è¯•é›†ä¸Šæµ‹è¯•å®ƒæ—¶ï¼Œæµ‹é‡åå·®å’Œæ–¹å·®ã€‚

ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œç”¨æ¥å¯¹æ•°æ®è¿›è¡Œå­é‡‡æ ·çš„æ–¹æ³•æ˜¯*è‡ªä¸¾*(åå­—*æ‰“åŒ…*æ¥æºäº*è‡ªä¸¾* + *åˆè®¡*)ã€‚è¿™ç§æ–¹æ³•åŒ…æ‹¬å¯¹æ•°æ®è¿›è¡Œéšæœºé‡‡æ ·å’Œæ›¿æ¢ï¼Œè¿™æ„å‘³ç€è®­ç»ƒæ•°æ®çš„å­é›†å°†é‡å ï¼Œå› ä¸ºæˆ‘ä»¬ä¸æ˜¯åˆ†å‰²æ•°æ®ï¼Œè€Œæ˜¯å¯¹å…¶è¿›è¡Œé‡é‡‡æ ·ã€‚

å› æ­¤ï¼Œé€šè¿‡è¿­ä»£è¿è¡Œ *bootstrapping* æ–¹æ³•å¹¶è·å¾—æµ‹è¯•é›†æ¨¡å‹çš„å‡†ç¡®æ€§ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—æˆ‘ä»¬è¿­ä»£çš„æ‰€æœ‰å›åˆçš„å¹³å‡åå·®å’Œæ–¹å·®ã€‚

ä¸‹é¢æ˜¯å›å½’ä»»åŠ¡çš„éƒ¨åˆ†ä»£ç ï¼Œæ€»ç»“äº†è¯¥æ–¹æ³•èƒŒåçš„ä¸»è¦é€»è¾‘ã€‚æ‰€æœ‰ä»£ç éƒ½æ˜¯ä» [MLxtend](https://github.com/rasbt/mlxtend) åº“ä¸­è·å¾—çš„ã€‚

```
Input:
- X_train
- y_train
- X_test
- y_test
- num_rounds: Number of iterations
Output:
- avg_expected_loss: Average MSE loss for all the rounds
- avg_bias: Average bias for all the rounds
- avg_var: Average variance for all the rounds
(avg_expected_loss = avg_bias^2 + avg_var)(1) Iterate for *num_rounds*, in each implementing bootstrapping, training the model and getting the predictions
for i in range(num_rounds):
- X_boot, y_boot = _draw_bootstrap_sample(rng, X_train, y_train)
- pred = estimator.fit(X_boot, y_boot).predict(X_test)
- all_pred[i] = pred(2) Obtain the average MSE error
**avg_expected_loss** = np.apply_along_axis(lambda x: ((x â€” y_test)**2).mean(), axis=1, arr=all_pred).mean()(3) Obtain the average bias and variance
main_predictions = np.mean(all_pred, axis=0)
**avg_bias** = np.sum((main_predictions â€” y_test)**2) / y_test.size
**avg_var** = np.sum((main_predictions â€” all_pred)**2) / all_pred.size
```

æœ€åï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª Python å®è·µç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•å®ç°åå·®-æ–¹å·®åˆ†è§£ã€‚

ä½œä¸ºå±•ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å…è´¹æä¾›çš„æ³¢å£«é¡¿ä½æˆ¿æ•°æ®é›†[2]ï¼Œå…¶ä»»åŠ¡æ˜¯ä½¿ç”¨å›å½’å˜é‡é¢„æµ‹æˆ¿ä»·ã€‚æˆ‘ä»¬é¦–å…ˆå°†æ•°æ®åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚

***ä¾‹ 1:å†³ç­–æ ‘***

ä¸ºäº†åˆ†æåå·®-æ–¹å·®åˆ†è§£ï¼Œæˆ‘ä»¬é¦–å…ˆå®ç°äº†ä¸€ä¸ªå†³ç­–æ ‘å›å½’å™¨ï¼Œå¹¶é€šè¿‡ *bias_variance_decomp* å‡½æ•°è¿è¡Œå®ƒï¼Œå…¶ä¼ªä»£ç å¦‚ä¸Šæ‰€ç¤ºã€‚

```
Average expected loss: 32.419
Average bias: 14.197
Average variance: 18.222
```

ä¸ºäº†å°†è¿™ä¸ªè¾“å‡ºä¸å¦ä¸€ä¸ªæ¨¡å‹è¿›è¡Œæ¯”è¾ƒï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨å†³ç­–æ ‘å›å½’å™¨è¿è¡Œäº†ä¸€ä¸ª bagging é›†æˆæ–¹æ³•ã€‚

```
Average expected loss: 18.693
Average bias: 15.292
Average variance: 3.402
```

ä¸ä¹‹å‰çš„ç»“æœç›¸æ¯”ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°åå·®æ˜¯å¦‚ä½•å¢åŠ çš„ï¼Œè¿™æ„å‘³ç€ bagging å›å½’æ¨¡å‹çš„è¡¨ç°æ¯”å†³ç­–æ ‘æ¨¡å‹å·®ã€‚ç„¶è€Œï¼Œæ–¹å·®ä¸¥é‡ä¸‹é™ï¼Œè¿™è¡¨æ˜è¯¥æ¨¡å‹ä¸å…¶é¢„æµ‹æ›´åŠ ä¸€è‡´ã€‚

***ä¾‹ 2:ç¥ç»ç½‘ç»œ***

æˆ‘ä»¬è¿˜è¯„ä¼°äº†åœ¨ Keras ä¸­å®ç°çš„åŸºäºç¥ç»ç½‘ç»œçš„æ¨¡å‹çš„æ€§èƒ½ï¼Œå› ä¸ºæ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œè¿™ä¸ªåŠŸèƒ½ä¸èƒ½åœ¨ PyTorch ä¸­å®ç°ã€‚

```
Average expected loss: 25.470
Average bias: 19.927
Average variance: 5.543
```

ä¸ç¬¬ä¸€ä¸ªæ¨¡å‹ç›¸æ¯”ï¼Œæˆ‘ä»¬é€šè¿‡å¢åŠ æ¯å±‚çš„ç¥ç»å…ƒæ•°é‡æ¥å¢åŠ æ¨¡å‹çš„å¤æ‚æ€§ã€‚

```
Average expected loss: 23.458
Average bias: 17.608
Average variance: 5.850
```

æ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œåå·®çš„å‡å°‘æ˜¯ä»¥å¢åŠ æ¨¡å‹çš„æ–¹å·®ä¸ºä»£ä»·çš„ã€‚

# ç®¡ç†åå·®å’Œå·®å¼‚çš„æ–¹æ³•

è¿™é‡Œæœ‰ä¸€äº›æŠ€å·§æ¥ç®¡ç†åå·®å’Œæ–¹å·®è¯¯å·®ã€‚

é¦–å…ˆä¹Ÿæ˜¯æœ€é‡è¦çš„ï¼Œä¸è¦åªå…³æ³¨åå·®çš„æœ€å°åŒ–ï¼Œæˆ–è€…æ¢å¥è¯è¯´ï¼Œä¸è¦å¿˜è®°æ–¹å·®ã€‚å¯¹äºä¸€ä¸ªå¥å£®çš„æ¨¡å‹æ¥è¯´ï¼Œè¿™ä¸¤è€…åŒæ ·é‡è¦ã€‚

ç„¶åï¼Œé€šè¿‡(1)å®æ–½*å¢å¼º*é›†æˆæ–¹æ³•ï¼Œæˆ–(2)æ·»åŠ æ›´å¤šç‰¹å¾æˆ–è¿›è¡Œç‰¹å¾å·¥ç¨‹æ¥å¢åŠ å¤æ‚æ€§ï¼Œå¯ä»¥å‡å°‘æ¨¡å‹çš„åå·®ã€‚

ç›¸åï¼Œæ–¹å·®å¯ä»¥é€šè¿‡(1)å®æ–½ *bagging* é›†åˆæ–¹æ³•ï¼Œæˆ–è€…(2)é€šè¿‡æ­£åˆ™åŒ–æ¥çº¦æŸæˆ–æ”¶ç¼©ä¼°è®¡çš„ç³»æ•°æ¥å‡å°ã€‚

æœ‰å…³å¦‚ä½•ä½¿ç”¨é›†æˆæ–¹æ³•ç®¡ç†åå·®å’Œæ–¹å·®çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œæˆ‘å»ºè®®é˜…è¯»æ–‡ç«  [*æœºå™¨å­¦ä¹ é›†æˆæ–¹æ³•ç®€ä»‹*](/introduction-to-ensemble-methods-in-machine-learning-e72c6b9ff4bc) ã€‚

## å¦‚ä½•è§£é‡Šåå·®å’Œå·®å¼‚çš„è¯¦ç»†è¯´æ˜

å¦‚æœæˆ‘ä»¬æœ‰ä¸‹é¢çš„åˆ†å¸ƒï¼Œ

![](img/4dac8901ec8ac3092ee4959153dbd790.png)

æœŸæœ›å€¼å’Œæ–¹å·®çš„è®¡ç®—å¦‚ä¸‹:

*   æœŸæœ›å€¼

![](img/0b484bfa2970fb5f854d7c33aefce966.png)

*   å·®å¼‚

![](img/4b5a8f96378917707b4120e55e41b250.png)

***å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·è€ƒè™‘*** [***è®¢é˜…***](https://javiferfer.medium.com/membership) ***ã€‚ä½ å°†è·å¾—æˆ‘æ‰€æœ‰çš„å†…å®¹+æ‰€æœ‰å…¶ä»–æ¥è‡ªç‰›é€¼åˆ›ä½œè€…çš„æ–‡ç« ï¼***

# å‚è€ƒ

[1] Scott Fortmann-Roeï¼Œ[äº†è§£åå·®-æ–¹å·®æƒè¡¡](http://scott.fortmann-roe.com/docs/BiasVariance.html)

[2]Harrison d .å’Œ Rubin feld d . l .ï¼Œã€Šäº«ä¹ä»·æ ¼å’Œå¯¹æ¸…æ´ç©ºæ°”çš„éœ€æ±‚ã€‹ï¼Œç¯å¢ƒæ‚å¿—ã€‚ç»æµå­¦ä¸ç®¡ç†å­¦ï¼Œç¬¬ 5 å·ï¼Œ81â€“102 é¡µï¼Œ1978 å¹´ã€‚

[3]æœºå™¨å­¦ä¹ è€…ï¼Œ[Entiende de una vez quÃ©es El trade off Bias-Variance](https://www.themachinelearners.com/tradeoff-bias-variance/)

[4] GitHubï¼Œ[å‡½æ•° bias_variance_decomp.py](https://github.com/rasbt/mlxtend/blob/master/mlxtend/evaluate/bias_variance_decomp.py)

ã€5ã€‘æ ˆäº¤æ¢ï¼Œ[ğ¸(ğ‘‹)ä»å­—é¢ä¸Šæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ](https://math.stackexchange.com/questions/2005675/what-is-ex2-mean-in-literal-terms)

[6]ä¸­ç­‰ï¼Œ[åå€š-æ–¹å·®æƒè¡¡è§£é‡Š](https://medium.com/@pardeshi.vishwa25/bias-variance-tradeoff-explained-7f18ebbef020)

[7]æœºå™¨å­¦ä¹ æŒæ¡ï¼Œ[æœºå™¨å­¦ä¹ ä¸­åå·®-æ–¹å·®æƒè¡¡çš„æ¸©å’Œä»‹ç»](https://machinelearningmastery.com/gentle-introduction-to-the-bias-variance-trade-off-in-machine-learning/)

[8] GitHubï¼Œ[ç”¨ python å®ç°æœºå™¨å­¦ä¹ è¯¯å·®åå·®-æ–¹å·®å’Œä¸å¯çº¦è¯¯å·®](https://github.com/christianversloot/machine-learning-articles/blob/main/machine-learning-error-bias-variance-and-irreducible-error-with-python.md)

[9] GitHubï¼Œ[åˆ†ç±»å’Œå›å½’æŸå¤±çš„åå·®-æ–¹å·®åˆ†è§£](http://rasbt.github.io/mlxtend/user_guide/evaluate/bias_variance_decomp/)

[10]å¤©æ‰åšå®¢ï¼Œ[ä»€ä¹ˆæ˜¯åå·®-æ–¹å·®æƒè¡¡ï¼Ÿ](https://kindsonthegenius.com/blog/bias-variance-trade-off-in-classificationmachine-learning/)
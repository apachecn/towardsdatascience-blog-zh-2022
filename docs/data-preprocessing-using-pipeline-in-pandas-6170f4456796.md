# Pandas ä¸­ä½¿ç”¨æµæ°´çº¿çš„æ•°æ®é¢„å¤„ç†

> åŸæ–‡ï¼š<https://towardsdatascience.com/data-preprocessing-using-pipeline-in-pandas-6170f4456796>

## ä½¿ç”¨ç†ŠçŒ«ç®¡é“å‡½æ•°ç¼–å†™æ›´å¥½çš„ä»£ç 

# åŠ¨æœº

ç°å®ç”Ÿæ´»ä¸­çš„æ•°æ®ä¼šç»å†è®¸å¤šé¢„å¤„ç†é˜¶æ®µï¼Œå¦‚è´¨é‡è¯„ä¼°ã€æ¸…æ´—ã€è½¬æ¢ã€å½’çº¦ç­‰ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½¿ç”¨ç†ŠçŒ«æ—¶ï¼Œè¿™äº›æ­¥éª¤çš„æ‰§è¡Œæ–¹å¼å¹¶ä¸æ€»æ˜¯æœ‰æ•ˆçš„ã€‚

å¦‚æœæˆ‘ä»¬èƒ½æœ‰ä¸€ç§æ–¹æ³•ï¼Œèƒ½å¤Ÿä»¥æœ€æœ‰æ•ˆçš„æ–¹å¼åœ¨ä¸€ä¸ªé“¾ä¸­æ‰§è¡Œæ‰€æœ‰çš„å¤„ç†åŠŸèƒ½ï¼Œé‚£ä¼šæ€ä¹ˆæ ·ï¼Ÿè¿™å°±æ˜¯ç†ŠçŒ«çš„`[**Pipe**](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pipe.html)`æ´¾ä¸Šç”¨åœºçš„åœ°æ–¹ã€‚

åœ¨è¿™ç¯‡çŸ­æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†é¦–å…ˆäº†è§£ç†ŠçŒ«çš„çƒŸæ–—æ˜¯ä»€ä¹ˆã€‚ç„¶åï¼Œæˆ‘ä»¬å°†ä»‹ç»å‡ ä¸ªå®è·µæ¡ˆä¾‹æ¥å±•ç¤ºå®ƒçš„ä½œç”¨ã€‚

# å¼€å§‹

åœ¨æœ¬èŠ‚ç»“æŸæ—¶ï¼Œæ‚¨å°†ç†è§£ä»€ä¹ˆæ˜¯`Pipe`ï¼Œç„¶ååœ¨å¯¹æ•°æ®é›†æœ‰äº†ä¸€ä¸ªå¥½çš„æ¦‚å¿µä¹‹åï¼Œå¯¹æˆ‘ä»¬è¯•å›¾è§£å†³çš„ä¸šåŠ¡é—®é¢˜æœ‰ä¸€ä¸ªæ›´å¥½çš„ç†è§£ã€‚

## ä»€ä¹ˆæ˜¯ç®¡é“ï¼Ÿ

Pipe æ˜¯ä¸€ä¸ª Pandas å‡½æ•°ï¼Œç”¨äºé€šè¿‡å°†å‰ä¸€ä¸ªå‡½æ•°çš„ç»“æœä¼ é€’ç»™é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå‡½æ•°æ¥æ‰§è¡Œå¤šä¸ªå‡½æ•°ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ï¼Œå¯ä»¥ä½¿ä»£ç æ›´æ¸…æ™°ï¼Œå¯è¯»æ€§æ›´å¥½ã€‚

ç°åœ¨æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬æ­£åœ¨å¤„ç†ä»€ä¹ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®è·µæ¡ˆä¾‹çš„æ•°æ®é›†ã€‚

## è®©æˆ‘ä»¬åˆ›å»ºæ•°æ®é›†

è¿™ä¸ªæ•°æ®é›†å¯èƒ½å¯¹æ‹›è˜ç»ç†æ›´æœ‰æ„ä¹‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ ä¸æ˜¯ï¼Œå°±ä¸ç”¨æ‹…å¿ƒğŸ˜€ã€‚åŸºæœ¬ä¸Šï¼Œå®ƒå­˜å‚¨äº†æ¥è‡ªä¸åŒéæ´²å¤§åŸå¸‚çš„ç”³è¯·äººçš„ä¿¡æ¯ã€‚æ­£å¦‚æ‚¨åœ¨ä¸‹é¢çœ‹åˆ°çš„ï¼Œå¤§å¤šæ•°åˆ—éƒ½æ˜¯ä¸è¨€è‡ªæ˜çš„ã€‚

pipe _ candidates.py

![](img/e406cfe46fb881768cc8fbbf91d0e820.png)

å€™é€‰äººçš„åŸå§‹ä¿¡æ¯(å›¾ç‰‡ç”±ä½œè€…æä¾›)

*   `Full_Name`æ˜¯å€™é€‰äººçš„å…¨åã€‚
*   `Degree`æ˜¯ç”³è¯·æœŸé—´è€ƒç”Ÿçš„å­¦ä½ã€‚
*   `From`å¯¹åº”äºå€™é€‰äººæ¥è‡ªå“ªé‡Œã€‚
*   `Application_date`æ˜¯å€™é€‰äººç”³è¯·èŒä½çš„æ—¶é—´ã€‚
*   `From_office (min)`æ˜¯åˆ°æ±‚èŒè€…æ‰€åœ¨åŸå¸‚çš„å…¬å¸åŠå…¬å®¤çš„é€šå‹¤æ—¶é—´(ä»¥åˆ†é’Ÿä¸ºå•ä½)ã€‚

## é—®é¢˜é™ˆè¿°

åŸºäºè¿™äº›ä¿¡æ¯ï¼Œæ‹›è˜ç»ç†å¸Œæœ›æ‚¨ä½œä¸ºæ•°æ®ç§‘å­¦å®¶åˆ›å»ºä¸‹è¡¨ï¼Œä»¥å¸®åŠ©ä»–è·å¾—å…³äºæ¯ä¸ªå€™é€‰äººçš„æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚

![](img/8659d8145903b1ad95a966dc48bdd429.png)

åŸºäºä¸šåŠ¡éœ€æ±‚çš„æœ€ç»ˆé¢„æœŸè¡¨æ ¼(å›¾ç‰‡ç”±ä½œè€…æä¾›)

## ä½¿ç”¨ç®¡é“å‰çš„ç‹¬ç«‹é¢„å¤„ç†

åœ¨å¼„è„æˆ‘ä»¬çš„æ‰‹ä¹‹å‰è¿˜æœ‰ä¸€ä»¶äº‹ï¼æˆ‘ä»¬éœ€è¦ä¸ºå›¾åƒä¸­æ˜¾ç¤ºçš„æ¯ä¸ªä»»åŠ¡å®ç°ç›¸åº”çš„åŠŸèƒ½ã€‚æœ¬èŠ‚çš„ç›®æ ‡æ˜¯åœ¨ä½¿ç”¨ Pipe è·å¾—æœ€ç»ˆç»“æœä¹‹å‰ï¼Œä»¥ç‹¬ç«‹çš„æ–¹å¼æ‰§è¡Œæ¯ä¸ªä»»åŠ¡çš„ç»“æœã€‚

**â†’ä»»åŠ¡ 1:å…¨åä¸­çš„åå’Œå§“:**å…¨åçš„æ ¼å¼å¦‚ä¸‹[å][é€—å·][å§“]ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°æ¥å®Œæˆè¿™é¡¹å·¥ä½œã€‚

ç»“æœ _ ä»»åŠ¡ 1.py

ä»ç¬¬ 11 è¡Œï¼Œæˆ‘ä»¬ä»ä»»åŠ¡ 1 çš„æ‰§è¡Œä¸­å¾—åˆ°ä»¥ä¸‹ç»“æœã€‚

![](img/2e09c89ed3fc0c123be8d55759c5c2de.png)

ä»»åŠ¡ 1:ä»å…¨ååˆ°åå’Œå§“(å›¾ç‰‡ç”±ä½œè€…æä¾›)

**â†’ä»»åŠ¡ 2:** æˆ‘ä»¬è¦ä»ç”³è¯·æ—¥æœŸï¼Œæ—¥ï¼Œæœˆï¼Œå¹´ï¼Œæ˜ŸæœŸå‡ ï¼Œå¹´ä¸­çš„æœˆã€‚

ç»“æœ _ ä»»åŠ¡ 2.py

ä»ç¬¬ 15 è¡Œï¼Œæˆ‘ä»¬ä»ä»»åŠ¡ 2 çš„æ‰§è¡Œä¸­å¾—åˆ°ä»¥ä¸‹ç»“æœã€‚

![](img/882e93daeccb3cba141e11743bae1eeb.png)

ä»»åŠ¡ 2:ä»ç”³è¯·æ—¥æœŸåˆ°æ›´è¯¦ç»†çš„æ—¶é—´ä¿¡æ¯(å›¾ç‰‡ç”±ä½œè€…æä¾›)

**â†’ä»»åŠ¡ 2:** è®©ä½ çš„æ‹›è˜ç»ç†æ»¡æ„çš„æœ€åä¸€ä¸ªä»»åŠ¡æ˜¯ä¸ºæ¯ä¸ªå€™é€‰äººåˆ›å»ºä¸€æ¡å¦‚ä¸‹æ ¼å¼çš„æ–‡æœ¬ä¿¡æ¯ï¼Œå…¶ä¸­[å€™é€‰äºº]æ˜¯å€™é€‰äººçš„å…¨å:

> [å€™é€‰äºº]æ‹¥æœ‰[å­¦ä½]ï¼Œä½åœ¨ç¦»åŠå…¬å®¤[From_office (min)]çš„åœ°æ–¹ã€‚

ç»“æœ _ ä»»åŠ¡ 3.py

![](img/d0e4b8e2a9e5b8b108fd319ffab61b42.png)

ä»»åŠ¡ 2:ä»æ‰€æœ‰æ ç›®ä¸­ç”Ÿæˆå€™é€‰äººä¿¡æ¯(å›¾ç‰‡ç”±ä½œè€…æä¾›)

## å‡½æ•°ä¸ç®¡é“é“¾æ¥

æ—¢ç„¶æˆ‘ä»¬å·²ç»çŸ¥é“äº†æ¯ä¸ªå‡½æ•°çš„å·¥ä½œåŸç†ä»¥åŠå®ƒä»¬çš„é¢„æœŸç»“æœï¼Œé‚£ä¹ˆæ˜¯æ—¶å€™ä½¿ç”¨ Pipe å°†å®ƒä»¬å…¨éƒ¨åˆå¹¶åˆ°ä¸€ä¸ªç®¡é“ä¸­äº†ã€‚ä½¿ç”¨ Pipe ä¸éœ€è¦é¢å¤–çš„åº“ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ª Pandas å†…ç½®å‡½æ•°ï¼Œä¸€èˆ¬è¯­æ³•å¦‚ä¸‹:

```
final_dataset = (my_original_data.
                 pipe(my_first_function, "single_column").
                 pipe(my_second_function, "[col1, ...colN]").
                 pipe(my_third_function).
                 ...
                 pipe(my_nth_function)
                 )
```

*   `final_dateset`æ˜¯åº”ç”¨æ‰€æœ‰å‡½æ•°åçš„æœ€ç»ˆé¢„å¤„ç†æ•°æ®é›†ã€‚
*   `my_original_data`æ˜¯åŸå§‹æ•°æ®é›†ã€‚
*   `pipe(my_first_function, "single_column")`æ„å‘³ç€`my_first_function`éœ€è¦`single_column`æ¥å®Œæˆä»»åŠ¡ã€‚
*   `pipe(my_second_function, "[col1, ..., colN]")`è¡¨ç¤º`my_second_function`éœ€è¦`[col1, ..., colN]`å®Œæˆä»»åŠ¡ã€‚
*   `pipe(my_second_function,)`æ„å‘³ç€ä¸éœ€è¦æŒ‡å®šåˆ—åã€‚

ä¸‹é¢æ˜¯å‰é¢æ ¼å¼å¯¹åº”çš„ç®¡é“é€»è¾‘ã€‚è¯·æ³¨æ„ï¼Œåœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œé¡ºåºå¹¶ä¸é‡è¦ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦åå­—å’Œå§“æ°æ¥è®¡ç®— Info åˆ—ï¼Œè¿™æ˜¯å¯èƒ½çš„ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬åœ¨è¿™é‡Œæ‰€åšçš„ï¼Œå› ä¸ºæˆ‘ä»¬ç›´æ¥ä½¿ç”¨å…¨åã€‚

åˆ›å»º _ ç®¡é“. py

![](img/b0d44a336c1d01530635e4d1eb8f0053.png)

ä½¿ç”¨ Pipe å°† 1 åˆ° 3 çš„æ‰€æœ‰ä»»åŠ¡ç»„åˆåœ¨ä¸€èµ·çš„æœ€ç»ˆç»“æœ(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# ç»“è®º

æ­å–œä½ ï¼ğŸ‰ ğŸ¾æ‚¨åˆšåˆšå­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ Pandas Pipe è¿›è¡Œå¤šåŠŸèƒ½é“¾æ¥ï¼æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« æ˜¯æœ‰å¸®åŠ©çš„ï¼Œå®ƒå°†å¸®åŠ©æ‚¨æŠŠé¢„å¤„ç†ä»»åŠ¡æé«˜åˆ°ä¸€ä¸ªæ–°çš„æ°´å¹³ã€‚

æ­¤å¤–ï¼Œå¦‚æœä½ å–œæ¬¢é˜…è¯»æˆ‘çš„æ•…äº‹ï¼Œå¹¶å¸Œæœ›æ”¯æŒæˆ‘çš„å†™ä½œï¼Œå¯ä»¥è€ƒè™‘[æˆä¸ºä¸€ä¸ªåª’ä½“æˆå‘˜](https://zoumanakeita.medium.com/membership)ã€‚æ¯æœˆæ”¯ä»˜ 5 ç¾å…ƒï¼Œä½ å°±å¯ä»¥æ— é™åˆ¶åœ°é˜…è¯»åª’ä½“ä¸Šçš„æ•…äº‹ã€‚

æ¬¢è¿åœ¨[åª’ä½“](https://zoumanakeita.medium.com/)ã€[æ¨ç‰¹](https://twitter.com/zoumana_keita_)å’Œ [YouTube](https://www.youtube.com/channel/UC9xKdy8cz6ZuJU5FTNtM_pQ) ä¸Šå…³æ³¨æˆ‘ï¼Œæˆ–è€…åœ¨ [LinkedIn](https://www.linkedin.com/in/zoumana-keita/) ä¸Šé—®å¥½ã€‚è®¨è®ºäººå·¥æ™ºèƒ½ã€äººå·¥æ™ºèƒ½ã€æ•°æ®ç§‘å­¦ã€è‡ªç„¶è¯­è¨€å¤„ç†å’Œäººå·¥æ™ºèƒ½æ˜¯ä¸€ç§ä¹è¶£ï¼

**é“¾æ¥åˆ°æºä»£ç â†’** [**æ­¤å¤„**](https://github.com/keitazoumana/Medium-Articles-Notebooks/blob/main/Pandas_Pipe.ipynb)

å†è§ğŸƒğŸ¾â€â™‚ï¸
# åœ¨ä»»æ„å°ºåº¦çš„ç¥ç»ç½‘ç»œè®­ç»ƒä¸­å¯è§†åŒ–åå‘ä¼ æ’­

> åŸæ–‡ï¼š<https://towardsdatascience.com/visualizing-backpropagation-in-neural-network-training-2647f5977fdb>

# åœ¨ä»»æ„å°ºåº¦çš„ç¥ç»ç½‘ç»œè®­ç»ƒä¸­å¯è§†åŒ–åå‘ä¼ æ’­

## ä½¿ç”¨ HiPlot ç”Ÿæˆå¹³è¡Œåæ ‡å›¾æ¥å¯è§†åŒ–æ·±åº¦å­¦ä¹ æ¨¡å‹è®­ç»ƒã€‚

![](img/8b744e4f36364951c001845ac7cb1025.png)

ä¸€ä¸ªå¹³è¡Œåæ ‡å›¾æ¥å¯è§†åŒ– ML è®­ç»ƒ(å›¾ç‰‡ç”±ä½œè€…æä¾›)

ç†è§£å’Œè°ƒè¯•ç¥ç»ç½‘ç»œåœ¨æ•°æ®é›†ä¸Šçš„æ€§èƒ½æ˜¯æœºå™¨å­¦ä¹ (ML)æ¨¡å‹çš„ç«¯åˆ°ç«¯ç”Ÿå‘½å‘¨æœŸä¸­çš„å…³é”®ä¸€ç« ã€‚æœ‰èƒ½åŠ›ç†è§£ä¸€ä¸ªæ¨¡å‹æ˜¯å¦‚ä½•è¢«è®­ç»ƒçš„ï¼Œå¯ä»¥æä¾›æœ‰ä»·å€¼çš„æ´å¯ŸåŠ›ï¼Œå»å‘ç°å“ªé‡Œå¯ä»¥è¢«æ”¹è¿›ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç®€å•è€Œæœ‰æ•ˆçš„æ–¹æ³•ï¼Œåœ¨ç¥ç»ç½‘ç»œè®­ç»ƒæœŸé—´å¯è§†åŒ–ä¸€ä¸ªç§°ä¸º[åå‘ä¼ æ’­](/understanding-backpropagation-algorithm-7bb3aa2f95fd)çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨çš„å¯è§†åŒ–æŠ€æœ¯è¢«ç§°ä¸º[å¹³è¡Œåæ ‡å›¾](https://www.data-to-viz.com/graph/parallel.html)ã€‚è¿™é€šå¸¸æ˜¯ä¸€ç§ç”¨äºä»å¤šä¸ªæ•°æ®ç‚¹ä»¥ä¸åŒçš„å•ä½æˆ–ç±»å‹å¯è§†åŒ–è®¸å¤šä¸åŒç‰¹å¾çš„æŠ€æœ¯ã€‚ä¸‹é¢æ˜¯æœ¬æ–‡å…¶ä½™éƒ¨åˆ†çš„æ¦‚è¦:

1.  ç†è§£è¯„ä¼°æ·±åº¦å­¦ä¹ æ¨¡å‹çš„é‡è¦æ€§
2.  å»ºç«‹åŸºç¡€
3.  ç”Ÿæˆå¯è§†åŒ–

# 1.ç†è§£è¯„ä¼°æ·±åº¦å­¦ä¹ æ¨¡å‹çš„é‡è¦æ€§

![](img/f6fb02e3ea4faf4fe9ede7be325bfd55.png)

æ±‰æ–¯Â·é›·å°¼å°”æ–¯åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) æ‹æ‘„çš„ç…§ç‰‡

æ·±åº¦å­¦ä¹ æ¨¡å‹åœ¨ç°å®ä¸–ç•Œä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨ï¼Œä»æ¬ºè¯ˆæ£€æµ‹åˆ°è‡ªåŠ¨é©¾é©¶æ±½è½¦ã€‚è¿™äº›åº”ç”¨é€šå¸¸ä¼šå½±å“æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ã€‚å½“ä¸€ä¸ªæ¨¡å‹è¢«æ‰©å±•ä»¥ä¾›æ•°ç™¾ä¸‡ç”¨æˆ·æ¯å¤©ä½¿ç”¨æ•°ç™¾ä¸‡æ¬¡æ—¶ï¼Œæ¨¡å‹æŒ‡æ ‡çš„å¾®å°æ”¹è¿›å¯èƒ½ä¼šå¯¼è‡´æ•´ä½“æ¨¡å‹æ€§èƒ½çš„æ˜¾è‘—æ”¹è¿›ã€‚

é€šè¿‡ä½¿ç”¨å¯è§†åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ·±å…¥åœ°ç†è§£æˆ‘ä»¬çš„æ¨¡å‹åœ¨æ¯ä¸ª[æ—¶æœŸ](https://deepai.org/machine-learning-glossary-and-terms/epoch)çš„è®­ç»ƒå’Œè¡¨ç°ã€‚æˆ‘ä»¬å¯¹æ¨¡å‹äº†è§£å¾—è¶Šå¤šï¼Œæˆ‘ä»¬åœ¨é€‰æ‹©æ¨¡å‹æ—¶å°±èƒ½åšå‡ºæ›´æ¸…æ™°çš„å†³ç­–ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨æ­¤ä¿¡æ¯æ¥äº†è§£æˆ‘ä»¬çš„æ¨¡å‹æ˜¯å¦åŸºäºæ‰€ä½¿ç”¨çš„è¯„ä¼°åº¦é‡è¿‡æ‹Ÿåˆæˆ–æ¬ æ‹Ÿåˆï¼Œè¿™æœ‰åŠ©äºè°ƒæ•´è¶…å‚æ•°ã€‚

# 2.å»ºç«‹åŸºç¡€

![](img/8e5cf1ac1d1a1b7f1a3117d7ecea5717.png)

ç…§ç‰‡ç”±[è‰¾è’‚å®‰Â·å‰æ‹‰å°”ä»£](https://unsplash.com/@etiennegirardet?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) æ‹æ‘„

æ—¢ç„¶æˆ‘ä»¬ç†è§£äº†å¯è§†åŒ–æ¨¡å‹è®­ç»ƒå¯ä»¥æä¾›çš„å¥½å¤„ï¼Œè®©æˆ‘ä»¬å¼€å§‹æ„å»ºå§ï¼è¿™ä¸ªä¾‹å­å°†ä½¿ç”¨ Python ç‰ˆã€‚

æˆ‘ä»¬å°†ä»å¯¼å…¥ Python ä¾èµ–é¡¹å¼€å§‹:

```
import tensorflow as tffrom keras import layers
from keras import models
```

å¯¹äºè¿™ä¸ªç¤ºä¾‹æ¨¡å‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨[1] [**Keras Boston Housing æ•°æ®é›†**](https://keras.io/api/datasets/boston_housing/) ã€‚è¯¥æ•°æ®é›†åŒ…å«æ³¢å£«é¡¿å‘¨å›´æˆ¿å±‹çš„ 13 ä¸ªè¦ç´ ï¼Œç›®æ ‡å€¼æ˜¯æˆ¿å±‹çš„ä»·å€¼ã€‚è¦ä¸‹è½½å’ŒåŠ è½½æ•°æ®ï¼Œè¯·æ·»åŠ ä»¥ä¸‹å‡ è¡Œ:

```
# Download dataset
dataset = tf.keras.datasets.boston_housing# Test train split
(x_train, y_train), (x_test, y_test) = dataset.load_data()# Normalize data using training data
mean = train_data.mean(axis=0)
train_data -= mean
std = train_data.std(axis=0)
train_data /= std

test_data -= mean
test_data /= std
```

æ—¢ç„¶æ•°æ®å·²ç»å‡†å¤‡å¥½è¿›è¡Œè®­ç»ƒï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥æ„å»ºæˆ‘ä»¬çš„å‡†ç³»ç»Ÿç¥ç»ç½‘ç»œã€‚

```
def build_model(): model = models.Sequential() model.add(layers.Dense(64, activation='relu',
              input_shape=(x_train.shape[1],))) model.add(layers.Dense(64, activation='relu')) model.add(layers.Dense(1)) model.compile(optimizer='rmsprop', loss='mse', metrics=['mae']) return model
```

æœ€åï¼Œè®©æˆ‘ä»¬è®­ç»ƒæ¨¡å‹ï¼

```
num_epochs = 18model = build_model()model_history = model.fit(x_train, y_train, epochs=num_epochs, batch_size=16, verbose=0)test_mse_score, test_mae_score = model.evaluate(x_test, y_test)print(test_mae_score)
```

è¿™é‡Œçš„æ¨¡å‹ä½¿ç”¨å¹³å‡ç»å¯¹è¯¯å·®ä½œä¸ºè¯„ä¼°æ ‡å‡†ã€‚MAE å¯ä»¥ç”¨æ¥è¯„ä¼°æˆ‘ä»¬çš„æ¨¡å‹æœ‰å¤šç²¾ç¡®ï¼Œå¹¶ä¸”å¯ä»¥ç»™å‡ºæ€§èƒ½çš„æ„Ÿè§‰ã€‚MAE åˆ†æ•°å°†æ€»æ˜¯æ­£æ•°ï¼Œåˆ†æ•°è¶Šæ¥è¿‘ 0ï¼Œæ¨¡å‹çš„æ€§èƒ½è¶Šå¥½ã€‚MAE å¯ä»¥é€šè¿‡å–è¯¯å·®çš„å¹³å‡å€¼æ¥è®¡ç®—ã€‚å–é¢„æµ‹å€¼å‡å»å®é™…å€¼çš„ç»å¯¹å€¼ï¼Œå–æ‰€æœ‰è¿™äº›æ•°å€¼çš„å’Œï¼Œæœ€åé™¤ä»¥æ•°æ®ç‚¹çš„æ€»æ•°ï¼ŒğŸ‰ä½ å¾—åˆ°äº†ä½ çš„æ¢…åˆ†æ•°ã€‚

![](img/69e06f85f65d7fe65580a30b66b586e5.png)

è®¡ç®— MAE(ä½œè€…å›¾ç‰‡)çš„å…¬å¼

# 3.ç”Ÿæˆå¯è§†åŒ–

![](img/21a9d49484d93d0107eca27b3f426e80.png)

ç…§ç‰‡ç”± [Isaac Smith](https://unsplash.com/@isaacmsmith?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

ç°åœ¨æ˜¯æœ€ç²¾å½©çš„éƒ¨åˆ†ï¼è®©æˆ‘ä»¬é€šè¿‡ç”Ÿæˆä¸€ä¸ªå¹³è¡Œå›¾æ¥ç›´è§‚åœ°è§‚å¯Ÿæˆ‘ä»¬çš„åŸºçº¿ç¥ç»ç½‘ç»œåœ¨æ¯ä¸ªæ—¶æœŸçš„æ¨¡å‹è®­ç»ƒæƒ…å†µï¼

ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨è„¸ä¹¦çš„å¼€æº HiPlot åº“ã€‚ **HiPlot** æ˜¯ä¸€ä¸ªè½»é‡çº§å·¥å…·ï¼Œèƒ½å¤Ÿæ ¹æ®æä¾›çš„æ•°æ®è½»æ¾å¿«é€Ÿåœ°ç”Ÿæˆå¹³è¡Œåæ ‡å›¾ã€‚è¿™æ˜¯å¹¶æ’æ˜¾ç¤ºå¤šä¸ªè¦ç´ ä»¥ç›´è§‚åˆ†ææ•°æ®å¤–è§‚çš„ä¸€ç§éå¸¸æ–¹ä¾¿çš„æ–¹å¼ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æå–çš„å…³äºæ¨¡å‹è®­ç»ƒçš„å…ƒæ•°æ®æ¥éå¸¸å¿«é€Ÿåœ°åˆ›å»ºä»¤äººæƒŠå¹çš„äº¤äº’å¼å¯è§†åŒ–ã€‚å…³äº HiPlot çš„æ›´å¤šä¿¡æ¯å¯ä»¥åœ¨ [HiPlot Github åº“](https://github.com/facebookresearch/hiplot)ä¸Šæ‰¾åˆ°ã€‚

è¦ç”Ÿæˆå¯è§†åŒ–ï¼Œé¦–å…ˆéœ€è¦ä¸º HiPlot å®‰è£…ä¸€ä¸ª Python ä¾èµ–é¡¹:

```
pip install -U hiplot
```

æ¥ä¸‹æ¥ï¼Œæ‚¨éœ€è¦å¯¼å…¥ HiPlot å¹¶ä½¿ç”¨å‡½æ•°æ¥ç”Ÿæˆç»˜å›¾ã€‚

```
import hiplot as hipdata = [{'epoch': idx,
         'loss': model_history.history['loss'][idx], 
         'mae': model_history.history['mae'][idx]}
       for idx in range(num_epochs)]
hip.Experiment.from_iterable(data).display()
```

ä¸Šé¢çš„ä»£ç å°†ä½¿ç”¨ Keras model.fit()æ–¹æ³•çš„è¿”å›å€¼å°†æ¨¡å‹å†å²åŠ è½½åˆ° HiPlot ä¸­ï¼Œä»¥ä¾¿è¿›è¡Œå¯è§†åŒ–å’Œäº¤äº’ã€‚

![](img/654b72d1fdb7f149c86080b2a242a424.png)

ä¸ HiPlot ç”Ÿæˆçš„å¹³è¡Œå›¾äº¤äº’(å›¾ç‰‡ç”±ä½œè€…æä¾›)

ğŸ‰æ­å–œä½ å»ºç«‹äº†ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå¹¶ç”¨ HiPlot ç”Ÿæˆçš„å¹¶è¡Œå›¾å¯è§†åŒ–äº†åå‘ä¼ æ’­è¿‡ç¨‹ï¼æ‚¨ä¼šæ³¨æ„åˆ°ï¼Œå¯¹äºæ¯ä¸ªæ—¶æœŸï¼ŒMAE å¾—åˆ†é€æ¸å˜å¾—æ›´å¥½ï¼Œç°åœ¨æˆ‘ä»¬èƒ½å¤Ÿåˆ†æå¹¶ä¸è¿™äº›æ•°æ®è¿›è¡Œäº¤äº’ï¼ŒåŒæ—¶æŸ¥çœ‹æ‹Ÿåˆåœ¨ç¡®åˆ‡æ—¶æœŸé€æ¸å‡å¼±çš„ä½ç½®ã€‚

é€šè¿‡è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆ›å»ºè¿™äº›äº¤äº’å¼å¯è§†åŒ–çš„å¯è¡Œæ€§å’Œæ— ç¼æ€§ï¼ŒåŒæ—¶è¿˜å¯ä»¥é€šè¿‡åˆ©ç”¨è®­ç»ƒå†å²æ•°æ®æ¥æ·±å…¥äº†è§£æ¨¡å‹åœ¨è®­ç»ƒæœŸé—´çš„è¿è¡Œæƒ…å†µã€‚ä½¿ç”¨ HiPlot çš„æœ€å¤§ä¼˜åŠ¿ä¹‹ä¸€**æ˜¯æ‚¨å¯ä»¥æ·»åŠ è®¸å¤šå…¶ä»–å±æ€§æ¥æ‰©å±•åˆ°å¯è§†åŒ–ä¸­ï¼Œä»¥ç»˜åˆ¶æ›´å¥½çš„å›¾ç‰‡ï¼Œè€Œæ— éœ€æ˜¾è‘—å¢åŠ è®¡ç®—èƒ½åŠ›éœ€æ±‚ã€‚**

# å‚è€ƒ

[1]æ³¢å£«é¡¿ä½æˆ¿æ•°æ®é›†:[https://keras.io/api/datasets/boston_housing/](https://keras.io/api/datasets/boston_housing/)

Harrison d .å’Œ Rubin feld d . l .â€˜[äº«ä¹ä»·æ ¼å’Œå¯¹æ¸…æ´ç©ºæ°”çš„éœ€æ±‚](https://www.law.berkeley.edu/files/Hedonic.PDF)â€™(1978)ï¼ŒJ. Environã€‚ç»æµå­¦&ç®¡ç†å­¦ï¼Œç¬¬ 5 å·ï¼Œ81â€“102 é¡µ
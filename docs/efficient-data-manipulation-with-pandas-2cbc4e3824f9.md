# ç†ŠçŒ«çš„é«˜æ•ˆæ•°æ®æ“ä½œ

> åŸæ–‡ï¼š<https://towardsdatascience.com/efficient-data-manipulation-with-pandas-2cbc4e3824f9>

## åœæ­¢ç”¨ä¼ ç»Ÿçš„æ–¹å¼ä½¿ç”¨ç†ŠçŒ«ï¼Œç”¨â€œç®¡é“â€ä»£æ›¿

## å­¦ä¹ åœ¨ç†ŠçŒ«ä¸­ä½¿ç”¨ç®¡é“è¿›è¡Œæ•°æ®æ“ä½œ

![](img/095e8c13352a6c0e489816c5ead7209b.png)

èµ„æ–™æ¥æº:Unsplashï¼ŒLars Kienle

æˆ‘ä»¬éƒ½åœ¨ç”¨ç†ŠçŒ«ã€‚å®ƒæ˜¯å‡ ä¹æ¯ä¸ªä½¿ç”¨ python çš„åˆ†æå¸ˆçš„é¦–é€‰å·¥å…·ã€‚æˆ‘ä»¬ä¸­çš„è®¸å¤šäººå·²ç»æŒæ¡äº†æ•°æ®å¤„ç†çš„è‰ºæœ¯ã€‚æˆ‘å¯¹æˆ‘æ‰€çŸ¥é“çš„å…³äºç†ŠçŒ«çš„çŸ¥è¯†å’Œæˆ‘åº”ç”¨çŸ¥è¯†çš„æ–¹å¼éå¸¸æ»¡æ„ï¼Œç›´åˆ°æˆ‘çœ‹åˆ°äº†é©¬ç‰¹Â·å“ˆé‡Œæ£®å†™çš„ä¸€æœ¬ä¹¦ã€‚è¿™æœ¬ä¹¦æ”¹å˜äº†æˆ‘ç†ŠçŒ«çš„ç”Ÿæ´»ã€‚æˆ‘è§‰å¾—æˆ‘ä¸€ç›´ä»¥æ¥éƒ½è¢«èƒŒå›äº†ğŸ˜…åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†åˆ†äº«å‡ ä»¶æˆ‘å­¦åˆ°å¹¶ç«‹å³çˆ±ä¸Šå®ƒä»¬çš„äº‹æƒ…ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ã€‚

## ä¸€äº›æˆ‘ä»¬å–œæ¬¢çš„ä»»åŠ¡

åœ¨æ“ä½œæ•°æ®æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ä»¥ä¸‹æ“ä½œ:

1ï¸âƒ£:åˆ—é€‰æ‹©
2ï¸âƒ£:è¿‡æ»¤æ•°æ®
3ï¸âƒ£:æ›´æ”¹åˆ—
4ï¸âƒ£:åˆ›å»ºæ–°åˆ—
5ï¸âƒ£:åº”ç”¨è‡ªå®šä¹‰å‡½æ•°
6ï¸âƒ£:èšåˆæ•°æ®
7ï¸âƒ£:è¿æ¥æ•°æ®
8ï¸âƒ£:å¯è§†åŒ–æ•°æ®

è¿™ç»å¯¹ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„åˆ—è¡¨ï¼Œä½†ç°åœ¨è¶³å¤Ÿäº†ã€‚ä½ ä¸€å®šæ³¨æ„åˆ°äº†ä¸Šé¢ä»»åŠ¡ä¸­çš„ç­‰çº§ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä»¥æœ‰åºçš„æ–¹å¼åº”ç”¨è¿™äº›ä»»åŠ¡ã€‚åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡é¡ºåˆ©ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬é€šå¸¸å€¾å‘äºå•ç‹¬æ‰§è¡Œè¿™äº›ä»»åŠ¡ï¼Œå³ä½¿æ‚¨å°†è¿™äº›ä»»åŠ¡æ”¾åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ã€‚æˆ‘ä»¬ç¼ºå°‘çš„æ˜¯â€œç®¡é“â€ã€‚

â€œç®¡é“â€çš„ç›®çš„æ˜¯å°†è¿™äº›ä»»åŠ¡ç¼åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä»¥ä¸€ç§å†…å­˜é«˜æ•ˆçš„æ–¹å¼è®¡ç®—å®ƒä»¬ã€‚è¿™æœ¬èº«å°±æ˜¯ä¸€ä¸ªå·¨å¤§çš„ä¼˜åŠ¿ã€‚ç„¶è€Œï¼Œå¯¹æˆ‘æ¥è¯´ï¼Œç®¡é“æœ€å¤§çš„å¥½å¤„æ˜¯ä»£ç çš„â€œå¯è¯»æ€§â€ã€‚é‚£ä¹ˆè¿™ä¸ªâ€œç®¡é“â€æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

> æœ€åæœ‰ä¸€ä¸ªå®Œæ•´çš„å¯å¤åˆ¶çš„ä»£ç ç¤ºä¾‹ã€‚åªéœ€æµè§ˆæµç¨‹çš„è™šæ‹Ÿä»£ç ç‰‡æ®µ(ç°è‰²çš„)ã€‚

## ç®¡é“

è¦æ„å»ºç®¡é“ï¼Œæ‚¨å®é™…ä¸Šä¸å¿…å»ä»»ä½•å…¶ä»–ç‰¹å®šçš„åº“ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†æ•°æ®å¸§åŒ…è£…åœ¨ä¸€ä¸ªå…ƒç»„ä¸­æ¥å¼€å§‹ä½¿ç”¨ç®¡é“ï¼Œå°±åƒè¿™æ ·:

```
import pandas as pd# read the data
df = read_csv("some_data.csv")
# make a pipeline
( 
  df
)
```

å¦‚æœæ‚¨æ‰§è¡Œä»£ç ï¼Œè¿™å°†æ˜¾ç¤º`df`æ•°æ®å¸§ã€‚æ²¡ä»€ä¹ˆç‰¹åˆ«çš„ã€‚ç„¶è€Œï¼Œè¿™å°±æ˜¯ä¹è¶£çš„å¼€å§‹ã€‚åœ¨åœ†æ‹¬å·å†…ï¼Œåœ¨`df`ä¸‹é¢ï¼Œä½ å¯ä»¥å¼€å§‹è°ƒç”¨æ‰€æœ‰ä½ å–œæ¬¢çš„æ–¹æ³•ï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªï¼ŒæŒ‰ç…§ä½ æƒ³è¦çš„é¡ºåºã€‚è®©æˆ‘ä»¬è¯•ä¸€è¯•ã€‚

```
(
  df
  # select few columns
  [['column_a','column_b','column_c']]
  # filter the data where column_a's values are green & blue
  .query(" column_a == ['green','blue']")
  # check the first 5 rows of the data
  .head())
```

å¦‚æœè¿è¡Œæ­¤ä»£ç ï¼Œæ‚¨å°†çœ‹åˆ°æ•°æ®æ¡†çš„å‰äº”è¡Œï¼Œå…±ä¸‰åˆ—ï¼ŒåŒ…å«â€œcolumn_aâ€å€¼ä¸ºâ€œç»¿è‰²â€æˆ–â€œè“è‰²â€çš„è®°å½•ã€‚è¿™æ­£æ˜¯ä½ ç‚¹çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬è¿è¡Œå¹¶æ£€æŸ¥`df`ï¼Œæˆ‘ä»¬ä¼šå‘ç°`df`ä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç”Ÿï¼Œæˆ‘ä»¬æ‰€åšçš„æ‰€æœ‰æ›´æ”¹éƒ½åº”ç”¨åˆ°å†…å­˜ä¸­ï¼Œå¹¶ä¸`df`åˆ†å¼€ä¿å­˜ã€‚å¤ªæ£’äº†ğŸ˜®ã€‚è¿™ç§æ–¹æ³•çš„ä¸€äº›å¥½å¤„æ˜¯:

ğŸ‘‰:ä»£ç å¯è¯»æ€§å¾ˆå¼º
ğŸ‘‰:ä»£ç çµæ´»ï¼Œæ›´æ”¹éå¸¸å®¹æ˜“å®ç°
ğŸ‘‰:æˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºä¿®æ”¹æ•°æ®å¸§çš„å•ç‹¬å¼•ç”¨
ğŸ‘‰:å†…å­˜æ•ˆç‡é«˜
ğŸ‘‰:åŸå§‹æ•°æ®å¸§ä¿æŒä¸å˜

## å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„

åœ†æ‹¬å·ä¸­çš„æ¯ä¸€è¡Œéƒ½æ˜¯ç®¡é“ä¸­çš„ä¸€ä¸ªâ€œæ­¥éª¤â€ã€‚æµæ°´çº¿çš„ç¬¬ä¸€æ­¥å¿…é¡»æ˜¯æ•°æ®å¸§ã€‚æ¯ä¸€æ­¥éƒ½å¿…é¡»ä»å•ç‹¬çš„ä¸€è¡Œå¼€å§‹ã€‚ä½ èµ°çš„æ¯ä¸€æ­¥éƒ½éœ€è¦ä¸€ä¸ªæ•°æ®æ¡†æ¶æ–¹æ³•ï¼Œæ¯”å¦‚`.head()` `.query()` `.tail()` `.merge()`ç­‰ã€‚æ¯ä¸€æ­¥çš„è¾“å‡ºéƒ½æˆä¸ºä¸‹ä¸€æ­¥çš„è¾“å…¥ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæ­¥éª¤`[['column_a','coumn_b'm'column_c']]`çš„è¾“å‡ºæ˜¯åŒ…å«ä¸‰åˆ—çš„æ•°æ®å¸§ã€‚è¿™æˆä¸ºè¿‡æ»¤æ•°æ®çš„`.query()`æ­¥éª¤çš„è¾“å…¥ã€‚è¿‡æ»¤åçš„æ•°æ®æˆä¸º`.head()`æ­¥éª¤çš„è¾“å…¥ï¼Œæœ€åçš„è¾“å‡ºæ˜¾ç¤ºç»™ç”¨æˆ·ã€‚

é‡è¦çš„æ˜¯ä¿æŒè¿™ä¸€åŠ¿å¤´ã€‚æˆ‘çš„æ„æ€æ˜¯ï¼Œæˆ‘ä»¬åº”è¯¥é¿å…åœ¨ç¬¬ä¸€æ­¥ä¹‹åä½¿ç”¨æ•°æ®æ¡†çš„åç§°ã€‚ä¾‹å¦‚ï¼Œæ‚¨æƒ³è¦å¯¹ç°æœ‰çš„åˆ—è¿›è¡Œæ›´æ”¹ã€‚æˆ‘å°†ä½¿ç”¨`.assign()`æ–¹æ³•ï¼Œè¿™æ˜¯åˆ›å»ºæˆ–æ›´æ”¹ç°æœ‰åˆ—çš„æ–¹æ³•ã€‚

è¿™æ˜¯ä½ åº”è¯¥**è€Œä¸æ˜¯**åšçš„:

```
(
df 
# apply a filter
.query("column_a == ['green','blue']")
# make a change to column_a
.assign(column_a = df['column_b'])
)
```

é€šè¿‡å¼•ç”¨`.assign()`æ­¥éª¤ä¸­çš„`df['column_b]`ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨å¼•ç”¨å›`df`çš„åŸå§‹çŠ¶æ€(å³å®ƒåœ¨ç¬¬ä¸€æ­¥æ—¶çš„çŠ¶æ€)ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸æƒ³è¦çš„ã€‚æˆ‘ä»¬æƒ³è¦çš„æ˜¯ä»…åœ¨æˆ‘ä»¬å°†è¿‡æ»¤å™¨åº”ç”¨åˆ°`column_a`(è¿‡æ»¤æ•°æ®çš„`.query()`æ­¥éª¤çš„è¾“å‡º)ä¹‹åæ”¹å˜`column_a`ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†åœ¨`assign()`æ­¥éª¤ä¸­ä½¿ç”¨ä¸€ä¸ªå‡½æ•°(æ¯”å¦‚ lambda)ã€‚è¿™å°±æ˜¯æˆ‘ä»¬**åº”è¯¥**åšçš„:

```
(
df 
# apply a filter
.query("column_a == ['green','blue']")
# make a change to column_a
.assign(column_a = lambda x: x['column_b])
)
```

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œlambda å‡½æ•°ä¸­çš„å‚æ•°`x`å¼•ç”¨çš„æ˜¯`.query()`æ­¥éª¤çš„è¾“å‡ºï¼Œè€Œä¸æ˜¯åŸæ¥çš„`df`ï¼Œæ­£å¦‚æˆ‘ä»¬æ‰€å¸Œæœ›çš„é‚£æ ·ã€‚

**æœ€åä¸€éƒ¨åˆ†**

åœ¨æˆ‘ä»¬è¿›è¡Œæœ€åä¸€ä¸ªå¯é‡å¤çš„ä¾‹å­ä¹‹å‰ï¼Œæˆ‘éœ€è¦å‘æ‚¨ä»‹ç»ä¸€ä¸ªé‡è¦çš„æ–¹æ³•ï¼Œ`.pipe()`æ–¹æ³•ã€‚å¦‚æœæ‚¨æƒ³è¦åº”ç”¨ç†ŠçŒ«æ•°æ®æ¡†å›ºæœ‰çš„ä¸å¯ç”¨æ–¹æ³•(å¦‚è‡ªå®šä¹‰å‡½æ•°)ï¼Œæ­¤æ–¹æ³•éå¸¸æœ‰ç”¨ã€‚`.pipe()`æ–¹æ³•æ¥å—ä¸€ä¸ªå‡½æ•°å’Œè¯¥å‡½æ•°çš„å‚æ•°ã€‚å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°åº”è¯¥æ˜¯æ•°æ®æ¡†ã€‚å‡½æ•°çš„è¾“å‡ºä¹Ÿåº”è¯¥æ˜¯æ•°æ®æ¡†ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­:

```
# define a custom function, first argument as a df. Function
# returns a df.
def some_function(df:pd.DataFrame,column_name:str)->pd.DataFrame:
  new_df = df[column_name]*4/df[column_name]^3
  return new_df# start the pipeline
(
  df
  .pipe(somefunction,"column_c")
  .head()
)
```

ç®€è€Œè¨€ä¹‹ï¼Œ`.pipe()`å°†å¸®åŠ©æˆ‘ä»¬éƒ¨ç½²ä»»ä½•æˆ‘ä»¬æƒ³è¦åº”ç”¨äºæˆ‘ä»¬çš„æ•°æ®æ¡†æ¶çš„å®šåˆ¶è§£å†³æ–¹æ¡ˆ/åŠŸèƒ½ã€‚

**æ€»ç»“**

Pandas piping æ˜¯ä¸€ç§ä¼˜ç§€çš„ã€èŠ‚çœå†…å­˜çš„æ–¹å¼ï¼Œå¯ä»¥ä¸ºæ•°æ®æ“ä½œç¼–å†™æ¸…æ™°å¯è¯»çš„ä»£ç ã€‚å®ƒç®€å•ç›´è§‚ã€‚æ‚¨è¿˜å¯ä»¥å°†æœ€ç»ˆè¾“å‡ºåˆ†é…ç»™å¦ä¸€ä¸ªå˜é‡ï¼Œä¾‹å¦‚

```
df_1 = (
         df
         .query("column_a == 'blue'")
         )
```

æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠç®¡é“åŒ…è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œç„¶åä¸€ç›´ä½¿ç”¨å‡½æ•°è¿›è¡Œé‡å¤ä½¿ç”¨ã€‚

æœ€åï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå¯é‡å¤çš„ä»£ç ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥è¿›ä¸€æ­¥æŒ–æ˜å’Œå®è·µã€‚

ä½œè€…ä»£ç 

â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–
å¯ä»¥åœ¨ [**ä¸Šå…³æ³¨æˆ‘**](https://fahadakbar-50702.medium.com/subscribe) &åœ¨[**LinkedIn**](https://www.linkedin.com/in/fahadakbar/)&ä¸Šè”ç³»æˆ‘è®¿é—®æˆ‘çš„ [**GitHub**](https://github.com/mfahadakbar/) **ã€‚** â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–â–

# æ‚¨å¯èƒ½è¿˜å¯¹ä»¥ä¸‹å†…å®¹æ„Ÿå…´è¶£:

ğŸ‘‰[Docker](/make-your-data-science-life-easy-with-docker-c3e1fc0dee59)
è®©æ‚¨çš„æ•°æ®ç§‘å­¦ç”Ÿæ´»å˜å¾—ç®€å•ğŸ‘‰[ä½¿ç”¨ PyCaret çš„è‡ªå®šä¹‰ä¼°ç®—å™¨ï¼Œç¬¬ 1 éƒ¨åˆ†](/custome-estimator-with-pycaret-part-1-by-fahad-akbar-839513315965)
ğŸ‘‰[ä½¿ç”¨ PyCaret çš„è‡ªå®šä¹‰ä¼°ç®—å™¨ï¼Œç¬¬ 2 éƒ¨åˆ†](/custom-estimator-with-pycaret-part-2-by-fahad-akbar-aee4dbdacbf?sk=3556332049ac839d1d423615dab25bf0)
ğŸ‘‰[è½»æ¾è·å¾— Windows å†…éƒ¨çš„ Linux](https://fahadakbar-50702.medium.com/get-linux-in-windows-the-easy-way-three-simple-steps-by-fahad-akbar-aa5b142c943c?sk=a8e20dae33fde0563e69bb00966b5c17)
ğŸ‘‰[ä½¿ç”¨ PyCaret è¿›è¡Œå¤šé‡å¤„ç†](/a-data-scientists-dream-python-big-data-multi-processing-pycaret-by-fahad-akbar-7cc213a12db)
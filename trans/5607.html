<html>
<head>
<title>Train YOLO for Object Detection on a Custom Dataset using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ Python è®­ç»ƒ YOLO åœ¨è‡ªå®šä¹‰æ•°æ®é›†ä¸Šè¿›è¡Œå¯¹è±¡æ£€æµ‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/train-yolo-for-object-detection-on-a-custom-dataset-using-python-e4fe5eb94673#2022-12-19">https://towardsdatascience.com/train-yolo-for-object-detection-on-a-custom-dataset-using-python-e4fe5eb94673#2022-12-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/083e4a2b52bebf3de78ad53a243d00c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gqIag9YypCanQJhLTzt3gg.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">éæ´²çš„é‡ç”Ÿé©¬èµ›æ´›(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><div class=""/><div class=""><h2 id="3903" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">äº†è§£ Yolov4 å’Œ Darknet æ¥è®­ç»ƒè‡ªå®šä¹‰å¯¹è±¡æ£€æµ‹å™¨</h2></div><h2 id="3737" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">ä»‹ç»</h2><p id="5138" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">æˆ‘æœ€è¿‘å¼€å§‹ä»äº‹è®¡ç®—æœºè§†è§‰é¢†åŸŸçš„å·¥ä½œã€‚åœ¨è¿™äº›æ—©æœŸï¼Œæˆ‘æ­£åœ¨ç ”ç©¶ç‰©ä½“æ£€æµ‹çš„å„ç§ç®—æ³•å¦‚ä½•å·¥ä½œã€‚å…¶ä¸­æœ€çŸ¥åçš„æœ‰<strong class="ls jg"> R-CNN </strong>ã€<strong class="ls jg">å¿« R-CNN </strong>ã€<strong class="ls jg">å¿« R-CNN </strong>å½“ç„¶è¿˜æœ‰<strong class="ls jg"> YOLO </strong>ã€‚</p><p id="567a" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘æƒ³é‡ç‚¹è®¨è®ºæœ€åæåˆ°çš„ç®—æ³•ã€‚YOLO æ˜¯ç‰©ä½“æ¢æµ‹é¢†åŸŸçš„å°–ç«¯æŠ€æœ¯ï¼ŒYOLO æœ‰æ— æ•°çš„åº”ç”¨æ¡ˆä¾‹ã€‚ç„¶è€Œï¼Œä»Šå¤©æˆ‘ä¸æƒ³å‘Šè¯‰ä½  YOLO æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä¹Ÿä¸æƒ³å‘Šè¯‰ä½ å®ƒçš„æ¶æ„ï¼Œä½†æ˜¯æˆ‘æƒ³ç®€å•åœ°å‘ä½ å±•ç¤ºå¦‚ä½•å¯åŠ¨è¿™ä¸ªç®—æ³•ï¼Œå¹¶åšå‡ºä½ çš„é¢„æµ‹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å°†äº†è§£å¦‚ä½•åœ¨è‡ªå®šä¹‰æ•°æ®é›†ä¸Šå¯¹å…¶è¿›è¡Œ<strong class="ls jg">è®­ç»ƒï¼Œä»è€Œä½¿å…¶é€‚åº”æ‚¨çš„æ•°æ®ã€‚å¦‚æœä½ ä¹Ÿæƒ³çœ‹æˆ‘å†™çš„ä¸€ç¯‡å…³äº YOLO å†…éƒ¨è¿ä½œçš„æ–‡ç« ï¼Œè¯·è·Ÿæˆ‘æ¥ï¼Œå› ä¸ºæˆ‘æ‰“ç®—åœ¨æœªæ¥å‡ å¤©å†…å†™è¿™ç¯‡æ–‡ç« ã€‚</strong></p><h2 id="3579" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">é»‘æš—ç½‘ç»œ</h2><p id="609d" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">æˆ‘ä¸è®¤ä¸ºæœ‰æ¯”ä½ åœ¨ä»–ä»¬çš„ç½‘ç«™ä¸Šæ‰¾åˆ°çš„å®šä¹‰æ›´å¥½çš„æ–¹å¼æ¥æè¿° Darknetã€‚</p><blockquote class="mp mq mr"><p id="b324" class="lq lr ms ls b lt mj kg lv lw mk kj ly mt ml ma mb mu mm md me mv mn mg mh mi ij bi translated">Darknet æ˜¯ç”¨ C å’Œ CUDA ç¼–å†™çš„å¼€æºç¥ç»ç½‘ç»œæ¡†æ¶ã€‚é€Ÿåº¦å¿«ï¼Œå®‰è£…æ–¹ä¾¿ï¼Œæ”¯æŒ CPU å’Œ GPU <br/>è®¡ç®—ã€‚ä½ å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°æºä»£ç ï¼Œæˆ–è€…ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äº Darknet å¯ä»¥åšä»€ä¹ˆçš„å†…å®¹ã€‚</p></blockquote><p id="ce18" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">æ‰€ä»¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯å­¦ä¹ å¦‚ä½•ä½¿ç”¨è¿™ä¸ªå¼€æºé¡¹ç›®ã€‚</p><p id="6fce" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">ä½ å¯ä»¥åœ¨ github ä¸Šæ‰¾åˆ°æš—ç½‘ä»£ç ã€‚çœ‹ä¸€çœ‹å®ƒï¼Œå› ä¸ºæˆ‘ä»¬å°†ä½¿ç”¨å®ƒåœ¨æˆ‘ä»¬çš„è‡ªå®šä¹‰æ•°æ®é›†ä¸Šè®­ç»ƒ YOLOã€‚</p><h2 id="51df" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">å…‹éš†æš—ç½‘</h2><p id="e9a1" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">æˆ‘å°†åœ¨ä¸‹é¢è¿™ç¯‡æ–‡ç« ä¸­å±•ç¤ºçš„ä»£ç æ˜¯è¦åœ¨ Colab ä¸Šè¿è¡Œçš„ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰å¸¦ GPU å½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨ç¬”è®°æœ¬ä¸Šé‡å¤è¿™æ®µä»£ç ã€‚å¶å°”ä¼šæ”¹å˜çš„æ˜¯è·¯å¾„ã€‚</p><p id="bef2" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬å»å…‹éš† darknet GitHub åº“ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨<strong class="ls jg"> <em class="ms"> %%bash </em> </strong> <em class="ms">å‘½ä»¤ï¼ŒColab å…è®¸æˆ‘ä»¬ç¼–å†™ bash å‘½ä»¤ã€‚</em></p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="ec61" class="nf kv jf nb b be ng nh l ni nj">%%bash<br/>git clone https://github.com/AlexeyAB/darknet</span></pre><p id="d982" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">ä¸€æ—¦ä½ å…‹éš†äº† repoï¼Œä½ ä¼šåœ¨ä½ çš„å·¥ä½œç›®å½•ä¸­çœ‹åˆ°å¾ˆå¤šæ–‡ä»¶ï¼Œæ”¾æ¾ï¼Œå®ƒçœ‹èµ·æ¥æ¯”å®é™…ä¸Šæ›´å¤æ‚ã€‚<br/>ç°åœ¨æˆ‘ä»¬éœ€è¦<strong class="ls jg">é‡æ–°é…ç½® makefile </strong>ã€‚ä¸çŸ¥é“ makefile æ˜¯ä»€ä¹ˆï¼Ÿç®€è€Œè¨€ä¹‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªä½¿ä½ çš„ä»£ç ç¼–è¯‘å˜å¾—å®¹æ˜“çš„æ–‡ä»¶ã€‚</p><p id="93fc" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">å¦‚æœä½ æ›¾ç»ç”¨ C è¯­è¨€ç¼–å†™è¿‡ä»£ç ï¼Œä½ ä¼šçŸ¥é“å®é™…çš„åšæ³•æ˜¯å†™ä¸€ä¸ªæ–‡ä»¶<em class="ms"> file.c </em>ï¼Œç„¶åä½ ç”¨ä¸€ä¸ªå‘½ä»¤æ¥ç¼–è¯‘å®ƒï¼Œæ¯”å¦‚<em class="ms"> g++ etcâ€¦ </em> <br/>è¿™ä¸ªå‘½ä»¤ç”¨æ¥ç¼–è¯‘åœ¨å¤§å‹é¡¹ç›®ä¸­å¯èƒ½ä¼šå¾ˆé•¿ï¼Œå› ä¸ºå®ƒå¿…é¡»è€ƒè™‘ä¾èµ–å…³ç³»ç­‰ç­‰ã€‚</p><p id="0614" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">å› æ­¤ï¼Œæ¯æ¬¡é€šè¿‡é‡å†™<em class="ms"> g++ etcâ€¦ </em> <br/>è¿›è¡Œç¼–è¯‘éƒ½ä¼šéå¸¸è´¹åŠ›ï¼Œç„¶åæˆ‘ä»¬è¦åšçš„æ˜¯åˆ›å»ºä¸€ä¸ª makefileï¼Œå…¶ä¸­å·²ç»åŒ…å«äº†è¿™ä¸ªå†™å¥½çš„å‘½ä»¤ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯<strong class="ls jg">å¯åŠ¨ makefile æ¥ç¼–è¯‘ä»£ç </strong>ã€‚<br/><strong class="ls jg">makefile é€šå¸¸åŒ…å«ç”¨æˆ·å¯ä»¥æ ¹æ®éœ€è¦è®¾ç½®çš„é…ç½®å˜é‡</strong>ã€‚</p><p id="a812" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯è®¾ç½®ä¸€äº›åœ¨æš—ç½‘ makefile ä¸­æ‰¾åˆ°çš„å˜é‡ã€‚<br/>å› æ­¤ï¼Œè¯·ç¡®ä¿æ‚¨æœ‰å¯ç”¨çš„ GPUï¼Œå¹¶è¿è¡Œä»¥ä¸‹å•å…ƒã€‚</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="ec54" class="nf kv jf nb b be ng nh l ni nj">%%bash<br/>cd darknet<br/>sed -i 's/OPENCV=0/OPENCV=1/' Makefile<br/># In case you dont have a GPU, make sure to comment out the<br/># below 3 lines<br/>sed -i 's/GPU=0/GPU=1/' Makefile<br/>sed -i 's/CUDNN=0/CUDNN=1/' Makefile<br/>sed -i 's/CUDNN_HALF=0/CUDNN_HALF=1/' Makefile</span></pre><p id="3650" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">åœ¨è¿™ä¸ªå•å…ƒä¸­ï¼Œä¾‹å¦‚ç¬¬ä¸€è¡Œä¸­çš„å‘½ä»¤<em class="ms"> sed -i </em>å…è®¸æ‚¨å°† OPENCV å˜é‡ä» 0 æ›´æ”¹ä¸º 1ã€‚</p><p id="c2bf" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">æˆ‘ä»¬åœ¨å‰ä¸€ä¸ªå•å…ƒæ ¼ä¸­è®¾ç½®çš„è®¾ç½®å…è®¸æˆ‘ä»¬åœ¨ GPU è€Œä¸æ˜¯ CPU ä¸Šå¯åŠ¨ YOLOã€‚<br/>ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨ make å‘½ä»¤å¯åŠ¨ makefileã€‚</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="fadd" class="nf kv jf nb b be ng nh l ni nj">%%bash<br/>#compile darkent source code<br/>cd darknet</span></pre><p id="5b59" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">ç°åœ¨æˆ‘ä»¬å®‰è£…äº†ä¸€ä¸ªåº“ï¼Œå®ƒå°†åœ¨ YOLO æ¢æµ‹åˆ°çš„ç‰©ä½“å‘¨å›´ç»˜åˆ¶è¾¹ç•Œæ¡†ã€‚</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="21f2" class="nf kv jf nb b be ng nh l ni nj">%%capture<br/>!pip install -q torch_snippets</span></pre><h2 id="88ad" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">ä¸‹è½½æ•°æ®é›†</h2><p id="c029" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">æˆ‘å°†ä½¿ç”¨åŒ…å«å¡è½¦å’Œå…¬å…±æ±½è½¦å›¾åƒçš„å¯¹è±¡æ£€æµ‹æ•°æ®é›†ã€‚Kaggle ä¸Šæœ‰å¾ˆå¤šç‰©ä½“æ£€æµ‹æ•°æ®é›†ï¼Œä½ å¯ä»¥ä»é‚£é‡Œä¸‹è½½ä¸€ä¸ªã€‚</p><p id="68f5" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">å¦‚æœä½ ä¸çŸ¥é“å¦‚ä½•ç›´æ¥ä» Colab ä¸‹è½½ Kaggle æ•°æ®é›†ï¼Œä½ å¯ä»¥å»çœ‹çœ‹æˆ‘ä»¥å‰çš„ä¸€äº›æ–‡ç« ã€‚</p><p id="dce3" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">æ‰€ä»¥æˆ‘ä¸‹è½½å¹¶è§£å‹æ•°æ®é›†ã€‚</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="82eb" class="nf kv jf nb b be ng nh l ni nj">!wget - quiet link_to_dataset<br/>!tar -xf open-images-bus-trucks.tar.xz<br/>!rm open-images-bus-trucks.tar.xz</span></pre><p id="0fe3" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">ä¸‹å›¾æè¿°äº†ä¸‹è½½çš„æ•°æ®é›†çš„ç»“æ„ã€‚</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/8b15ca95f474d319500f6e227b8ee2dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*Wk8PbW8Zcq0sFo39G1_m9w.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">ä½œè€…å›¾ç‰‡</p></figure><h2 id="5af0" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">ä¸‹è½½ YOLO</h2><p id="2298" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">æ˜¾ç„¶ï¼Œä½ ä¸å¿…ä»å¤´å¼€å§‹åš YOLO è®­ç»ƒï¼Œè€Œæ˜¯ç›´æ¥ä»ç½‘ä¸Šä¸‹è½½é‡é‡ã€‚<br/>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä»<strong class="ls jg"> YOLO4 </strong>ä¸‹è½½æƒé‡ã€‚</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="3619" class="nf kv jf nb b be ng nh l ni nj">!wget - quiet https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.weights</span></pre><p id="d46c" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">è¦æŸ¥çœ‹ä¸€åˆ‡æ˜¯å¦æ­£å¸¸ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="2033" class="nf kv jf nb b be ng nh l ni nj">%%bash<br/>#I had to use the flag -dont_show cause wasnt working. Try to run wiithout it<br/>cd darknet<br/>./darknet detector test cfg/coco.data cfg/yolov4.cfg ../yolov4.weights data/person.jpg -dont_show</span></pre><p id="4d4c" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">åœ¨è¿™ä¸ªå‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬åˆšåˆšè¿è¡Œäº†</p><ul class=""><li id="a960" class="nl nm jf ls b lt mj lw mk ld nn lh no ll np mi nq nr ns nt bi translated">æˆ‘ä»¬æŒ‡å®šæˆ‘ä»¬æƒ³è¦ YOLO4: <em class="ms"> cfg/yolov4.cfg </em>çš„é…ç½®</li><li id="60db" class="nl nm jf ls b lt nu lw nv ld nw lh nx ll ny mi nq nr ns nt bi translated">æˆ‘ä»¬æŒ‡å®šä½¿ç”¨åˆšåˆšä¸‹è½½çš„æƒé‡:<em class="ms">../yolov4.weights </em></li><li id="4910" class="nl nm jf ls b lt nu lw nv ld nw lh nx ll ny mi nq nr ns nt bi translated">æˆ‘ä»¬å°†å¯¹å…‹éš†äº†å›è´­åè®®åè·å¾—çš„ coco æ•°æ®é›†è¿›è¡Œé¢„æµ‹:<em class="ms"> cfg/coco.data </em></li><li id="786a" class="nl nm jf ls b lt nu lw nv ld nw lh nx ll ny mi nq nr ns nt bi translated">è€Œæˆ‘ä»¬åšçš„é¢„æµ‹å¦‚ä¸‹å›¾:<em class="ms"> data/person.jpg </em></li></ul><h2 id="1e5a" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">å‡†å¤‡æ•°æ®é›†</h2><p id="4b8d" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">YOLO å¸Œæœ›æ‰¾åˆ°æ­£ç¡®è®¾ç½®çš„æŸäº›æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œä»¥ä¾¿åœ¨æ‚¨çš„è‡ªå®šä¹‰æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒã€‚<br/>é¦–å…ˆï¼Œä½ éœ€è¦åœ¨<em class="ms"> darknet/data/obj.names </em>è·¯å¾„ä¸­æ‰“å¼€ä½ å†™æ ‡ç­¾çš„æ–‡ä»¶ã€‚<br/>åœ¨ Colab ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong class="ls jg">é­”æ³•å‘½ä»¤</strong>é€šè¿‡å•å…ƒæ ¼ç›´æ¥å†™å…¥æ–‡ä»¶ã€‚magic å‘½ä»¤ä¸‹çš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šè¢«å¤åˆ¶<br/>åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ã€‚</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="b0cf" class="nf kv jf nb b be ng nh l ni nj">%%writefile darknet/data/obj.names<br/>bus<br/>truck</span></pre><p id="a107" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">ç°åœ¨æˆ‘ä»¬éœ€è¦ä¿®æ”¹å¦ä¸€ä¸ªæ–‡ä»¶æ¥å‘Šè¯‰ YOLO éœ€è¦å¤šå°‘ä¸ªç±»ï¼Œåœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°è®­ç»ƒå’Œ<br/>éªŒè¯çš„è·¯å¾„ï¼Œä»¥åŠåœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°å¸¦æœ‰æ ‡ç­¾åç§°çš„æ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨ magic å‘½ä»¤å’Œä¸‹é¢å‡ è¡Œä»£ç æ¥å®Œæˆã€‚</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="222c" class="nf kv jf nb b be ng nh l ni nj">%%writefile darknet/data/obj.data<br/>classes = 2<br/>train = darknet/data/train.txt<br/>valid = darknet/data/val.txt<br/>names = darknet/data/obj.names<br/>backup = backup/</span></pre><p id="8adb" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">æ‰€ä»¥ä¸ºäº†ç†è§£å®ƒï¼Œä½ çš„ train txt æ–‡ä»¶åº”è¯¥çœ‹èµ·æ¥åƒä½ åœ¨ä¸‹å›¾ä¸­çœ‹åˆ°çš„é‚£æ ·(ç±»ä¼¼äºéªŒè¯)ã€‚</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/a41ba968587a21a5da2b9fe1a4aa8f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*m6SmVSb6PtQ2M9wRuUEzNA.png"/></div></figure><p id="276f" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">å…¶ä¸­æ¯è¡ŒæŒ‡ç¤ºåœ¨å“ªé‡Œæ‰¾åˆ°è®­ç»ƒå›¾åƒã€‚</p><p id="d75d" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">ä½†æ˜¯æˆ‘ä»¬æŒ‡å®šçš„æ–‡ä»¶ä»ç„¶æ˜¯ç©ºçš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ä¸‹è½½çš„æ•°æ®é›†æ–‡ä»¶å¤¹ä¸­çš„æ•°æ®å¤åˆ¶åˆ° Darknet ä¸­çš„é»˜è®¤æ–‡ä»¶å¤¹ä¸­ã€‚</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="db91" class="nf kv jf nb b be ng nh l ni nj">!mkdir -p darknet/data/obj<br/>!cp -r open-images-bus-trucks/images/* darknet/data/obj/<br/>!cp -r open-images-bus-trucks/yolo_labels/all/{train,val}.txt darknet/data/<br/>!cp -r open-images-bus-trucks/yolo_labels/all/labels/*.txt darknet/data/obj/<br/>#add prefix 'darkent/' in front of each row in darkent/data/train.txt<br/>!sed -i -e 's/^/darknet\//' darknet/data/train.txt<br/>!sed -i -e 's/^/darknet\//' darknet/data/val.txt</span></pre><p id="bf05" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">å°±åƒæˆ‘ä»¬ä¹‹å‰ä¸‹è½½ YOLO çš„æƒé‡ä¸€æ ·ã€‚è¿™æ¬¡æˆ‘ä»¬æ‹¿<strong class="ls jg"> <em class="ms"> yolov4-tiny </em> </strong>æ¯”ä¹‹å‰çš„å¿«ã€‚<br/>ç„¶åæˆ‘ä»¬å°†æƒé‡å¤åˆ¶åˆ° Darknet ä¸­é€‚å½“çš„æ–‡ä»¶å¤¹ã€‚</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="cb71" class="nf kv jf nb b be ng nh l ni nj">!wget - quiet https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v4_pre/yolov4-tiny.conv.29<br/>!cp yolov4-tiny.conv.29 darknet/build/darknet/x64/</span></pre><p id="90e9" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">ç°åœ¨è®©æˆ‘ä»¬é‡å‘½åè´Ÿè´£é…ç½®<em class="ms"> yolov4 tiny </em>æ¶æ„çš„é…ç½®æ–‡ä»¶ã€‚<br/>ä¹‹åï¼Œæˆ‘ä»¬å°†ç¼–è¾‘ä¸€äº›å‚æ•°æ¥è®¾ç½®æ‰¹æ¬¡æ•°é‡ã€ç±»åˆ«æ•°é‡å’Œå…¶ä»–å‚æ•°ã€‚</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="d14f" class="nf kv jf nb b be ng nh l ni nj">%%bash<br/>cd darknet<br/># create a copy of existing configuration and modify it in place<br/>cp cfg/yolov4-tiny-custom.cfg cfg/yolov4-tiny-bus-trucks.cfg<br/># max_batches to 4000 (since the dataset is small enough)<br/>sed -i 's/max_batches = 500200/max_batches=4000/' cfg/yolov4-tiny-bus-trucks.cfg<br/># number of sub-batches per batch<br/>sed -i 's/subdivisions=1/subdivisions=16/' cfg/yolov4-tiny-bus-trucks.cfg<br/># number of batches after which learning rate is decayed<br/>sed -i 's/steps=400000,450000/steps=3200,3600/' cfg/yolov4-tiny-bus-trucks.cfg<br/># number of classes is 2 as opposed to 80<br/># (which is the number of COCO classes)<br/>sed -i 's/classes=80/classes=2/g' cfg/yolov4-tiny-bus-trucks.cfg<br/># in the classification and regression heads,<br/># change number of output convolution filters<br/># from 255 -&gt; 21 and 57 -&gt; 33, since we have fewer classes<br/># we don't need as many filters<br/>sed -i 's/filters=255/filters=21/g' cfg/yolov4-tiny-bus-trucks.cfg<br/>sed -i 's/filters=57/filters=33/g' cfg/yolov4-tiny-bus-trucks.cfg</span></pre><h2 id="68b5" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">è®­ç»ƒæ¨¡å‹ï¼</h2><p id="9821" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">ç°åœ¨æˆ‘ä»¬å‡†å¤‡å¥½äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯å¯åŠ¨æ¨¡å‹ç«è½¦äº†</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="d408" class="nf kv jf nb b be ng nh l ni nj">!./darknet/darknet detector train darknet/data/obj.data ./darknet/cfg/yolov4-tiny-bus-trucks.cfg yolov4-tiny.conv.29 -dont_show -mapLastAt</span></pre><p id="0e98" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">å¯¹æˆ‘æ¥è¯´ï¼Œè¿™ä¸ªè®­ç»ƒèŠ±äº†å¤§çº¦ä¸€ä¸ªå°æ—¶ã€‚<br/>ç°åœ¨ä½ å¯ä»¥åœ¨ä½ çš„å›¾åƒä¸Šè¿è¡Œé¢„æµ‹æ¥å¾—åˆ°ç±»å’Œè¾¹ç•Œæ¡†ã€‚</p><pre class="mw mx my mz gt na nb nc bn nd ne bi"><span id="0d27" class="nf kv jf nb b be ng nh l ni nj">from torch_snippets import Glob, stem, show, read<br/># upload your own images to a folder<br/>image_paths = Glob('images-of-trucks-and-busses')<br/>for f in image_paths:<br/> !./darknet detector test \<br/> data/obj.data cfg/yolov4-tiny-bus-trucks.cfg\<br/> backup/yolov4-tiny-bus-trucks_4000.weights {f}<br/> !mv predictions.jpg {stem(f)}_pred.jpg<br/>for i in Glob('*_pred.jpg'):<br/> show(read(i, 1), sz=20)</span></pre><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oa"><img src="../Images/390e27b48da6f3b6b7b0d348a2bc7628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A-sUpcgRMDnVKT9tl_vBiA.png"/></div></div></figure><h1 id="0293" class="ob kv jf bd kw oc od oe kz of og oh lc kl oi km lg ko oj kp lk kr ok ks lo ol bi translated">æœ€åçš„æƒ³æ³•</h1><p id="fe7b" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œä½¿ç”¨ YOLO å¹¶ä¸å¤æ‚ã€‚æˆ‘ä»¬å¯ä»¥å…‹éš†ä¸€äº›é«˜æ•ˆçš„å®ç°ï¼Œå¹¶å°†å…¶ç”¨äºæˆ‘ä»¬çš„ç”¨ä¾‹ã€‚å°±æˆ‘è€Œè¨€ï¼Œæˆ‘åªæ˜¯ç”¨å®ƒæ¥å¯¹æˆ‘ä»Šå¹´å¤å¤©å»éæ´²æ—…è¡Œæ—¶æ‹çš„ä¸€äº›ç…§ç‰‡è¿›è¡Œé¢„æµ‹ï¼Œä»¥æ­¤å–ä¹ã€‚ğŸ˜</p><p id="4a9e" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated">æˆ‘è¿˜æ²¡æœ‰è¯¦ç»†ä»‹ç»è¿™ä¸ªç®—æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå› ä¸ºæˆ‘æƒ³åœ¨ä»¥åçš„æ–‡ç« ä¸­ä½¿ç”¨è‡ªé¡¶å‘ä¸‹çš„æ–¹æ³•æ¥è¯¦ç»†ä»‹ç»ã€‚æ‰€ä»¥æˆ‘å¸Œæœ›ä½ ç°åœ¨ä¹Ÿèƒ½åƒæˆ‘ä¸€æ ·ä½¿ç”¨ YOLO å’Œç©å®ƒï¼</p><h1 id="33e0" class="ob kv jf bd kw oc od oe kz of og oh lc kl oi km lg ko oj kp lk kr ok ks lo ol bi translated">ç»“æŸäº†</h1><p id="3120" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated"><em class="ms">é©¬èµ›æ´›Â·æ³¢åˆ©è’‚</em></p><p id="eb91" class="pw-post-body-paragraph lq lr jf ls b lt mj kg lv lw mk kj ly ld ml ma mb lh mm md me ll mn mg mh mi ij bi translated"><a class="ae mo" href="https://www.linkedin.com/in/marcello-politi/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>ï¼Œ<a class="ae mo" href="https://twitter.com/_March08_" rel="noopener ugc nofollow" target="_blank"> Twitter </a>ï¼Œ<a class="ae mo" href="https://march-08.github.io/digital-cv/" rel="noopener ugc nofollow" target="_blank"> CV </a></p></div></div>    
</body>
</html>
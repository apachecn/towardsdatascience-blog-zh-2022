<html>
<head>
<title>Accessing the NYC Taxi Data in 2022</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">è®¿é—®2022å¹´çº½çº¦å¸‚çš„å‡ºç§Ÿè½¦æ•°æ®</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/accessing-the-nyc-taxi-data-in-2022-8363adfda76a#2022-05-17">https://towardsdatascience.com/accessing-the-nyc-taxi-data-in-2022-8363adfda76a#2022-05-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="77d6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">å…³äºæœ€è¿‘çš„å˜åŒ–ä½ éœ€è¦çŸ¥é“çš„ä¸€åˆ‡</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f0b61774eec19ae69ff890d8c7a536e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P444fv3gmbNzbCOKk203pg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">å›¾ç‰‡ç”±Benjamin Gremleré€šè¿‡Unsplashæä¾›</p></figure><p id="5f02" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">æˆªè‡³2022å¹´5æœˆ13æ—¥ï¼Œå¯¹çº½çº¦å¸‚å‡ºç§Ÿè½¦æ•°æ®çš„è®¿é—®å·²å‘ç”Ÿå˜åŒ–ã€‚æ‹¼èŠ±ç°åœ¨å·²ç»æˆä¸ºæ–°çš„é»˜è®¤æ–‡ä»¶æ ¼å¼ï¼Œè€Œä¸æ˜¯CSVã€‚å®é™…ä¸Šï¼Œè¿™æ„å‘³ç€æ‚¨éœ€è¦æ›´æ”¹ä»£ç ä¸­çš„ä¸¤ä»¶äº‹:</p><ol class=""><li id="698d" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">å°†è·¯å¾„æ›´æ”¹ä¸ºS3æ¡¶</li><li id="06f0" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">ä½¿ç”¨<code class="fe mi mj mk ml b">dd.read_parquet()</code>æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä½ å¸¸ç”¨çš„<code class="fe mi mj mk ml b">dd.read_csv()</code>æˆ–<code class="fe mi mj mk ml b">pd.read_csv()</code></li></ol><p id="0acf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¿™ç¯‡æ–‡ç« æä¾›äº†å˜åŒ–çš„èƒŒæ™¯ï¼Œè§£é‡Šäº†æ‹¼èŠ±æ–‡ä»¶æ ¼å¼çš„å¥½å¤„ï¼Œå¹¶å±•ç¤ºäº†å¯¹çº½çº¦å¸‚11å¹´å‡ºç§Ÿè½¦æ•°æ®çš„è¿è¡Œè®¡ç®—ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/fdd09ab75535bad21e234415463ac6d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dN2bT6yvgs2WGMWa.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">å›¾ç‰‡æ¥è‡ª<a class="ae mn" href="https://www1.nyc.gov/site/tlc/about/tlc-trip-record-data.page" rel="noopener ugc nofollow" target="_blank">www1.nyc.gov</a></p></figure><h1 id="10cf" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">ä½ å¤šå¹´æ¥ä¸€ç›´åœ¨åšçš„äº‹æƒ…</h1><p id="3bf8" class="pw-post-body-paragraph ky kz it la b lb ng ju ld le nh jx lg lh ni lj lk ll nj ln lo lp nk lr ls lt im bi translated"><a class="ae mn" href="https://www1.nyc.gov/site/tlc/about/tlc-trip-record-data.page" rel="noopener ugc nofollow" target="_blank"> NYC TLCæ•°æ®é›†</a>æ˜¯æœ€çŸ¥åçš„å…¬å…±æ•°æ®é›†ä¹‹ä¸€ã€‚è¿™æ˜¯ä¸ºæ•°ä¸å¤šçš„æ—¢å¤§(&gt; 100GBs) <em class="nl">åˆç›¸å¯¹å¹²å‡€çš„å…¬å…±æ•°æ®é›†ä¹‹ä¸€ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œè®¸å¤šå…¬å¸å°†å…¶ç”¨äºæ¼”ç¤ºå’Œå†…éƒ¨æµ‹è¯•ã€‚åå¤šå¹´æ¥ï¼Œæ•°æ®é›†ä¸€ç›´æ˜¯å¤§æ•°æ®é¢†åŸŸçš„ä¸€ä¸ªå¯é ç‰¹å¾ã€‚</em></p><p id="1fc9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">åˆ°äº†å‘¨æœ«ï¼Œè¿™ç§æƒ…å†µçªç„¶å‘ç”Ÿäº†å˜åŒ–ã€‚å¦‚æœä½ ç°åœ¨å°è¯•æ‹¨æ‰“ä½ ç†Ÿæ‚‰çš„<code class="fe mi mj mk ml b">read_csv</code>ç”µè¯ï¼Œä½ ä¼šé‡åˆ°ä¸€ä¸ª<code class="fe mi mj mk ml b">IndexError: list index out of range</code>:</p><pre class="kj kk kl km gt nm ml nn no aw np bi"><span id="6475" class="nq mp it ml b gy nr ns l nt nu"># read in 2012 CSV data <br/>ddf = dd.read_csv("s3://nyc-tlc/trip data/yellow_tripdata_2012-*.csv")</span></pre><p id="1548" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¿™å°†äº§ç”Ÿå¦‚ä¸‹æ¶ˆæ¯:</p><pre class="kj kk kl km gt nm ml nn no aw np bi"><span id="df64" class="nq mp it ml b gy nr ns l nt nu">--------------------------------------------------------------------------- IndexError Traceback (most recent call last)<br/> Input In [21], in &lt;cell line: 2&gt;() <strong class="ml iu"> 1</strong> # read in 2012 CSV data ----&gt; 2 ddf = dd.read_csv(<strong class="ml iu"> 3</strong> "s3://nyc-tlc/trip data/yellow_tripdata_2012-*.csv",<strong class="ml iu"> 4</strong> ) File ~/mambaforge/envs/dask-dataframes/lib/python3.9/site-packages/dask/dataframe/io/csv.py:741, in make_reader.&lt;locals&gt;.read(urlpath, blocksize, lineterminator, compression, sample, sample_rows, enforce, assume_missing, storage_options, include_path_column, **kwargs)<strong class="ml iu"> 728</strong> <strong class="ml iu">def</strong> read(<strong class="ml iu"> 729</strong> urlpath,<strong class="ml iu"> 730</strong> blocksize="default", (...)<strong class="ml iu"> 739</strong> **kwargs,<strong class="ml iu"> 740</strong> ): --&gt; 741<strong class="ml iu">return</strong> read_pandas(<strong class="ml iu"> 742</strong> reader,<strong class="ml iu"> 743</strong> urlpath,<strong class="ml iu"> 744</strong> blocksize=blocksize,<strong class="ml iu"> 745</strong> lineterminator=lineterminator,<strong class="ml iu"> 746</strong> compression=compression,<strong class="ml iu"> 747</strong> sample=sample,<strong class="ml iu"> 748</strong> sample_rows=sample_rows,<strong class="ml iu"> 749</strong> enforce=enforce,<strong class="ml iu"> 750</strong> assume_missing=assume_missing,<strong class="ml iu"> 751</strong> storage_options=storage_options,<strong class="ml iu"> 752</strong> include_path_column=include_path_column,<strong class="ml iu"> 753</strong> **kwargs,<strong class="ml iu"> 754</strong> ) File ~/mambaforge/envs/dask-dataframes/lib/python3.9/site-packages/dask/dataframe/io/csv.py:520, in read_pandas(reader, urlpath, blocksize, lineterminator, compression, sample, sample_rows, enforce, assume_missing, storage_options, include_path_column, **kwargs)<strong class="ml iu"> 515</strong> paths = get_fs_token_paths(urlpath, mode="rb", storage_options=storage_options)[<strong class="ml iu"> 516</strong> 2<strong class="ml iu"> 517</strong> ]<strong class="ml iu"> 519</strong> # Infer compression from first path --&gt; 520 compression = infer_compression(paths[0])<strong class="ml iu"> 522</strong> <strong class="ml iu">if</strong> blocksize == "default":<strong class="ml iu"> 523</strong> blocksize = AUTO_BLOCKSIZE</span><span id="50d1" class="nq mp it ml b gy nv ns l nt nu">IndexError: list index out of range</span></pre><h1 id="86b5" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">æ¢æˆæ‹¼èŠ±åœ°æ¿</h1><p id="b020" class="pw-post-body-paragraph ky kz it la b lb ng ju ld le nh jx lg lh ni lj lk ll nj ln lo lp nk lr ls lt im bi translated">æ‹¼èŠ±åœ°æ¿å·²ç»æˆä¸ºçº½çº¦å¸‚TLCæ•°æ®çš„æ–°é»˜è®¤å€¼ã€‚è¦è®¿é—®æ•°æ®ï¼Œæ‚¨éœ€è¦:</p><ol class=""><li id="19fd" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">å°†S3å­˜å‚¨æ¡¶çš„è·¯å¾„æ”¹ä¸ºä½¿ç”¨æ–‡ä»¶æ‰©å±•å<code class="fe mi mj mk ml b">.parquet</code>è€Œä¸æ˜¯<code class="fe mi mj mk ml b">.csv</code></li><li id="88a0" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">ä½¿ç”¨<code class="fe mi mj mk ml b">dd.read_parquet()</code>æ–¹æ³•ä»£æ›¿<code class="fe mi mj mk ml b">dd.read_csv()</code></li></ol><pre class="kj kk kl km gt nm ml nn no aw np bi"><span id="0f88" class="nq mp it ml b gy nr ns l nt nu"># read in 2012 Parquet data <br/>ddf = dd.read_parquet("s3://nyc-tlc/trip data/yellow_tripdata_2012-*.parquet") </span><span id="2ee0" class="nq mp it ml b gy nv ns l nt nu">ddf.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/71f8d05227ed96c0f12d1513c08091cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bvWJakRmwTwlYUpR.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ä½œè€…æä¾›çš„å›¾ç‰‡(ä¸ºä¾¿äºé˜…è¯»ï¼Œå·²æˆªæ–­)</p></figure><p id="36bf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae mn" href="https://dask.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu"> Dask </strong> </a> <strong class="la iu">æ˜¯æŒ‰æ¯”ä¾‹è¯»å–çº½çº¦å¸‚æ–°å‡ºç§Ÿè½¦æ•°æ®çš„æœ€ä½³æ–¹å¼ã€‚Daskä½¿æ‚¨èƒ½å¤Ÿæœ€å¤§é™åº¦åœ°æé«˜æ‹¼èŠ±æ–‡ä»¶æ ¼å¼çš„å¹¶è¡Œè¯»/å†™èƒ½åŠ›ã€‚</strong></p><p id="70ae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ä½ ä¹Ÿå¯ä»¥é€šè¿‡<code class="fe mi mj mk ml b">pd.read_parquet()</code>ä½¿ç”¨pandasï¼Œä½†è¿™æ„å‘³ç€ä½ åªèƒ½ä½¿ç”¨ä¸€ä¸ªCPUå†…æ ¸æ¥å¤„ç†æ•°æ®ã€‚è¿™å°†ä½¿ä½ çš„å·¥ä½œæµç¨‹å˜å¾—æ›´æ…¢ï¼Œå¯æ‰©å±•æ€§æ›´å·®ã€‚</p><p id="6ff5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">é˜…è¯»è¿™ç¯‡æ–‡ç« äº†è§£æ›´å¤šå…³äºDaskå¦‚ä½•å¸®åŠ©ä½ åŠ é€Ÿæ•°æ®åˆ†æçš„ä¿¡æ¯ã€‚</p><h1 id="5418" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">æ—§ä¹ éš¾æ”¹</h1><p id="11cc" class="pw-post-body-paragraph ky kz it la b lb ng ju ld le nh jx lg lh ni lj lk ll nj ln lo lp nk lr ls lt im bi translated">å¦‚æœä½ çœŸçš„ï¼ŒçœŸçš„ï¼ŒçœŸçš„æƒ³ä½¿ç”¨ä¸€ä¸ªè¾ƒæ…¢çš„å¹¶è¡ŒI/Oï¼Œè¾ƒå°‘çš„å‹ç¼©é€‰é¡¹ï¼Œæ²¡æœ‰åˆ—ä¿®å‰ªæˆ–è°“è¯ä¸‹æ¨çš„åŠ£è´¨æ–‡ä»¶æ ¼å¼ğŸ˜‰æ‚¨ä»ç„¶å¯ä»¥è®¿é—®<code class="fe mi mj mk ml b">csv_backup</code>ç›®å½•ä¸­çš„CSVæ•°æ®:</p><pre class="kj kk kl km gt nm ml nn no aw np bi"><span id="017e" class="nq mp it ml b gy nr ns l nt nu"># read in 2012 CSV data <br/>ddf = dd.read_csv("s3://nyc-tlc/csv_backup/yellow_tripdata_2012-*.csv")</span></pre><p id="ff94" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¯·æ³¨æ„ï¼Œä¸æ–°çš„Parquetæ–‡ä»¶ç›¸æ¯”ï¼Œè¿™äº›CSVæ–‡ä»¶çš„å¹¶è¡ŒI/Oé€Ÿåº¦è¾ƒæ…¢ï¼Œå‹ç¼©é€‰é¡¹è¾ƒå°‘ï¼Œå¹¶ä¸”æ²¡æœ‰åˆ—ä¿®å‰ªæˆ–è°“è¯ä¸‹æ¨ã€‚å¦‚æœæ‚¨æ­£åœ¨å¤§è§„æ¨¡å·¥ä½œï¼Œé™¤éæ‚¨æœ‰éå¸¸å……åˆ†çš„ç†ç”±ä½¿ç”¨CSVï¼Œå¦åˆ™æ‚¨é€šå¸¸åº”è¯¥ä½¿ç”¨æ‹¼èŠ±åœ°æ¿è€Œä¸æ˜¯CSVã€‚<a class="ae mn" href="https://coiled.io/blog/writing-parquet-files-with-dask-using-to_parquet/" rel="noopener ugc nofollow" target="_blank">é˜…è¯»è¿™ä¸ªåšå®¢</a>ï¼Œäº†è§£æ›´å¤šå…³äºå¦‚ä½•ç”¨Daskç¼–å†™æ‹¼èŠ±æ–‡ä»¶çš„ä¿¡æ¯ã€‚</p><h1 id="f73a" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">è¿˜æœ‰æ›´å¥½çš„</h1><p id="107e" class="pw-post-body-paragraph ky kz it la b lb ng ju ld le nh jx lg lh ni lj lk ll nj ln lo lp nk lr ls lt im bi translated">NYC TLCæ‹¼èŠ±æ–‡ä»¶çš„å”¯ä¸€ç¼ºç‚¹æ˜¯ä¸‹è½½è¿™äº›æ‹¼èŠ±æ–‡ä»¶éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œå› ä¸ºæ¯å¹´æœ‰12ä¸ªéå¸¸å¤§çš„åˆ†åŒºã€‚ä¸ºäº†å¹¶è¡ŒIOå’Œæ›´å¿«çš„è®¡ç®—ï¼Œæœ€å¥½å°†æ•°æ®é›†é‡æ–°åˆ†åŒºåˆ°æ›´ä¼˜åŒ–çš„å¤§å°ã€‚</p><pre class="kj kk kl km gt nm ml nn no aw np bi"><span id="a16f" class="nq mp it ml b gy nr ns l nt nu">ddf = ddf.repartition(partition_size="100MB")</span></pre><p id="f65e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¯¹2011å¹´åˆ°2021å¹´çš„NYC TLCæ•°æ®æ‰§è¡Œgroupbyè®¡ç®—ã€‚è¿™æ˜¯ç£ç›˜ä¸Šè¶…è¿‡200GBçš„æœªå‹ç¼©æ•°æ®ã€‚æ‚¨çš„æœ¬åœ°æœºå™¨ä¸å¤ªå¯èƒ½æœ‰è¿è¡Œè¯¥åˆ†æçš„å†…å­˜ã€‚æˆ‘ä»¬å°†åœ¨ä¸€ä¸ªæœ‰50ä¸ªå·¥äººå’Œ16GBå†…å­˜çš„å·çŠ¶é›†ç¾¤ä¸Šè¿è¡Œæˆ‘ä»¬çš„è®¡ç®—ã€‚<a class="ae mn" href="https://docs.coiled.io/user_guide/getting_started.html" rel="noopener ugc nofollow" target="_blank">é˜…è¯»æ–‡æ¡£</a>å¼€å§‹ä½¿ç”¨Coiledã€‚</p><pre class="kj kk kl km gt nm ml nn no aw np bi"><span id="e33a" class="nq mp it ml b gy nr ns l nt nu">from coiled import Cluster <br/>from distributed import Client <br/>import dask.dataframe as dd </span><span id="b411" class="nq mp it ml b gy nv ns l nt nu"># launch Coiled cluster <br/>cluster = Cluster( <br/>    name="dataframes", <br/>    n_workers=50, <br/>    worker_memory="16GiB", <br/>    software="coiled-examples/dask-dataframes",<br/>) </span><span id="32b5" class="nq mp it ml b gy nv ns l nt nu"># connect Dask to Coiled <br/>client = Client(cluster)</span></pre><p id="dfa8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥åŠ è½½æˆ‘ä»¬çš„æ•°æ®é›†:</p><pre class="kj kk kl km gt nm ml nn no aw np bi"><span id="bbe0" class="nq mp it ml b gy nr ns l nt nu"># read in all data for 2011-2021 <br/>ddf = dd.read_parquet("s3://nyc-tlc/trip data/yellow_tripdata_2011-*.parquet") </span><span id="3258" class="nq mp it ml b gy nv ns l nt nu">for i in range(2012,2022): <br/>   ddf_temp = dd.read_parquet(f"s3://nyc-tlc/trip data/yellow_tripdata_{i}-*.parquet") <br/>    ddf = ddf.append(ddf_temp) </span><span id="93ee" class="nq mp it ml b gy nv ns l nt nu"># repartition dataset <br/>ddf = ddf.repartition(partition_size="100MB").persist()</span></pre><p id="645f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ç°åœ¨é€šè¿‡è®¡ç®—æ¥è¿è¡Œæˆ‘ä»¬çš„ç»„:</p><pre class="kj kk kl km gt nm ml nn no aw np bi"><span id="c4da" class="nq mp it ml b gy nr ns l nt nu">%%time <br/># perform groupby aggregation ddf.groupby('passenger_count').trip_distance.mean().compute()</span><span id="2933" class="nq mp it ml b gy nv ns l nt nu">CPU times: user 526 ms, sys: 55.1 ms, total: 582 ms <br/>Wall time: 10.3 s </span><span id="ce71" class="nq mp it ml b gy nv ns l nt nu">passenger_count<br/>49.0      0.000000<br/>208.0     0.241961<br/>10.0      0.386429<br/>19.0      0.690000<br/>211.0     0.970000<br/>192.0     1.010000<br/>254.0     1.020000<br/>223.0     1.160000<br/>96.0      1.195000<br/>177.0     1.340000<br/>33.0      1.615000<br/>249.0     1.690000<br/>193.0     1.740000<br/>112.0     1.800000<br/>97.0      1.870000<br/>129.0     2.050000<br/>37.0      2.160000<br/>0.0       2.522421<br/>47.0      2.560000<br/>15.0      2.590000<br/>255.0     2.953333<br/>6.0       2.975480<br/>5.0       3.001735<br/>70.0      3.060000<br/>7.0       3.288784<br/>247.0     3.310000<br/>58.0      3.460000<br/>225.0     4.830000<br/>8.0       4.950078<br/>250.0     5.010000<br/>4.0       5.028690<br/>9.0       5.675410<br/>2.0       5.869093<br/>3.0       5.931338<br/>1.0       6.567514<br/>61.0      8.780000<br/>65.0     18.520000<br/>36.0     20.160000<br/>Name: trip_distance, dtype: float64</span></pre><h1 id="8fa9" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">æ‹¼èŠ±åœ°æ¿æ˜¯ä½ çš„æ–°æœ‹å‹</h1><p id="bb59" class="pw-post-body-paragraph ky kz it la b lb ng ju ld le nh jx lg lh ni lj lk ll nj ln lo lp nk lr ls lt im bi translated">æ˜¯çš„ï¼Œè¿™ç§è®¿é—®æ›´æ”¹æ˜¯ç—›è‹¦çš„ï¼Œå¹¶ä¸”æ„å‘³ç€æ‚¨å¯èƒ½å¿…é¡»æ›´æ–°ä¸€äº›é—ç•™ä»£ç ã€‚ä½†è¿™ç§æ”¹å˜æ˜¯æœ‰å……åˆ†ç†ç”±çš„:Parquetæ˜¯ä¸€ç§æ›´æœ‰æ•ˆçš„æ–‡ä»¶æ ¼å¼ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†è¿™ç§è§„æ¨¡çš„æ•°æ®é›†æ—¶ï¼Œæœ€å¥½ä»¥å¹¶è¡Œæ–¹å¼è¯»å–ã€‚Parquetä½¿æ‚¨èƒ½å¤Ÿæ‰§è¡ŒèŠ‚çœæ—¶é—´çš„æ“ä½œï¼Œæ¯”å¦‚å¹¶è¡ŒIOã€åˆ—ä¿®å‰ªå’Œè°“è¯ä¸‹æ¨ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/f8235beb87a8ca791c929e5a8049760b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OHTWsNcR2qffIfNo.png"/></div></figure><p id="0f9f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae mn" href="https://coiled.io/blog/parquet-file-column-pruning-predicate-pushdown/" rel="noopener ugc nofollow" target="_blank">é˜…è¯»æˆ‘ä»¬å…³äºä½¿ç”¨Parquetä¼˜äºCSVæˆ–JSONçš„æ‰€æœ‰ä¼˜åŠ¿çš„å¸–å­</a>,äº†è§£æ›´å¤šä¿¡æ¯å¹¶æ›´è¯¦ç»†åœ°æ£€æŸ¥ä¸Šè¿°åŸºå‡†ã€‚</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nw nx l"/></div></figure></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="378f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nl">åŸè½½äº2022å¹´5æœˆ17æ—¥</em><a class="ae mn" href="https://coiled.io/blog/nyc-taxi-parquet-csv-index-error/" rel="noopener ugc nofollow" target="_blank"><em class="nl">https://coiled . io</em></a><em class="nl">ã€‚</em></p></div></div>    
</body>
</html>
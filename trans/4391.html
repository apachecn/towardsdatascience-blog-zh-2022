<html>
<head>
<title>Bayesian Regression Using PyMC3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨PyMC3çš„è´å¶æ–¯å›å½’</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/bayesian-regression-using-pymc3-e279ccc81d20#2022-09-28">https://towardsdatascience.com/bayesian-regression-using-pymc3-e279ccc81d20#2022-09-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="20c3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">å¦‚ä½•ä½¿ç”¨PyMC3åŒ…åœ¨Pythonä¸­å®ç°è´å¶æ–¯å›å½’</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8da1b56def8c4a58f04620d379dce2af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hX3sHnixH-ZZQeGa"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Joachim SchnÃ¼rle åœ¨<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šçš„ç…§ç‰‡</p></figure><h1 id="9340" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">èƒŒæ™¯</h1><p id="467c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://www.pymc.io/welcome.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> PyMC3 </strong> </a>(ç°åœ¨ç®€ç§°PyMC)æ˜¯ä¸€ä¸ªè´å¶æ–¯å»ºæ¨¡åŒ…ï¼Œä½¿æˆ‘ä»¬ä½œä¸ºæ•°æ®ç§‘å­¦å®¶èƒ½å¤Ÿè½»æ¾åœ°æ‰§è¡Œ<a class="ae ky" href="https://en.wikipedia.org/wiki/Bayesian_inference" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">è´å¶æ–¯æ¨ç†</strong> </a>ã€‚</p><p id="031b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">åœ¨å¼•æ“ç›–ä¸‹ï¼ŒPyMC3ä½¿ç”¨<a class="ae ky" href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">ã€MCMCã€‘</strong></a><strong class="lt iu"/>çš„æ–¹æ³•è®¡ç®—åéªŒåˆ†å¸ƒã€‚ç°åœ¨ï¼Œè¿™ç§æ–¹æ³•éå¸¸å¤æ‚ï¼Œéœ€è¦å¦å¤–ä¸€ç¯‡æ–‡ç« æ¥å…¨é¢ä»‹ç»ã€‚å› æ­¤ï¼Œæˆ‘åœ¨è¿™é‡Œé“¾æ¥äº†ä¸€ä¸ªå¾ˆå¥½åœ°è§£é‡Šäº†è¿™ä¸ªè¯é¢˜çš„å¸–å­<a class="ae ky" rel="noopener" target="_blank" href="/a-zero-math-introduction-to-markov-chain-monte-carlo-methods-dcba889e0c50">ã€‚</a></p><p id="788a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">æ‚¨å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆå°è£…ä½¿ç”¨MCMCï¼Ÿå—¯è¿™æ˜¯ä¸ºäº†ç»•è¿‡<a class="ae ky" href="https://www.reddit.com/r/askmath/comments/cghi5c/what_is_an_intractable_integral_and_why_this/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">è®¡ç®—<a class="ae ky" href="https://en.wikipedia.org/wiki/Normalizing_constant#Bayes'_theorem" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">å½’ä¸€åŒ–å¸¸æ•°</strong> </a>ä¸­çš„<a class="ae ky" href="https://en.wikipedia.org/wiki/Bayes'_theorem" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">è´å¶æ–¯å®šç†</strong> </a></strong></a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/18feaecf9728b45456c78d0768346a6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*RKYfKnmcfWUgTlwlhoonAw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ä½œè€…åœ¨LaTeXä¸­ç”Ÿæˆçš„æ–¹ç¨‹ã€‚</p></figure><p id="2806" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">å…¶ä¸­<em class="mt"> P(H | D) </em>æ˜¯<a class="ae ky" href="https://en.wikipedia.org/wiki/Posterior_probability" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">åéªŒ</strong> </a>ï¼Œ<em class="mt"> P(H) </em> <strong class="lt iu"> </strong>æ˜¯<a class="ae ky" href="https://en.wikipedia.org/wiki/Prior_probability" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">å…ˆéªŒ</strong> </a>ï¼Œ<em class="mt"> P(D | H) </em>æ˜¯<a class="ae ky" href="https://en.wikipedia.org/wiki/Likelihood_function" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">ä¼¼ç„¶</strong> </a>ï¼Œ<em class="mt"> P(D) </em>æ˜¯å½’ä¸€åŒ–å¸¸æ•°ï¼Œå®šä¹‰ä¸º:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/b98f8d5ecdb0845861836aa96d433dd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*WFzP9sQh9c6bbX5CjODjVw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ä½œè€…åœ¨LaTeXä¸­ç”Ÿæˆçš„æ–¹ç¨‹ã€‚</p></figure><p id="4992" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">å¯¹äºè®¸å¤šé—®é¢˜æ¥è¯´ï¼Œè¿™ä¸ªç§¯åˆ†è¦ä¹ˆæ²¡æœ‰å°é—­å½¢å¼çš„è§£ï¼Œè¦ä¹ˆæ— æ³•è®¡ç®—ã€‚å› æ­¤ï¼ŒåƒMCMCè¿™æ ·çš„æ–¹æ³•è¢«å¼€å‘å‡ºæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¹¶å…è®¸æˆ‘ä»¬ä½¿ç”¨è´å¶æ–¯æ–¹æ³•ã€‚</p><p id="3c6f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">å¦‚æœä½ ä¸ç†Ÿæ‚‰è´å¶æ–¯å®šç†ï¼Œæˆ‘æ¨èä½ çœ‹çœ‹æˆ‘ä»¥å‰å…³äºè¿™ä¸ªä¸»é¢˜çš„æ–‡ç« :</p><div class="mv mw gp gr mx my"><a href="https://pub.towardsai.net/conditional-probability-and-bayes-theorem-simply-explained-788a6361f333" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">æ¡ä»¶æ¦‚ç‡å’Œè´å¶æ–¯å®šç†æµ…é‡Š</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">æ¡ä»¶æ¦‚ç‡å’Œè´å¶æ–¯å®šç†çš„ç®€å•ç›´è§‚çš„è§£é‡Šã€‚</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">pub.towardsai.net</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm ks my"/></div></div></a></div><p id="b2a3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">è¿˜æœ‰å¦ä¸€ç§å«åš<a class="ae ky" href="https://en.wikipedia.org/wiki/Conjugate_prior" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">å…±è½­å…ˆéªŒ</strong> </a>çš„æ–¹æ³•ä¹Ÿè§£å†³äº†è¿™ä¸ªæ£˜æ‰‹çš„é—®é¢˜ï¼Œä½†æ˜¯å®ƒçš„å¯å¡‘æ€§ä¸å¦‚MCMCã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºå…±è½­å…ˆéªŒçš„çŸ¥è¯†ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¥å‰çš„æ–‡ç« :</p><div class="mv mw gp gr mx my"><a rel="noopener follow" target="_blank" href="/bayesian-conjugate-priors-simply-explained-747218be0f70"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">è´å¶æ–¯å…±è½­å…ˆéªŒç®€å•è§£é‡Š</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">æ‰§è¡Œè´å¶æ–¯ç»Ÿè®¡çš„ä¸€ç§è®¡ç®—æœ‰æ•ˆçš„æ–¹æ³•</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">towardsdatascience.com</p></div></div><div class="nh l"><div class="nn l nj nk nl nh nm ks my"/></div></div></a></div><p id="5198" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨PyMC3åŒ…å®ç°<a class="ae ky" href="https://en.wikipedia.org/wiki/Bayesian_linear_regression" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">è´å¶æ–¯çº¿æ€§å›å½’</strong> </a>ï¼Œå¹¶å¿«é€Ÿæµè§ˆä¸€ä¸‹å®ƒä¸æ™®é€šçš„<a class="ae ky" href="https://en.wikipedia.org/wiki/Linear_regression" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">çº¿æ€§å›å½’</strong> </a>æœ‰ä½•ä¸åŒã€‚å¦‚æœä½ æƒ³çŸ¥é“å¦‚ä½•ä»é›¶å¼€å§‹å®ç°è´å¶æ–¯çº¿æ€§å›å½’ï¼Œé‚£ä¹ˆçœ‹çœ‹æˆ‘æœ€è¿‘çš„å¸–å­:</p><div class="mv mw gp gr mx my"><a rel="noopener follow" target="_blank" href="/bayesian-regression-from-scratch-a1fe19ff64c"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">è´å¶æ–¯å›å½’ä»é›¶å¼€å§‹</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">ä½¿ç”¨Pythonä»åŸºæœ¬åŸç†å¯¼å‡ºè´å¶æ–¯çº¿æ€§å›å½’</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">towardsdatascience.com</p></div></div><div class="nh l"><div class="no l nj nk nl nh nm ks my"/></div></div></a></div><h1 id="edbe" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">æ¦‚è¿°:è´å¶æ–¯ä¸é¢‘ç‡ä¸»ä¹‰å›å½’</h1><p id="4d88" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œ<a class="ae ky" href="https://en.wikipedia.org/wiki/Frequentist_inference" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> Frequentist </strong> </a>å’ŒBayesianå›å½’æ–¹æ³•ä¹‹é—´çš„å…³é”®åŒºåˆ«åœ¨äºå®ƒä»¬å¦‚ä½•å¤„ç†å‚æ•°ã€‚åœ¨é¢‘ç‡ç»Ÿè®¡ä¸­ï¼Œçº¿æ€§å›å½’æ¨¡å‹çš„å‚æ•°æ˜¯å›ºå®šçš„ï¼Œè€Œåœ¨è´å¶æ–¯ç»Ÿè®¡ä¸­ï¼Œå®ƒä»¬æ˜¯éšæœºå˜é‡ã€‚</p><p id="df08" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">é¢‘ç‡ä¸»ä¹‰è€…ä½¿ç”¨<a class="ae ky" href="https://en.wikipedia.org/wiki/Maximum_likelihood_estimation" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a>çš„æ–¹æ³•æ¥æ¨å¯¼çº¿æ€§å›å½’æ¨¡å‹çš„å€¼ã€‚MLEçš„ç»“æœæ˜¯æ¯ä¸ªå‚æ•°çš„å•ä¸€å›ºå®šå€¼ã€‚</p><p id="fb9c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">ç„¶è€Œï¼Œåœ¨è´å¶æ–¯ä¸–ç•Œä¸­ï¼Œä½ çš„å‚æ•°æœ‰ä¸€ä¸ªå€¼çš„åˆ†å¸ƒï¼Œå®ƒä»¬å¯èƒ½æœ‰ä¸€å®šçš„æ¦‚ç‡ã€‚ç„¶åä½¿ç”¨æ›´å¤šçš„æ•°æ®æ›´æ–°è¿™ä¸ªåˆ†å¸ƒï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ›´åŠ ç¡®å®šå‚æ•°çš„å–å€¼ã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º<a class="ae ky" href="https://en.wikipedia.org/wiki/Bayesian_inference" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">è´å¶æ–¯æ›´æ–°</strong> </a>ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œäº†è§£æ›´å¤šä¿¡æ¯:</p><div class="mv mw gp gr mx my"><a rel="noopener follow" target="_blank" href="/bayesian-updating-simply-explained-c2ed3e563588"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">è´å¶æ–¯æ›´æ–°ç®€å•è§£é‡Š</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">ç”¨è´å¶æ–¯å®šç†æ›´æ–°ä¿¡å¿µçš„ç›´è§‚è§£é‡Š</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">towardsdatascience.com</p></div></div><div class="nh l"><div class="np l nj nk nl nh nm ks my"/></div></div></a></div><p id="6441" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">è¿™æ˜¯å¯¹è´å¶æ–¯å’Œé¢‘ç‡ä¸»ä¹‰å›å½’ä¹‹é—´çš„ä¸»è¦åŒºåˆ«çš„ä¸€ç¥ã€‚å¦‚æœä½ æƒ³è¦æ›´æ·±å…¥çš„è§‚ç‚¹ï¼Œæœ‰å¾ˆå¤šèµ„æºå¯ä»¥æ¯”æˆ‘è§£é‡Šå¾—æ›´å¥½ï¼</p><h1 id="dd58" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">ä½¿ç”¨PyMC3</h1><h2 id="041e" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">åŒ…è£…</h2><p id="0ece" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬è£…å…¥æˆ‘ä»¬çš„åŒ…:</p><pre class="kj kk kl km gt oc od oe of aw og bi"><span id="67a9" class="nq la it od b gy oh oi l oj ok"># Import pyMC3 and also arviz for visualisation<br/>import pymc3 as pm<br/>import arviz as az</span><span id="cbbe" class="nq la it od b gy ol oi l oj ok"># Import the other core data science packages<br/>import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>from sklearn import datasets<br/>from scipy.stats import norm<br/>import statsmodels.formula.api as smf</span></pre><p id="3fea" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">ä½ å¯èƒ½éœ€è¦å®‰è£…PyMC3å’Œ<a class="ae ky" href="https://www.arviz.org/en/latest/" rel="noopener ugc nofollow" target="_blank">T5 ArviZ</a><strong class="lt iu">ã€‚ä¸ºæ­¤ï¼Œåªéœ€éµå¾ªä»–ä»¬ç½‘ç«™ä¸Šçš„å®‰è£…è¯´æ˜ã€‚</strong></p><h2 id="9543" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">æ•°æ®</h2><p id="d0d2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">ç°åœ¨æˆ‘ä»¬ä½¿ç”¨sklearnçš„<em class="mt"> make_regression </em>å‡½æ•°ç”Ÿæˆä¸€äº›æ•°æ®:</p><pre class="kj kk kl km gt oc od oe of aw og bi"><span id="5877" class="nq la it od b gy oh oi l oj ok"># Generate data<br/>x, y = datasets.make_regression(n_samples=10_000,<br/>                                n_features=1,<br/>                                noise=10,<br/>                                bias=5)</span><span id="7e6a" class="nq la it od b gy ol oi l oj ok"># Create the dataframe<br/>data = pd.DataFrame(list(zip(x.flatten(), y)),columns =['x', 'y'])</span><span id="481e" class="nq la it od b gy ol oi l oj ok"># Plot the data<br/>fig, ax = plt.subplots(figsize=(9,5))<br/>ax.scatter(data['x'], data['y'])<br/>ax.ticklabel_format(style='plain')<br/>plt.xlabel('x',fontsize=18)<br/>plt.ylabel('y',fontsize=18)<br/>plt.xticks(fontsize=18)<br/>plt.yticks(fontsize=18)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/c0853b6d2ccf9c42ec2e851053e6a799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*2btFjRfAfmTR_5V7Qac4TQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ä½œè€…ç”¨Pythonç”Ÿæˆçš„å›¾ã€‚</p></figure><h2 id="61e7" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">é¢‘ç‡å›å½’çº¿</h2><p id="d53f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">æˆ‘ä»¬ä½¿ç”¨<a class="ae ky" href="https://en.wikipedia.org/wiki/Ordinary_least_squares" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">ã€æ™®é€šæœ€å°äºŒä¹˜æ³•(OLS) </strong> </a>çš„æ–¹æ³•ç»˜åˆ¶é¢‘ç‡çº¿æ€§å›å½’çº¿:</p><pre class="kj kk kl km gt oc od oe of aw og bi"><span id="0b05" class="nq la it od b gy oh oi l oj ok"># OLS line<br/>formula = 'y ~ x'<br/>results = smf.ols(formula, data=data).fit()<br/>results.params</span><span id="32d9" class="nq la it od b gy ol oi l oj ok"># Get our equation of the OLS line<br/>inter = results.params['Intercept']<br/>slope = results.params['x']<br/>x_vals = np.arange(min(x), max(x), 0.1)<br/>ols_line = inter + slope * x_vals</span><span id="7e20" class="nq la it od b gy ol oi l oj ok"># Plot the target against our feature with the OLS regression<br/>fig, ax = plt.subplots(figsize=(9,5))<br/>ax.scatter(data['x'], data['y'])<br/>ax.plot(x_vals, ols_line,label='OLS Fit', color='red')<br/>ax.ticklabel_format(style='plain')<br/>plt.xlabel('x',fontsize=18)<br/>plt.ylabel('y',fontsize=18)<br/>plt.xticks(fontsize=18)<br/>plt.yticks(fontsize=18)<br/>plt.legend(fontsize=16)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/462c2f2b3f4f940dc6dc6ef61a914082.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*SUQLvkKM-Mi5-k1xf2WvWw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ä½œè€…ç”¨Pythonç”Ÿæˆçš„å›¾ã€‚</p></figure><h2 id="f7c9" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">PyMC3: 100ä¸ªæ ·æœ¬</h2><p id="0786" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">è¦ä½¿ç”¨PyMC3ï¼Œæˆ‘ä»¬å¿…é¡»å¯åŠ¨ä¸€ä¸ªæ¨¡å‹ï¼Œé€‰æ‹©æˆ‘ä»¬çš„å…ˆéªŒï¼Œå¹¶å‘Šè¯‰æ¨¡å‹æˆ‘ä»¬çš„åéªŒåº”è¯¥æ˜¯ä»€ä¹ˆåˆ†å¸ƒ:</p><pre class="kj kk kl km gt oc od oe of aw og bi"><span id="f2ac" class="nq la it od b gy oh oi l oj ok"># Start our model<br/>with pm.Model() as model_100:</span><span id="5922" class="nq la it od b gy ol oi l oj ok">    # Define the priors on each parameter:<br/>    grad = pm.Uniform("grad",<br/>                      lower=results.params['x']*0.5,<br/>                      upper=results.params['x']*1.5)<br/>    <br/>    inter = pm.Uniform("inter",<br/>                       lower=results.params['Intercept']*0.5,<br/>                       upper=results.params['Intercept']*1.5)<br/>    <br/>    sigma = pm.Uniform("sigma",<br/>                       lower=results.resid.std()*0.5,\<br/>                       upper=results.resid.std()*1.5)<br/>    <br/>    # Linear regression line<br/>    mean = inter + grad*data['x']<br/>    <br/>    # Describe the distribution of our conditional output<br/>    y = pm.Normal('y', mu = mean, sd = sigma, observed = data['y'])</span><span id="47b5" class="nq la it od b gy ol oi l oj ok">    # Run the sampling using pymc3 for 100 samples<br/>    trace_100 = pm.sample(100,return_inferencedata=True)</span></pre><p id="0920" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">è¿™æ®µä»£ç å°†è¿è¡ŒMCMCé‡‡æ ·å™¨æ¥è®¡ç®—æ¯ä¸ªå‚æ•°çš„åéªŒæ¦‚ç‡ã€‚åŒæ ·ï¼Œå¦‚æœæ‚¨æœ‰å…´è¶£äº†è§£MCMCæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè¯·å‚è€ƒèƒŒæ™¯éƒ¨åˆ†çš„é“¾æ¥ã€‚</p><p id="4301" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">æˆ‘ä»¬ç°åœ¨å¯ä»¥ç»˜åˆ¶æ¯ä¸ªå‚æ•°çš„åéªŒåˆ†å¸ƒ:</p><pre class="kj kk kl km gt oc od oe of aw og bi"><span id="e9e0" class="nq la it od b gy oh oi l oj ok">with model_100:<br/>    az.plot_posterior(trace_100,<br/>                      var_names=['grad', 'inter', 'sigma'],<br/>                      textsize=18,<br/>                      point_estimate='mean',<br/>                      rope_color='black')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/916a4d962982cb18879a989cbb8a497a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MNXwQgAAX3DJ5OsQzpCcrw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ä½œè€…ç”¨Pythonç”Ÿæˆçš„å›¾ã€‚</p></figure><p id="de2a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">è¿™äº›åéªŒåˆ†å¸ƒçš„å¹³å‡å€¼ä¸OLSä¼°è®¡å€¼ç›¸åŒï¼Œä½†æ˜¯è¿™ä¸æ˜¯å‚æ•°å¯ä»¥é‡‡ç”¨çš„å”¯ä¸€å€¼ã€‚å¦‚ä½ æ‰€è§ï¼Œæœ‰å¾ˆå¤šå€¼ã€‚è¿™æ˜¯è´å¶æ–¯çº¿æ€§å›å½’èƒŒåçš„è¦ç‚¹ã€‚</p><p id="08d6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">HDIä»£è¡¨<a class="ae ky" href="https://stats.stackexchange.com/questions/148439/what-is-a-highest-density-region-hdr" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">é«˜å¯†åº¦åŒºé—´</strong> </a>ï¼Œæè¿°äº†æˆ‘ä»¬åœ¨å‚æ•°ä¼°è®¡ä¸­çš„ç¡®å®šæ€§ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºäººç±»å‘å±•æŒ‡æ•°çš„ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æˆ‘åœ¨<a class="ae ky" href="https://en.wikipedia.org/wiki/Credible_interval" rel="noopener ugc nofollow" target="_blank">T21ã€è´å¶æ–¯å¯ä¿¡åŒºé—´T23ã€‘ä¸Šçš„åšæ–‡:</a></p><div class="mv mw gp gr mx my"><a rel="noopener follow" target="_blank" href="/bayesian-credible-intervals-simply-explained-24989c9259a3"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">è´å¶æ–¯å¯ä¿¡åŒºé—´ç®€å•è§£é‡Š</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">è´å¶æ–¯å¯ä¿¡åŒºé—´çš„ç®€æ˜æè¿°åŠå…¶åœ¨Pythonä¸­çš„å®ç°</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">towardsdatascience.com</p></div></div><div class="nh l"><div class="oo l nj nk nl nh nm ks my"/></div></div></a></div><p id="11dd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">è¿™ä¸ªæ¨¡æ‹Ÿåªä½¿ç”¨äº†æˆ‘ä»¬æ•°æ®ä¸­çš„100ä¸ªæ ·æœ¬ã€‚ä¸è´å¶æ–¯æ–¹æ³•ä¸€æ ·ï¼Œæˆ‘ä»¬éšç€æ›´å¤šçš„æ•°æ®å˜å¾—æ›´åŠ ç¡®å®šã€‚</p><h2 id="9cbf" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">PyMC3: 10ï¼Œ000ä¸ªæ ·æœ¬</h2><p id="1198" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">è®©æˆ‘ä»¬å†æ¬¡è¿è¡Œè¯¥è¿‡ç¨‹ï¼Œä½†ç°åœ¨ä½¿ç”¨10ï¼Œ000ä¸ªæ ·æœ¬:</p><pre class="kj kk kl km gt oc od oe of aw og bi"><span id="16c4" class="nq la it od b gy oh oi l oj ok"># Start our model<br/>with pm.Model() as model_10_100:</span><span id="0af0" class="nq la it od b gy ol oi l oj ok">    # Define the priors on each parameter:<br/>    grad = pm.Uniform("grad",<br/>                      lower=results.params['x']*0.5,<br/>                      upper=results.params['x']*1.5)<br/>    <br/>    inter = pm.Uniform("inter",<br/>                       lower=results.params['Intercept']*0.5,<br/>                       upper=results.params['Intercept']*1.5)<br/>    <br/>    sigma = pm.Uniform("sigma",<br/>                       lower=results.resid.std()*0.5,<br/>                       upper=results.resid.std()*1.5)<br/>    <br/>    # Linear regression line<br/>    mean = inter + grad*data['x']<br/>    <br/>    # Describe the distribution of our conditional output<br/>    y = pm.Normal('y', mu = mean, sd = sigma, observed = data['y'])</span><span id="5035" class="nq la it od b gy ol oi l oj ok">    # Run the sampling using pymc3 for 10,000 samples<br/>    trace_10_000 = pm.sample(10_000,return_inferencedata=True)</span></pre><p id="56ad" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">è®©æˆ‘ä»¬å†æ¬¡æŸ¥çœ‹å‚æ•°çš„åéªŒåˆ†å¸ƒ:</p><pre class="kj kk kl km gt oc od oe of aw og bi"><span id="ecdf" class="nq la it od b gy oh oi l oj ok">with model_10_100:<br/>    az.plot_posterior(trace_10_000,<br/>                      var_names=['grad', 'inter', 'sigma'],<br/>                      textsize=18,<br/>                      point_estimate='mean',<br/>                      rope_color='black')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/9aaaed10469bf07d0825bbd97240a5e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hlfk_t8mHK2TJHA4PnaDTw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ä½œè€…ç”¨Pythonç”Ÿæˆçš„å›¾ã€‚</p></figure><p id="f0dd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">å¹³å‡é¢„æµ‹æ²¡æœ‰æ”¹å˜ï¼Œä½†æ˜¯éšç€æˆ‘ä»¬æ›´åŠ ç¡®å®šå‚æ•°çš„åˆ†å¸ƒï¼Œæ€»ä½“ä¸Šåˆ†å¸ƒå˜å¾—æ›´åŠ å¹³æ»‘å’Œç´§å¯†ã€‚</p><h2 id="3a48" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">å¯†ç </h2><p id="587c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">è¦æŸ¥çœ‹æˆ‘åœ¨è¿™ç¯‡æ–‡ç« ä¸­ä½¿ç”¨çš„å…¨éƒ¨ä»£ç ï¼Œè¯·ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹GitHubä¸Šçš„ç¬”è®°æœ¬:</p><div class="mv mw gp gr mx my"><a href="https://github.com/egorhowell/Medium-Articles/blob/main/Statistics/pymc3_tutorial.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">Medium-Articles/pym C3 _ tutorial . ipynb at main egorhowell/Medium-Articles</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">æˆ‘åœ¨æˆ‘çš„åª’ä½“åšå®¢/æ–‡ç« ä¸­ä½¿ç”¨çš„ä»£ç ã€‚é€šè¿‡åˆ›å»ºä¸€ä¸ªå…³äºâ€¦çš„å¸æˆ·ï¼Œä¸ºegorhowell/Medium-Articlesçš„å¼€å‘åšå‡ºè´¡çŒ®</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">github.com</p></div></div><div class="nh l"><div class="op l nj nk nl nh nm ks my"/></div></div></a></div><h1 id="b0b8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">ç»“è®º</h1><p id="1b50" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æµè§ˆäº†è´å¶æ–¯ç»Ÿè®¡çš„ä¸»è¦åŸåˆ™ï¼Œå¹¶è§£é‡Šäº†å®ƒå¦‚ä½•é‡‡å–ä¸åŒäºé¢‘ç‡ç»Ÿè®¡çš„çº¿æ€§å›å½’æ–¹æ³•ã€‚ç„¶åæˆ‘ä»¬çœ‹äº†ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­ï¼Œå¦‚ä½•ä½¿ç”¨PyMC3åŒ…è¿›è¡Œè´å¶æ–¯å›å½’ã€‚</p><h1 id="0ec4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">å’Œæˆ‘è”ç³»ï¼</h1><ul class=""><li id="ca40" class="oq or it lt b lu lv lx ly ma os me ot mi ou mm ov ow ox oy bi translated">è¦åœ¨åª’ä½“ä¸Šé˜…è¯»æ— é™çš„æ•…äº‹ï¼Œè¯·åŠ¡å¿…åœ¨æ­¤æ³¨å†Œï¼T3<em class="mt">T5ã€‘ğŸ’œ</em></li><li id="9786" class="oq or it lt b lu oz lx pa ma pb me pc mi pd mm ov ow ox oy bi translated"><a class="ae ky" href="/subscribe/@egorhowell" rel="noopener ugc nofollow" target="_blank"> <em class="mt">å½“æˆ‘åœ¨è¿™é‡Œå‘å¸ƒæ³¨å†Œé‚®ä»¶é€šçŸ¥æ—¶ï¼Œå¯ä»¥è·å¾—æ›´æ–°ï¼</em> </a> <em class="mt"> </em>ğŸ˜€</li><li id="b8dc" class="oq or it lt b lu oz lx pa ma pb me pc mi pd mm ov ow ox oy bi translated"><a class="ae ky" href="https://www.linkedin.com/in/egor-howell-092a721b3/" rel="noopener ugc nofollow" target="_blank"> <em class="mt">é¢†è‹±</em> </a> <em class="mt"> </em>ğŸ‘”</li><li id="a7a0" class="oq or it lt b lu oz lx pa ma pb me pc mi pd mm ov ow ox oy bi translated"><a class="ae ky" href="https://twitter.com/EgorHowell" rel="noopener ugc nofollow" target="_blank"> <em class="mt">æ¨ç‰¹</em> </a> <em class="mt"> </em> ğŸ–Š</li><li id="fb18" class="oq or it lt b lu oz lx pa ma pb me pc mi pd mm ov ow ox oy bi translated"><a class="ae ky" href="https://github.com/egorhowell" rel="noopener ugc nofollow" target="_blank"><em class="mt">github</em></a><em class="mt"/>ğŸ–¥</li><li id="87b0" class="oq or it lt b lu oz lx pa ma pb me pc mi pd mm ov ow ox oy bi translated"><a class="ae ky" href="https://www.kaggle.com/egorphysics" rel="noopener ugc nofollow" target="_blank"><em class="mt"/></a><em class="mt"/>ğŸ…</li></ul><blockquote class="pe pf pg"><p id="72f1" class="lr ls mt lt b lu mn ju lw lx mo jx lz ph mp mc md pi mq mg mh pj mr mk ml mm im bi translated">(æ‰€æœ‰è¡¨æƒ…ç¬¦å·ç”±<a class="ae ky" href="https://openmoji.org/" rel="noopener ugc nofollow" target="_blank"> OpenMoji </a>è®¾è®¡â€”â€”å¼€æºè¡¨æƒ…ç¬¦å·å’Œå›¾æ ‡é¡¹ç›®ã€‚è®¸å¯è¯:<a class="ae ky" href="https://creativecommons.org/licenses/by-sa/4.0/#" rel="noopener ugc nofollow" target="_blank"> CC BY-SA 4.0 </a></p></blockquote></div></div>    
</body>
</html>
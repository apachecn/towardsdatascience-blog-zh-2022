<html>
<head>
<title>Part 12: Matrix Profiles For Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç¬¬12éƒ¨åˆ†:æœºå™¨å­¦ä¹ çš„çŸ©é˜µè½®å»“</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/part-12-matrix-profiles-for-machine-learning-2dfd98d7ff3f#2022-05-05">https://towardsdatascience.com/part-12-matrix-profiles-for-machine-learning-2dfd98d7ff3f#2022-05-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5b1d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">åœ¨STUMPYå‘ç°Shapelet</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ad4e754cf13b8202ebaef75b7c7eeaca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bM2bc5qNAji5uyQBQ6pBEQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(å›¾ç‰‡ç”±<a class="ae kv" href="https://unsplash.com/@ninjason" rel="noopener ugc nofollow" target="_blank"> Jason Leung </a>æä¾›)</p></figure><h1 id="5364" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">æ•´ä½“å¤§äºéƒ¨åˆ†ä¹‹å’Œ</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/76d64324c08fc58f1be4388db1892cb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/0*-Ljh5aAhePRv_Z1h.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><p id="5c82" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated"><a class="ae kv" href="https://github.com/TDAmeritrade/stumpy" rel="noopener ugc nofollow" target="_blank"> STUMPYæ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”å¯æ‰©å±•çš„Pythonåº“ï¼Œç”¨äºç°ä»£æ—¶é—´åºåˆ—åˆ†æ</a>ï¼Œåœ¨å…¶æ ¸å¿ƒï¼Œæœ‰æ•ˆåœ°è®¡ç®—å‡ºä¸€ç§å«åš<em class="ml">çŸ©é˜µè½®å»“</em>çš„ä¸œè¥¿ã€‚è¿™ä¸ªå¤šéƒ¨åˆ†ç³»åˆ—çš„ç›®æ ‡æ˜¯è§£é‡Šä»€ä¹ˆæ˜¯matrix profileï¼Œä»¥åŠå¦‚ä½•å¼€å§‹åˆ©ç”¨<a class="ae kv" href="https://stumpy.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> STUMPY </a>å®Œæˆæ‰€æœ‰ç°ä»£æ—¶é—´åºåˆ—æ•°æ®æŒ–æ˜ä»»åŠ¡ï¼</p><p id="e465" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated"><em class="ml">æ³¨:è¿™äº›æ•™ç¨‹æœ€åˆå‡ºç°åœ¨</em> <a class="ae kv" href="https://stumpy.readthedocs.io/en/latest/tutorials.html" rel="noopener ugc nofollow" target="_blank"> <em class="ml"> STUMPYæ–‡æ¡£</em> </a> <em class="ml">ä¸­ã€‚</em></p><p id="d32a" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">ç¬¬1éƒ¨åˆ†:<a class="ae kv" rel="noopener" target="_blank" href="/the-matrix-profile-e4a679269692">çŸ©é˜µè½®å»“å›¾</a> <br/>ç¬¬2éƒ¨åˆ†:<a class="ae kv" rel="noopener" target="_blank" href="/stumpy-basics-21844a2d2d92"> STUMPYåŸºç¡€çŸ¥è¯†</a> <br/>ç¬¬3éƒ¨åˆ†:<a class="ae kv" rel="noopener" target="_blank" href="/part-3-time-series-chains-da281450abbf">æ—¶é—´åºåˆ—é“¾</a> <br/>ç¬¬4éƒ¨åˆ†:<a class="ae kv" rel="noopener" target="_blank" href="/part-4-semantic-segmentation-b42c3792833d">è¯­ä¹‰åˆ†å‰²</a> <br/>ç¬¬5éƒ¨åˆ†:<a class="ae kv" rel="noopener" target="_blank" href="/part-5-fast-approximate-matrix-profiles-with-scrump-c6d9c984c560">ç”¨STUMPYå¿«é€Ÿè¿‘ä¼¼çŸ©é˜µè½®å»“å›¾</a> <br/>ç¬¬6éƒ¨åˆ†:<a class="ae kv" rel="noopener" target="_blank" href="/matrix-profiles-for-streaming-time-series-data-f877ff6f9eef">ç”¨äºæµå¼æ—¶é—´åºåˆ—æ•°æ®çš„çŸ©é˜µè½®å»“å›¾</a> <br/>ç¬¬7éƒ¨åˆ†:<a class="ae kv" rel="noopener" target="_blank" href="/part-7-fast-pattern-searching-with-stumpy-2baf610a8de1">ç”¨STUMPYå¿«é€Ÿæ¨¡å¼æœç´¢</a> 10: <a class="ae kv" rel="noopener" target="_blank" href="/part-10-discovering-multidimensional-time-series-motifs-45da53b594bb">å‘ç°å¤šç»´æ—¶é—´åºåˆ—æ¨¡ä½“</a> <br/>ç¬¬11éƒ¨åˆ†:<a class="ae kv" rel="noopener" target="_blank" href="/part-11-user-guided-motif-search-d3d317caf9ea">ç”¨æˆ·å¼•å¯¼çš„æ¨¡ä½“æœç´¢</a> <br/>ç¬¬12éƒ¨åˆ†:<a class="ae kv" rel="noopener" target="_blank" href="/part-12-matrix-profiles-for-machine-learning-2dfd98d7ff3f">æœºå™¨å­¦ä¹ çš„çŸ©é˜µè½®å»“</a></p><h1 id="bfaa" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">Shapeletå‘ç°</h1><p id="5401" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">æœ¬æ•™ç¨‹æ¢è®¨äº†æ¥è‡ªç ”ç©¶è®ºæ–‡çš„â€œShapelet Discoveryâ€æ¡ˆä¾‹ç ”ç©¶:<a class="ae kv" href="https://www.cs.ucr.edu/~eamonn/Top_Ten_Things_Matrix_Profile.pdf" rel="noopener ugc nofollow" target="_blank">æ—¶é—´åºåˆ—æ•°æ®æŒ–æ˜çš„ç‘å£«å†›åˆ€:ä½ å¯ä»¥ç”¨çŸ©é˜µæ¦‚è¦å’Œåè¡Œä»£ç åšçš„åä»¶æœ‰ç”¨çš„äº‹æƒ…ã€‘</a>(è§3.7èŠ‚)ã€‚æ­¤å¤–ï¼Œæ‚¨å¯èƒ½æƒ³è¦å‚è€ƒ<a class="ae kv" href="https://www.cs.ucr.edu/~eamonn/PID4481997_extend_Matrix%20Profile_I.pdf" rel="noopener ugc nofollow" target="_blank">çŸ©é˜µæ¦‚è¦I </a>å’Œ<a class="ae kv" href="https://www.cs.ucr.edu/~eamonn/shaplet.pdf" rel="noopener ugc nofollow" target="_blank">æ—¶é—´åºåˆ—Shapelets:ä¸€ç§æ–°çš„æ•°æ®æŒ–æ˜åŸè¯­</a>è®ºæ–‡ä»¥è·å¾—æ›´å¤šä¿¡æ¯å’Œå…¶ä»–ç›¸å…³ç¤ºä¾‹ã€‚</p><h1 id="bc62" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">ä»€ä¹ˆæ˜¯Shapeletï¼Ÿ</h1><p id="1cff" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">éæ­£å¼åœ°ï¼Œæ—¶é—´åºåˆ—â€œshapeletsâ€æ˜¯æ—¶é—´åºåˆ—å­åºåˆ—ï¼Œåœ¨æŸç§æ„ä¹‰ä¸Šï¼Œå®ƒæœ€å¤§é™åº¦åœ°ä»£è¡¨äº†ä¸€ä¸ªç±»ã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªæ—¶é—´åºåˆ—æ¥è·Ÿè¸ªæ‚¨å®¶ä¸­å¤§å‹ç”µå™¨äº”å¹´æ¥æ¯ç§’é’Ÿçš„è€—ç”µé‡ã€‚æ¯æ¬¡ä½ è¿è¡Œå¹²è¡£æœºã€æ´—ç¢—æœºæˆ–ç©ºè°ƒæ—¶ï¼Œä½ çš„ç”µè¡¨éƒ½ä¼šè®°å½•æ¶ˆè€—çš„ç”µåŠ›ï¼Œåªéœ€æŸ¥çœ‹æ—¶é—´åºåˆ—ï¼Œä½ å°±å¯ä»¥å°†ç”µåŠ›æ¶ˆè€—â€œç‰¹å¾â€(å³å½¢çŠ¶ã€æŒç»­æ—¶é—´ã€æœ€å¤§èƒ½æºä½¿ç”¨é‡ç­‰)ä¸æ¯å°è®¾å¤‡å…³è”èµ·æ¥ã€‚è¿™äº›æ¨¡å¼å¯èƒ½æ˜¾è€Œæ˜“è§ï¼Œä¹Ÿå¯èƒ½å¾ˆå¾®å¦™ï¼Œæ­£æ˜¯å®ƒä»¬ç‹¬ç‰¹çš„â€œæˆå½¢â€æ—¶åºå­åºåˆ—è®©æ‚¨èƒ½å¤ŸåŒºåˆ†æ¯ä¸ªç”µå™¨ç±»åˆ«ã€‚å› æ­¤ï¼Œè¿™äº›æ‰€è°“çš„shapeletå¯ç”¨äºå¯¹åŒ…å«shape letå‡ºç°çš„æœªæ ‡è®°æ—¶é—´åºåˆ—è¿›è¡Œåˆ†ç±»ã€‚å¦‚æœè¿™å¬èµ·æ¥æœ‰ç‚¹è¡Œè¯ï¼Œä¸è¦æ‹…å¿ƒï¼Œå› ä¸ºé€šè¿‡ä¸‹é¢çš„ä¾‹å­ï¼Œä¸€åˆ‡éƒ½ä¼šå˜å¾—æ›´æ¸…æ¥šã€‚</p><p id="1799" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">æœ€è¿‘çš„ç ”ç©¶(è§ä¸Šæ–‡)è¡¨æ˜ï¼ŒçŸ©é˜µé…ç½®æ–‡ä»¶å¯ä»¥ç”¨æ¥æœ‰æ•ˆåœ°è¯†åˆ«ç‰¹å®šç±»çš„shape letï¼Œå› æ­¤ï¼Œåœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å»ºç«‹åœ¨æˆ‘ä»¬çš„çŸ©é˜µé…ç½®æ–‡ä»¶çŸ¥è¯†ä¹‹ä¸Šï¼Œå¹¶æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨STUMPYè½»æ¾åœ°å‘ç°æœ‰è¶£çš„shape letï¼Œåªéœ€å‡ è¡Œé¢å¤–çš„ä»£ç ã€‚</p><h1 id="120e" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">å…¥é—¨æŒ‡å—</h1><p id="0a67" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">è®©æˆ‘ä»¬å¯¼å…¥åŠ è½½ã€åˆ†æå’Œç»˜åˆ¶æ•°æ®æ‰€éœ€çš„åŒ…ï¼Œç„¶åæ„å»ºç®€å•çš„å†³ç­–æ ‘æ¨¡å‹ã€‚</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="9470" class="mw kx iq ms b gy mx my l mz na"><strong class="ms ir">%</strong>matplotlib inline</span><span id="c4ff" class="mw kx iq ms b gy nb my l mz na"><strong class="ms ir">import</strong> stumpy<br/><strong class="ms ir">import</strong> pandas <strong class="ms ir">as</strong> pd<br/><strong class="ms ir">import</strong> numpy <strong class="ms ir">as</strong> np<br/><strong class="ms ir">import</strong> matplotlib.pyplot <strong class="ms ir">as</strong> plt<br/><strong class="ms ir">from</strong> sklearn <strong class="ms ir">import</strong> tree<br/><strong class="ms ir">from</strong> sklearn <strong class="ms ir">import</strong> metrics</span><span id="faab" class="mw kx iq ms b gy nb my l mz na">plt.style.use('https://raw.githubusercontent.com/TDAmeritrade/stumpy/main/docs/stumpy.mplstyle')</span></pre><h1 id="b2d3" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">åŠ è½½æªå£æ•°æ®é›†</h1><p id="6f07" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">è¯¥æ•°æ®é›†æ˜¯ä¸€ä¸ªè¿åŠ¨æ•æ‰æ—¶é—´åºåˆ—ï¼Œç”¨äºè·Ÿè¸ªæ¼”å‘˜å³æ‰‹çš„è¿åŠ¨ï¼ŒåŒ…å«ä¸¤ä¸ªç±»:</p><blockquote class="nc nd ne"><p id="5d35" class="lp lq ml lr b ls lt jr lu lv lw ju lx nf lz ma mb ng md me mf nh mh mi mj mk ij bi translated"><code class="fe ni nj nk ms b">1. Gun</code></p><p id="72c3" class="lp lq ml lr b ls lt jr lu lv lw ju lx nf lz ma mb ng md me mf nh mh mi mj mk ij bi translated"><code class="fe ni nj nk ms b">2. Point</code></p></blockquote><p id="f398" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">åœ¨<code class="fe ni nj nk ms b">Gun</code>ç±»ä¸­ï¼Œæ¼”å‘˜ä»è‡€éƒ¨å®‰è£…çš„æªå¥—ä¸­å–å‡ºä¸€æŠŠå®ä½“æªï¼Œå°†æªå¯¹å‡†ç›®æ ‡å¤§çº¦ä¸€ç§’é’Ÿï¼Œç„¶åå°†æªæ”¾å›æªå¥—ï¼Œå¹¶å°†æ‰‹æ”¾æ¾åˆ°èº«ä½“ä¸¤ä¾§ã€‚åœ¨<code class="fe ni nj nk ms b">Point</code>ç±»ä¸­ï¼Œæ¼”å‘˜å°†æªæ”¾åœ¨èº«ä½“ä¸¤ä¾§ï¼Œç›¸åï¼Œä»–ä»¬å°†é£ŸæŒ‡æŒ‡å‘ç›®æ ‡(å³æ²¡æœ‰æª)å¤§çº¦ä¸€ç§’é’Ÿï¼Œç„¶åå°†æ‰‹æ”¾å›èº«ä½“ä¸¤ä¾§ã€‚å¯¹äºè¿™ä¸¤ä¸ªç±»ï¼Œæ¼”å‘˜çš„å³æ‰‹è´¨å¿ƒè¢«è·Ÿè¸ªï¼Œä»¥ä»£è¡¨å…¶è¿åŠ¨ã€‚</p><p id="e76b" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">ä¸‹é¢ï¼Œæˆ‘ä»¬å°†æ£€ç´¢åŸå§‹æ•°æ®ï¼Œå°†å®ƒä»¬åˆ†æˆ<code class="fe ni nj nk ms b">gun_df</code>å’Œ<code class="fe ni nj nk ms b">point_df</code>ï¼Œç„¶åï¼Œå¯¹äºæ¯ä¸ªç›¸åº”çš„ç±»ï¼Œå°†æ‰€æœ‰å•ç‹¬çš„æ ·æœ¬è¿æ¥æˆä¸€ä¸ªé•¿æ—¶é—´åºåˆ—ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨æ¯ä¸ªæ ·æœ¬åé™„åŠ ä¸€ä¸ª<code class="fe ni nj nk ms b">NaN</code>å€¼ï¼Œä¸ºæ¯ä¸ªæ ·æœ¬å»ºç«‹ä¸€ä¸ªæ¸…æ™°çš„è¾¹ç•Œ(å³æ ·æœ¬å¼€å§‹å’Œç»“æŸçš„åœ°æ–¹)ã€‚è¿™æœ‰åŠ©äºç¡®ä¿æ‰€æœ‰çŸ©é˜µåˆ†å¸ƒè®¡ç®—ä¸ä¼šè¿”å›è·¨è¶Šå¤šä¸ªæ ·æœ¬çš„äººä¸ºå­åºåˆ—:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="e2ec" class="mw kx iq ms b gy mx my l mz na">train_df <strong class="ms ir">=</strong> pd.read_csv("https://zenodo.org/record/4281349/files/gun_point_train_data.csv?download=1")</span><span id="87d8" class="mw kx iq ms b gy nb my l mz na">gun_df <strong class="ms ir">=</strong> train_df[train_df['0'] <strong class="ms ir">==</strong> 0].iloc[:, 1:].reset_index(drop<strong class="ms ir">=True</strong>)</span><span id="08ac" class="mw kx iq ms b gy nb my l mz na">gun_df <strong class="ms ir">= </strong>(gun_df.assign(NaN<strong class="ms ir">=</strong>np.nan)<br/>                .stack(dropna<strong class="ms ir">=False</strong>)<br/>                .to_frame()<br/>                .reset_index(drop<strong class="ms ir">=True</strong>)<br/>                .rename({0: "Centroid Location"}, axis<strong class="ms ir">=</strong>'columns')<br/>)</span><span id="88cf" class="mw kx iq ms b gy nb my l mz na">point_df <strong class="ms ir">=</strong> train_df[train_df['0'] <strong class="ms ir">==</strong> 1].iloc[:, 1:].reset_index(drop<strong class="ms ir">=True</strong>)</span><span id="7ffe" class="mw kx iq ms b gy nb my l mz na">point_df <strong class="ms ir">=</strong> (point_df.assign(NaN<strong class="ms ir">=</strong>np.nan)<br/>                   .stack(dropna<strong class="ms ir">=False</strong>)<br/>                   .to_frame()<br/>                   .reset_index(drop<strong class="ms ir">=True</strong>)<br/>                   .rename({0: "Centroid Location"}, axis<strong class="ms ir">=</strong>'columns')<br/>)</span></pre><h1 id="5c35" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">å¯è§†åŒ–æªå£æ•°æ®é›†</h1><p id="96a6" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ç»˜åˆ¶æˆ‘ä»¬çš„æ•°æ®ï¼Œå¹¶æƒ³è±¡æ²¡æœ‰æªæ—¶å’Œæœ‰æªæ—¶çš„è¿åŠ¨å·®å¼‚:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="46b2" class="mw kx iq ms b gy mx my l mz na">fig, axs <strong class="ms ir">=</strong> plt.subplots(2, sharex<strong class="ms ir">=True</strong>, gridspec_kw<strong class="ms ir">=</strong>{'hspace': 0})<br/>plt.suptitle('Point vs. Gun', fontsize<strong class="ms ir">=</strong>'30')<br/>plt.xlabel('Time', fontsize <strong class="ms ir">=</strong>'20')<br/>fig.text(0.09, 0.5, 'Centroid Location', va<strong class="ms ir">=</strong>'center', rotation<strong class="ms ir">=</strong>'vertical', fontsize<strong class="ms ir">=</strong>'20')</span><span id="8103" class="mw kx iq ms b gy nb my l mz na">axs[0].plot(point_df, label<strong class="ms ir">=</strong>"Point")<br/>axs[0].legend()<br/>axs[1].plot(gun_df, color<strong class="ms ir">=</strong>"C1", label<strong class="ms ir">=</strong>"Gun")<br/>axs[1].legend()<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/55326dcffb81018bcf312435dc5913f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Azq7oxGBiE_dijPcIOmizw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><p id="6742" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">åœ¨è¿™ä¸ªæ•°æ®é›†ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°<code class="fe ni nj nk ms b">Point</code>å’Œ<code class="fe ni nj nk ms b">Gun</code>åˆ†åˆ«æœ‰26ä¸ªå’Œ24ä¸ªæ ·æœ¬ã€‚è¿™ä¸¤ä¸ªç±»éƒ½åŒ…å«çª„/å®½æ ·æœ¬å’Œå‚ç›´ç§»åŠ¨çš„è´¨å¿ƒä½ç½®ï¼Œè¿™ä½¿å¾—åŒºåˆ†å®ƒä»¬å…·æœ‰æŒ‘æˆ˜æ€§ã€‚æ‚¨æ˜¯å¦èƒ½å¤Ÿè¯†åˆ«å‡º<code class="fe ni nj nk ms b">Point</code>å’Œ<code class="fe ni nj nk ms b">Gun</code>ä¹‹é—´çš„ä»»ä½•ç»†å¾®å·®å¼‚(å³shapelets ),ä»è€Œå¸®åŠ©æ‚¨åŒºåˆ†è¿™ä¸¤ä¸ªç±»åˆ«ï¼Ÿ</p><p id="9de9" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">äº‹å®è¯æ˜ï¼ŒçŸ©é˜µè½®å»“å¯èƒ½æœ‰åŠ©äºæˆ‘ä»¬è‡ªåŠ¨è¯†åˆ«æ½œåœ¨çš„å½¢çŠ¶ï¼</p><h1 id="08f3" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">ä½¿ç”¨çŸ©é˜µè½®å»“æŸ¥æ‰¾å€™é€‰Shapelets</h1><p id="5a39" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">å›æƒ³ä¸€ä¸‹æˆ‘ä»¬çš„<a class="ae kv" href="https://stumpy.readthedocs.io/en/latest/Tutorial_AB_Joins.html" rel="noopener ugc nofollow" target="_blank">å¯»æ‰¾è·¨ä¸¤ä¸ªæ—¶é—´åºåˆ—çš„ä¿å®ˆæ¨¡å¼æ•™ç¨‹</a>ï¼Œä»å•ä¸ªæ—¶é—´åºåˆ—ğ‘‡ğ´è®¡ç®—çš„çŸ©é˜µåˆ†å¸ƒå›¾ğ‘ƒğ´ğ´è¢«ç§°ä¸ºâ€œè‡ªè¿æ¥â€,å®ƒå…è®¸ä½ è¯†åˆ«ğ‘‡ğ´.å†…çš„ä¿å®ˆå­åºåˆ—ç„¶è€Œï¼Œé€šè¿‡ä¸¤ä¸ªä¸åŒçš„æ—¶é—´åºåˆ—(ğ‘‡ğ´å’Œğ‘‡ğµ)è®¡ç®—çš„çŸ©é˜µåˆ†å¸ƒå›¾(ğ‘ƒğ´ğµ)é€šå¸¸è¢«ç§°ä¸ºâ€œAB-joinâ€ã€‚æœ¬è´¨ä¸Šï¼ŒAB-joinå°†ğ‘‡ğ´çš„æ‰€æœ‰å­åºåˆ—ä¸ğ‘‡ğµçš„æ‰€æœ‰å­åºåˆ—è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šğ‘‡ğ´çš„ä»»ä½•å­åºåˆ—æ˜¯å¦ä¹Ÿèƒ½åœ¨ğ‘‡ğµ.æ‰¾åˆ°æ¢å¥è¯è¯´ï¼Œäº§ç”Ÿçš„çŸ©é˜µè½®å»“ï¼Œğ‘ƒğ´ğµï¼Œç”¨å®ƒåœ¨ğ‘‡ğµ.çš„æœ€ä½³åŒ¹é…å­åºåˆ—æ¥æ³¨é‡Šåœ¨ğ‘‡ğ´çš„æ¯ä¸ªå­åºåˆ—ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬äº¤æ¢æ—¶é—´åºåˆ—å¹¶è®¡ç®—ğ‘ƒğµğ´(å³â€œBA-joinâ€)ï¼Œé‚£ä¹ˆè¿™ä¼šç”¨ğ‘‡ğ´.çš„æœ€è¿‘é‚»å­åºåˆ—æ¥æ³¨é‡Šğ‘‡ğµçš„æ¯ä¸ªå­åºåˆ—</p><p id="2398" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">æ ¹æ®<a class="ae kv" href="https://www.cs.ucr.edu/~eamonn/PID4481997_extend_Matrix%20Profile_I.pdf" rel="noopener ugc nofollow" target="_blank"> Matrix Profile I </a>è®ºæ–‡çš„héƒ¨åˆ†ï¼Œå£°ç§°æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Matrix Profileæ¥è¯•æ¢æ€§åœ°â€œå»ºè®®â€å€™é€‰shape letï¼Œå¹¶ä¸”ä¸»è¦ç›´è§‰æ˜¯ï¼Œå¦‚æœåœ¨<code class="fe ni nj nk ms b">Gun</code>ç±»ä¸­å­˜åœ¨åŒºåˆ«æ€§å›¾æ¡ˆï¼Œè€Œåœ¨<code class="fe ni nj nk ms b">Point</code>ç±»ä¸­ä¸å­˜åœ¨åŒºåˆ«æ€§å›¾æ¡ˆ(åä¹‹äº¦ç„¶)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æœŸæœ›åœ¨å®ƒä»¬ç›¸åº”çš„ğ‘ƒ(ğ‘ƒğ‘œğ‘–ğ‘›ğ‘¡,ğ‘ƒğ‘œğ‘–ğ‘›t)- ğ‘ƒ(ğ‘ƒğ‘œğ‘–ğ‘›ğ‘¡,ğºğ‘¢ğ‘›(æˆ–ğ‘ƒ(ğºğ‘¢ğ‘›,ğºğ‘¢n)- ğ‘ƒ(ğºğ‘¢ğ‘›,ğ‘ƒğ‘œğ‘–ğ‘›t)çŸ©é˜µProfileä¸­çœ‹åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªâ€œå‡¸èµ·â€ï¼Œå¹¶ä¸”é«˜åº¦ä¸Šçš„ä»»ä½•æ˜¾è‘—å·®å¼‚å¯èƒ½æ˜¯è‰¯å¥½å€™é€‰shape letçš„å¼ºæœ‰åŠ›æŒ‡ç¤ºã€‚</p><p id="f845" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">å› æ­¤ï¼Œé¦–å…ˆï¼Œè®©æˆ‘ä»¬è®¡ç®—çŸ©é˜µè½®å»“ï¼Œğ‘ƒ(ğ‘ƒğ‘œğ‘–ğ‘›ğ‘¡,ğ‘ƒğ‘œğ‘–ğ‘›t(è‡ªè¿æ¥)å’Œğ‘ƒ(ğ‘ƒğ‘œğ‘–ğ‘›ğ‘¡,ğºğ‘¢n(a B-è¿æ¥)ï¼Œå¹¶ä¸”ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬ä½¿ç”¨å­åºåˆ—é•¿åº¦<code class="fe ni nj nk ms b">m = 38</code>ï¼Œè¿™æ˜¯ä¸ºè¯¥æ•°æ®é›†æŠ¥å‘Šçš„æœ€ä½³shapelet <a class="ae kv" href="https://www.cs.ucr.edu/~eamonn/shaplet.pdf" rel="noopener ugc nofollow" target="_blank">çš„é•¿åº¦:</a></p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="1ce0" class="mw kx iq ms b gy mx my l mz na">m <strong class="ms ir">=</strong> 38</span><span id="204c" class="mw kx iq ms b gy nb my l mz na">P_Point_Point <strong class="ms ir">=</strong> stumpy.stump(point_df["Centroid Location"], m)[:, 0].astype(float)</span><span id="c67c" class="mw kx iq ms b gy nb my l mz na">P_Point_Gun <strong class="ms ir">=</strong> stumpy.stump(<br/>    point_df["Centroid Location"], <br/>    m, <br/>    gun_df["Centroid Location"], <br/>    ignore_trivial<strong class="ms ir">=False<br/></strong>)[:, 0].astype(float)</span></pre><p id="78cb" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">ç”±äºæˆ‘ä»¬çš„æ—¶é—´åºåˆ—ä¸­æœ‰ä¸€äº›<code class="fe ni nj nk ms b">np.nan</code>å€¼ï¼ŒçŸ©é˜µé…ç½®æ–‡ä»¶çš„è¾“å‡ºå°†åŒ…å«å‡ ä¸ª<code class="fe ni nj nk ms b">np.inf</code>å€¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†é€šè¿‡å°†å…¶è½¬æ¢ä¸º<code class="fe ni nj nk ms b">np.nan</code>æ¥æ‰‹åŠ¨è°ƒæ•´:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="745f" class="mw kx iq ms b gy mx my l mz na">P_Point_Point[P_Point_Point <strong class="ms ir">==</strong> np.inf] <strong class="ms ir">=</strong> np.nan<br/>P_Point_Gun[P_Point_Gun <strong class="ms ir">==</strong> np.inf] <strong class="ms ir">=</strong> np.nan</span></pre><p id="8eb7" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">ç°åœ¨æˆ‘ä»¬å°†å®ƒä»¬ä¸€ä¸ªå ä¸€ä¸ªåœ°ç»˜åˆ¶å‡ºæ¥:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="c936" class="mw kx iq ms b gy mx my l mz na">plt.plot(P_Point_Point, label<strong class="ms ir">=</strong>"$P_{Point,Point}$")<br/>plt.plot(P_Point_Gun, color<strong class="ms ir">=</strong>"C1", label<strong class="ms ir">=</strong>"$P_{Point,Gun}$")<br/>plt.xlabel("Time", fontsize<strong class="ms ir">=</strong>"20")<br/>plt.ylabel("Matrix Profile", fontsize<strong class="ms ir">=</strong>"20")<br/>plt.legend()<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/61e72de981bfaab5d7c667407f7383cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8nD5a5ScuOt3DPGRKFtIiw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><p id="66e9" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»˜åˆ¶ğ‘ƒ(ğ‘ƒğ‘œğ‘–ğ‘›ğ‘¡,ğ‘ƒğ‘œğ‘–ğ‘›tå’Œğ‘ƒ(ğ‘ƒğ‘œğ‘–ğ‘›ğ‘¡,ğºğ‘¢n).ä¹‹é—´çš„å·®å¼‚æ¥çªå‡ºä¸¤ä¸ªçŸ©é˜µå›¾ä¹‹é—´çš„ä¸»è¦åå·®ç›´è§‰ä¸Šï¼Œğ‘ƒ(ğ‘ƒğ‘œğ‘–ğ‘›ğ‘¡,ğ‘ƒğ‘œğ‘–ğ‘›t)å°†æ¯”ğ‘ƒ(ğ‘ƒğ‘œğ‘–ğ‘›ğ‘¡,ğºğ‘¢n)å°ï¼Œå› ä¸ºæˆ‘ä»¬æœŸæœ›åŒä¸€ç±»ä¸­çš„å­åºåˆ—æ¯”ä¸åŒç±»ä¸­çš„å­åºåˆ—æ›´ç›¸ä¼¼:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="a9b1" class="mw kx iq ms b gy mx my l mz na">P_diff <strong class="ms ir">=</strong> P_Point_Gun <strong class="ms ir">-</strong> P_Point_Point<br/>idx <strong class="ms ir">=</strong> np.argpartition(np.nan_to_num(P_diff), <strong class="ms ir">-</strong>10)[<strong class="ms ir">-</strong>10:]  <em class="ml"># get the top 10 peak locations in P_diff<br/></em>plt.suptitle("", fontsize<strong class="ms ir">=</strong>"30")<br/>plt.xlabel("Time", fontsize<strong class="ms ir">=</strong>"20")<br/>plt.ylabel("$P_{diff} = P_{Point,Gun} - P_{Point, Point}$", fontsize<strong class="ms ir">=</strong>"20")<br/>plt.plot(idx, P_diff[idx], color<strong class="ms ir">=</strong>"C1", marker<strong class="ms ir">=</strong>"o", linewidth<strong class="ms ir">=</strong>0, markersize<strong class="ms ir">=</strong>10)<br/>plt.plot(P_diff)<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/6e2fd8b0b8dfc9b0b67567dfb314d196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cYcA0ZFVJCxne122BOUPlw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><p id="ad45" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">ğ‘ƒ_ğ‘‘ğ‘–ğ‘“ğ‘“(æ©™è‰²åœ†åœˆ)ä¸­çš„å³°å€¼æ˜¯è‰¯å¥½shapeletå€™é€‰è€…çš„æŒ‡æ ‡ï¼Œå› ä¸ºå®ƒä»¬æš—ç¤ºäº†åœ¨å®ƒä»¬è‡ªå·±çš„ç±»(å³ï¼Œğ‘ƒ(ğ‘ƒğ‘œğ‘–ğ‘›ğ‘¡,ğ‘ƒğ‘œğ‘–ğ‘›tè‡ªè¿æ¥)ä¸­éå¸¸ä¿å®ˆçš„æ¨¡å¼ï¼Œä½†æ˜¯ä¹Ÿä¸å®ƒä»¬åœ¨å¦ä¸€ç±»(å³ï¼Œğ‘ƒ(ğ‘ƒğ‘œğ‘–ğ‘›ğ‘¡,ğºğ‘¢n a B-è¿æ¥)ä¸­æœ€æ¥è¿‘çš„åŒ¹é…éå¸¸ä¸åŒã€‚æœ‰äº†è¿™äº›çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬æå–å‘ç°çš„shapeletsï¼Œç„¶åç»˜åˆ¶å®ƒä»¬:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="f572" class="mw kx iq ms b gy mx my l mz na">point_shapelets <strong class="ms ir">=</strong> []<br/><strong class="ms ir">for</strong> i <strong class="ms ir">in</strong> idx:<br/>    shapelet <strong class="ms ir">=</strong> point_df.iloc[i : i <strong class="ms ir">+</strong> m, 0]<br/>    point_shapelets.append(shapelet)</span><span id="340c" class="mw kx iq ms b gy nb my l mz na">plt.xlabel("Time", fontsize<strong class="ms ir">=</strong>"20")<br/>plt.ylabel('Centroid Location', fontsize<strong class="ms ir">=</strong>'20')<br/>plt.plot(point_df, label<strong class="ms ir">=</strong>"Point")</span><span id="6910" class="mw kx iq ms b gy nb my l mz na"><strong class="ms ir">for</strong> i, shapelet <strong class="ms ir">in</strong> zip(idx, point_shapelets):<br/>    plt.plot(range(i, i <strong class="ms ir">+</strong> m), shapelet, color<strong class="ms ir">=</strong>"C1", linewidth<strong class="ms ir">=</strong>3.0)</span><span id="40ab" class="mw kx iq ms b gy nb my l mz na">plt.legend()<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/39f1cb456b6d0ebafdd0ea5ad07116d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r8Z7CvI-vgrSeiITz_L2IQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><p id="48b5" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">åŸºäºè¿™äº›å€™é€‰å½¢çŠ¶(æ©™è‰²)ï¼Œä¼¼ä¹è¿™ä¸¤ä¸ªç±»åˆ«ä¹‹é—´çš„ä¸»è¦åŒºåˆ«å› ç´ åœ¨äºæ¼”å‘˜çš„æ‰‹å¦‚ä½•å°†(å‡æƒ³çš„)æªæ”¾å›æªå¥—ï¼Œç„¶ååœ¨æ¼”å‘˜èº«è¾¹æ”¾æ¾ã€‚æ ¹æ®åŸä½œè€…çš„è¯´æ³•,<code class="fe ni nj nk ms b">Point</code>ç±»â€œæœ‰ä¸€ä¸ªâ€˜ä¸‹é™â€™,æ¼”å‘˜å°†æ‰‹æ”¾åœ¨èº«ä½“ä¸¤ä¾§ï¼Œè¿™æ˜¯æƒ¯æ€§ä½¿å¥¹çš„æ‰‹æœ‰ç‚¹å¤ªè¿œï¼Œå¥¹è¢«è¿«çº æ­£è¿™ä¸€ç‚¹â€”â€”ä½œè€…å°†è¿™ä¸€ç°è±¡ç§°ä¸ºâ€œè¿‡åº¦â€ã€‚</p><h1 id="9eb0" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">æ„å»ºä¸€ä¸ªç®€å•çš„åˆ†ç±»å™¨</h1><p id="40a0" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»ç¡®å®šäº†10ä¸ªå€™é€‰shape letï¼Œè®©æˆ‘ä»¬åŸºäºè¿™äº›shape letæ„å»º10ä¸ªç‹¬ç«‹çš„å†³ç­–æ ‘æ¨¡å‹ï¼Œçœ‹çœ‹å®ƒä»¬èƒ½åœ¨å¤šå¤§ç¨‹åº¦ä¸Šå¸®åŠ©æˆ‘ä»¬åŒºåˆ†<code class="fe ni nj nk ms b">Point</code>ç±»å’Œ<code class="fe ni nj nk ms b">Gun</code>ç±»ã€‚å¹¸è¿çš„æ˜¯ï¼Œè¿™ä¸ªæ•°æ®é›†åŒ…æ‹¬ä¸€ä¸ªè®­ç»ƒé›†(å¦‚ä¸Š)å’Œä¸€ä¸ªç‹¬ç«‹çš„æµ‹è¯•é›†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒä»¬æ¥è¯„ä¼°æˆ‘ä»¬çš„æ¨¡å‹çš„å‡†ç¡®æ€§:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="39b7" class="mw kx iq ms b gy mx my l mz na">test_df <strong class="ms ir">=</strong> df <strong class="ms ir">=</strong> pd.read_csv("https://zenodo.org/record/4281349/files/gun_point_test_data.csv?download=1")</span><span id="8f8e" class="mw kx iq ms b gy nb my l mz na"><em class="ml"># Get the train and test targets<br/></em>y_train <strong class="ms ir">=</strong> train_df.iloc[:, 0]<br/>y_test <strong class="ms ir">=</strong> test_df.iloc[:, 0]</span></pre><p id="5afe" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">ç°åœ¨ï¼Œå¯¹äºæˆ‘ä»¬çš„åˆ†ç±»ä»»åŠ¡ï¼Œéœ€è¦è¯„ä¼°æ¯ä¸ªshapeletsçš„é¢„æµ‹èƒ½åŠ›ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆè®¡ç®—shapeletå’Œæ¯ä¸ªæ—¶é—´åºåˆ—æˆ–æ ·æœ¬ä¸­çš„æ¯ä¸ªå­åºåˆ—ä¹‹é—´çš„è·ç¦»è½®å»“(æˆå¯¹æ¬§å‡ é‡Œå¾·è·ç¦»)ã€‚ç„¶åï¼Œä¿æŒæœ€å°å€¼ï¼Œä»¥äº†è§£æ˜¯å¦åœ¨æ—¶é—´åºåˆ—ä¸­æ‰¾åˆ°äº†shapeletçš„ç´§å¯†åŒ¹é…ã€‚<code class="fe ni nj nk ms b">stumpy.mass</code>åŠŸèƒ½éå¸¸é€‚åˆè¿™é¡¹ä»»åŠ¡:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="9844" class="mw kx iq ms b gy mx my l mz na"><strong class="ms ir">def</strong> distance_to_shapelet(data, shapelet):<br/>    """<br/>    Compute the minimum distance beteen each data sample<br/>    and a shapelet of interest<br/>    """<br/>    data <strong class="ms ir">=</strong> np.asarray(data)<br/>    X <strong class="ms ir">=</strong> np.empty(len(data))<br/>    <strong class="ms ir">for</strong> i <strong class="ms ir">in</strong> range(len(data)):<br/>        D <strong class="ms ir">=</strong> stumpy.mass(shapelet, data[i])<br/>        X[i] <strong class="ms ir">=</strong> D.min()</span><span id="4127" class="mw kx iq ms b gy nb my l mz na"><strong class="ms ir">    return</strong> X.reshape(<strong class="ms ir">-</strong>1, 1)</span><span id="e210" class="mw kx iq ms b gy nb my l mz na">clf <strong class="ms ir">=</strong> tree.DecisionTreeClassifier()<br/><strong class="ms ir">for</strong> i, shapelet <strong class="ms ir">in</strong> enumerate(point_shapelets):<br/>    X_train <strong class="ms ir">=</strong> distance_to_shapelet(train_df.iloc[:, 1:], shapelet)<br/>    X_test <strong class="ms ir">=</strong> distance_to_shapelet(test_df.iloc[:, 1:], shapelet)<br/>    clf.fit(X_train, y_train)<br/>    y_pred <strong class="ms ir">=</strong> clf.predict(X_test.reshape(<strong class="ms ir">-</strong>1, 1))<br/>    print(f"Accuracy for shapelet {i} = {round(metrics.accuracy_score(y_test, y_pred), 3)}")</span><span id="29bb" class="mw kx iq ms b gy nb my l mz na">Accuracy for shapelet 0 = 0.867<br/>Accuracy for shapelet 1 = 0.833<br/>Accuracy for shapelet 2 = 0.807<br/>Accuracy for shapelet 3 = 0.833<br/>Accuracy for shapelet 4 = 0.933<br/>Accuracy for shapelet 5 = 0.873<br/>Accuracy for shapelet 6 = 0.873<br/>Accuracy for shapelet 7 = 0.833<br/>Accuracy for shapelet 8 = 0.86<br/>Accuracy for shapelet 9 = 0.913</span></pre><p id="cac6" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œæ‰€æœ‰çš„Shapeletéƒ½æä¾›äº†ä¸€äº›åˆç†çš„é¢„æµ‹èƒ½åŠ›ï¼Œæœ‰åŠ©äºåŒºåˆ†<code class="fe ni nj nk ms b">Point</code>å’Œ<code class="fe ni nj nk ms b">Gun</code>ç±»ï¼Œä½†Shapelet 4è¿”å›äº†93.3%çš„æœ€ä½³å‡†ç¡®åº¦ï¼Œè¯¥ç»“æœå‡†ç¡®åœ°å†ç°äº†<a class="ae kv" href="https://www.cs.ucr.edu/~eamonn/Top_Ten_Things_Matrix_Profile.pdf" rel="noopener ugc nofollow" target="_blank">å‘å¸ƒçš„ç»“æœ</a>ã€‚å¤ªå¥½äº†ï¼</p><h1 id="953b" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">é™„åŠ éƒ¨åˆ†â€”ç¬¬äºŒç±»çš„Shapelets</h1><p id="7992" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">ä½œä¸ºé¢å¤–çš„ä¸€ç‚¹ï¼Œæˆ‘ä»¬è¿˜å°†ä»<code class="fe ni nj nk ms b">Gun</code>æ—¶é—´åºåˆ—ä¸­æå–shapeletsï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦èƒ½ä¸ºæˆ‘ä»¬çš„æ¨¡å‹å¢åŠ ä»»ä½•é¢å¤–çš„é¢„æµ‹èƒ½åŠ›ã€‚è¯¥è¿‡ç¨‹ä¸æˆ‘ä»¬åœ¨ä¸Šé¢è§£é‡Šè¿‡çš„è¿‡ç¨‹ç›¸åŒï¼Œåªæ˜¯æˆ‘ä»¬å…³æ³¨çš„æ˜¯ä»<code class="fe ni nj nk ms b">gun_df</code>æ´¾ç”Ÿçš„shapeletsï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡Œä¸æ‰“ç®—è¿›è¡Œè¿‡å¤šçš„æè¿°:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="1e5e" class="mw kx iq ms b gy mx my l mz na">m <strong class="ms ir">=</strong> 38</span><span id="ccce" class="mw kx iq ms b gy nb my l mz na">P_Gun_Gun <strong class="ms ir">=</strong> stumpy.stump(gun_df["Centroid Location"], m)[:, 0].astype(float)<br/>P_Gun_Point <strong class="ms ir">=</strong> stumpy.stump(gun_df["Centroid Location"], m, point_df["Centroid Location"], ignore_trivial<strong class="ms ir">=False</strong>)[:, 0].astype(float)</span><span id="53c1" class="mw kx iq ms b gy nb my l mz na">P_Gun_Gun[P_Gun_Gun <strong class="ms ir">==</strong> np.inf] <strong class="ms ir">=</strong> np.nan<br/>P_Gun_Point[P_Gun_Point <strong class="ms ir">==</strong> np.inf] <strong class="ms ir">=</strong> np.nan<br/>P_diff <strong class="ms ir">=</strong> P_Gun_Point <strong class="ms ir">-</strong> P_Gun_Gun<br/>idx <strong class="ms ir">=</strong> np.argpartition(np.nan_to_num(P_diff), <strong class="ms ir">-</strong>10)[<strong class="ms ir">-</strong>10:]  <em class="ml"># get the top 10 peak locations in P_diff<br/></em>plt.suptitle("", fontsize<strong class="ms ir">=</strong>"30")<br/>plt.xlabel("Time", fontsize<strong class="ms ir">=</strong>"20")<br/>plt.ylabel("$P_{diff} = P_{Gun, Point} - P_{Gun, Gun}$", fontsize<strong class="ms ir">=</strong>"20")<br/>plt.plot(idx, P_diff[idx], color<strong class="ms ir">=</strong>"C1", marker<strong class="ms ir">=</strong>"o", linewidth<strong class="ms ir">=</strong>0, markersize<strong class="ms ir">=</strong>10)<br/>plt.plot(P_diff)<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/eb76ec035408fd10c2057fe285a56bc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BbVuqxfzWEuTJnCwSvh6FQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="4a26" class="mw kx iq ms b gy mx my l mz na">gun_shapelets <strong class="ms ir">=</strong> []</span><span id="aeba" class="mw kx iq ms b gy nb my l mz na"><strong class="ms ir">for</strong> i <strong class="ms ir">in</strong> idx:<br/>    shapelet <strong class="ms ir">=</strong> gun_df.iloc[i : i <strong class="ms ir">+</strong> m, 0]<br/>    gun_shapelets.append(shapelet)<br/>plt.xlabel("Time", fontsize<strong class="ms ir">=</strong>"20")<br/>plt.ylabel('Centroid Location', fontsize<strong class="ms ir">=</strong>'20')<br/>plt.plot(gun_df, label<strong class="ms ir">=</strong>"Gun")</span><span id="529f" class="mw kx iq ms b gy nb my l mz na"><strong class="ms ir">for</strong> i, shapelet <strong class="ms ir">in</strong> zip(idx, gun_shapelets):<br/>    plt.plot(range(i, i <strong class="ms ir">+</strong> m), shapelet, color<strong class="ms ir">=</strong>"C1", linewidth<strong class="ms ir">=</strong>3.0)</span><span id="ef5c" class="mw kx iq ms b gy nb my l mz na">plt.legend()<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/376b240dc5c3637480855662907d20f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sEvnbYMGy02OrXnTuTTR9Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><p id="b974" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">è¯·æ³¨æ„ï¼Œå½“å­˜åœ¨ç‰©ç†æªæ—¶ï¼Œåœ¨<code class="fe ni nj nk ms b">Gun</code>ç»˜åˆ¶åŠ¨ä½œå¼€å§‹æ—¶å‘ç°çš„shapeletsä¸åƒ<code class="fe ni nj nk ms b">Point</code>æ ·æœ¬é‚£æ ·å¹³æ»‘ã€‚åŒæ ·ï¼Œç»™<code class="fe ni nj nk ms b">Gun</code>é‡æ–°è£…ä¸Šæªå¥—ä¼¼ä¹ä¹Ÿéœ€è¦ä¸€ç‚¹å¾®è°ƒã€‚</p><p id="fd97" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">æœ€åï¼Œæˆ‘ä»¬æ„å»ºæˆ‘ä»¬çš„æ¨¡å‹ï¼Œä½†æ˜¯è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬ç»“åˆäº†æ¥è‡ª<code class="fe ni nj nk ms b">Gun</code>shape letå’Œ<code class="fe ni nj nk ms b">Point</code>shape letçš„è·ç¦»ç‰¹å¾:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="9945" class="mw kx iq ms b gy mx my l mz na">clf <strong class="ms ir">=</strong> tree.DecisionTreeClassifier()<br/><strong class="ms ir">for</strong> i, (gun_shapelet, point_shapelet) <strong class="ms ir">in</strong> numerate(zip(gun_shapelets, point_shapelets)):<br/>    X_train_gun <strong class="ms ir">=</strong> distance_to_shapelet(train_df.iloc[:, 1:], gun_shapelet)<br/>    X_train_point <strong class="ms ir">=</strong> distance_to_shapelet(train_df.iloc[:, 1:], point_shapelet)<br/>    X_train <strong class="ms ir">=</strong> np.concatenate((X_train_gun, X_train_point), axis<strong class="ms ir">=</strong>1)<br/>    X_test_gun <strong class="ms ir">=</strong> distance_to_shapelet(test_df.iloc[:, 1:], gun_shapelet)<br/>    X_test_point <strong class="ms ir">=</strong> distance_to_shapelet(test_df.iloc[:, 1:], point_shapelet)<br/>    X_test <strong class="ms ir">=</strong> np.concatenate((X_test_gun, X_test_point), axis<strong class="ms ir">=</strong>1)<br/>    clf.fit(X_train, y_train)<br/>    y_pred <strong class="ms ir">=</strong> clf.predict(X_test)<br/>    print(f"Accuracy for shapelet {i} = {round(metrics.accuracy_score(y_test, y_pred), 3)}")</span><span id="8298" class="mw kx iq ms b gy nb my l mz na">Accuracy for shapelet 0 = 0.913<br/>Accuracy for shapelet 1 = 0.853<br/>Accuracy for shapelet 2 = 0.813<br/>Accuracy for shapelet 3 = 0.953<br/>Accuracy for shapelet 4 = 0.933<br/>Accuracy for shapelet 5 = 0.94<br/>Accuracy for shapelet 6 = 0.873<br/>Accuracy for shapelet 7 = 0.867<br/>Accuracy for shapelet 8 = 0.867<br/>Accuracy for shapelet 9 = 0.913</span></pre><p id="2066" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæˆ‘ä»¬åŒ…æ‹¬æ¥è‡ª<code class="fe ni nj nk ms b">Gun</code>ç±»Shapeletå’Œ<code class="fe ni nj nk ms b">Point</code>ç±»shape letçš„è·ç¦»ï¼Œåˆ†ç±»å™¨è¾¾åˆ°95.3%çš„å‡†ç¡®åº¦(Shapelet 3)ï¼æ˜¾ç„¶ï¼Œæ·»åŠ ä¸ç¬¬äºŒç±»çš„è·ç¦»ä¹Ÿä¸ºæ¨¡å‹æä¾›äº†é¢å¤–çš„æœ‰ç”¨ä¿¡æ¯ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç»“æœï¼Œå› ä¸ºå®ƒå°†ç»“æœæé«˜äº†å¤§çº¦2%ã€‚åŒæ ·ï¼Œä»¤äººå°è±¡æ·±åˆ»çš„æ˜¯ï¼Œæ‰€æœ‰è¿™äº›ä¿¡æ¯éƒ½å¯ä»¥é€šè¿‡åˆ©ç”¨çŸ©é˜µé…ç½®æ–‡ä»¶â€œå…è´¹â€æå–ã€‚</p><h1 id="a12e" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">æ‘˜è¦</h1><p id="1b9e" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated">å°±æ˜¯è¿™æ ·ï¼æ‚¨åˆšåˆšå­¦ä¹ äº†å¦‚ä½•åˆ©ç”¨çŸ©é˜µé…ç½®æ–‡ä»¶æ¥æŸ¥æ‰¾shapeletsï¼Œå¹¶ä½¿ç”¨å®ƒä»¬æ¥æ„å»ºæœºå™¨å­¦ä¹ åˆ†ç±»å™¨ã€‚</p><h1 id="6bd7" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">å‚è€ƒ</h1><p id="76d4" class="pw-post-body-paragraph lp lq iq lr b ls mm jr lu lv mn ju lx ly mo ma mb mc mp me mf mg mq mi mj mk ij bi translated"><a class="ae kv" href="https://www.cs.ucr.edu/~eamonn/Top_Ten_Things_Matrix_Profile.pdf" rel="noopener ugc nofollow" target="_blank">æ—¶é—´åºåˆ—æ•°æ®æŒ–æ˜çš„ç‘å£«å†›åˆ€:çŸ©é˜µæ¦‚è¦å’Œåè¡Œä»£ç å¯ä»¥åšçš„åä»¶æœ‰ç”¨çš„äº‹æƒ…</a>(å‚è§ç¬¬3.7èŠ‚)<br/> <a class="ae kv" href="https://www.cs.ucr.edu/~eamonn/shaplet.pdf" rel="noopener ugc nofollow" target="_blank">æ—¶é—´åºåˆ—Shapelets:æ•°æ®æŒ–æ˜çš„æ–°åŸè¯­</a> <br/> <a class="ae kv" href="https://stumpy.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> STUMPYæ–‡æ¡£</a> <br/> <a class="ae kv" href="https://github.com/TDAmeritrade/stumpy" rel="noopener ugc nofollow" target="_blank"> STUMPYçŸ©é˜µæ¦‚è¦Githubä»£ç åº“</a></p><h2 id="d863" class="mw kx iq bd ky nq nr dn lc ns nt dp lg ly nu nv li mc nw nx lk mg ny nz lm oa bi translated">â† <a class="ae kv" href="https://medium.com/p/d3d317caf9ea#92dc-ad9c13147b05" rel="noopener">ç¬¬11éƒ¨åˆ†:ç”¨æˆ·å¯¼å‘çš„ä¸»é¢˜æœç´¢</a> |ç¬¬13éƒ¨åˆ†å³å°†æ¨å‡ºâ†’</h2></div></div>    
</body>
</html>
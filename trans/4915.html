<html>
<head>
<title>Creating Your Own Logistic Regression Model from Scratch in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨Rä¸­ä»å¤´å¼€å§‹åˆ›å»ºè‡ªå·±çš„é€»è¾‘å›å½’æ¨¡å‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/creating-your-own-logistic-regression-model-from-scratch-in-r-ce719a49e10b#2022-11-01">https://towardsdatascience.com/creating-your-own-logistic-regression-model-from-scratch-in-r-ce719a49e10b#2022-11-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7a58" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">åœ¨æ²¡æœ‰å¤–éƒ¨åŒ…çš„æƒ…å†µä¸‹ç”¨Ræ„å»ºäºŒè¿›åˆ¶åˆ†ç±»æ¨¡å‹çš„åˆå­¦è€…æŒ‡å—</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bb372b594260dd92e5f9fe6a21ff40f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KeB2Wsj79Ac92UyO"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ç±³åˆ©å®‰Â·è€¶è¥¿è€¶åœ¨<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</p></figure><blockquote class="kz la lb"><p id="3545" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">è¿™ç¯‡æ–‡ç« ç€é‡äºä»å¤´å¼€å§‹å¼€å‘ä¸€ä¸ªé€»è¾‘å›å½’æ¨¡å‹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨è™šæ‹Ÿæ•°æ®æ¥ç ”ç©¶ä¼—æ‰€å‘¨çŸ¥çš„åˆ¤åˆ«æ¨¡å‹(å³é€»è¾‘å›å½’)çš„æ€§èƒ½ï¼Œå¹¶éšç€æ•°æ®é‡çš„å¢åŠ åæ˜ å…¸å‹åˆ¤åˆ«æ¨¡å‹çš„å­¦ä¹ æ›²çº¿çš„è¡Œä¸ºã€‚æ•°æ®é›†å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°<a class="ae ky" href="https://github.com/angeleastbengal/Data-Collection" rel="noopener ugc nofollow" target="_blank">ã€‚è¯·æ³¨æ„ï¼Œè¯¥æ•°æ®æ˜¯ä½¿ç”¨éšæœºæ•°ç”Ÿæˆå™¨åˆ›å»ºçš„ï¼Œç”¨äºåœ¨æ¦‚å¿µä¸Šè®­ç»ƒæ¨¡å‹ã€‚</a></p></blockquote><h1 id="3c91" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">ä»‹ç»</h1><p id="f06b" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated">é€»è¾‘å›å½’ç›´æ¥å°†ç›®æ ‡å˜é‡yå¯¹è¾“å…¥xçš„é¢„æµ‹å»ºæ¨¡ä¸ºå®šä¹‰ä¸º<strong class="lf iu"> p(y|x) </strong>çš„æ¡ä»¶æ¦‚ç‡ã€‚ä¸çº¿æ€§å›å½’æ¨¡å‹ç›¸æ¯”ï¼Œåœ¨é€»è¾‘å›å½’ä¸­ï¼Œç›®æ ‡å€¼é€šå¸¸è¢«é™åˆ¶ä¸º0åˆ°1ä¹‹é—´çš„å€¼ï¼›æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ¿€æ´»å‡½æ•°(sigmoid)å°†æˆ‘ä»¬çš„é¢„æµ‹è½¬æ¢æˆä¸€ä¸ªæœ‰ç•Œå€¼ã€‚</p><p id="0c9f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">å‡è®¾å‡½æ•°sigmoidåº”ç”¨äºæ•°æ®çš„çº¿æ€§å‡½æ•°æ—¶ï¼Œå°†å…¶è½¬æ¢ä¸º:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/9ba827f28054ad6d611192f9c88cb663.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*wXPxgPS13EYPpNkHS5qJKA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd na">æ–¹ç¨‹å¼1ã€‚</strong>è¯´æ˜äº†åº”ç”¨äºçº¿æ€§å‡½æ•°çš„sigmoidå˜æ¢ã€‚ä½œè€…ä½¿ç”¨Markdown &amp; Latexåˆ¶ä½œçš„å›¾ç‰‡ã€‚</p></figure><p id="174e" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">æˆ‘ä»¬ç°åœ¨å¯ä»¥å°†ç±»åˆ«æ¦‚ç‡å»ºæ¨¡ä¸º:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/88bf6edd4973f1dfa5fa037a25270c9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*cJ7ek8r1OjpgLdqIqyt7nA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd na">æ–¹ç¨‹å¼2ã€‚</strong>ä½¿ç”¨é€»è¾‘å‡½æ•°è¯´æ˜äº†ç±»åˆ«æ¦‚ç‡Cã€‚å›¾ç‰‡ç”±ä½œè€…ä½¿ç”¨Markdown &amp;ä¹³èƒ¶åˆ¶ä½œã€‚</p></figure><p id="43ab" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">æˆ‘ä»¬ç°åœ¨å¯ä»¥å°†ç±»åˆ«æ¦‚ç‡C=1æˆ–C=0å»ºæ¨¡ä¸º:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/b459b91e53570ddd6c1fcc0627181a5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Sa09ekbtEw5VEAXtEcwDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd na">æ–¹ç¨‹å¼3ã€‚</strong>ä½¿ç”¨é€»è¾‘å‡½æ•°ï¼Œè¯´æ˜ç±»åˆ«æ¦‚ç‡C=1|Xå’ŒC=0|Xã€‚å›¾ç‰‡ç”±ä½œè€…ä½¿ç”¨Markdown &amp; Latexåˆ¶ä½œã€‚</p></figure><p id="b9d8" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">é€»è¾‘å›å½’æœ‰ä¸€ä¸ªçº¿æ€§å†³ç­–è¾¹ç•Œï¼›å› æ­¤ï¼Œä½¿ç”¨æœ€å¤§ä¼¼ç„¶å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šæ¨¡å‹å‚æ•°ï¼Œå³æƒé‡ã€‚<strong class="lf iu">æ³¨P(C|x) = y(x)ï¼Œä¸ºç®€å•èµ·è§ï¼Œè®°ä¸ºyâ€™ã€‚</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/0ed310933928182e32d3b41119c21bee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*-VBrJlGkp0FniqoBUFo5Ow.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd na">æ–¹ç¨‹å¼4ã€‚</strong>è¯´æ˜äº†æŸå¤±å‡½æ•°ã€‚ä½œè€…ä½¿ç”¨Markdown &amp; Latexåˆ¶ä½œçš„å›¾ç‰‡ã€‚</p></figure><p id="ff85" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">æœ€å¤§ä¼¼ç„¶å‡½æ•°å¯ä»¥è®¡ç®—å¦‚ä¸‹:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/cb3acd4afae77f0fc151e7c4626baae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*1DmjhChs5JwUsDag1G4xrg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd na">æ–¹ç¨‹å¼5ã€‚</strong>ä½œè€…ä½¿ç”¨Markdown &amp; Latexåˆ¶ä½œçš„å›¾ç‰‡ã€‚</p></figure><p id="57d9" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨è™šæ‹Ÿæ•°æ®æ¥ç©é€»è¾‘å›å½’æ¨¡å‹ã€‚</p><h1 id="bebf" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">1.åœ¨Rä¸­åŠ è½½ç›¸å…³çš„åº“</h1><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="92fe" class="nk ma it ng b gy nl nm l nn no">#---------------------------------Loading Libraries---------------------------------<br/>library(mvtnorm)<br/>library(reshape2)<br/>library(ggplot2)<br/>library(corrplot)<br/>library(gridExtra)</span></pre><p id="d384" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">è¿™äº›åº“å°†ç”¨äºåˆ›å»ºå¯è§†åŒ–å’Œæ£€æŸ¥æ•°æ®ä¸å¹³è¡¡ã€‚</p><h1 id="4119" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">2.è¯»å–ç›¸å…³æ•°æ®</h1><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="f2b8" class="nk ma it ng b gy nl nm l nn no">#---------------------------------Set Working Directory---------------------------------</span><span id="6b19" class="nk ma it ng b gy np nm l nn no">setwd("C:/Users/91905/LR/")</span><span id="756c" class="nk ma it ng b gy np nm l nn no">#---------------------------------Loading Training &amp; Test Data---------------------------------</span><span id="c0e3" class="nk ma it ng b gy np nm l nn no">train_data = read.csv("Train_Logistic_Model.csv", header=T)<br/>test_data = read.csv("Test_Logistic_Model.csv", header=T)</span><span id="87d2" class="nk ma it ng b gy np nm l nn no">#---------------------------------Set random seed (to produce reproducible results)---------------------------------<br/>set.seed(1234)</span><span id="fea3" class="nk ma it ng b gy np nm l nn no">#---------------------------------Create  training and testing labels and data---------------------------------<br/>train.len = dim(train_data)[1]<br/>train.data &lt;- train_data[1:2]<br/>train.label &lt;- train_data[,3]</span><span id="1d29" class="nk ma it ng b gy np nm l nn no">test.len = dim(test_data)[1]<br/>test.data &lt;- test_data[1:2]<br/>test.label &lt;- test_data[ ,3]</span><span id="27d7" class="nk ma it ng b gy np nm l nn no">#---------------------------------Defining Class labels---------------------------------<br/>c0 &lt;- '1'; c1 &lt;- '-1'</span></pre><h1 id="464e" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">3.åˆ›å»ºå›¾:è®­ç»ƒå’Œæµ‹è¯•æ•°æ®çš„ç‹¬ç«‹å˜é‡æ•£ç‚¹å›¾</h1><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="f331" class="nk ma it ng b gy nl nm l nn no">#------------------------------Function to define figure size---------------------------------<br/>fig &lt;- function(width, heigth){<br/>     options(repr.plot.width = width, repr.plot.height = heigth)<br/>}</span></pre><p id="4b5b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">è§‚å¯Ÿæ•°æ®çš„åˆ†å¸ƒã€‚</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="19e1" class="nk ma it ng b gy nl nm l nn no"># â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” Creating a Copy of Training Data â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -<br/>data=train_data<br/>data[â€˜labelsâ€™]=lapply(train_data[â€˜yâ€™], as.character)</span><span id="88cc" class="nk ma it ng b gy np nm l nn no">fig(18,8)<br/>plt1=ggplot(data=data, aes(x=x1, y=x2, color=labels)) + <br/>geom_point()+<br/> ggtitle (â€˜Scatter Plot of X1 and X2: Training Dataâ€™) +<br/> theme(plot.title = element_text(size = 10, hjust=0.5), legend.position=â€™topâ€™)</span><span id="669e" class="nk ma it ng b gy np nm l nn no">data=test_data<br/>data[â€˜labelsâ€™]=lapply(test_data[â€˜yâ€™], as.character)</span><span id="e4c5" class="nk ma it ng b gy np nm l nn no">fig(18,8)<br/>plt2=ggplot(data=data, aes(x=x1, y=x2, color=labels)) + <br/>geom_point()+<br/> ggtitle (â€˜Scatter Plot of X1 and X2: Test Dataâ€™) +<br/> theme(plot.title = element_text(size = 10, hjust=0.5), legend.position=â€™topâ€™)</span><span id="4436" class="nk ma it ng b gy np nm l nn no">grid.arrange(plt1, plt2, ncol=2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/07a3de6df8a8995bd6f3af791d9e70b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m4yYg4zq5ek7fR68kIKAyw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd na">å›¾ä¸€ã€‚</strong>è¯´æ˜äº†è®­ç»ƒå’Œæµ‹è¯•æ•°æ®çš„åˆ†å¸ƒã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä¸Šé¢çš„å›¾ä¸­è§‚å¯Ÿåˆ°æ•°æ®æ˜¯çº¿æ€§å¯åˆ†çš„ã€‚è¿™æ˜¯ä¼ªæ•°æ®ã€‚çœŸå®ä¸–ç•Œçš„æ•°æ®å¯èƒ½ä¸åƒç±»ä¼¼çš„åˆ†å¸ƒï¼Œè‡ªå˜é‡çš„æ•°é‡ä¹Ÿä¸ä¼šé™åˆ¶ä¸ºä¸¤ä¸ªã€‚Image credit â€”ç”±ä½œè€…ä½¿ç”¨rã€‚</p></figure><h1 id="74c9" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">4.æ£€æŸ¥é˜¶çº§ä¸å¹³è¡¡</h1><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="9550" class="nk ma it ng b gy nl nm l nn no">#------------------------------Function to define figure size---------------------------------<br/>fig &lt;- function(width, heigth){<br/>     options(repr.plot.width = width, repr.plot.height = heigth)<br/>}</span></pre><p id="3a4d" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">çœ‹æ•°æ®ä¸å¹³è¡¡ã€‚æˆ‘ä»¬æ£€æŸ¥æ¥è‡ªè®­ç»ƒå’Œæµ‹è¯•æ•°æ®çš„å‰100è¡Œã€‚</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="0fec" class="nk ma it ng b gy nl nm l nn no">library(â€˜dplyrâ€™)</span><span id="e0e3" class="nk ma it ng b gy np nm l nn no">data_incr=100<br/>fig(8,4)</span><span id="238f" class="nk ma it ng b gy np nm l nn no"># â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” Creating a Copy of Training Data â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -<br/>data=train_data<br/>data[â€˜labelsâ€™]=lapply(train_data[â€˜yâ€™], as.character)</span><span id="e83e" class="nk ma it ng b gy np nm l nn no"># â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” Looping 100 iterations (500/5) â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” <br/># â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” Since increment is 5 â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” <br/>for (i in 1:2)<br/> <br/> {</span><span id="02ac" class="nk ma it ng b gy np nm l nn no">interim=data[1:data_incr,]<br/> <br/> # â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” Count of Records by class balance â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” <br/> result&lt;-interim%&gt;%<br/> group_by(labels) %&gt;%<br/> summarise(Records = n())<br/> <br/> # â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” Plot â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” <br/> if (i==1)<br/> {<br/> plot1=ggplot(data=result, aes(x=labels, y=Records)) +<br/> geom_bar(stat=â€identityâ€, fill=â€steelblueâ€)+<br/> geom_text(aes(label=Records), vjust=-0.3, size=3.5)+<br/> ggtitle(â€œDistribution of Class (#Training Data=5) â€œ)+<br/> theme(plot.title = element_text(size = 10, hjust=0.5), legend.position=â€™topâ€™)<br/> }<br/> <br/> else<br/> {<br/> plot2=ggplot(data=result, aes(x=labels, y=Records)) +<br/> geom_bar(stat=â€identityâ€, fill=â€steelblueâ€)+<br/> geom_text(aes(label=Records), vjust=-0.3, size=3.5)+<br/> ggtitle(â€œDistribution of Class (#Training Data=10) â€œ)+<br/> theme(plot.title = element_text(size = 10, hjust=0.5), legend.position=â€™topâ€™)<br/> }<br/> <br/> <br/> data_incr=data_incr+5<br/> <br/> }<br/>grid.arrange(plot1, plot2, ncol=2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/0275d438c8beb674115b0b6cd46b622e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1sDL8UGYDPCF8Pk9XGsskA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd na">å›¾äºŒã€‚</strong>è¯´æ˜äº†äºŒè¿›åˆ¶ç±»çš„åˆ†å¸ƒã€‚æ­£å¦‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬çš„ç§¯æç±»åœ¨æ•°æ®ä¸­å å¤šæ•°ï¼›å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ•°æ®åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ä¸å¹³è¡¡çš„ã€‚Credit â€”ç”±ä½œè€…ä½¿ç”¨rã€‚</p></figure><h1 id="7c14" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">5.é€»è¾‘å›å½’</h1><p id="e457" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated">æ¦‚ç‡åˆ¤åˆ«æ¨¡å‹ä½¿ç”¨å¹¿ä¹‰çº¿æ€§æ¨¡å‹æ¥è·å¾—ç±»åˆ«çš„åéªŒæ¦‚ç‡ï¼Œå¹¶æ—¨åœ¨ä½¿ç”¨æœ€å¤§ä¼¼ç„¶æ¥å­¦ä¹ å‚æ•°ã€‚é€»è¾‘å›å½’æ˜¯ä¸€ç§æ¦‚ç‡åˆ¤åˆ«æ¨¡å‹ï¼Œå¯ç”¨äºåŸºäºåˆ†ç±»çš„ä»»åŠ¡ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/06a1404f30a02680fbc2686dd3615f5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IG_9nqWDm8X26fCb3fWtIA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd na">å›¾ä¸‰ã€‚</strong>å±•ç¤ºäº†è®¾è®¡é€»è¾‘å›å½’æ¨¡å‹çš„é€æ­¥æ–¹æ³•ã€‚Credit â€”ç”±ä½œè€…ä½¿ç”¨markdownå’Œlatexå¼€å‘ã€‚</p></figure><h2 id="29d5" class="nk ma it bd mb ns nt dn mf nu nv dp mj mt nw nx ml mv ny nz mn mx oa ob mp oc bi translated">5.1å®šä¹‰è¾…åŠ©åŠŸèƒ½</h2><h2 id="17b0" class="nk ma it bd mb ns nt dn mf nu nv dp mj mt nw nx ml mv ny nz mn mx oa ob mp oc bi translated">é¢„æµ‹åŠŸèƒ½</h2><p id="784e" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated">ä½¿ç”¨æ¦‚ç‡åˆ†æ•°è¿”å›-1æˆ–+1ã€‚è¿™é‡Œä½¿ç”¨çš„é˜ˆå€¼æ˜¯0.5ï¼Œå³å¦‚æœä¸€ä¸ªç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡&gt; 0.5ï¼Œé‚£ä¹ˆè¯¥ç±»åˆ«è¢«æ ‡è®°ä¸º-1ï¼Œå¦åˆ™ä¸º+1ã€‚</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="8818" class="nk ma it ng b gy nl nm l nn no">#-------------------------------Auxiliary function that predicts class labels-------------------------------</span><span id="b038" class="nk ma it ng b gy np nm l nn no">predict &lt;- function(w, X, c0, c1)<br/>{<br/>    sig &lt;- sigmoid(w, X)<br/>    <br/>    return(ifelse(sig&gt;0.5, c1, c0))<br/>    <br/>}</span></pre><h2 id="b011" class="nk ma it bd mb ns nt dn mf nu nv dp mj mt nw nx ml mv ny nz mn mx oa ob mp oc bi translated">æˆæœ¬å‡½æ•°</h2><p id="da6a" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated">è®¡ç®—æˆæœ¬çš„è¾…åŠ©åŠŸèƒ½ã€‚</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="f9b2" class="nk ma it ng b gy nl nm l nn no">#-------------------------------Auxiliary function to calculate cost function-------------------------------</span><span id="2de7" class="nk ma it ng b gy np nm l nn no">cost &lt;- function (w, X, T, c0)<br/>{<br/>    sig &lt;- sigmoid(w, X)<br/>    return(sum(ifelse(T==c0, 1-sig, sig)))<br/>    <br/>}</span></pre><h2 id="5442" class="nk ma it bd mb ns nt dn mf nu nv dp mj mt nw nx ml mv ny nz mn mx oa ob mp oc bi translated">ä¹™çŠ¶ç»“è‚ åŠŸèƒ½</h2><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="c283" class="nk ma it ng b gy nl nm l nn no">#-------------------------------Auxiliary function to implement sigmoid function-------------------------------</span><span id="8e44" class="nk ma it ng b gy np nm l nn no">sigmoid &lt;- function(w, x)<br/>{<br/>    return(1.0/(1.0+exp(-w%*%t(cbind(1,x)))))    <br/>}</span></pre><h2 id="ac5a" class="nk ma it bd mb ns nt dn mf nu nv dp mj mt nw nx ml mv ny nz mn mx oa ob mp oc bi translated">5.1.4è®­ç»ƒé€»è¾‘å›å½’æ¨¡å‹</h2><p id="0cd8" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated">è¯¥ç®—æ³•çš„å·¥ä½œåŸç†å¦‚ä¸‹ã€‚æœ€åˆï¼Œè®¾ç½®å‚æ•°ã€‚ç„¶åï¼Œåœ¨å¤„ç†æ¯ä¸ªæ•°æ®ç‚¹Xnï¼ŒTnä¹‹åï¼Œå‚æ•°å‘é‡è¢«æ›´æ–°ä¸º:</p><p id="e51b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">ğ‘¤(ğœ+1):=ğ‘¤ğœâˆ’ğœ‚ğœ(ğ‘¦ğ‘›âˆ’ğ‘¡ğ‘›)(ğ‘¥ğ‘›)å…¶ä¸­ï¼Œ(ğ‘¦ğ‘›âˆ’ğ‘¡ğ‘›)(ğ‘¥ğ‘›)æ˜¯è¯¯å·®å‡½æ•°çš„æ¢¯åº¦ï¼Œğœæ˜¯è¿­ä»£æ¬¡æ•°ï¼Œğœ‚ğœæ˜¯ç‰¹å®šäºè¿­ä»£çš„å­¦ä¹ é€Ÿç‡ã€‚</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="b1bc" class="nk ma it ng b gy nl nm l nn no">Logistic_Regression &lt;- function(train.data, train.label, test.data, test.label)<br/>{<br/>    <br/>    #-------------------------------------Initializations-----------------------------------------<br/>    train.len = nrow(train.data)<br/>    <br/>    #-------------------------------------Iterations-----------------------------------------<br/>    tau.max &lt;- train.len * 2<br/>    <br/>    #-------------------------------------Learning Rate-----------------------------------------<br/>    eta &lt;- 0.01<br/>    <br/>    #-------------------------------------Threshold On Cost Function to Terminate Iteration-----------------------------------<br/>    epsilon &lt;- 0.01<br/>    <br/>    #-------------------------------------Counter for Iteration-----------------------------------<br/>    tau &lt;- 1<br/>    <br/>    #-------------------------------------Boolean to check Terimination-----------------------------------<br/>    terminate &lt;- FALSE</span><span id="19ac" class="nk ma it ng b gy np nm l nn no">#-------------------------------------Type Conversion-----------------------------------<br/>    <br/>    #-------------------------------------Convert Training Data to Matrix-----------------------------------<br/>    X &lt;- as.matrix(train.data)<br/>    <br/>    #-------------------------------------Train Labels-----------------------------------<br/>    T &lt;- ifelse(train.label==c0,0,1)<br/>    <br/>    #-------------------------------------Declaring Weight Matrix-----------------------------------<br/>    #-------------------------------------Used to Store Estimated Coefficients-----------------------------------<br/>    #-------------------------------------Dimension of the Matrix = Iteration x Total Columns + 1-----------------------------<br/>    <br/>    W &lt;- matrix(,nrow=tau.max, ncol=(ncol(X)+1))<br/>    <br/>    #-------------------------------------Initializing Weights-----------------------------------<br/>    W[1,] &lt;- runif(ncol(W))</span><span id="6dbc" class="nk ma it ng b gy np nm l nn no">#-------------------------------------Project Data Using Sigmoid function-----------------------------------<br/>    #-------------------------------------Y includes the probability values-----------------------------------<br/>    Y &lt;- sigmoid(W[1,],X)<br/>    <br/>    #-------------------------------------Creating a data frame for storing Cost-----------------------------------<br/>    costs &lt;- data.frame('tau'=1:tau.max)<br/>    <br/>    #-------------------------------------Threshold On Cost Function to Terminate Iteration-----------------------------------<br/>    costs[1, 'cost'] &lt;- cost(W[1,],X,T, c0)<br/> <br/>  <br/>  #-------------------------------------Checking Termination of Iteration-----------------------------------<br/>  while(!terminate){<br/>  <br/>      #-------------------------------------Terminating Criterion----------------------------------<br/>      #-------------------------------------1. Tau &gt; or = Tau Max (Iteration 1 is done before)----------------------------------<br/>      #-------------------------------------Cost &lt;=minimum value called epsilon-----------------------------------<br/>      <br/>      terminate &lt;- tau &gt;= tau.max | cost(W[tau,],X,T, c0)&lt;=epsilon</span><span id="abce" class="nk ma it ng b gy np nm l nn no">#-------------------------------------Shuffling Data-----------------------------------<br/>      train.index &lt;- sample(1:train.len, train.len, replace = FALSE)<br/>      <br/>      #-------------------------------------Obtaing Indexes of Dependent and Independent Variable------------------------------<br/>      X &lt;- X[train.index,]<br/>      T &lt;- T[train.index]</span><span id="399e" class="nk ma it ng b gy np nm l nn no">#-------------------------------------Iterating for each data point-----------------------------------<br/>      for (i in 1:train.len){<br/>        <br/>        #------------------------------------Cross check termination criteria-----------------------------------<br/>        if (tau &gt;= tau.max | cost(W[tau,],X,T, c0) &lt;=epsilon) {terminate&lt;-TRUE;break}<br/>        <br/>        #-------------------------------------Predictions using Current Weights-----------------------------------<br/>        Y &lt;- sigmoid(W[tau,],X)</span><span id="c31a" class="nk ma it ng b gy np nm l nn no">#-------------------------------------Updating Weights-----------------------------------<br/>        #-------------------------------------Refer to the Formula above-----------------------------------<br/>        <br/>        W[(tau+1),] &lt;- W[tau,] - eta * (Y[i]-T[i]) * cbind(1, t(X[i,]))</span><span id="59e5" class="nk ma it ng b gy np nm l nn no">#-------------------------------------Calculate Cost-----------------------------------<br/>        costs[(tau+1), 'cost'] &lt;- cost(W[tau,],X,T, c0)</span><span id="e3f1" class="nk ma it ng b gy np nm l nn no"># #-------------------------------------Updating Iteration-----------------------------------<br/>        tau &lt;- tau + 1</span><span id="48ea" class="nk ma it ng b gy np nm l nn no"># #-------------------------------------Decrease Learning Rate-----------------------------------<br/>        eta = eta * 0.999<br/>      }<br/>      }<br/>     <br/>    #-------------------------------------Remove NAN from Cost vector if it stops early-----------------------------------<br/>      costs &lt;- costs[1:tau, ]</span><span id="7bb3" class="nk ma it ng b gy np nm l nn no">#-------------------------------------Final Weights-----------------------------------<br/>    # #-------------------------------------We use the last updated weight since it is most optimized---------------------<br/>      weights &lt;- W[tau,]</span><span id="2dc8" class="nk ma it ng b gy np nm l nn no">#-------------------------------------Calculating misclassification-----------------------------------<br/>    <br/>    train.predict&lt;-predict(weights,train.data,c0,c1)<br/>    test.predict&lt;-predict(weights,test.data,c0,c1)<br/>    <br/>      errors = matrix(,nrow=1, ncol=2)<br/>    <br/>      errors[,1] = (1-sum(train.label==train.predict)/nrow(train.data))<br/>      errors[,2] = (1-sum(test.label==test.predict)/nrow(test.data))<br/>  <br/>  return(errors)<br/>}</span></pre><p id="cd0c" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">é€»è¾‘å›å½’ï¼Œä½¿ç”¨æœ€å¤§ä¼¼ç„¶å­¦ä¹ å‚æ•°ã€‚è¿™æ„å‘³ç€åœ¨å­¦ä¹ æ¨¡å‹å‚æ•°(æƒé‡)æ—¶ï¼Œå¿…é¡»å¼€å‘å¹¶æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°ã€‚ç„¶è€Œï¼Œç”±äºéçº¿æ€§æ–¹ç¨‹ç³»ç»Ÿæ²¡æœ‰è§£æè§£ï¼Œæ‰€ä»¥ä½¿ç”¨è¿­ä»£è¿‡ç¨‹æ¥å¯»æ‰¾æœ€ä¼˜è§£ã€‚</p><p id="2924" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">éšæœºæ¢¯åº¦ä¸‹é™è¢«åº”ç”¨äºé€»è¾‘å›å½’çš„è®­ç»ƒç›®æ ‡ï¼Œä»¥å­¦ä¹ å‚æ•°å’Œè¯¯å·®å‡½æ•°ï¼Œä»è€Œæœ€å°åŒ–è´Ÿå¯¹æ•°ä¼¼ç„¶ã€‚</p><h2 id="f121" class="nk ma it bd mb ns nt dn mf nu nv dp mj mt nw nx ml mv ny nz mn mx oa ob mp oc bi translated">5.2ä½¿ç”¨ä¸åŒæ•°æ®å­é›†çš„è®­ç»ƒæ¨¡å‹</h2><p id="7c6d" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated">æˆ‘ä»¬å°†åœ¨ä¸åŒçš„æ•°æ®å­é›†ä¸Šè®­ç»ƒæ¨¡å‹ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†åœ¨ç ”ç©¶æ•°æ®é‡å¯¹æ¨¡å‹é”™è¯¯åˆ†ç±»ç‡çš„å½±å“æ—¶è€ƒè™‘æ–¹å·®å’Œåå·®ã€‚</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="81e8" class="nk ma it ng b gy nl nm l nn no">#------------------------------------------Creating a dataframe to track Errors--------------------------------------</span><span id="7614" class="nk ma it ng b gy np nm l nn no">acc_train &lt;- data.frame('Points'=seq(5, train.len, 5), 'LR'=rep(0,(train.len/5)))<br/>acc_test &lt;- data.frame('Points'=seq(5, test.len, 5), 'LR'=rep(0,(test.len/5)))</span><span id="0208" class="nk ma it ng b gy np nm l nn no">data_incr=5</span><span id="03a0" class="nk ma it ng b gy np nm l nn no">#------------------------------------------Looping 100 iterations (500/5)--------------------------------------<br/>#------------------------------------------Since increment is 5--------------------------------------<br/>for (i in 1:(train.len/5))<br/>    <br/>    {<br/>        #---------------------------------Training on a subset and test on whole data-----------------------------<br/>        error_Logistic = Logistic_Regression(train.data[1:data_incr, ], train.label[1:data_incr], test.data, test.label)<br/>        <br/>        #------------------------------------------Creating accuarcy metrics--------------------------------------<br/>      <br/>        acc_train[i,'LR'] &lt;- round(error_Logistic[ ,1],2)</span><span id="5d6b" class="nk ma it ng b gy np nm l nn no">acc_test[i,'LR'] &lt;- round(error_Logistic[ ,2],2)<br/>        <br/>        #------------------------------------------Increment by 5--------------------------------------<br/>        data_incr = data_incr + 5<br/>}</span></pre><p id="8aba" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated">æ¨¡å‹çš„å‡†ç¡®æ€§å¯é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œæ£€éªŒ:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="5e27" class="nk ma it ng b gy nl nm l nn no">head(acc_train)<br/>head(acc_test)</span></pre><h1 id="d46b" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">6.ç»“è®º</h1><p id="55fa" class="pw-post-body-paragraph lc ld it lf b lg mr ju li lj ms jx ll mt mu lo lp mv mw ls lt mx my lw lx ly im bi translated">åœ¨å¤„ç†æ¯ä¸ªæ•°æ®ç‚¹ä¹‹åæ›´æ–°å‚æ•°å‘é‡ï¼›å› æ­¤ï¼Œåœ¨é€»è¾‘å›å½’ä¸­ï¼Œè¿­ä»£çš„æ¬¡æ•°å–å†³äºæ•°æ®çš„å¤§å°ã€‚å½“å¤„ç†è¾ƒå°çš„æ•°æ®é›†æ—¶(å³æ•°æ®ç‚¹çš„æ•°é‡è¾ƒå°‘)ï¼Œæ¨¡å‹éœ€è¦æ›´å¤šçš„è®­ç»ƒæ•°æ®æ¥æ›´æ–°æƒé‡å’Œå†³ç­–è¾¹ç•Œã€‚å› æ­¤ï¼Œå½“è®­ç»ƒæ•°æ®é‡å¾ˆå°æ—¶ï¼Œå®ƒçš„å‡†ç¡®æ€§å¾ˆå·®ã€‚</p></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><p id="12ea" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mt ln lo lp mv lr ls lt mx lv lw lx ly im bi translated"><em class="le">å…³äºä½œè€…:é«˜çº§åˆ†æä¸“å®¶å’Œç®¡ç†é¡¾é—®ï¼Œå¸®åŠ©å…¬å¸é€šè¿‡å¯¹ç»„ç»‡æ•°æ®çš„å•†ä¸šã€æŠ€æœ¯å’Œæ•°å­¦çš„ç»„åˆæ‰¾åˆ°å„ç§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ä¸€ä¸ªæ•°æ®ç§‘å­¦çˆ±å¥½è€…ï¼Œåœ¨è¿™é‡Œåˆ†äº«ã€å­¦ä¹ ã€è´¡çŒ®ï¼›ä½ å¯ä»¥å’Œæˆ‘åœ¨</em> <a class="ae ky" href="https://www.linkedin.com/in/angel-das-9532bb12a/" rel="noopener ugc nofollow" target="_blank"> <em class="le">ä¸Šè”ç³»</em> </a> <em class="le">å’Œ</em> <a class="ae ky" href="https://twitter.com/dasangel07_andy" rel="noopener ugc nofollow" target="_blank"> <em class="le">ä¸Šæ¨ç‰¹</em></a><em class="le">ï¼›</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Implementing Gradient Descent in Python from Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä»å¤´å¼€å§‹åœ¨ Python ä¸­å®ç°æ¢¯åº¦ä¸‹é™</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/implementing-gradient-descent-in-python-from-scratch-760a8556c31f#2022-02-18">https://towardsdatascience.com/implementing-gradient-descent-in-python-from-scratch-760a8556c31f#2022-02-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d187" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">ä»å¤´å¼€å§‹ç”¨ä»£ç å®ç°æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œäº†è§£å®ƒçš„å·¥ä½œåŸç†ã€‚</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/58c9e8aaac3d4e402ea9bb79f3bdba7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*QZXjuWZdGLnYioL58vtYfA.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated"><strong class="bd kr">ä½œè€…å›¾ç‰‡(ä½¿ç”¨ python ä¸­çš„ matplotlib åˆ›å»º)</strong></p></figure><p id="bd1a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">æœºå™¨å­¦ä¹ æ¨¡å‹å¯èƒ½æœ‰å‡ ä¸ªç‰¹å¾ï¼Œä½†æ˜¯ä¸€äº›ç‰¹å¾å¯èƒ½æ¯”å…¶ä»–ç‰¹å¾å¯¹è¾“å‡ºæœ‰æ›´é«˜çš„å½±å“ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ¨¡å‹é¢„æµ‹å…¬å¯“ä»·æ ¼ï¼Œå…¬å¯“çš„ä½ç½®å¯¹è¾“å‡ºçš„å½±å“å¯èƒ½æ¯”å…¬å¯“å»ºç­‘çš„å±‚æ•°æ›´å¤§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æå‡ºäº†æƒé‡çš„æ¦‚å¿µã€‚æ¯ä¸ªç‰¹å¾éƒ½ä¸ä¸€ä¸ªæƒé‡(ä¸€ä¸ªæ•°å­—)ç›¸å…³è”ï¼Œå³ç‰¹å¾å¯¹è¾“å‡ºçš„å½±å“è¶Šå¤§ï¼Œä¸ä¹‹ç›¸å…³è”çš„æƒé‡å°±è¶Šå¤§ã€‚ä½†æ˜¯ï¼Œå¦‚ä½•å†³å®šåº”è¯¥ç»™æ¯ä¸ªç‰¹å¾åˆ†é…å¤šå¤§çš„æƒé‡å‘¢ï¼Ÿè¿™å°±æ˜¯æ¢¯åº¦ä¸‹é™çš„ç”¨æ­¦ä¹‹åœ°ã€‚</p><p id="1dd9" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">æ¢¯åº¦ä¸‹é™æ˜¯ä¸€ç§ä¼˜åŒ–ç®—æ³•ï¼Œå¯ä»¥å¸®åŠ©æ‚¨æ‰¾åˆ°æ¨¡å‹çš„æœ€ä½³æƒé‡ã€‚å®ƒé€šè¿‡å°è¯•å„ç§æƒé‡å¹¶æ‰¾åˆ°æœ€é€‚åˆæ¨¡å‹çš„æƒé‡æ¥å®ç°ï¼Œå³æœ€å°åŒ–æˆæœ¬å‡½æ•°ã€‚æˆæœ¬å‡½æ•°å¯ä»¥å®šä¹‰ä¸ºå®é™…äº§é‡å’Œé¢„æµ‹äº§é‡ä¹‹é—´çš„å·®å¼‚ã€‚å› æ­¤ï¼Œæˆæœ¬å‡½æ•°è¶Šå°ï¼Œæ¨¡å‹çš„é¢„æµ‹è¾“å‡ºå°±è¶Šæ¥è¿‘å®é™…è¾“å‡ºã€‚æˆæœ¬å‡½æ•°åœ¨æ•°å­¦ä¸Šå¯ä»¥å®šä¹‰ä¸º:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="18f9" class="lt lu iq lp b gy lv lw l lx ly"><strong class="lp ir">ğ‘¦=ğ›½+Î¸nXn,</strong> <br/>where x is the parameters(can go from 1 to n), ğ›½ is the             bias and Î¸ is the weight</span></pre><p id="d64a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è€Œå¦ä¸€æ–¹é¢ï¼Œæ¢¯åº¦ä¸‹é™çš„å­¦ä¹ ç‡è¢«è¡¨ç¤ºä¸º<strong class="ku ir"> Î±ã€‚</strong>å­¦ä¹ ç‡æ˜¯æ¯ä¸ªæ¢¯åº¦æ‰€èµ°çš„æ­¥çš„å¤§å°ã€‚è™½ç„¶è¾ƒå¤§çš„å­¦ä¹ ç‡å¯èƒ½ä¼šç»™æˆ‘ä»¬çš„<strong class="ku ir"> ğ›½ </strong>å’Œ<strong class="ku ir"> Î¸ </strong>çš„ä¼˜åŒ–å€¼è¾ƒå·®ï¼Œä½†å­¦ä¹ ç‡ä¹Ÿå¯èƒ½å¤ªå°ï¼Œè¿™éœ€è¦å¤§é‡å¢åŠ è·å¾—æ”¶æ•›ç‚¹(ğ›½å’ŒÎ¸çš„æœ€ä½³å€¼ç‚¹)æ‰€éœ€çš„è¿­ä»£æ¬¡æ•°ã€‚è¯¥ç®—æ³•ç»™å‡ºÎ± <strong class="ku ir">ã€</strong> ğ›½å’ŒÎ¸çš„å€¼ä½œä¸ºè¾“å‡ºã€‚</p><p id="db13" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">å¦‚æœä½ æƒ³æ›´è¯¦ç»†çš„äº†è§£æ¢¯åº¦ä¸‹é™å’Œä»£ä»·å‡½æ•°ï¼Œæˆ‘æ¨è<a class="ae lz" rel="noopener" target="_blank" href="/machine-leaning-cost-function-and-gradient-descend-75821535b2ef">è¿™ç¯‡æ–‡ç« </a>ã€‚</p><p id="a877" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯æ¢¯åº¦ä¸‹é™ä»¥åŠå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè®©æˆ‘ä»¬å¼€å§‹ç”¨ python å®ç°å®ƒã€‚ä½†æ˜¯ï¼Œåœ¨æˆ‘ä»¬å¼€å§‹ç›¸åŒçš„ä»£ç é€»è¾‘ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„æ•°æ®å’Œä¸ºäº†æˆ‘ä»¬çš„ç›®çš„å°†è¦å¯¼å…¥çš„åº“ã€‚</p><p id="5d55" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">å¯¹äºè¿™ä¸ªå®ç°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å¹¿å‘Šæ•°æ®é›†ã€‚è¿™æ˜¯ä¸€ä¸ªæ•°æ®é›†ï¼Œå®ƒç»™å‡ºäº†ä¸åŒäº§å“åœ¨ç”µè§†ã€å¹¿æ’­å’ŒæŠ¥çº¸ä¸Šé”€å”®åçš„æ€»é”€å”®é¢ã€‚ä½¿ç”¨æˆ‘ä»¬çš„ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾å‡ºå“ªç§åª’ä½“å¯¹æˆ‘ä»¬çš„é”€å”®è¡¨ç°æœ€å¥½ï¼Œå¹¶ç›¸åº”åœ°ä¸ºæ‰€æœ‰åª’ä½“åˆ†é…æƒé‡ã€‚è¯¥æ•°æ®é›†å¯ä»ä»¥ä¸‹é“¾æ¥ä¸‹è½½:</p><blockquote class="ma mb mc"><p id="af80" class="ks kt md ku b kv kw jr kx ky kz ju la me lc ld le mf lg lh li mg lk ll lm ln ij bi translated"><a class="ae lz" href="https://www.kaggle.com/sazid28/advertising.csv" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/sazid28/advertising.csv</a></p></blockquote><p id="9963" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è½¬åˆ°å¯¼å…¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åº“ pandas å’Œ numpyï¼Œå®ƒä»¬å°†ç”¨äºè¯»å–æ•°æ®ä»¥åŠå¯¹æ•°æ®æ‰§è¡Œæ•°å­¦å‡½æ•°ã€‚æˆ‘ä»¬è¿˜å°†ä½¿ç”¨ matplotlib å’Œ seaborn æ¥ç»˜åˆ¶æˆ‘ä»¬çš„å‘ç°ï¼Œå¹¶ä»¥å›¾å½¢æ–¹å¼è§£é‡Šç»“æœã€‚ä¸€æ—¦æˆ‘ä»¬å¯¼å…¥äº†åº“ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ pandas æ¥è¯»å–æˆ‘ä»¬çš„æ•°æ®é›†ï¼Œå¹¶æ‰“å°å‰ 5 åˆ—ä»¥ç¡®ä¿æ•°æ®è¢«æ­£ç¡®è¯»å–ã€‚ä¸€æ—¦æˆ‘ä»¬è¯»å–äº†æ•°æ®ï¼Œæˆ‘ä»¬å°†ä¸ºæˆ‘ä»¬çš„æ¢¯åº¦ä¸‹é™æ›²çº¿è®¾ç½® X &amp; Y å˜é‡ã€‚</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="57c1" class="lt lu iq lp b gy lv lw l lx ly">import pandas as pd</span><span id="2137" class="lt lu iq lp b gy mh lw l lx ly">import numpy as np</span><span id="7c35" class="lt lu iq lp b gy mh lw l lx ly">import matplotlib.pyplot as plt</span><span id="b953" class="lt lu iq lp b gy mh lw l lx ly">import seaborn as sn</span><span id="860b" class="lt lu iq lp b gy mh lw l lx ly">df=pd.read_csv('Advertising.csv')</span><span id="d2b4" class="lt lu iq lp b gy mh lw l lx ly">df.head()</span></pre><p id="90d2" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è¾“å‡º:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mi"><img src="../Images/955e36e643966b3604dcea7f11e9a9f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*avEBTNmC-LFjjxRNAQ1cBQ.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ(æ•°æ®é›†çš„å‰ 5 è¡Œ)</p></figure><p id="1342" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">x ä»£è¡¨ç”µè§†ã€å¹¿æ’­å’ŒæŠ¥çº¸ï¼Œè€Œ Y ä»£è¡¨æˆ‘ä»¬çš„é”€å”®ã€‚ç”±äºæ‰€æœ‰è¿™äº›é”€å”®å¯èƒ½åœ¨ä¸åŒçš„è§„æ¨¡ï¼Œç„¶åæˆ‘ä»¬æ­£å¸¸åŒ–æˆ‘ä»¬çš„ X &amp; Y å˜é‡ã€‚</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="195a" class="lt lu iq lp b gy lv lw l lx ly">X=df[[â€˜TVâ€™,â€™Radioâ€™,â€™Newspaperâ€™]]</span><span id="7abf" class="lt lu iq lp b gy mh lw l lx ly">Y=df[â€˜Salesâ€™]</span><span id="a563" class="lt lu iq lp b gy mh lw l lx ly">Y=np.array((Y-Y.mean())/Y.std())</span><span id="fcf1" class="lt lu iq lp b gy mh lw l lx ly">X=X.apply(lambda rec:(rec-rec.mean())/rec.std(),axis=0)</span></pre><p id="95e9" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">ä¸€æ—¦æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæ ‡å‡†åŒ–çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å®šä¹‰æˆ‘ä»¬çš„ç®—æ³•ã€‚è¦å®ç°æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œæˆ‘ä»¬éœ€è¦éµå¾ª 4 ä¸ªæ­¥éª¤:</p><ol class=""><li id="3453" class="mn mo iq ku b kv kw ky kz lb mp lf mq lj mr ln ms mt mu mv bi translated">éšæœºåˆå§‹åŒ–åå·®å’Œæƒé‡Î¸</li><li id="c90f" class="mn mo iq ku b kv mw ky mx lb my lf mz lj na ln ms mt mu mv bi translated">ç»™å®šåå·®å’Œæƒé‡ï¼Œè®¡ç®— Y çš„é¢„æµ‹å€¼</li><li id="0bea" class="mn mo iq ku b kv mw ky mx lb my lf mz lj na ln ms mt mu mv bi translated">æ ¹æ® Y çš„é¢„æµ‹å€¼å’Œå®é™…å€¼è®¡ç®—æˆæœ¬å‡½æ•°</li><li id="52a9" class="mn mo iq ku b kv mw ky mx lb my lf mz lj na ln ms mt mu mv bi translated">è®¡ç®—æ¢¯åº¦å’Œæƒé‡</li></ol><p id="50fa" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä¸ºåå·®å’Œæƒé‡å–ä¸€ä¸ªéšæœºå€¼ï¼Œå®ƒå¯èƒ½å®é™…ä¸Šæ¥è¿‘æœ€ä½³åå·®å’Œæƒé‡ï¼Œä¹Ÿå¯èƒ½ç¦»å¾—å¾ˆè¿œã€‚</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="a1ae" class="lt lu iq lp b gy lv lw l lx ly">import random</span><span id="c8b6" class="lt lu iq lp b gy mh lw l lx ly">def initialize(dim):</span><span id="de68" class="lt lu iq lp b gy mh lw l lx ly">b=random.random()</span><span id="2b64" class="lt lu iq lp b gy mh lw l lx ly">theta=np.random.rand(dim)</span><span id="7782" class="lt lu iq lp b gy mh lw l lx ly">return b,theta</span><span id="f5ec" class="lt lu iq lp b gy mh lw l lx ly">b,theta=initialize(3)</span><span id="c9cf" class="lt lu iq lp b gy mh lw l lx ly">print(â€œBias: â€œ,b,â€Weights: â€œ,theta)</span></pre><p id="dfe5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è¾“å‡º:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="f991" class="lt lu iq lp b gy lv lw l lx ly">Bias: 0.4439513186463464 Weights: [0.92396489 0.05155633 0.06354297]</span></pre><p id="a15a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º initialise çš„å‡½æ•°ï¼Œå®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€äº›åå·®å’Œæƒé‡çš„éšæœºå€¼ã€‚æˆ‘ä»¬ä½¿ç”¨éšæœºåº“æ¥ç»™å‡ºç¬¦åˆæˆ‘ä»¬éœ€è¦çš„éšæœºæ•°ã€‚ä¸‹ä¸€æ­¥æ˜¯ä½¿ç”¨è¿™äº›æƒé‡å’Œåå·®è®¡ç®—è¾“å‡º(Y)ã€‚</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="8d7a" class="lt lu iq lp b gy lv lw l lx ly">def predict_Y(b,theta,X):</span><span id="6e3a" class="lt lu iq lp b gy mh lw l lx ly">return b + np.dot(X,theta)</span><span id="b0cd" class="lt lu iq lp b gy mh lw l lx ly">Y_hat=predict_Y(b,theta,X)</span><span id="c7e9" class="lt lu iq lp b gy mh lw l lx ly">Y_hat[0:10]</span></pre><p id="3a59" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è¾“å‡º:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="e436" class="lt lu iq lp b gy lv lw l lx ly">array([ 3.53610908, 0.53826004, 1.4045012 , 2.27511933, 2.25046604, 1.6023777 , -0.36009639, -0.37804669, -2.20360351, 0.69993066])</span></pre><p id="fad4" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">Y_hat æ˜¯é¢„æµ‹çš„è¾“å‡ºå€¼ï¼Œè€Œ Y å°†æ˜¯å®é™…å€¼ã€‚è¿™ä¸¤è€…ä¹‹é—´çš„å·®å¼‚å°†ç»™å‡ºæˆ‘ä»¬çš„æˆæœ¬å‡½æ•°ã€‚è¿™å°†åœ¨æˆ‘ä»¬ä¸‹ä¸€ä¸ªå‡½æ•°ä¸­è®¡ç®—ã€‚</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="da96" class="lt lu iq lp b gy lv lw l lx ly">import math</span><span id="1def" class="lt lu iq lp b gy mh lw l lx ly">def get_cost(Y,Y_hat):</span><span id="210d" class="lt lu iq lp b gy mh lw l lx ly">Y_resd=Y-Y_hat</span><span id="eba4" class="lt lu iq lp b gy mh lw l lx ly">return np.sum(np.dot(Y_resd.T,Y_resd))/len(Y-Y_resd)</span><span id="0450" class="lt lu iq lp b gy mh lw l lx ly">Y_hat=predict_Y(b,theta,X)</span><span id="e0a2" class="lt lu iq lp b gy mh lw l lx ly">get_cost(Y,Y_hat)</span></pre><p id="d683" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è¾“å‡º:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="445c" class="lt lu iq lp b gy lv lw l lx ly">0.5253558445651124</span></pre><p id="413c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è¿™æ˜¯æˆ‘ä»¬çš„æˆæœ¬å‡½æ•°ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯å°½å¯èƒ½åœ°å‡å°‘è¿™ä¸ªï¼Œä»¥è·å¾—æœ€å‡†ç¡®çš„é¢„æµ‹ã€‚ä¸ºäº†è·å¾—æ›´æ–°çš„åå·®å’Œæƒé‡ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¢¯åº¦ä¸‹é™å…¬å¼:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nb"><img src="../Images/ecfdc38ef0edeac651b8e753373052f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OVgmDqccd2uFMMbNsFZIkQ.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">å›¾ç‰‡ä½œè€…(æ›´æ–°çš„ theta å…¬å¼)ï¼Œ</p></figure><p id="9aa5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">ä¼ é€’ç»™è¯¥å‡½æ•°çš„å‚æ•°æœ‰</p><ol class=""><li id="1471" class="mn mo iq ku b kv kw ky kz lb mp lf mq lj mr ln ms mt mu mv bi translated">xï¼Œy:è¾“å…¥å’Œè¾“å‡ºå˜é‡</li><li id="beed" class="mn mo iq ku b kv mw ky mx lb my lf mz lj na ln ms mt mu mv bi translated">y_hat:å¸¦æœ‰å½“å‰åå·®å’Œæƒé‡çš„é¢„æµ‹å€¼</li><li id="14dc" class="mn mo iq ku b kv mw ky mx lb my lf mz lj na ln ms mt mu mv bi translated">b_0ï¼ŒÎ¸_ 0:ç”µæµåç½®å’Œæƒé‡</li><li id="2b92" class="mn mo iq ku b kv mw ky mx lb my lf mz lj na ln ms mt mu mv bi translated">å­¦ä¹ ç‡:è°ƒæ•´æ›´æ–°æ­¥é•¿çš„å­¦ä¹ ç‡</li></ol><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="b30f" class="lt lu iq lp b gy lv lw l lx ly">def update_theta(x,y,y_hat,b_0,theta_o,learning_rate):</span><span id="fe6c" class="lt lu iq lp b gy mh lw l lx ly">db=(np.sum(y_hat-y)*2)/len(y)</span><span id="5b03" class="lt lu iq lp b gy mh lw l lx ly">dw=(np.dot((y_hat-y),x)*2)/len(y)</span><span id="ce16" class="lt lu iq lp b gy mh lw l lx ly">b_1=b_0-learning_rate*db</span><span id="a283" class="lt lu iq lp b gy mh lw l lx ly">theta_1=theta_o-learning_rate*dw</span><span id="4161" class="lt lu iq lp b gy mh lw l lx ly">return b_1,theta_1</span><span id="0e0f" class="lt lu iq lp b gy mh lw l lx ly">print("After initialization -Bias: ",b,"theta: ",theta)</span><span id="8947" class="lt lu iq lp b gy mh lw l lx ly">Y_hat=predict_Y(b,theta,X)</span><span id="df18" class="lt lu iq lp b gy mh lw l lx ly">b,theta=update_theta(X,Y,Y_hat,b,theta,0.01)</span><span id="e90b" class="lt lu iq lp b gy mh lw l lx ly">print("After first update -Bias: ",b,"theta: ",theta)</span><span id="1ea3" class="lt lu iq lp b gy mh lw l lx ly">get_cost(Y,Y_hat)</span></pre><p id="9c09" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è¾“å‡º:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="0c8b" class="lt lu iq lp b gy lv lw l lx ly">After initialization -Bias:  0.4733071000028529 theta:  [0.56745402 0.43024717 0.0722811 ]<br/>After first update -Bias:  0.46384095800279584 theta:  [0.57117721 0.43202382 0.07171437]</span><span id="0b85" class="lt lu iq lp b gy mh lw l lx ly">0.37245638135702513</span></pre><p id="9a02" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">å¦‚æˆ‘ä»¬æ‰€è§ï¼Œæ–°çš„åå·®å’Œæƒé‡é™ä½äº†æˆæœ¬å‡½æ•°ã€‚ç›®å‰æˆ‘ä»¬å°†å­¦ä¹ ç‡å®šä¸º 0.001ï¼Œæˆ‘ä»¬ä¹Ÿå°†å°è¯• 0.01ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦èƒ½æˆä¸ºæ›´å¥½ã€æ›´ä¼˜çš„å­¦ä¹ ç‡ã€‚</p><p id="4b72" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†æ‰€æœ‰éœ€è¦çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸»æ¢¯åº¦ä¸‹é™å‡½æ•°ï¼Œå®ƒè¿è¡Œå®ƒä»¬ä¸€ä¸ªç‰¹å®šçš„è¿­ä»£æ¬¡æ•°ï¼Œå¹¶ä¸ºæˆ‘ä»¬æ‰¾åˆ°æœ€ä½³çš„åå·®å’Œæƒé‡ã€‚å¯¹äºè¿™ä¸ªå®ç°ï¼Œæˆ‘ä»¬è¿è¡Œè¿™ä¸ªå‡½æ•° 200 æ¬¡è¿­ä»£ã€‚</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="09d0" class="lt lu iq lp b gy lv lw l lx ly">def run_gradient_descent(X,</span><span id="78b4" class="lt lu iq lp b gy mh lw l lx ly">Y,</span><span id="547f" class="lt lu iq lp b gy mh lw l lx ly">alpha,</span><span id="4816" class="lt lu iq lp b gy mh lw l lx ly">num_iterations):</span><span id="edb4" class="lt lu iq lp b gy mh lw l lx ly">b,theta=initialize(X.shape[1])</span><span id="2229" class="lt lu iq lp b gy mh lw l lx ly">iter_num=0</span><span id="c7e0" class="lt lu iq lp b gy mh lw l lx ly">gd_iterations_df=pd.DataFrame(columns=[â€˜iterationâ€™,â€™costâ€™])</span><span id="52d6" class="lt lu iq lp b gy mh lw l lx ly">result_idx=0</span><span id="7162" class="lt lu iq lp b gy mh lw l lx ly">for each_iter in range(num_iterations):</span><span id="7b82" class="lt lu iq lp b gy mh lw l lx ly">Y_hat=predict_Y(b,theta,X)</span><span id="29bb" class="lt lu iq lp b gy mh lw l lx ly">this_cost=get_cost(Y,Y_hat)</span><span id="f27c" class="lt lu iq lp b gy mh lw l lx ly">prev_b=b</span><span id="594b" class="lt lu iq lp b gy mh lw l lx ly">prev_theta=theta</span><span id="a7c2" class="lt lu iq lp b gy mh lw l lx ly">b,theta=update_theta(X,Y,Y_hat,prev_b,prev_theta,alpha)</span><span id="a5a5" class="lt lu iq lp b gy mh lw l lx ly">if(iter_num%10==0):</span><span id="6457" class="lt lu iq lp b gy mh lw l lx ly">gd_iterations_df.loc[result_idx]=[iter_num,this_cost]</span><span id="c2e5" class="lt lu iq lp b gy mh lw l lx ly">result_idx=result_idx+1</span><span id="81f3" class="lt lu iq lp b gy mh lw l lx ly">iter_num +=1</span><span id="ac37" class="lt lu iq lp b gy mh lw l lx ly">print(â€œFinal Estimate of b and theta : â€œ,b,theta)</span><span id="1ee4" class="lt lu iq lp b gy mh lw l lx ly">return gd_iterations_df,b,theta</span><span id="cc6b" class="lt lu iq lp b gy mh lw l lx ly">gd_iterations_df,b,theta=run_gradient_descent(X,Y,alpha=0.001,num_iterations=200)</span></pre><p id="643c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è¾“å‡º:</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="7b3a" class="lt lu iq lp b gy lv lw l lx ly">Final Estimate of b and theta : 0.31516040347417285 [0.39731522 0.31571747 0.61334115]</span></pre><p id="2f2d" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">theta æ˜¯ 3 ä¸ªæ•°å­—çš„åˆ—è¡¨ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰ 3 ä¸ªè¾“å…¥ï¼Œç”µè§†ï¼Œå¹¿æ’­å’ŒæŠ¥çº¸ã€‚å¦‚æœæˆ‘ä»¬æ‰“å°æ¯æ¬¡è¿­ä»£çš„æˆæœ¬å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆæœ¬å‡½æ•°çš„å‡å°‘ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»˜åˆ¶è¿­ä»£çš„æˆæœ¬å‡½æ•°æ¥æŸ¥çœ‹ç»“æœã€‚</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="b294" class="lt lu iq lp b gy lv lw l lx ly">gd_iterations_df[0:10]</span></pre><p id="db1c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è¾“å‡º:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/ffa9b315f4c9256a59887873d619f380.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*iuRzVL_9kUS0v2s7bh_hSw.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ(è¿­ä»£çš„è¾“å‡º)</p></figure><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="8fdc" class="lt lu iq lp b gy lv lw l lx ly">%matplotlib inline</span><span id="5f68" class="lt lu iq lp b gy mh lw l lx ly">plt.plot(gd_iterations_df[â€˜iterationâ€™],gd_iterations_df[â€˜costâ€™])</span><span id="63a9" class="lt lu iq lp b gy mh lw l lx ly">plt.xlabel(â€œNumber of iterationsâ€)</span><span id="79f0" class="lt lu iq lp b gy mh lw l lx ly">plt.ylabel(â€œCost or MSEâ€)</span></pre><p id="9592" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è¾“å‡º:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/b62cf3d74c1daa806046e7ef415628ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*6aHxZEebP5Kp78wAFVV1Rw.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">æŒ‰ä½œè€…åˆ†ç±»çš„å›¾åƒ(æˆæœ¬å‡½æ•°ä¸è¿­ä»£)</p></figure><p id="cfd4" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">æ­£å¦‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°çš„ï¼Œæˆæœ¬å‡½æ•°éšç€è¿­ä»£æ¬¡æ•°çš„å¢åŠ è€Œå‡å°‘ï¼Œä½†æˆ‘ä»¬ä»ç„¶æ²¡æœ‰è¾¾åˆ°æ”¶æ•›ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°è¯•ä½¿ç”¨Î±=0.01 è¿›è¡Œ 2000 æ¬¡è¿­ä»£ï¼Œå¹¶å°†å…¶ä¸Î±=0.001 è¿›è¡Œæ¯”è¾ƒï¼Œæ‰¾å‡ºå“ªä¸ªå­¦ä¹ ç‡å¯¹äºè¯¥æ•°æ®é›†æ›´å¥½ã€‚</p><pre class="kg kh ki kj gt lo lp lq lr aw ls bi"><span id="b2b6" class="lt lu iq lp b gy lv lw l lx ly">alpha_df_1,b,theta=run_gradient_descent(X,Y,alpha=0.01,num_iterations=2000)</span><span id="3ae2" class="lt lu iq lp b gy mh lw l lx ly">alpha_df_2,b,theta=run_gradient_descent(X,Y,alpha=0.001,num_iterations=2000)</span><span id="1740" class="lt lu iq lp b gy mh lw l lx ly">plt.plot(alpha_df_1[â€˜iterationâ€™],alpha_df_1[â€˜costâ€™],label=â€alpha=0.01")</span><span id="2240" class="lt lu iq lp b gy mh lw l lx ly">plt.plot(alpha_df_2[â€˜iterationâ€™],alpha_df_2[â€˜costâ€™],label=â€alpha=0.001")</span><span id="c855" class="lt lu iq lp b gy mh lw l lx ly">plt.legend()</span><span id="835c" class="lt lu iq lp b gy mh lw l lx ly">plt.ylabel(â€˜costâ€™)</span><span id="96ab" class="lt lu iq lp b gy mh lw l lx ly">plt.xlabel(â€˜Number of iterationsâ€™)</span><span id="68ea" class="lt lu iq lp b gy mh lw l lx ly">plt.title(â€˜Cost Vs. Iterations for different alpha valuesâ€™)</span></pre><p id="8eba" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è¾“å‡º:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/9fa15589b088b4ad7a9594269a74b091.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*xlZPvGn3smfQK3TDMPWxcQ.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">ä½œè€…å›¾ç‰‡</p></figure><p id="d76e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">å¯ä»¥çœ‹å‡ºï¼Œ0.01 æ˜¯æ›´ä¼˜çš„å­¦ä¹ é€Ÿç‡ï¼Œå› ä¸ºå®ƒæ¯” 0.001 æ”¶æ•›å¾—æ›´å¿«ã€‚0.01 åœ¨ 100 å¤§å…³é™„è¿‘æ”¶æ•›ï¼Œè€Œ 0.001 éœ€è¦ 1000 æ¬¡è¿­ä»£æ‰èƒ½è¾¾åˆ°æ”¶æ•›ã€‚</p><p id="47e0" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">å› æ­¤ï¼Œæˆ‘ä»¬æˆåŠŸåœ°åœ¨ python ä¸Šæ„å»ºäº†æ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚è®°ä½ï¼Œå­¦ä¹ ç‡çš„æœ€ä½³å€¼å¯¹äºæ¯ä¸ªæ•°æ®é›†éƒ½æ˜¯ä¸åŒçš„ã€‚</p><p id="3e3f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">å¸Œæœ›ä½ ä»Šå¤©å­¦åˆ°äº†æ–°çš„æœ‰æ„ä¹‰çš„ä¸œè¥¿ã€‚</p><p id="7685" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">è°¢è°¢ä½ ã€‚</p></div></div>    
</body>
</html>
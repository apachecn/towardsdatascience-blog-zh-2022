<html>
<head>
<title>Stop Hardcoding Your Unit Tests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœæ­¢ç¡¬ç¼–ç ä½ çš„å•å…ƒæµ‹è¯•</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/stop-hardcoding-your-unit-tests-e6643dfd254b#2022-12-28">https://towardsdatascience.com/stop-hardcoding-your-unit-tests-e6643dfd254b#2022-12-28</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="9ba5" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph"><a class="ae ep" href="https://medium.com/tag/unit-testing" rel="noopener">å•å…ƒæµ‹è¯•</a></h2><div class=""/><div class=""><h2 id="7027" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">ä½¿ç”¨å‡è®¾åœ¨ Python ä¸­è¿›è¡ŒåŸºäºå±æ€§çš„æµ‹è¯•æŒ‡å—</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/10c68b026a9616695cc49b8e07f7775c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mJ9AWsCfUwzM5QWQ"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae li" href="https://unsplash.com/@r3dmax?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">ä¹”çº³æ£®æ´¾</a>åœ¨<a class="ae li" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</p></figure><p id="47ad" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi mf translated">æ•°æ®ç§‘å­¦å®¶çš„å·¥ä½œæœ‰å¾ˆå¤šæ–¹é¢:ä»–ä»¬å¿…é¡»ç†è§£ä¸šåŠ¡é—®é¢˜ï¼ŒçŸ¥é“ä»–ä»¬çš„ç®—æ³•å’Œç»Ÿè®¡æ•°æ®ï¼Œå¹¶ç¼–å†™è®°å½•è‰¯å¥½å’Œç»è¿‡æµ‹è¯•çš„ä»£ç ï¼Œç­‰ç­‰ã€‚è¿™æ˜¯ä¸€é¡¹è‰°å·¨çš„ä»»åŠ¡ï¼Œè€ƒè™‘åˆ°ä½ æœ‰é™çš„æ—¶é—´ï¼Œä½ ç»å¸¸è¦å†³å®šä¼˜å…ˆåšä»€ä¹ˆã€‚</p><p id="05bf" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">ä»æˆ‘çš„ç»éªŒæ¥çœ‹ï¼Œç¼–ç éƒ¨åˆ†é€šå¸¸ä¼šè¢«å¿½ç•¥ä¸€ç‚¹â€”â€”ä»£ç åœ¨ä¸€äº›ç¬”è®°æœ¬ä¸­è¢«åŸå‹åŒ–ï¼Œç„¶ååœ¨æŸä¸ªæ—¶å€™ï¼Œå®ƒè¿è¡Œ<em class="mo">è¶³å¤Ÿå¥½</em>ï¼Œå°±æ˜¯è¿™æ ·ã€‚è¿™ä¹Ÿå‘ç”Ÿåœ¨æˆ‘èº«ä¸Šã€‚æˆ‘ç”šè‡³èƒ½ç†è§£è¿™ä¸€ç‚¹:è®°å½•ä¸œè¥¿ä¸€ç‚¹ä¹Ÿä¸å¥½ç©ï¼Œä½†æ˜¯æ²¡æœ‰å®ƒï¼Œæ²¡æœ‰äºº(åŒ…æ‹¬ä½ è‡ªå·±)èƒ½ç†è§£ä½ çš„ä»£ç ï¼Œå®ƒå¯èƒ½ä¼šåœ¨å°†æ¥è¢«é‡å†™ï¼Œå³ä½¿ä½ å†™äº†æœ‰å²ä»¥æ¥æœ€å¥½çš„ä»£ç ã€‚æ‰€ä»¥ï¼Œå³ä½¿ä»£ç æ–‡æ¡£ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œä»ç„¶è¦ç”¨<strong class="ll je">æ–‡æ¡£åŒ–ä½ çš„ä»£ç </strong>ï¼æˆ‘ç°åœ¨æ¯”è¾ƒæ„Ÿå…´è¶£çš„æ˜¯<strong class="ll je">ä»£ç æµ‹è¯•</strong>ä½ã€‚</p><h1 id="982f" class="mp mq iu bd mr ms mt mu mv mw mx my mz kj na kk nb km nc kn nd kp ne kq nf ng bi translated">ä»£ç æµ‹è¯•</h1><p id="55a1" class="pw-post-body-paragraph lj lk iu ll b lm nh ke lo lp ni kh lr ls nj lu lv lw nk ly lz ma nl mc md me in bi translated">æ‚¨åº”è¯¥å§‹ç»ˆæµ‹è¯•æ‚¨çš„ä»£ç ï¼Œä»¥è·å¾—ä¿¡å¿ƒï¼Œç¡®ä¿¡å®ƒç¡®å®åšäº†æ‚¨æ‰€æœŸæœ›çš„äº‹æƒ…ã€‚</p><blockquote class="nm"><p id="98e3" class="nn no iu bd np nq nr ns nt nu nv me dk translated">æ²¡æœ‰é€‚å½“çš„æµ‹è¯•ï¼Œæ‚¨çš„ä»£ç å¯èƒ½ä¼šåšé”™äº‹æƒ…ï¼Œå¹¶ä¸”æ‚¨çš„åˆ†æä¼šç»™å‡ºè¯¯å¯¼æ€§çš„ç»“æœã€‚</p></blockquote><p id="10ae" class="pw-post-body-paragraph lj lk iu ll b lm nw ke lo lp nx kh lr ls ny lu lv lw nz ly lz ma oa mc md me in bi translated">é‚£ä¹ˆï¼Œå¦‚ä½•æµ‹è¯•ä½ çš„ä»£ç å‘¢ï¼Ÿå¾ˆæœ‰å¯èƒ½ä½ å·²ç»ç”¨<a class="ae li" href="https://docs.python.org/3/library/unittest.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ll je"> unittest </strong> </a>æˆ–è€…<a class="ae li" href="https://docs.pytest.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll je"> pytest </strong> </a>å†™è¿‡ä¸€äº›åŸºæœ¬çš„æµ‹è¯•ã€‚å³ä½¿æ²¡æœ‰ï¼Œä¹Ÿè¯·ç»§ç»­è¯»ä¸‹å»ï¼Œå› ä¸ºæˆ‘å°†ä½¿ç”¨ä¸€ä¸ªå°ä¾‹å­æ¥è§£é‡Šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ç§ä¼ ç»Ÿçš„æµ‹è¯•æ–¹æ³•(åŸºäºå®ä¾‹çš„æµ‹è¯•æ–¹æ³•)ä¸åŸºäºå±æ€§çš„æµ‹è¯•æ–¹æ³•è¿›è¡Œæ¯”è¾ƒï¼Œè¿™æ˜¯æœ¬æ–‡çš„é‡ç‚¹ã€‚</p></div><div class="ab cl ob oc hy od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="in io ip iq ir"><p id="acd7" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">ä½œä¸ºä¸€ä¸ªè¿è¡Œç¤ºä¾‹ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª<strong class="ll je">æ—¶é—´è®­ç»ƒæµ‹è¯•åˆ†å‰²</strong>çš„å®ç°ã€‚å®ƒåº”è¯¥åšåˆ°ä»¥ä¸‹å‡ ç‚¹:é‰´äºâ€¦</p><ul class=""><li id="0e59" class="oi oj iu ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">ç†ŠçŒ«æ•°æ®å¸§<code class="fe or os ot ou b">data</code>åŒ…å«ä¸€ä¸ªåä¸º<em class="mo">æ—¥æœŸ</em>çš„åˆ—</li><li id="8f71" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me on oo op oq bi translated">ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡<code class="fe or os ot ou b">split_date</code></li></ul><p id="0f44" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">è¾“å‡ºä¸¤ä¸ªç†ŠçŒ«æ•°æ®å¸§ï¼Œ</p><ul class=""><li id="e78d" class="oi oj iu ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">åŒ…å«éƒ¨åˆ†<code class="fe or os ot ou b">data</code>çš„<strong class="ll je">åˆ—è½¦</strong>æ•°æ®å¸§ï¼Œå…¶ä¸­<em class="mo">æ—¥æœŸ</em>åˆ—ä¸­çš„å€¼åœ¨ T1 ä¹‹å‰<strong class="ll je"/></li><li id="2328" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me on oo op oq bi translated">ä¸€ä¸ª<strong class="ll je">æµ‹è¯•</strong>æ•°æ®å¸§ï¼ŒåŒ…å«<code class="fe or os ot ou b">data</code>çš„éƒ¨åˆ†ï¼Œå…¶ä¸­<em class="mo">æ—¥æœŸ</em>åˆ—ä¸­çš„å€¼åœ¨ T3 ä¹‹å<strong class="ll je">åˆ°æ¥ã€‚</strong></li></ul><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pa"><img src="../Images/13e6ba5478320e32fff93149d0253bc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nyHvUXGcGMaQF-ZUi8Zm7g.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚</p></figure><p id="240e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">å¾ˆç®€å•ï¼Œå¯¹å§ï¼Ÿç°åœ¨ï¼Œåœ¨æµ‹è¯•è¯¥å‡½æ•°ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»é¦–å…ˆå®ç°å®ƒ:</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="8d35" class="pf mq iu ou b be pg ph l pi pj">def temporal_train_test_split(data, split_date):<br/>    train = data.query("date &lt; @split_date")<br/>    test = data.query("date &gt; @split_date")<br/><br/>    return train, test</span></pre><blockquote class="pk pl pm"><p id="8571" class="lj lk mo ll b lm ln ke lo lp lq kh lr pn lt lu lv po lx ly lz pp mb mc md me in bi translated"><strong class="ll je"> <em class="iu">æ³¨:</em> </strong> <em class="iu">ä»£ç ä¸­æœ‰é”™è¯¯ï¼Œä½†æˆ‘ä»¬å§‘ä¸”å‡è£…å¿½ç•¥äº†ã€‚</em></p></blockquote><h2 id="52d2" class="pq mq iu bd mr pr ps dn mv pt pu dp mz ls pv pw nb lw px py nd ma pz qa nf ja bi translated">åŸºäºå®ä¾‹çš„æµ‹è¯•</h2><p id="10b3" class="pw-post-body-paragraph lj lk iu ll b lm nh ke lo lp ni kh lr ls nj lu lv lw nk ly lz ma nl mc md me in bi translated">ä¸ºäº†æµ‹è¯•ä»£ç ï¼Œæ‚¨é€šå¸¸ä¼šç¡¬ç¼–ç ä¸€äº›è¾“å…¥æ•°æ®ï¼Œå¯¹å…¶åº”ç”¨å‡½æ•°ï¼Œå¹¶ç”¨ç¡¬ç¼–ç çš„é¢„æœŸè¾“å‡ºæ¥æ£€æŸ¥å®ƒã€‚æ‚¨å¯ä»¥åƒè¿™æ ·æµ‹è¯•ä¸Šå›¾ä¸­çš„ç¤ºä¾‹:</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="5df1" class="pf mq iu ou b be pg ph l pi pj">import pandas as pd<br/><br/><br/>#function we want to test<br/>def temporal_train_test_split(data, split_date):<br/>    train = data.query("date &lt; @split_date")<br/>    test = data.query("date &gt; @split_date")<br/><br/>    return train, test<br/><br/># testing function<br/>def test_temporal_train_test_split():<br/>    data = pd.DataFrame(<br/>        {<br/>            "date": [<br/>                "1988-07-31",<br/>                "2022-12-24",<br/>                "2018-03-18",<br/>                "2018-03-19",<br/>                "1994-02-25",<br/>            ],<br/>            "x1": [12, -1, 1, 123, -7],<br/>            "x2": ["a", "d", "c", "a", "b"],<br/>        }<br/>    )<br/><br/>    split_date = "2000-01-01"<br/><br/>    expected_output_train = pd.DataFrame(<br/>        {<br/>            "date": ["1988-07-31", "1994-02-25"],<br/>            "x1": [12, -7],<br/>            "x2": ["a", "b"]<br/>        },<br/>        index=[0, 4],<br/>    )<br/><br/>    expected_output_test = pd.DataFrame(<br/>        {<br/>            "date": ["2022-12-24", "2018-03-18", "2018-03-19"],<br/>            "x1": [-1, 1, 123],<br/>            "x2": ["d", "c", "a"],<br/>        },<br/>        index=[1, 2, 3],<br/>    )<br/><br/>    train, test = temporal_train_test_split(data, split_date)<br/><br/>    assert train.equals(expected_output_train)<br/>    assert test.equals(expected_output_test)</span></pre><p id="94e7" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">é€šè¿‡<code class="fe or os ot ou b">pip install pytest</code>å®‰è£… pytest åï¼Œå°†ä¸Šè¿°ä»£ç ä¿å­˜åœ¨<code class="fe or os ot ou b">test_temporal_train_test_split.py</code>ç­‰æ–‡ä»¶ä¸­ï¼Œå¹¶é€šè¿‡<code class="fe or os ot ou b">pytest test_temporal_train_test_split.py</code>æ‰§è¡Œã€‚pytest éšåå°†è¿è¡Œæµ‹è¯•ï¼Œå¹¶æŠ¥å‘Šæµ‹è¯•æˆåŠŸã€‚å¾ˆå¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹æˆ‘ä»¬çš„ä»£ç æŒ‰é¢„æœŸå·¥ä½œæ›´æœ‰ä¿¡å¿ƒäº†ï¼</p></div><div class="ab cl ob oc hy od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="in io ip iq ir"><p id="acc7" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">ä½†æ˜¯ï¼Œæ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œè¿™ä¸ªæµ‹è¯•å¹¶æ²¡æœ‰æ¶µç›–è¿™ä¸ªå‡½æ•°å¯èƒ½æ¥æ”¶çš„å„ç§è¾“å…¥ã€‚è¿™åªæ˜¯ä¸€ä¸ªå¶ç„¶å‘ç”Ÿçš„æƒ…å†µã€‚æˆ–è®¸ä½ è¿˜ä¼šé”™è¿‡ä¸€äº›<strong class="ll je">è¾¹ç¼˜æƒ…å†µ</strong>ï¼Œåœ¨é‚£é‡Œä½ çš„ä»£ç å¯èƒ½ä¼šä¸­æ–­ã€‚</p><p id="02a9" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">ä½ èƒ½åšçš„ä¸‹ä¸€ä»¶æœ€å¥½çš„äº‹æƒ…æ˜¯å®šä¹‰æ›´å¤šçš„è¾“å…¥/è¾“å‡ºå¯¹æ¥å¢åŠ ä¸€ç‚¹è¦†ç›–èŒƒå›´ï¼Œä½†æ˜¯è¿™çœŸçš„æ²¡æœ‰æ„æ€ï¼Œå› ä¸ºä½ å¿…é¡»ç¡¬ç¼–ç è®¸å¤šæ•°æ®å¸§ã€‚å› ä¸ºåŸºäºå®ä¾‹çš„æµ‹è¯•æ˜¯å¦‚æ­¤ä¹å‘³ï¼Œå¦‚æœä½ æŸ¥çœ‹æµ‹è¯•æ–‡ä»¶ï¼Œé€šå¸¸ä½ æœ€å¤šåªèƒ½çœ‹åˆ°å°‘æ•°ç¡¬ç¼–ç çš„ä¾‹å­ã€‚</p><p id="6bf3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">ä¸è¦è¯¯è§£æˆ‘çš„æ„æ€ï¼Œå³ä½¿åƒè¿™æ ·çš„å°æµ‹è¯•ä¹Ÿæ¯”æ²¡æœ‰æµ‹è¯•è¦å¥½ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨åŸºäºå±æ€§çš„æµ‹è¯•åšå¾—æ›´å¥½ã€‚</p><h2 id="4c27" class="pq mq iu bd mr pr ps dn mv pt pu dp mz ls pv pw nb lw px py nd ma pz qa nf ja bi translated">åŸºäºå±æ€§çš„æµ‹è¯•</h2><p id="a6bd" class="pw-post-body-paragraph lj lk iu ll b lm nh ke lo lp ni kh lr ls nj lu lv lw nk ly lz ma nl mc md me in bi translated">å¦‚æœä½ æƒ³åšåŸºäºå±æ€§çš„æµ‹è¯•ï¼Œé¦–å…ˆä½ å¿…é¡»èŠ±å‡ åˆ†é’Ÿæ—¶é—´æƒ³æƒ³ä½ æƒ³ä»è¾“å‡ºä¸­çœ‹åˆ°ä»€ä¹ˆå±æ€§ã€‚æœ‰æ—¶è¿™å¯èƒ½å¾ˆéš¾åšåˆ°ï¼Œä½†åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œè¿™å¾ˆå®¹æ˜“ã€‚è¾“å‡º<code class="fe or os ot ou b">train</code>å’Œ<code class="fe or os ot ou b">test</code>åº”å…·æœ‰ä»¥ä¸‹å±æ€§:</p><ol class=""><li id="d883" class="oi oj iu ll b lm ln lp lq ls ok lw ol ma om me qb oo op oq bi translated"><code class="fe or os ot ou b">train</code>ä¸­çš„<em class="mo">æ—¥æœŸ</em>æ åº”å§‹ç»ˆå°äºæˆ–ç­‰äº<code class="fe or os ot ou b">split_date</code>ï¼Œå¹¶ä¸”<code class="fe or os ot ou b">test</code>ä¸­çš„<em class="mo">æ—¥æœŸ</em>æ åº”å§‹ç»ˆå¤§äº<code class="fe or os ot ou b">split_date</code>ã€‚</li><li id="d816" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me qb oo op oq bi translated">å¦‚æœæ‚¨è¿æ¥<code class="fe or os ot ou b">train</code>å’Œ<code class="fe or os ot ou b">test</code>ï¼Œæ‚¨åº”è¯¥æ¥æ”¶å›è¾“å…¥æ•°æ®å¸§ï¼Œå³æ²¡æœ‰è¡Œæˆ–åˆ—è¢«æ·»åŠ æˆ–ä¸¢å¤±ï¼Œä¹Ÿæ²¡æœ‰å•å…ƒæ ¼è¢«æ›´æ”¹ã€‚</li></ol><p id="2b30" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">è¿™å®é™…ä¸Šæ˜¯æ—¶é—´è®­ç»ƒæµ‹è¯•åˆ†å‰²çš„æœ¬è´¨ï¼Œå®šä¹‰å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æµ‹è¯•å®ƒã€‚</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="c2cf" class="pf mq iu ou b be pg ph l pi pj">def test_temporal_train_test_split_property():<br/>    data = pd.DataFrame(<br/>        {<br/>            "date": [<br/>                "1988-07-31",<br/>                "2022-12-24",<br/>                "2018-03-18",<br/>                "2018-03-19",<br/>                "1994-02-25",<br/>            ],<br/>            "x1": [12, -1, 1, 123, -7],<br/>            "x2": ["a", "d", "c", "a", "b"],<br/>        }<br/>    )<br/><br/>    split_date = "2000-01-01"<br/><br/>    train, test = temporal_train_test_split(data, split_date)<br/>    concatenated = (<br/>        pd.concat([train, test])<br/>        .sort_values(["date", "x1", "x2"]) # see note below<br/>        .reset_index(drop=True)<br/>    )<br/>    sorted_input = data.sort_values(["date", "x1", "x2"]).reset_index(drop=True) # see note below<br/><br/>    assert (train["date"] &lt;= split_date).all() # 1st property<br/>    assert (test["date"] &gt; split_date).all()   # 1st property<br/>    assert concatenated.equals(sorted_input)   # 2nd property</span></pre><blockquote class="pk pl pm"><p id="c24b" class="lj lk mo ll b lm ln ke lo lp lq kh lr pn lt lu lv po lx ly lz pp mb mc md me in bi translated"><strong class="ll je"> <em class="iu">æ³¨æ„:</em> </strong> <em class="iu">ä½ å¿…é¡»å¯¹æ•°æ®å¸§è¿›è¡Œæ’åºï¼Œå› ä¸ºå°†ä¸€ä¸ªæ•°æ®å¸§åˆ†å‰²æˆè®­ç»ƒå’Œæµ‹è¯•ï¼Œå†å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·å¯èƒ½ä¼šæ”¹å˜è¡Œçš„é¡ºåºã€‚ä½†å³ä½¿åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ£€æŸ¥åº”è¯¥é€šè¿‡ï¼Œé¡ºåºå¹¶ä¸é‡è¦ã€‚</em></p></blockquote><p id="68c7" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">è¿™å·²ç»å¥½å¾—å¤šäº†ï¼Œå› ä¸ºä½ ä¸å†éœ€è¦ç¡¬ç¼–ç è¾“å‡ºã€‚æ‚¨åªéœ€è¦å®šä¹‰ä¸€äº›è¾“å…¥æ•°æ®ï¼Œè®©å±æ€§æ¥å¤„ç†å…¶ä½™çš„äº‹æƒ…ã€‚è¿™ç”šè‡³ä¸ºå¦ä¸€ä¸ªè¯¡è®¡æ‰“å¼€äº†å¤§é—¨:</p><blockquote class="nm"><p id="1b97" class="nn no iu bd np nq nr ns nt nu nv me dk translated">ç”Ÿæˆä¸€å †éšæœºè¾“å…¥ï¼Œç„¶åè¿è¡Œå±æ€§æ£€æŸ¥ï¼Œè¿™ä¸æ˜¯å¾ˆå¥½å—ï¼Ÿ</p></blockquote><p id="d91f" class="pw-post-body-paragraph lj lk iu ll b lm nw ke lo lp nx kh lr ls ny lu lv lw nz ly lz ma oa mc md me in bi translated">è¿™ä¸ªæƒ³æ³•å¾ˆç®€å•ï¼Œæˆ‘æ‰“èµŒä½ å¯ä»¥ç”¨ä¸€äº›è‡ªå®šä¹‰ä»£ç æ¥å®ç°ã€‚ç„¶è€Œï¼Œæˆ‘æ›´æ„¿æ„å‘æ‚¨å±•ç¤ºä¸€ä¸ªæ•´æ´çš„åº“ï¼Œå®ƒå¯ä»¥å¸®åŠ©æ‚¨å®ç°è¿™ä¸ªæƒ³æ³•ï¼Œå³ä½¿æ‚¨å°†ä¼šçœ‹åˆ°åœ¨å®ƒçš„é¡¶éƒ¨æœ‰ä¸€ä¸ªæ¨±æ¡ƒï¼å®ƒè¢«ç§°ä¸º<a class="ae li" href="https://hypothesis.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll je">å‡è®¾</strong> </a>ï¼Œæˆ‘å°†åœ¨æ–‡ç« çš„å…¶ä½™éƒ¨åˆ†å‘æ‚¨å±•ç¤ºå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><h1 id="59d8" class="mp mq iu bd mr ms mt mu mv mw mx my mz kj na kk nb km nc kn nd kp ne kq nf ng bi translated">åŸºäºå‡è®¾çš„ç±»å›ºé†‡æ€§è´¨æ£€éªŒ</h1><p id="bf98" class="pw-post-body-paragraph lj lk iu ll b lm nh ke lo lp ni kh lr ls nj lu lv lw nk ly lz ma nl mc md me in bi translated">é¦–å…ˆï¼Œç”¨ä¸€ä¸ªç®€å•çš„<code class="fe or os ot ou b">pip install hypothesis</code>å®‰è£…è¿™ä¸ªåº“ã€‚åœ¨æˆ‘ä»¬å†™æµ‹è¯•ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç©ä¸€ä¼šå„¿ã€‚å‡è®¾æœ‰ä¸€ç‚¹å¾ˆæ£’ï¼Œé‚£å°±æ˜¯äº§ç”Ÿéšæœºæ•°æ®ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬å¯¼å…¥åº“:</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="d155" class="pf mq iu ou b be pg ph l pi pj">import hypothesis.strategies as st</span></pre><h2 id="7def" class="pq mq iu bd mr pr ps dn mv pt pu dp mz ls pv pw nb lw px py nd ma pz qa nf ja bi translated">å…¥é—¨æŒ‡å—</h2><p id="0bf0" class="pw-post-body-paragraph lj lk iu ll b lm nh ke lo lp ni kh lr ls nj lu lv lw nk ly lz ma nl mc md me in bi translated">ç°åœ¨è®©æˆ‘ä»¬åšä¸€ä¸ªéå¸¸ç®€å•çš„ä»»åŠ¡:<strong class="ll je">â€œç”Ÿæˆéšæœºæ•´æ•°ï¼â€</strong>ã€‚</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="4add" class="pf mq iu ou b be pg ph l pi pj">integer_strategy = st.integers()<br/><br/>for _ in range(5):<br/>    print(integer_strategy.example())<br/><br/># Example output:<br/># 26239<br/># -32170<br/># 8226<br/># 12448<br/># -25828</span></pre><p id="19dc" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">è¿™ä¼šç»™ä½ ä¸€äº›éšæœºçš„æ•´æ•°ã€‚å¥½å§ï¼Œä½†æ˜¯<a class="ae li" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll je"> numpy </strong> </a>ä¹Ÿå¯ä»¥è¿™ä¹ˆåšï¼Œä½•å¿…å‘¢ï¼Ÿçœ‹çœ‹å¦ä¸€ä¸ªä¾‹å­:<strong class="ll je">â€œç”Ÿæˆéšæœºæ•´æ•°åˆ—è¡¨ï¼â€</strong>ã€‚</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="4f8c" class="pf mq iu ou b be pg ph l pi pj">integer_list_strategy = st.lists(st.integers())<br/><br/>for _ in range(5):<br/>    print(integer_list_strategy.example())<br/><br/># Example output: <br/># [-14, -2189, 9898, 116]<br/># [115252802955829576656830209704323089026, 12850, -22, -23389, -37044854417799513209994526228023296414, 9033, -25431, 111, 1650017586, 2100275240795033860, 14027, 9549, 119, 32276, 3287]<br/># [867485840, -16288]<br/># [867485840, -16288]<br/># [23623, 18045420794467201802863702411254425247, 11413941429584508497211673000716218542, -35326783386759048949361175218368769135, 25, 18663, 85, 29311, -54]</span></pre><p id="90ba" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">è¿™ä¸ªæ›´æœ‰æ„æ€ä¸€ç‚¹ã€‚ä¸éœ€è¦å¤ªå¤šçš„åŠªåŠ›ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”Ÿæˆä¸€äº›éšæœºåˆ—è¡¨ï¼Œç”¨æ¥æµ‹è¯•æ’åºç®—æ³•ã€‚</p><p id="acb0" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">æˆ‘ä»¬å¯ä»¥ç»“åˆæ›´å¤šçš„è¿™äº›<em class="mo">ç­–ç•¥</em>æ¥åšæ›´ç–¯ç‹‚çš„äº‹æƒ…ï¼Œæ¯”å¦‚:<strong class="ll je">â€œç”ŸæˆåŒ…å«éšæœºæ•´æ•°å’Œå¸ƒå°”çš„å…ƒç»„åˆ—è¡¨ï¼â€</strong>ã€‚</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="66db" class="pf mq iu ou b be pg ph l pi pj">strategy = st.lists(st.tuples(st.integers(), st.booleans()))<br/><br/>for _ in range(5):<br/>    print(strategy.example())<br/><br/># Example output:<br/># [(-28942, True), (39, True), (2034980965, True), (-633849778, False), (-111, False), (-25, True), (15592, True), (-6976, False), (-29086, True), (20529, False), (-28691, True), (-6358763519719057102, False)]<br/># [(-83, False), (0, True), (16, False), (-21, True), (32707, True), (-45239080, True), (115, False), (567947076, True), (-7363, False)]<br/># [(-100, False), (-14515, True), (32539, False), (-22134, True), (-1419424594, False), (-21631, False)]<br/># [(3401224866052712356, True), (-663846088058567152, True), (26848, False), (71, True), (-4004, True), (-84, True), (5403, True), (31368, False)]<br/># [(21237, False), (-29568, True), (978088832, False), (-1095376597, True)]</span></pre><p id="4774" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">å¤©ç©ºæ˜¯æ— é™çš„ï¼æ‚¨å¯ä»¥å°†å…³é”®å­—ä¼ é€’ç»™æ‰€æœ‰çš„ç­–ç•¥ï¼Œä¾‹å¦‚ï¼Œé™åˆ¶æ•´æ•°çš„å¤§å°æˆ–åˆ—è¡¨é•¿åº¦ã€‚</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="c007" class="pf mq iu ou b be pg ph l pi pj">strategy = st.lists(<br/>    st.tuples(<br/>        st.integers(min_value=0, max_value=5),<br/>        st.booleans()<br/>        ),<br/>    min_size=2, max_size=4<br/>    )<br/><br/>for _ in range(5):<br/>    print(strategy.example())<br/><br/># Example output:<br/># [(0, True), (0, True), (0, True), (0, True)]<br/># [(5, False), (3, True), (2, True), (5, True)]<br/># [(2, True), (4, True), (1, True), (2, False)]<br/># [(2, False), (2, True), (2, True), (2, True)]<br/># [(1, False), (5, False), (2, True)]</span></pre><p id="e6e2" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">è¿˜æœ‰æ›´å¤šçš„ç­–ç•¥ï¼Œæˆ‘é¼“åŠ±ä½ é˜…è¯»å‡è®¾æ–‡æ¡£æ¥äº†è§£æ›´å¤šçš„ä¿¡æ¯ï¼Œä½†æ˜¯ç°åœ¨è®©æˆ‘ä»¬ä¸“æ³¨äºæˆ‘ä»¬çš„ç”¨ä¾‹ã€‚</p><h2 id="7c44" class="pq mq iu bd mr pr ps dn mv pt pu dp mz ls pv pw nb lw px py nd ma pz qa nf ja bi translated">ç”¨å‡è®¾æµ‹è¯•æˆ‘ä»¬çš„ä»£ç </h2><p id="c4d4" class="pw-post-body-paragraph lj lk iu ll b lm nh ke lo lp ni kh lr ls nj lu lv lw nk ly lz ma nl mc md me in bi translated">æé†’ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„æ—¶é—´è®­ç»ƒæµ‹è¯•åˆ†å‰²æœ‰ä¸¤ä¸ªè¾“å…¥:</p><ul class=""><li id="4ec9" class="oi oj iu ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">ç†ŠçŒ«æ•°æ®å¸§<code class="fe or os ot ou b">data</code>åŒ…å«ä¸€ä¸ªåä¸º<em class="mo">çš„æ—¥æœŸ</em>çš„åˆ—</li><li id="cf70" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me on oo op oq bi translated">ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡<code class="fe or os ot ou b">split_date</code></li></ul><p id="68a6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">è®©æˆ‘ä»¬é¦–å…ˆå¤„ç†ç”Ÿæˆéšæœºæ—¥æœŸï¼Œå› ä¸ºè¿™æ›´å®¹æ˜“ã€‚ä½ å¯èƒ½å·²ç»çŒœåˆ°ä½ å¯ä»¥è¿™æ ·åš:</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="bedd" class="pf mq iu ou b be pg ph l pi pj">date_strategy = st.dates()<br/><br/>for _ in range(5):<br/>    print(date_strategy.example())<br/><br/># Example output:<br/># 1479-03-03<br/># 3285-02-06<br/># 0715-06-28<br/># 6354-02-18<br/># 9276-08-08</span></pre><p id="65e2" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">è¿™ç§ç­–ç•¥ä¼šäº§ç”Ÿ Python æ—¥æœŸå¯¹è±¡ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„å‡½æ•°ä»¥<strong class="ll je">å­—ç¬¦ä¸²</strong>çš„å½¢å¼è·å–æ—¥æœŸï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="439a" class="pf mq iu ou b be pg ph l pi pj">st.dates().map(lambda d: d.strftime("%Y-%m-%d"))</span></pre></div><div class="ab cl ob oc hy od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="in io ip iq ir"><p id="2e05" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">æ•°æ®æ¡†æ˜¯ä¸€ç§æ›´å¤æ‚çš„æ•°æ®ç±»å‹ï¼Œä½†æ˜¯å‡è®¾è®©æˆ‘ä»¬åœ¨è¿™é‡Œæœ‰æ‰€äº†è§£ã€‚å®ƒæä¾›äº†å‡ ç§å®šä¹‰æ•°æ®æ¡†çš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘å°†ä½¿ç”¨<code class="fe or os ot ou b">composite</code>è£…é¥°å™¨å‘æ‚¨å±•ç¤ºæœ€é€šç”¨çš„ä¸€ç§ã€‚</p><p id="04e6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">ä»¥ä¸‹ä»£ç ç‰‡æ®µ</p><ol class=""><li id="728d" class="oi oj iu ll b lm ln lp lq ls ok lw ol ma om me qb oo op oq bi translated">åˆ›å»ºéšæœºæ•°é‡çš„è¡Œï¼Œç„¶å</li><li id="4f39" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me qb oo op oq bi translated">åˆ›å»ºä¸€å®šæ•°é‡çš„åŒ…å«æ—¥æœŸã€æ•´æ•°å’Œå­—æ¯ aã€bã€cã€d ä¹‹ä¸€çš„è¡Œï¼Œç„¶å</li><li id="3e06" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me qb oo op oq bi translated">ç”¨å®ƒåˆ¶ä½œä¸€ä¸ªç†ŠçŒ«æ•°æ®æ¡†å¹¶è¾“å‡ºã€‚</li></ol><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="927a" class="pf mq iu ou b be pg ph l pi pj">@st.composite<br/>def random_dataframe_with_a_date_column_strategy(draw):<br/>    n_rows = draw(st.integers(min_value=0, max_value=100))<br/><br/>    rows = [<br/>        (<br/>            draw(st.dates().map(lambda d: d.strftime("%Y-%m-%d"))),<br/>            draw(st.integers()),<br/>            draw(st.sampled_from(list("abcd"))),<br/>        )<br/>        for _ in range(n_rows)<br/>    ]<br/>    data = pd.DataFrame(rows, columns=["date", "x1", "x2"])<br/><br/>    return data</span></pre><p id="5915" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">æ³¨æ„<code class="fe or os ot ou b">draw</code>åœ¨é‚£é‡Œçš„ä¸åŒå‡ºç°ã€‚ä½ éœ€è¦è¿™æ ·åšï¼Œå› ä¸ºåƒ<code class="fe or os ot ou b">range</code>è¿™æ ·çš„å‡½æ•°éœ€è¦åˆé€‚çš„æ•´æ•°ã€‚ä¸ä»»ä½•å…¶ä»–ç­–ç•¥ä¸€æ ·ï¼Œæ‚¨å¯ä»¥</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="c7a5" class="pf mq iu ou b be pg ph l pi pj">random_dataframe_with_a_date_column_strategy().example()</span></pre><p id="8fdb" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">ç°åœ¨æ¥æ¥æ”¶ä¸€ä¸ªéšæœºçš„ä¾‹å­ã€‚</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj qc"><img src="../Images/e1f8846f15d0a4a5d7b0fb559b29d71f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*a4_83osOaSc4J1ab4shxUg.png"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚</p></figure><p id="a163" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">å½“ç„¶ï¼Œä½ å¯ä»¥åˆ¶ä½œæ›´é€šç”¨çš„æ•°æ®æ¡†ã€‚æˆ‘ä»¬åªæ˜¯æ”¹å˜äº†è¿™é‡Œçš„è¡Œæ•°ï¼Œä½†æ˜¯æ‚¨ä¹Ÿå¯ä»¥</p><ul class=""><li id="c678" class="oi oj iu ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">æ”¹å˜åˆ—æ•°</li><li id="ef3f" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me on oo op oq bi translated">æ”¹å˜æ•°æ®ç±»å‹</li><li id="2332" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me on oo op oq bi translated">æ”¹å˜åˆ—å</li></ul><p id="eef5" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">é™¤äº†åˆ«çš„ä»¥å¤–ã€‚ä½†æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹è¿™ä¸ªæ›´å…·ä½“çš„ç­–ç•¥ã€‚</p></div><div class="ab cl ob oc hy od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="in io ip iq ir"><p id="17fc" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">å¤ªå¥½äº†ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ç”Ÿæˆéšæœºè¾“å…¥æ•°æ®äº†ï¼å”¯ä¸€å‰©ä¸‹çš„äº‹æƒ…å°±æ˜¯ä»¥é€‚å½“çš„æ–¹å¼æŠŠå®ƒè¾“å…¥åˆ°æˆ‘ä»¬çš„æµ‹è¯•å‡½æ•°ä¸­ã€‚å¹¸è¿çš„æ˜¯ï¼Œå‡è®¾ä½¿è¿™å˜å¾—éå¸¸å®¹æ˜“ã€‚åªéœ€åˆ›å»ºå¦ä¸€ä¸ªåä¸º<code class="fe or os ot ou b">test_temporal_train_test_split_hypothesis.py</code>çš„æ–‡ä»¶ï¼Œç„¶åç²˜è´´ä»¥ä¸‹å†…å®¹:</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="9d28" class="pf mq iu ou b be pg ph l pi pj">import pandas as pd<br/>from hypothesis import given, note<br/>import hypothesis.strategies as st<br/><br/># Function to test<br/>def temporal_train_test_split(data, split_date):<br/>    train = data.query("date &lt; @split_date")<br/>    test = data.query("date &gt; @split_date")<br/><br/>    return train, test<br/><br/><br/># Strategies<br/>split_date_strategy = st.dates().map(lambda d: d.strftime("%Y-%m-%d"))<br/><br/><br/>@st.composite<br/>def random_dataframe_with_a_date_column_strategy(draw):<br/>    n_rows = draw(st.integers(min_value=0, max_value=100))<br/><br/>    rows = [<br/>        (<br/>            draw(st.dates().map(lambda d: d.strftime("%Y-%m-%d"))),<br/>            draw(st.integers()),<br/>            draw(st.sampled_from(list("abcd"))),<br/>        )<br/>        for _ in range(n_rows)<br/>    ]<br/>    data = pd.DataFrame(rows, columns=["date", "x1", "x2"])<br/><br/>    return data<br/><br/># The actual test<br/>@given(<br/>    data=random_dataframe_with_a_date_column_strategy(), split_date=split_date_strategy<br/>)<br/>def test_temporal_train_test_split(data, split_date):<br/>    note(data) # basically a print function if a test fails<br/>    note(split_date) # basically a print function if a test fails<br/><br/>    train, test = temporal_train_test_split(data, split_date)<br/>    concatenated = (<br/>        pd.concat([train, test])<br/>        .sort_values(["date", "x1", "x2"])<br/>        .reset_index(drop=True)<br/>    )<br/>    sorted_input = data.sort_values(["date", "x1", "x2"]).reset_index(drop=True)<br/><br/>    assert (train["date"] &lt;= split_date).all()<br/>    assert (test["date"] &gt; split_date).all()<br/>    assert concatenated.equals(sorted_input)</span></pre><p id="c7b8" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">æ‚¨å·²ç»çŸ¥é“äº†å…³äºè¿™æ®µä»£ç çš„å¤§éƒ¨åˆ†å†…å®¹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰æƒ³è¦æµ‹è¯•çš„å‡½æ•°ä»¥åŠéšæœºè¾“å…¥çš„ç­–ç•¥ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¥è‡ªå‡è®¾çš„<code class="fe or os ot ou b">given</code>è£…é¥°å™¨è¿›è¡Œæµ‹è¯•ã€‚å·²ç»è¿™æ ·äº†ï¼æˆ‘ä»¬å¯ä»¥è®©å®ƒå†æ¬¡è¿è¡Œ</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="dba8" class="pf mq iu ou b be pg ph l pi pj">pytest test_temporal_train_test_split_hypothesis.py</span></pre><blockquote class="nm"><p id="73fc" class="nn no iu bd np nq qd qe qf qg qh me dk translated">é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™å°†åˆ›å»º 100 ä¸ªéšæœºè¾“å…¥å¹¶æ£€æŸ¥å±æ€§ã€‚</p></blockquote><p id="90f9" class="pw-post-body-paragraph lj lk iu ll b lm nw ke lo lp nx kh lr ls ny lu lv lw nz ly lz ma oa mc md me in bi translated">æ‚¨å¯èƒ½ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj qi"><img src="../Images/3b0b0e1e41af23e016106f9c8fab6e56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_AnCH2vjQEQSJxkKmNcZjQ.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚</p></figure><p id="4bcf" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">å“å‘€ï¼Œæˆ‘ä»¬çš„å‡½æ•°ä»ç„¶åŒ…å«ä¸€ä¸ªé”™è¯¯ï¼å‡è®¾å¾ˆå¥½åœ°å‘Šè¯‰æˆ‘ä»¬å“ªäº›è¾“å…¥äº§ç”Ÿäº†é”™è¯¯ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ä»£ç ä¸­ä½¿ç”¨äº†<code class="fe or os ot ou b">note(data)</code>å’Œ<code class="fe or os ot ou b">note(split_date)</code>ã€‚</p><h2 id="040a" class="pq mq iu bd mr pr ps dn mv pt pu dp mz ls pv pw nb lw px py nd ma pz qa nf ja bi translated">ç¼©å°ç¤ºä¾‹</h2><p id="06c5" class="pw-post-body-paragraph lj lk iu ll b lm nh ke lo lp ni kh lr ls nj lu lv lw nk ly lz ma nl mc md me in bi translated">å¦ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„äº‹æƒ…æ˜¯ï¼Œè¿™ä¸ªä¾‹å­å¾ˆå¥½ï¼Œå¾ˆçŸ­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥çŒœæµ‹é”™è¯¯å¯èƒ½æ˜¯ä»€ä¹ˆã€‚<strong class="ll je">è¿™ç»ä¸æ˜¯å·§åˆã€‚</strong>æ¯å½“ Hypothesis å‘ç°ä¸€ä¸ªç ´åæ‚¨çš„ä»£ç çš„ä¾‹å­â€”â€”åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­å¯èƒ½æ˜¯ä¸€ä¸ªåŒ…å« 98 è¡Œçš„æ•°æ®å¸§â€”â€”å®ƒè¯•å›¾ç®€åŒ–è¿™ä¸ªä¾‹å­ï¼Œè¿™æ ·å®ƒ<strong class="ll je">ä»ç„¶ç ´åæ‚¨çš„ä»£ç </strong>ï¼Œä½†æ˜¯ä»æŸç§æ„ä¹‰ä¸Šè¯´<strong class="ll je">æ¯”</strong>å°ã€‚</p><p id="70ff" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º<strong class="ll je">æ”¶ç¼©</strong>ï¼Œå®ƒè®©äººç±»æ›´å®¹æ˜“æ‰¾åˆ°é”™è¯¯çš„æ¥æºã€‚ç¼©æ°´é€šå¸¸è®©äººæ„Ÿè§‰å¾ˆè‡ªç„¶:</p><ul class=""><li id="c511" class="oi oj iu ll b lm ln lp lq ls ok lw ol ma om me on oo op oq bi translated">ç¼©å°æ•°å­—æ„å‘³ç€è®©å®ƒä»¬æ›´æ¥è¿‘é›¶</li><li id="b741" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me on oo op oq bi translated">ç¼©å‡åˆ—è¡¨æ„å‘³ç€è®©å®ƒä»¬æ›´çŸ­</li><li id="b82a" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me on oo op oq bi translated">æ”¶ç¼©å­—ç¬¦ä¸²æ„å‘³ç€è®©å®ƒä»¬æ›´çŸ­</li><li id="0272" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me on oo op oq bi">â€¦</li></ul><p id="317b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬ç”¨é”™è¯¯ä¿¡æ¯æ¥æ€è€ƒä¸€ä¸‹å“ªé‡Œå‡ºé”™äº†ï¼</p><h2 id="8e13" class="pq mq iu bd mr pr ps dn mv pt pu dp mz ls pv pw nb lw px py nd ma pz qa nf ja bi translated">ä¿®å¤é”™è¯¯</h2><p id="5ddc" class="pw-post-body-paragraph lj lk iu ll b lm nh ke lo lp ni kh lr ls nj lu lv lw nk ly lz ma nl mc md me in bi translated">æˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹åˆ°ï¼Œç ´åæˆ‘ä»¬ä»£ç çš„ä¾‹å­æœ‰ä¸€ä¸ª<code class="fe or os ot ou b">split_date</code>ç­‰äº<code class="fe or os ot ou b">data</code>ä¸­çš„æ—¥æœŸå€¼ï¼Œè¿™çœ‹èµ·æ¥çœŸçš„å¾ˆå¯ç–‘ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„ä»£ç å¯èƒ½ä¸èµ·ä½œç”¨ã€‚è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€çœ‹:</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="3d39" class="pf mq iu ou b be pg ph l pi pj">def temporal_train_test_split(data, split_date):<br/>    train = data.query("date &lt; @split_date")<br/>    test = data.query("date &gt; @split_date")<br/><br/>    return train, test</span></pre><p id="9dec" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">æ˜¯çš„ï¼Œæœ‰é“ç†ã€‚æˆ‘ä»¬ä½¿ç”¨<strong class="ll je"> &lt; </strong>å’Œ<strong class="ll je"> &gt; </strong>ï¼Œä½†æ˜¯ç­‰äº<code class="fe or os ot ou b">split_date</code>çš„æ—¥æœŸä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿä»–ä»¬åªæ˜¯åœ¨æˆ‘ä»¬çš„ç‰ˆæœ¬ä¸­è¢«åˆ é™¤äº†ã€‚ğŸ˜–æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç®€å•çš„</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="1b9e" class="pf mq iu ou b be pg ph l pi pj">def temporal_train_test_split(data, split_date):<br/>    train = data.query("date &lt;= @split_date") # fixed<br/>    test = data.query("date &gt; @split_date")<br/><br/>    return train, test</span></pre><p id="adca" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">å¦‚æœæˆ‘ä»¬è®©å®ƒå†è¿è¡Œä¸€æ¬¡ï¼Œç°åœ¨æµ‹è¯•å°±é€šè¿‡äº†ï¼Œå¤ªæ£’äº†ï¼</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj qj"><img src="../Images/f7122cb3c50216d395ea2e2f7f718421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*un_k_e8096OksAilAf6uSw.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">å›¾ç‰‡ç”±ä½œè€…æä¾›ã€‚</p></figure><p id="11d7" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">åŒæ ·ï¼Œæˆ‘æƒ³å¼ºè°ƒçš„æ˜¯ï¼Œå³ä½¿çœ‹èµ·æ¥åƒæ˜¯è¿è¡Œäº†ä¸€ä¸ªæµ‹è¯•ï¼Œå®é™…ä¸Š<strong class="ll je">è¿è¡Œäº† 100 ä¸ªæµ‹è¯•</strong>ã€‚</p><h2 id="d894" class="pq mq iu bd mr pr ps dn mv pt pu dp mz ls pv pw nb lw px py nd ma pz qa nf ja bi translated">æ›´å¤šåŠŸèƒ½</h2><p id="10cc" class="pw-post-body-paragraph lj lk iu ll b lm nh ke lo lp ni kh lr ls nj lu lv lw nk ly lz ma nl mc md me in bi translated">æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨<code class="fe or os ot ou b">setting</code>è£…é¥°å™¨æ¥æ›´æ”¹è¿™ä¸ªæ•°å­—ï¼Œä¾‹å¦‚:</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="da82" class="pf mq iu ou b be pg ph l pi pj">from hypothesis import settings<br/><br/>@given(<br/>    data=random_dataframe_with_a_date_column_strategy(), split_date=split_date_strategy<br/>)<br/>@settings(max_examples=200) # number of random examples<br/>def test_temporal_train_test_split(data, split_date):<br/>    [...]</span></pre><p id="fe4d" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">æ­¤å¤–ï¼Œæœ‰æ—¶ä½ æƒ³ç¡®ä¿ä¸€äº›å¯¹ä½ æ¥è¯´éå¸¸é‡è¦çš„å…·ä½“ä¾‹å­è¢«è¦†ç›–ï¼Œä½ ä¸æƒ³è®©å®ƒç¢°è¿æ°”ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥åƒè¿™æ ·ä½¿ç”¨<code class="fe or os ot ou b">example</code>è£…é¥°å™¨:</p><pre class="kt ku kv kw gu pb ou pc bn pd pe bi"><span id="126f" class="pf mq iu ou b be pg ph l pi pj">from hypothesis import example<br/><br/>@given(<br/>    data=random_dataframe_with_a_date_column_strategy(), split_date=split_date_strategy<br/>)<br/>@example(data=pd.DataFrame(None, columns=["date", "x1", "x2"]), split_date="9999-12-31") # this example is always covered<br/>def test_temporal_train_test_split(data, split_date):<br/>    [...]</span></pre><p id="53ac" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">ç°åœ¨ä½ çŸ¥é“äº†åŸºäºå±æ€§çš„å‡è®¾æµ‹è¯•çš„åŸºæœ¬çŸ¥è¯†ï¼Œä½ å¯ä»¥è¯•ç€åœ¨ä½ çš„é¡¹ç›®ä¸­åº”ç”¨å®ƒäº†ï¼</p><h1 id="0725" class="mp mq iu bd mr ms mt mu mv mw mx my mz kj na kk nb km nc kn nd kp ne kq nf ng bi translated">ç»“è®º</h1><p id="132c" class="pw-post-body-paragraph lj lk iu ll b lm nh ke lo lp ni kh lr ls nj lu lv lw nk ly lz ma nl mc md me in bi translated">æµ‹è¯•ä½ çš„ä»£ç æ˜¯ä¸€é¡¹å•è°ƒä¹å‘³çš„ä»»åŠ¡ï¼Œä½†æ˜¯ä½ ä»ç„¶å¿…é¡»è¿™æ ·åšæ¥å‘ç°å¯èƒ½ä¼šç ´åä½ çš„ç»“æœçš„é”™è¯¯ã€‚æ‚¨å¯ä»¥é€šè¿‡æä¾›è¾“å…¥/è¾“å‡ºå¯¹(ç¤ºä¾‹)æ¥æµ‹è¯•æ‚¨çš„ä»£ç ï¼Œä½†æ˜¯äººä»¬å€¾å‘äºæœ€å¤šåªç¡¬ç¼–ç ä¸€å°éƒ¨åˆ†ç¤ºä¾‹ã€‚è¿™å¯¼è‡´è¦†ç›–èŒƒå›´å¾ˆå°ï¼Œæ‚¨çš„ä»£ç å¯èƒ½ä»ç„¶ä¸èƒ½å¤„ç†å¤§éƒ¨åˆ†è¾“å…¥ï¼Œæˆ–è€…ä¸€äº›å¯èƒ½å¾ˆé‡è¦çš„è¾¹ç¼˜æƒ…å†µã€‚</p><p id="0ab0" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">åŸºäºå±æ€§çš„æµ‹è¯•æ˜¯å¢åŠ è¦†ç›–ç‡çš„ä¸€ç§ä¾¿æ·æ–¹å¼ã€‚å®ƒæµ‹è¯•éšæœºè¾“å…¥ï¼Œå‡è®¾åº“ç”šè‡³å¯ä»¥ä¸ºæ‚¨æä¾›ç ´åä»£ç çš„ç®€å•ç¤ºä¾‹ï¼Œå› æ­¤ä¿®å¤ bug å˜å¾—æ›´åŠ å®¹æ˜“ã€‚ç¼ºç‚¹æ˜¯ä½ å¿…é¡»æƒ³å‡ºæœ‰æ„ä¹‰çš„å±æ€§ã€‚æœ‰æ—¶å€™è¿™å¾ˆå®¹æ˜“ï¼Œå°±åƒæˆ‘ä»¬çš„æ—¶æ€è®­ç»ƒæµ‹è¯•åˆ†å‰²ä¾‹å­ä¸€æ ·ã€‚å¯¹æ•°å­—è¿›è¡Œæ’åºæ˜¯åŸºäºå±æ€§çš„æµ‹è¯•çš„å¦ä¸€ä¸ªå¾ˆå¥½çš„ç”¨ä¾‹ã€‚ä½ åªéœ€è¦æ£€æŸ¥ä¸€ä¸‹</p><ol class=""><li id="a5d6" class="oi oj iu ll b lm ln lp lq ls ok lw ol ma om me qb oo op oq bi translated">è¾“å‡ºä¸­çš„æ•°å­—æŒ‰å‡åºæ’åˆ—</li><li id="7657" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me qb oo op oq bi translated">æ²¡æœ‰æ•°å­—è¢«æ·»åŠ æˆ–åˆ é™¤ã€‚</li></ol><p id="0d3d" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">ğŸš€å°è¯•å®ç°æ‚¨é€‰æ‹©çš„æ’åºç®—æ³•ï¼Œå¹¶ä½¿ç”¨åŸºäºå±æ€§çš„æµ‹è¯•æ¥æµ‹è¯•å®ƒï¼</strong></p><blockquote class="pk pl pm"><p id="4213" class="lj lk mo ll b lm ln ke lo lp lq kh lr pn lt lu lv po lx ly lz pp mb mc md me in bi translated">å¤æ‚æ€§ç±» NP ä¸­çš„æ¯ä¸ªé—®é¢˜å®é™…ä¸Šéƒ½æ˜¯åŸºäºå±æ€§çš„æµ‹è¯•çš„è‰¯å¥½å€™é€‰ï¼Œå› ä¸ºéªŒè¯è§£å†³æ–¹æ¡ˆå¯ä»¥æœ‰æ•ˆåœ°å®Œæˆã€‚</p></blockquote><p id="fb33" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">ä½†æœ‰æ—¶å¯èƒ½å¾ˆéš¾å¼¥è¡¥å¥½çš„å±æ€§ã€‚æœ‰æ—¶ä½ ä¹Ÿåªæ‰¾åˆ°ä¸€äº›ï¼Œä½†ä¸æ˜¯æ‰€æœ‰çš„å®šä¹‰å±æ€§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨ä»ç„¶å¯ä»¥æ£€æŸ¥æ‚¨èƒ½æƒ³åˆ°çš„æ‰€æœ‰å±æ€§ï¼Œå¹¶åƒåœ¨ä¼ ç»Ÿçš„åŸºäºç¤ºä¾‹çš„æµ‹è¯•ä¸­ä¸€æ ·æä¾›ä¸€äº›æ‰‹åŠ¨ç¤ºä¾‹ã€‚</p><blockquote class="nm"><p id="bfa8" class="nn no iu bd np nq nr ns nt nu nv me dk translated">æ²¡æœ‰ä»€ä¹ˆèƒ½é˜»æ­¢ä½ åŒæ—¶ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•ï¼å¾ˆå¤šæ—¶å€™ï¼Œè¿™ç”šè‡³æ˜¯ä¸€ä»¶ä¼Ÿå¤§çš„äº‹æƒ…ã€‚</p></blockquote></div><div class="ab cl ob oc hy od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="in io ip iq ir"><p id="a981" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">æˆ‘å¸Œæœ›ä½ ä»Šå¤©å­¦åˆ°äº†æ–°çš„ã€æœ‰è¶£çš„ã€æœ‰ç”¨çš„ä¸œè¥¿ã€‚æ„Ÿè°¢é˜…è¯»ï¼</p><p id="d656" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">ä½œä¸ºæœ€åä¸€ç‚¹ï¼Œå¦‚æœä½ </strong></p><ol class=""><li id="5148" class="oi oj iu ll b lm ln lp lq ls ok lw ol ma om me qb oo op oq bi translated"><strong class="ll je">æƒ³æ”¯æŒæˆ‘å¤šå†™ç‚¹æœºå™¨å­¦ä¹ å’Œ</strong></li><li id="b818" class="oi oj iu ll b lm ov lp ow ls ox lw oy ma oz me qb oo op oq bi translated"><strong class="ll je">æ— è®ºå¦‚ä½•éƒ½è®¡åˆ’è·å¾—ä¸€ä¸ªä¸­ç­‰è®¢é˜…ï¼Œ</strong></li></ol><p id="ac0c" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><strong class="ll je">ä¸ºä»€ä¹ˆä¸åš</strong> <a class="ae li" href="https://dr-robert-kuebler.medium.com/membership" rel="noopener"> <strong class="ll je">é€šè¿‡è¿™ä¸ªç¯èŠ‚</strong> </a> <strong class="ll je">ï¼Ÿè¿™å°†å¯¹æˆ‘å¸®åŠ©å¾ˆå¤§ï¼ğŸ˜Š</strong></p><p id="5e2f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><em class="mo">è¯´ç™½äº†ï¼Œç»™ä½ çš„ä»·æ ¼ä¸å˜ï¼Œä½†å¤§çº¦ä¸€åŠçš„è®¢é˜…è´¹ç›´æ¥å½’æˆ‘ã€‚</em></p><p id="bce3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">éå¸¸æ„Ÿè°¢ï¼Œå¦‚æœä½ è€ƒè™‘æ”¯æŒæˆ‘çš„è¯ï¼</p><blockquote class="nm"><p id="bfae" class="nn no iu bd np nq nr ns nt nu nv me dk translated">å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·åœ¨<a class="ae li" href="https://www.linkedin.com/in/dr-robert-k%C3%BCbler-983859150/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>ä¸Šç»™æˆ‘å†™ä¿¡ï¼</p></blockquote></div></div>    
</body>
</html>